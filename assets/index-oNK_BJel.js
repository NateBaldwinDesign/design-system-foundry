var Ky=Object.defineProperty;var Qy=(e,t,n)=>t in e?Ky(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var bs=(e,t,n)=>Qy(e,typeof t!="symbol"?t+"":t,n);import{u as tn,a as Hn,j as s,B as Y,T as B,b as Ee,V as ye,H as ve,c as us,I as mt,M as zn,d as vn,e as Pn,f as wn,g as cr,h as Sn,F as Ge,i as Ue,k as ut,l as Xn,C as Yl,m as yt,S as Qa,n as Ki,o as Qi,p as ea,q as Jo,r as Bs,s as ai,t as ir,v as pn,w as Fs,x as sn,D as Ss,y as er,A as ex,z as tx,E as nx,G as pt,J as rx,K as sx,L as xn,N as bn,O as Oi,P as or,Q as Zt,R as cs,U as Np,W as ca,X as pa,Y as ma,Z as ix,_ as Bi,$ as so,a0 as Mp,a1 as io,a2 as bl,a3 as vl,a4 as Di,a5 as ax,a6 as ox,a7 as lx,a8 as cx,a9 as Fi,aa as Li,ab as Jn,ac as Tn,ad as Dp,ae as vr,af as bd,ag as Jl,ah as Rp,ai as vd,aj as wl,ak as Op,al as Vp,am as ux,an as $i,ao as Iu,ap as dx,aq as Ur,ar as $a,as as Xc,at as Ga,au as hx,av as Ih,aw as Xo,ax as sa,ay as ia,az as aa,aA as Au,aB as _u,aC as Eu,aD as Nu,aE as Mu,aF as Ia,aG as fr,aH as Ah,aI as it,aJ as fx,aK as zp,aL as px,aM as Ls,aN as $t,aO as mx,aP as gx,aQ as yx,aR as _h,aS as Pp,aT as xx}from"./chakra-C1ddy4GE.js";import{a as wd,b as kt,r as z,d as bx,c as Bp,g as vx}from"./vendor-CnbTAVxw.js";import{u as wx,L as Sx,a as kx,H as jx,R as Cx,b as yn,N as ta}from"./router-p6W222uo.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Du={},Eh=wd;Du.createRoot=Eh.createRoot,Du.hydrateRoot=Eh.hydrateRoot;const Tx="modulepreload",Ix=function(e){return"/"+e},Nh={},oa=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(n.map(h=>{if(h=Ix(h),h in Nh)return;Nh[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":Tx,f||(g.as="script"),g.crossOrigin="",g.href=h,u&&g.setAttribute("nonce",u),document.head.appendChild(g),f)return new Promise((y,b)=>{g.addEventListener("load",y),g.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return i.then(l=>{for(const u of l||[])u.status==="rejected"&&a(u.reason);return t().catch(a)})};var Yt;(function(e){e.assertEqual=i=>{};function t(i){}e.assertIs=t;function n(i){throw new Error}e.assertNever=n,e.arrayToEnum=i=>{const a={};for(const l of i)a[l]=l;return a},e.getValidEnumValues=i=>{const a=e.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),l={};for(const u of a)l[u]=i[u];return e.objectValues(l)},e.objectValues=i=>e.objectKeys(i).map(function(a){return i[a]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&a.push(l);return a},e.find=(i,a)=>{for(const l of i)if(a(l))return l},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,a=" | "){return i.map(l=>typeof l=="string"?`'${l}'`:l).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(Yt||(Yt={}));var Mh;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(Mh||(Mh={}));const tt=Yt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ni=e=>{switch(typeof e){case"undefined":return tt.undefined;case"string":return tt.string;case"number":return Number.isNaN(e)?tt.nan:tt.number;case"boolean":return tt.boolean;case"function":return tt.function;case"bigint":return tt.bigint;case"symbol":return tt.symbol;case"object":return Array.isArray(e)?tt.array:e===null?tt.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?tt.promise:typeof Map<"u"&&e instanceof Map?tt.map:typeof Set<"u"&&e instanceof Set?tt.set:typeof Date<"u"&&e instanceof Date?tt.date:tt.object;default:return tt.unknown}},Be=Yt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Hs extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},r={_errors:[]},i=a=>{for(const l of a.issues)if(l.code==="invalid_union")l.unionErrors.map(i);else if(l.code==="invalid_return_type")i(l.returnTypeError);else if(l.code==="invalid_arguments")i(l.argumentsError);else if(l.path.length===0)r._errors.push(n(l));else{let u=r,h=0;for(;h<l.path.length;){const f=l.path[h];h===l.path.length-1?(u[f]=u[f]||{_errors:[]},u[f]._errors.push(n(l))):u[f]=u[f]||{_errors:[]},u=u[f],h++}}};return i(this),r}static assert(t){if(!(t instanceof Hs))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Yt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):r.push(t(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Hs.create=e=>new Hs(e);const Ru=(e,t)=>{let n;switch(e.code){case Be.invalid_type:e.received===tt.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Be.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Yt.jsonStringifyReplacer)}`;break;case Be.unrecognized_keys:n=`Unrecognized key(s) in object: ${Yt.joinValues(e.keys,", ")}`;break;case Be.invalid_union:n="Invalid input";break;case Be.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Yt.joinValues(e.options)}`;break;case Be.invalid_enum_value:n=`Invalid enum value. Expected ${Yt.joinValues(e.options)}, received '${e.received}'`;break;case Be.invalid_arguments:n="Invalid function arguments";break;case Be.invalid_return_type:n="Invalid function return type";break;case Be.invalid_date:n="Invalid date";break;case Be.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Yt.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Be.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Be.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Be.custom:n="Invalid input";break;case Be.invalid_intersection_types:n="Intersection results could not be merged";break;case Be.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Be.not_finite:n="Number must be finite";break;default:n=t.defaultError,Yt.assertNever(e)}return{message:n}};let Ax=Ru;function _x(){return Ax}const Ex=e=>{const{data:t,path:n,errorMaps:r,issueData:i}=e,a=[...n,...i.path||[]],l={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let u="";const h=r.filter(f=>!!f).slice().reverse();for(const f of h)u=f(l,{data:t,defaultError:u}).message;return{...i,path:a,message:u}};function Ye(e,t){const n=_x(),r=Ex({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Ru?void 0:Ru].filter(i=>!!i)});e.common.issues.push(r)}class jr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const i of n){if(i.status==="aborted")return wt;i.status==="dirty"&&t.dirty(),r.push(i.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const i of n){const a=await i.key,l=await i.value;r.push({key:a,value:l})}return jr.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const i of n){const{key:a,value:l}=i;if(a.status==="aborted"||l.status==="aborted")return wt;a.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof l.value<"u"||i.alwaysSet)&&(r[a.value]=l.value)}return{status:t.value,value:r}}}const wt=Object.freeze({status:"aborted"}),Ja=e=>({status:"dirty",value:e}),ss=e=>({status:"valid",value:e}),Dh=e=>e.status==="aborted",Rh=e=>e.status==="dirty",ga=e=>e.status==="valid",Sl=e=>typeof Promise<"u"&&e instanceof Promise;var ct;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(ct||(ct={}));class Cs{constructor(t,n,r,i){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Oh=(e,t)=>{if(ga(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Hs(e.common.issues);return this._error=n,this._error}}};function Nt(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(l,u)=>{const{message:h}=e;return l.code==="invalid_enum_value"?{message:h??u.defaultError}:typeof u.data>"u"?{message:h??r??u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:h??n??u.defaultError}},description:i}}class Pt{get description(){return this._def.description}_getType(t){return ni(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:ni(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new jr,ctx:{common:t.parent.common,data:t.data,parsedType:ni(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Sl(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ni(t)},i=this._parseSync({data:t,path:r.path,parent:r});return Oh(r,i)}"~validate"(t){var r,i;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ni(t)};if(!this["~standard"].async)try{const a=this._parseSync({data:t,path:[],parent:n});return ga(a)?{value:a.value}:{issues:n.common.issues}}catch(a){(i=(r=a==null?void 0:a.message)==null?void 0:r.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(a=>ga(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ni(t)},i=this._parse({data:t,path:r.path,parent:r}),a=await(Sl(i)?i:Promise.resolve(i));return Oh(r,a)}refine(t,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,a)=>{const l=t(i),u=()=>a.addIssue({code:Be.custom,...r(i)});return typeof Promise<"u"&&l instanceof Promise?l.then(h=>h?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(t,n){return this._refinement((r,i)=>t(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(t){return new ba({schema:this,typeName:xt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return di.create(this,this._def)}nullable(){return va.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ks.create(this)}promise(){return Il.create(this,this._def)}or(t){return jl.create([this,t],this._def)}and(t){return Cl.create(this,t,this._def)}transform(t){return new ba({...Nt(this._def),schema:this,typeName:xt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Pu({...Nt(this._def),innerType:this,defaultValue:n,typeName:xt.ZodDefault})}brand(){return new Qx({typeName:xt.ZodBranded,type:this,...Nt(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Bu({...Nt(this._def),innerType:this,catchValue:n,typeName:xt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Sd.create(this,t)}readonly(){return Fu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Nx=/^c[^\s-]{8,}$/i,Mx=/^[0-9a-z]+$/,Dx=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Rx=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ox=/^[a-z0-9_-]{21}$/i,Vx=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,zx=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Px=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Bx="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Kc;const Fx=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Lx=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,$x=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Gx=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Hx=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,qx=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Fp="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ux=new RegExp(`^${Fp}$`);function Lp(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Wx(e){return new RegExp(`^${Lp(e)}$`)}function Zx(e){let t=`${Fp}T${Lp(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Yx(e,t){return!!((t==="v4"||!t)&&Fx.test(e)||(t==="v6"||!t)&&$x.test(e))}function Jx(e,t){if(!Vx.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||t&&i.alg!==t)}catch{return!1}}function Xx(e,t){return!!((t==="v4"||!t)&&Lx.test(e)||(t==="v6"||!t)&&Gx.test(e))}class $s extends Pt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==tt.string){const a=this._getOrReturnCtx(t);return Ye(a,{code:Be.invalid_type,expected:tt.string,received:a.parsedType}),wt}const r=new jr;let i;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const l=t.data.length>a.value,u=t.data.length<a.value;(l||u)&&(i=this._getOrReturnCtx(t,i),l?Ye(i,{code:Be.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&Ye(i,{code:Be.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")Px.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"email",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Kc||(Kc=new RegExp(Bx,"u")),Kc.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"emoji",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")Rx.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"uuid",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")Ox.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"nanoid",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")Nx.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"cuid",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")Mx.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"cuid2",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")Dx.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"ulid",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),Ye(i,{validation:"url",code:Be.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"regex",code:Be.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?Zx(a).test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?Ux.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?Wx(a).test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?zx.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"duration",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?Yx(t.data,a.version)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"ip",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?Jx(t.data,a.alg)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"jwt",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?Xx(t.data,a.version)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"cidr",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?Hx.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"base64",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?qx.test(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{validation:"base64url",code:Be.invalid_string,message:a.message}),r.dirty()):Yt.assertNever(a);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(i=>t.test(i),{validation:n,code:Be.invalid_string,...ct.errToObj(r)})}_addCheck(t){return new $s({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...ct.errToObj(t)})}url(t){return this._addCheck({kind:"url",...ct.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...ct.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...ct.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...ct.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...ct.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...ct.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...ct.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...ct.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...ct.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...ct.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...ct.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...ct.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...ct.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...ct.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...ct.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...ct.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...ct.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...ct.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...ct.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...ct.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...ct.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...ct.errToObj(n)})}nonempty(t){return this.min(1,ct.errToObj(t))}trim(){return new $s({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new $s({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new $s({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}$s.create=e=>new $s({checks:[],typeName:xt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Nt(e)});function Kx(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r,a=Number.parseInt(e.toFixed(i).replace(".","")),l=Number.parseInt(t.toFixed(i).replace(".",""));return a%l/10**i}class ya extends Pt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==tt.number){const a=this._getOrReturnCtx(t);return Ye(a,{code:Be.invalid_type,expected:tt.number,received:a.parsedType}),wt}let r;const i=new jr;for(const a of this._def.checks)a.kind==="int"?Yt.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Ye(r,{code:Be.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),Ye(r,{code:Be.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),Ye(r,{code:Be.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?Kx(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),Ye(r,{code:Be.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Ye(r,{code:Be.not_finite,message:a.message}),i.dirty()):Yt.assertNever(a);return{status:i.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,ct.toString(n))}gt(t,n){return this.setLimit("min",t,!1,ct.toString(n))}lte(t,n){return this.setLimit("max",t,!0,ct.toString(n))}lt(t,n){return this.setLimit("max",t,!1,ct.toString(n))}setLimit(t,n,r,i){return new ya({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:ct.toString(i)}]})}_addCheck(t){return new ya({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:ct.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ct.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ct.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ct.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ct.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:ct.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:ct.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ct.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ct.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Yt.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}ya.create=e=>new ya({checks:[],typeName:xt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Nt(e)});class ao extends Pt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==tt.bigint)return this._getInvalidInput(t);let r;const i=new jr;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),Ye(r,{code:Be.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),Ye(r,{code:Be.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Ye(r,{code:Be.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):Yt.assertNever(a);return{status:i.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return Ye(n,{code:Be.invalid_type,expected:tt.bigint,received:n.parsedType}),wt}gte(t,n){return this.setLimit("min",t,!0,ct.toString(n))}gt(t,n){return this.setLimit("min",t,!1,ct.toString(n))}lte(t,n){return this.setLimit("max",t,!0,ct.toString(n))}lt(t,n){return this.setLimit("max",t,!1,ct.toString(n))}setLimit(t,n,r,i){return new ao({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:ct.toString(i)}]})}_addCheck(t){return new ao({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ct.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ct.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ct.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ct.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:ct.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}ao.create=e=>new ao({checks:[],typeName:xt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Nt(e)});class Ou extends Pt{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==tt.boolean){const r=this._getOrReturnCtx(t);return Ye(r,{code:Be.invalid_type,expected:tt.boolean,received:r.parsedType}),wt}return ss(t.data)}}Ou.create=e=>new Ou({typeName:xt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Nt(e)});class kl extends Pt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==tt.date){const a=this._getOrReturnCtx(t);return Ye(a,{code:Be.invalid_type,expected:tt.date,received:a.parsedType}),wt}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return Ye(a,{code:Be.invalid_date}),wt}const r=new jr;let i;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):Yt.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new kl({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:ct.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:ct.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}kl.create=e=>new kl({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:xt.ZodDate,...Nt(e)});class Vh extends Pt{_parse(t){if(this._getType(t)!==tt.symbol){const r=this._getOrReturnCtx(t);return Ye(r,{code:Be.invalid_type,expected:tt.symbol,received:r.parsedType}),wt}return ss(t.data)}}Vh.create=e=>new Vh({typeName:xt.ZodSymbol,...Nt(e)});class zh extends Pt{_parse(t){if(this._getType(t)!==tt.undefined){const r=this._getOrReturnCtx(t);return Ye(r,{code:Be.invalid_type,expected:tt.undefined,received:r.parsedType}),wt}return ss(t.data)}}zh.create=e=>new zh({typeName:xt.ZodUndefined,...Nt(e)});class Ph extends Pt{_parse(t){if(this._getType(t)!==tt.null){const r=this._getOrReturnCtx(t);return Ye(r,{code:Be.invalid_type,expected:tt.null,received:r.parsedType}),wt}return ss(t.data)}}Ph.create=e=>new Ph({typeName:xt.ZodNull,...Nt(e)});class Vu extends Pt{constructor(){super(...arguments),this._any=!0}_parse(t){return ss(t.data)}}Vu.create=e=>new Vu({typeName:xt.ZodAny,...Nt(e)});class Bh extends Pt{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ss(t.data)}}Bh.create=e=>new Bh({typeName:xt.ZodUnknown,...Nt(e)});class gi extends Pt{_parse(t){const n=this._getOrReturnCtx(t);return Ye(n,{code:Be.invalid_type,expected:tt.never,received:n.parsedType}),wt}}gi.create=e=>new gi({typeName:xt.ZodNever,...Nt(e)});class Fh extends Pt{_parse(t){if(this._getType(t)!==tt.undefined){const r=this._getOrReturnCtx(t);return Ye(r,{code:Be.invalid_type,expected:tt.void,received:r.parsedType}),wt}return ss(t.data)}}Fh.create=e=>new Fh({typeName:xt.ZodVoid,...Nt(e)});class ks extends Pt{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),i=this._def;if(n.parsedType!==tt.array)return Ye(n,{code:Be.invalid_type,expected:tt.array,received:n.parsedType}),wt;if(i.exactLength!==null){const l=n.data.length>i.exactLength.value,u=n.data.length<i.exactLength.value;(l||u)&&(Ye(n,{code:l?Be.too_big:Be.too_small,minimum:u?i.exactLength.value:void 0,maximum:l?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(Ye(n,{code:Be.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(Ye(n,{code:Be.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((l,u)=>i.type._parseAsync(new Cs(n,l,n.path,u)))).then(l=>jr.mergeArray(r,l));const a=[...n.data].map((l,u)=>i.type._parseSync(new Cs(n,l,n.path,u)));return jr.mergeArray(r,a)}get element(){return this._def.type}min(t,n){return new ks({...this._def,minLength:{value:t,message:ct.toString(n)}})}max(t,n){return new ks({...this._def,maxLength:{value:t,message:ct.toString(n)}})}length(t,n){return new ks({...this._def,exactLength:{value:t,message:ct.toString(n)}})}nonempty(t){return this.min(1,t)}}ks.create=(e,t)=>new ks({type:e,minLength:null,maxLength:null,exactLength:null,typeName:xt.ZodArray,...Nt(t)});function ra(e){if(e instanceof Gn){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=di.create(ra(r))}return new Gn({...e._def,shape:()=>t})}else return e instanceof ks?new ks({...e._def,type:ra(e.element)}):e instanceof di?di.create(ra(e.unwrap())):e instanceof va?va.create(ra(e.unwrap())):e instanceof Vi?Vi.create(e.items.map(t=>ra(t))):e}class Gn extends Pt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Yt.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==tt.object){const f=this._getOrReturnCtx(t);return Ye(f,{code:Be.invalid_type,expected:tt.object,received:f.parsedType}),wt}const{status:r,ctx:i}=this._processInputParams(t),{shape:a,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof gi&&this._def.unknownKeys==="strip"))for(const f in i.data)l.includes(f)||u.push(f);const h=[];for(const f of l){const p=a[f],g=i.data[f];h.push({key:{status:"valid",value:f},value:p._parse(new Cs(i,g,i.path,f)),alwaysSet:f in i.data})}if(this._def.catchall instanceof gi){const f=this._def.unknownKeys;if(f==="passthrough")for(const p of u)h.push({key:{status:"valid",value:p},value:{status:"valid",value:i.data[p]}});else if(f==="strict")u.length>0&&(Ye(i,{code:Be.unrecognized_keys,keys:u}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const p of u){const g=i.data[p];h.push({key:{status:"valid",value:p},value:f._parse(new Cs(i,g,i.path,p)),alwaysSet:p in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const f=[];for(const p of h){const g=await p.key,y=await p.value;f.push({key:g,value:y,alwaysSet:p.alwaysSet})}return f}).then(f=>jr.mergeObjectSync(r,f)):jr.mergeObjectSync(r,h)}get shape(){return this._def.shape()}strict(t){return ct.errToObj,new Gn({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var a,l;const i=((l=(a=this._def).errorMap)==null?void 0:l.call(a,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:ct.errToObj(t).message??i}:{message:i}}}:{}})}strip(){return new Gn({...this._def,unknownKeys:"strip"})}passthrough(){return new Gn({...this._def,unknownKeys:"passthrough"})}extend(t){return new Gn({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Gn({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:xt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Gn({...this._def,catchall:t})}pick(t){const n={};for(const r of Yt.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Gn({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Yt.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Gn({...this._def,shape:()=>n})}deepPartial(){return ra(this)}partial(t){const n={};for(const r of Yt.objectKeys(this.shape)){const i=this.shape[r];t&&!t[r]?n[r]=i:n[r]=i.optional()}return new Gn({...this._def,shape:()=>n})}required(t){const n={};for(const r of Yt.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof di;)a=a._def.innerType;n[r]=a}return new Gn({...this._def,shape:()=>n})}keyof(){return $p(Yt.objectKeys(this.shape))}}Gn.create=(e,t)=>new Gn({shape:()=>e,unknownKeys:"strip",catchall:gi.create(),typeName:xt.ZodObject,...Nt(t)});Gn.strictCreate=(e,t)=>new Gn({shape:()=>e,unknownKeys:"strict",catchall:gi.create(),typeName:xt.ZodObject,...Nt(t)});Gn.lazycreate=(e,t)=>new Gn({shape:e,unknownKeys:"strip",catchall:gi.create(),typeName:xt.ZodObject,...Nt(t)});class jl extends Pt{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function i(a){for(const u of a)if(u.result.status==="valid")return u.result;for(const u of a)if(u.result.status==="dirty")return n.common.issues.push(...u.ctx.common.issues),u.result;const l=a.map(u=>new Hs(u.ctx.common.issues));return Ye(n,{code:Be.invalid_union,unionErrors:l}),wt}if(n.common.async)return Promise.all(r.map(async a=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(i);{let a;const l=[];for(const h of r){const f={...n,common:{...n.common,issues:[]},parent:null},p=h._parseSync({data:n.data,path:n.path,parent:f});if(p.status==="valid")return p;p.status==="dirty"&&!a&&(a={result:p,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const u=l.map(h=>new Hs(h));return Ye(n,{code:Be.invalid_union,unionErrors:u}),wt}}get options(){return this._def.options}}jl.create=(e,t)=>new jl({options:e,typeName:xt.ZodUnion,...Nt(t)});function zu(e,t){const n=ni(e),r=ni(t);if(e===t)return{valid:!0,data:e};if(n===tt.object&&r===tt.object){const i=Yt.objectKeys(t),a=Yt.objectKeys(e).filter(u=>i.indexOf(u)!==-1),l={...e,...t};for(const u of a){const h=zu(e[u],t[u]);if(!h.valid)return{valid:!1};l[u]=h.data}return{valid:!0,data:l}}else if(n===tt.array&&r===tt.array){if(e.length!==t.length)return{valid:!1};const i=[];for(let a=0;a<e.length;a++){const l=e[a],u=t[a],h=zu(l,u);if(!h.valid)return{valid:!1};i.push(h.data)}return{valid:!0,data:i}}else return n===tt.date&&r===tt.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Cl extends Pt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),i=(a,l)=>{if(Dh(a)||Dh(l))return wt;const u=zu(a.value,l.value);return u.valid?((Rh(a)||Rh(l))&&n.dirty(),{status:n.value,value:u.data}):(Ye(r,{code:Be.invalid_intersection_types}),wt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,l])=>i(a,l)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Cl.create=(e,t,n)=>new Cl({left:e,right:t,typeName:xt.ZodIntersection,...Nt(n)});class Vi extends Pt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==tt.array)return Ye(r,{code:Be.invalid_type,expected:tt.array,received:r.parsedType}),wt;if(r.data.length<this._def.items.length)return Ye(r,{code:Be.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),wt;!this._def.rest&&r.data.length>this._def.items.length&&(Ye(r,{code:Be.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((l,u)=>{const h=this._def.items[u]||this._def.rest;return h?h._parse(new Cs(r,l,r.path,u)):null}).filter(l=>!!l);return r.common.async?Promise.all(a).then(l=>jr.mergeArray(n,l)):jr.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new Vi({...this._def,rest:t})}}Vi.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Vi({items:e,typeName:xt.ZodTuple,rest:null,...Nt(t)})};class Tl extends Pt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==tt.object)return Ye(r,{code:Be.invalid_type,expected:tt.object,received:r.parsedType}),wt;const i=[],a=this._def.keyType,l=this._def.valueType;for(const u in r.data)i.push({key:a._parse(new Cs(r,u,r.path,u)),value:l._parse(new Cs(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?jr.mergeObjectAsync(n,i):jr.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Pt?new Tl({keyType:t,valueType:n,typeName:xt.ZodRecord,...Nt(r)}):new Tl({keyType:$s.create(),valueType:t,typeName:xt.ZodRecord,...Nt(n)})}}class Lh extends Pt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==tt.map)return Ye(r,{code:Be.invalid_type,expected:tt.map,received:r.parsedType}),wt;const i=this._def.keyType,a=this._def.valueType,l=[...r.data.entries()].map(([u,h],f)=>({key:i._parse(new Cs(r,u,r.path,[f,"key"])),value:a._parse(new Cs(r,h,r.path,[f,"value"]))}));if(r.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const h of l){const f=await h.key,p=await h.value;if(f.status==="aborted"||p.status==="aborted")return wt;(f.status==="dirty"||p.status==="dirty")&&n.dirty(),u.set(f.value,p.value)}return{status:n.value,value:u}})}else{const u=new Map;for(const h of l){const f=h.key,p=h.value;if(f.status==="aborted"||p.status==="aborted")return wt;(f.status==="dirty"||p.status==="dirty")&&n.dirty(),u.set(f.value,p.value)}return{status:n.value,value:u}}}}Lh.create=(e,t,n)=>new Lh({valueType:t,keyType:e,typeName:xt.ZodMap,...Nt(n)});class oo extends Pt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==tt.set)return Ye(r,{code:Be.invalid_type,expected:tt.set,received:r.parsedType}),wt;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(Ye(r,{code:Be.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(Ye(r,{code:Be.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const a=this._def.valueType;function l(h){const f=new Set;for(const p of h){if(p.status==="aborted")return wt;p.status==="dirty"&&n.dirty(),f.add(p.value)}return{status:n.value,value:f}}const u=[...r.data.values()].map((h,f)=>a._parse(new Cs(r,h,r.path,f)));return r.common.async?Promise.all(u).then(h=>l(h)):l(u)}min(t,n){return new oo({...this._def,minSize:{value:t,message:ct.toString(n)}})}max(t,n){return new oo({...this._def,maxSize:{value:t,message:ct.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}oo.create=(e,t)=>new oo({valueType:e,minSize:null,maxSize:null,typeName:xt.ZodSet,...Nt(t)});class $h extends Pt{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}$h.create=(e,t)=>new $h({getter:e,typeName:xt.ZodLazy,...Nt(t)});class Gh extends Pt{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Ye(n,{received:n.data,code:Be.invalid_literal,expected:this._def.value}),wt}return{status:"valid",value:t.data}}get value(){return this._def.value}}Gh.create=(e,t)=>new Gh({value:e,typeName:xt.ZodLiteral,...Nt(t)});function $p(e,t){return new xa({values:e,typeName:xt.ZodEnum,...Nt(t)})}class xa extends Pt{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Ye(n,{expected:Yt.joinValues(r),received:n.parsedType,code:Be.invalid_type}),wt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Ye(n,{received:n.data,code:Be.invalid_enum_value,options:r}),wt}return ss(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return xa.create(t,{...this._def,...n})}exclude(t,n=this._def){return xa.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}xa.create=$p;class Hh extends Pt{_parse(t){const n=Yt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==tt.string&&r.parsedType!==tt.number){const i=Yt.objectValues(n);return Ye(r,{expected:Yt.joinValues(i),received:r.parsedType,code:Be.invalid_type}),wt}if(this._cache||(this._cache=new Set(Yt.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const i=Yt.objectValues(n);return Ye(r,{received:r.data,code:Be.invalid_enum_value,options:i}),wt}return ss(t.data)}get enum(){return this._def.values}}Hh.create=(e,t)=>new Hh({values:e,typeName:xt.ZodNativeEnum,...Nt(t)});class Il extends Pt{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==tt.promise&&n.common.async===!1)return Ye(n,{code:Be.invalid_type,expected:tt.promise,received:n.parsedType}),wt;const r=n.parsedType===tt.promise?n.data:Promise.resolve(n.data);return ss(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Il.create=(e,t)=>new Il({type:e,typeName:xt.ZodPromise,...Nt(t)});class ba extends Pt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===xt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),i=this._def.effect||null,a={addIssue:l=>{Ye(r,l),l.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),i.type==="preprocess"){const l=i.transform(r.data,a);if(r.common.async)return Promise.resolve(l).then(async u=>{if(n.value==="aborted")return wt;const h=await this._def.schema._parseAsync({data:u,path:r.path,parent:r});return h.status==="aborted"?wt:h.status==="dirty"||n.value==="dirty"?Ja(h.value):h});{if(n.value==="aborted")return wt;const u=this._def.schema._parseSync({data:l,path:r.path,parent:r});return u.status==="aborted"?wt:u.status==="dirty"||n.value==="dirty"?Ja(u.value):u}}if(i.type==="refinement"){const l=u=>{const h=i.refinement(u,a);if(r.common.async)return Promise.resolve(h);if(h instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(r.common.async===!1){const u=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return u.status==="aborted"?wt:(u.status==="dirty"&&n.dirty(),l(u.value),{status:n.value,value:u.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(u=>u.status==="aborted"?wt:(u.status==="dirty"&&n.dirty(),l(u.value).then(()=>({status:n.value,value:u.value}))))}if(i.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ga(l))return wt;const u=i.transform(l.value,a);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:u}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>ga(l)?Promise.resolve(i.transform(l.value,a)).then(u=>({status:n.value,value:u})):wt);Yt.assertNever(i)}}ba.create=(e,t,n)=>new ba({schema:e,typeName:xt.ZodEffects,effect:t,...Nt(n)});ba.createWithPreprocess=(e,t,n)=>new ba({schema:t,effect:{type:"preprocess",transform:e},typeName:xt.ZodEffects,...Nt(n)});class di extends Pt{_parse(t){return this._getType(t)===tt.undefined?ss(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}di.create=(e,t)=>new di({innerType:e,typeName:xt.ZodOptional,...Nt(t)});class va extends Pt{_parse(t){return this._getType(t)===tt.null?ss(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}va.create=(e,t)=>new va({innerType:e,typeName:xt.ZodNullable,...Nt(t)});class Pu extends Pt{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===tt.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Pu.create=(e,t)=>new Pu({innerType:e,typeName:xt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Nt(t)});class Bu extends Pt{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Sl(i)?i.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Hs(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Hs(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Bu.create=(e,t)=>new Bu({innerType:e,typeName:xt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Nt(t)});class qh extends Pt{_parse(t){if(this._getType(t)!==tt.nan){const r=this._getOrReturnCtx(t);return Ye(r,{code:Be.invalid_type,expected:tt.nan,received:r.parsedType}),wt}return{status:"valid",value:t.data}}}qh.create=e=>new qh({typeName:xt.ZodNaN,...Nt(e)});class Qx extends Pt{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Sd extends Pt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?wt:a.status==="dirty"?(n.dirty(),Ja(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?wt:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(t,n){return new Sd({in:t,out:n,typeName:xt.ZodPipeline})}}class Fu extends Pt{_parse(t){const n=this._def.innerType._parse(t),r=i=>(ga(i)&&(i.value=Object.freeze(i.value)),i);return Sl(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}Fu.create=(e,t)=>new Fu({innerType:e,typeName:xt.ZodReadonly,...Nt(t)});var xt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(xt||(xt={}));const ce=$s.create,Jt=ya.create,Bn=Ou.create,bi=Vu.create;gi.create;const nt=ks.create,He=Gn.create,nr=jl.create;Cl.create;Vi.create;const vi=Tl.create,en=xa.create;Il.create;di.create;va.create;const e2=en(["COLOR","DIMENSION","SPACING","FONT_FAMILY","FONT_WEIGHT","FONT_SIZE","LINE_HEIGHT","LETTER_SPACING","DURATION","CUBIC_BEZIER","BLUR","SPREAD","RADIUS"]),t2=He({pattern:ce().optional(),minimum:Jt().optional(),maximum:Jt().optional(),allowedValues:nt(ce()).optional()}),n2=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),displayName:ce(),type:e2.optional(),description:ce().optional(),validation:t2.optional()}),r2=en(["experimental","stable","deprecated"]),s2=en(["PRIMITIVE","SEMANTIC","COMPONENT"]),i2=en(["MOST_SPECIFIC_MATCH","DIMENSION_PRIORITY","NEAREST_PARENT","DEFAULT_VALUE"]),Lu=He({hex:ce().regex(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/),rgb:He({r:Jt().int().min(0).max(255),g:Jt().int().min(0).max(255),b:Jt().int().min(0).max(255),a:Jt().min(0).max(1).optional()}).optional()}),Xr=nr([He({value:Jt(),unit:en(["px","rem","%","em","vh","vw","pt"])}),ce().regex(/^[0-9]+(\.[0-9]+)?(px|rem|%|em|vh|vw|pt)$/)]);nr([He({value:Jt().min(0),unit:en(["ms","s"])}),ce().regex(/^[0-9]+(\.[0-9]+)?(ms|s)$/)]);nr([He({x1:Jt().min(0).max(1),y1:Jt(),x2:Jt().min(0).max(1),y2:Jt()}),ce().regex(/^cubic-bezier\([0-9]*(\.[0-9]+)?, ?[0-9]*(\.[0-9]+)?, ?[0-9]*(\.[0-9]+)?, ?[0-9]*(\.[0-9]+)?\)$/)]);nr([He({offsetX:Xr,offsetY:Xr,blur:Xr,spread:Xr,color:Lu,inset:Bn().optional()}),nt(He({offsetX:Xr,offsetY:Xr,blur:Xr,spread:Xr,color:Lu,inset:Bn().optional()})),ce().regex(/^([0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) (#[A-Fa-f0-9]{6}|rgba?\([0-9]+, ?[0-9]+, ?[0-9]+(, ?[0-9]+(\.[0-9]+)?)?\))( inset)?)(, ?[0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) (#[A-Fa-f0-9]{6}|rgba?\([0-9]+, ?[0-9]+, ?[0-9]+(, ?[0-9]+(\.[0-9]+)?)?\))( inset)?)*$/)]);He({fontFamily:ce(),fontSize:Xr,fontWeight:nr([Jt().int().min(100).max(900).multipleOf(100),en(["normal","bold","lighter","bolder"])]),lineHeight:nr([Jt(),Xr]).optional(),letterSpacing:Xr.optional(),textDecoration:en(["none","underline","line-through","overline"]).optional(),textTransform:en(["none","capitalize","uppercase","lowercase"]).optional()});nr([He({width:Xr,style:en(["solid","dashed","dotted","double","groove","ridge","inset","outset","none"]),color:Lu}),ce().regex(/^[0-9]+(\.[0-9]+)?(px|rem) (solid|dashed|dotted|double|groove|ridge|inset|outset|none) (#[A-Fa-f0-9]{6}|rgba?\([0-9]+, ?[0-9]+, ?[0-9]+(, ?[0-9]+(\.[0-9]+)?)?\))$/)]);const a2=nr([He({value:bi()}),He({tokenId:ce().regex(/^[a-zA-Z0-9-_]+$/)})]),o2=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),name:ce(),description:ce().optional(),dimensionId:ce().regex(/^[a-zA-Z0-9-_]+$/)}),l2=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),displayName:ce(),description:ce().optional(),modes:nt(o2).min(1),required:Bn().default(!1),defaultMode:ce(),resolvedValueTypeIds:nt(ce()).optional()}),c2=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),name:ce(),description:ce().optional(),resolvedValueTypeIds:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)),private:Bn().default(!1),defaultModeIds:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)).optional(),modeResolutionStrategy:He({priorityByType:nt(ce()),fallbackStrategy:i2}).optional()}),u2=He({platformId:ce(),value:ce(),metadata:vi(bi()).optional()}),d2=He({taxonomyId:ce(),termId:ce()}),kd=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),displayName:ce(),description:ce().optional(),tokenCollectionId:ce().regex(/^[a-zA-Z0-9-_]+$/).optional(),resolvedValueTypeId:ce().regex(/^[a-zA-Z0-9-_]+$/),private:Bn().default(!1),themeable:Bn().default(!1),status:r2.optional(),tokenTier:s2,generatedByAlgorithm:Bn().default(!1),algorithmId:ce().regex(/^[a-zA-Z0-9-_]+$/).optional(),taxonomies:nt(d2),propertyTypes:nt(ce()),codeSyntax:nt(He({platformId:ce(),formattedName:ce()})),valuesByMode:nt(He({modeIds:nt(ce()),value:a2,metadata:vi(bi()).optional(),platformOverrides:nt(u2).optional()})).describe("If any entry in valuesByMode has modeIds: [], it must be the only entry in the array. Otherwise, all entries must have modeIds.length > 0. This enforces that a token can have either a single global value or multiple mode-specific values, but not both.").min(1)}),h2=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),name:ce(),description:ce().optional(),tokenCollectionId:ce().regex(/^[a-zA-Z0-9-_]+$/),tokens:nt(kd)});He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),name:ce(),description:ce().optional(),tokenCollectionId:ce().regex(/^[a-zA-Z0-9-_]+$/),tokens:nt(kd)});const f2=en(["","_","-",".","/"]),p2=He({id:ce(),displayName:ce(),description:ce().optional(),syntaxPatterns:He({prefix:ce().optional(),suffix:ce().optional(),delimiter:f2.optional(),capitalization:en(["none","uppercase","lowercase","capitalize"]).optional(),formatString:ce().optional()}).optional(),valueFormatters:He({color:en(["hex","rgb","rgba","hsl","hsla"]).optional(),dimension:en(["px","rem","em","pt","dp","sp"]).optional(),numberPrecision:Jt().int().min(0).max(10).optional()}).optional()}),m2=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),displayName:ce(),description:ce().optional(),isDefault:Bn()}),Gp=He({value:nr([ce(),Jt(),Bn()]),tokenId:ce().regex(/^[a-zA-Z0-9-_]+$/).optional()}),g2=He({platformId:ce(),value:Gp}),y2=He({tokenId:ce().regex(/^[a-zA-Z0-9-_]+$/),value:Gp,platformOverrides:nt(g2).optional()}),x2=vi(nt(y2)),b2=He({id:ce(),name:ce(),description:ce().optional()}),v2=He({id:ce(),name:ce(),description:ce(),terms:nt(b2),resolvedValueTypeIds:nt(ce()).optional()}),w2=He({emptyModeIds:en(["mapToDefaults","preserveEmpty","requireExplicit"]),preserveOriginalValues:Bn()}),S2=He({version:ce(),dimensions:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)),date:ce(),migrationStrategy:w2.optional()}),k2=He({whenAdding:ce().regex(/^[a-zA-Z0-9-_]+$/),mapEmptyModeIdsTo:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)),preserveDefaultValues:Bn().optional()}),j2=He({rules:nt(k2)}),C2=He({systemName:ce(),systemId:ce().regex(/^[a-zA-Z0-9-_]+$/),description:ce().optional(),version:ce(),versionHistory:nt(S2),dimensionEvolution:j2.optional(),dimensions:nt(l2),dimensionOrder:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)).optional(),tokenCollections:nt(c2),tokens:nt(kd),platforms:nt(p2),themes:nt(m2).optional(),themeOverrides:x2.optional(),taxonomies:nt(v2),resolvedValueTypes:nt(n2),extensions:He({tokenGroups:nt(h2).optional(),tokenVariants:vi(bi()).optional()}).optional()}).refine(e=>{if(!e.dimensionOrder)return!0;const t=new Set(e.dimensions.map(n=>n.id));return e.dimensionOrder.every(n=>t.has(n))},{message:"All dimensionOrder IDs must match existing dimension IDs",path:["dimensionOrder"]}),T2=e=>C2.parse(e),Xl={core:()=>oa(()=>import("./core-data-CE-_Zp81.js"),[]),brandAOverrides:()=>oa(()=>import("./brand-a-overrides-CZ5KNG5B.js"),[]),brandBOverrides:()=>oa(()=>import("./brand-b-overrides-yrCeUxK4.js"),[]),minimal:()=>oa(()=>import("./example-minimal-data-B-6C8thN.js"),[])},Hp={core:()=>oa(()=>import("./core-algorithms-CZqvVs2X.js"),[]).catch(()=>null),minimal:()=>oa(()=>import("./example-minimal-algorithms-B4SVSBJt.js"),[]).catch(()=>null)},I2=["COLOR","DIMENSION","SPACING","FONT_FAMILY","FONT_WEIGHT","FONT_SIZE","LINE_HEIGHT","LETTER_SPACING","DURATION","CUBIC_BEZIER","BLUR","SPREAD","RADIUS"];function A2(){return I2.map(e=>{const t=e.toLowerCase().replace(/_/g,"-"),n=e.toLowerCase().replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase());return{id:t,displayName:n,type:e}})}const qp=A2();console.debug("[StorageService] Initialized default value types:",qp);const fn={TOKENS:"token-model:tokens",COLLECTIONS:"token-model:collections",MODES:"token-model:modes",VALUE_TYPES:"token-model:value-types",DIMENSIONS:"token-model:dimensions",DIMENSION_ORDER:"token-model:dimension-order",PLATFORMS:"token-model:platforms",THEMES:"token-model:themes",TAXONOMIES:"token-model:taxonomies",NAMING_RULES:"token-model:naming-rules",ALGORITHMS:"token-model:algorithms",ALGORITHM_FILE:"token-model:algorithm-file",ROOT_DATA:"token-model:root-data"};class he{static getItem(t,n){const r=localStorage.getItem(t);return r?JSON.parse(r):(localStorage.setItem(t,JSON.stringify(n)),n)}static setItem(t,n){localStorage.setItem(t,JSON.stringify(n))}static getTokens(){return this.getItem(fn.TOKENS,[])}static setTokens(t){localStorage.setItem(fn.TOKENS,JSON.stringify(t))}static getCollections(){return this.getItem(fn.COLLECTIONS,[])}static setCollections(t){localStorage.setItem(fn.COLLECTIONS,JSON.stringify(t))}static getModes(){return this.getItem(fn.MODES,[])}static setModes(t){localStorage.setItem(fn.MODES,JSON.stringify(t))}static getValueTypes(){const t=this.getItem(fn.VALUE_TYPES,qp);return console.debug("[StorageService] Retrieved value types:",t),t}static setValueTypes(t){console.debug("[StorageService] Setting value types:",t),localStorage.setItem(fn.VALUE_TYPES,JSON.stringify(t))}static getDimensions(){return this.getItem(fn.DIMENSIONS,[])}static setDimensions(t){localStorage.setItem(fn.DIMENSIONS,JSON.stringify(t))}static getDimensionOrder(){return this.getItem(fn.DIMENSION_ORDER,[])}static setDimensionOrder(t){localStorage.setItem(fn.DIMENSION_ORDER,JSON.stringify(t))}static getPlatforms(){return this.getItem(fn.PLATFORMS,[])}static setPlatforms(t){localStorage.setItem(fn.PLATFORMS,JSON.stringify(t))}static getThemes(){return this.getItem(fn.THEMES,[])}static setThemes(t){localStorage.setItem(fn.THEMES,JSON.stringify(t))}static getTaxonomies(){return this.getItem(fn.TAXONOMIES,[])}static setTaxonomies(t){localStorage.setItem(fn.TAXONOMIES,JSON.stringify(t))}static getNamingRules(){return this.getItem(fn.NAMING_RULES,{taxonomyOrder:[]})}static setNamingRules(t){const n=this.getTaxonomies(),r=new Set(n.map(l=>l.id)),i=t.taxonomyOrder.filter(l=>r.has(l));i.length!==t.taxonomyOrder.length&&console.warn("[StorageService] Removed invalid taxonomy IDs from naming rules:",t.taxonomyOrder.filter(l=>!r.has(l)));const a={taxonomyOrder:i};this.setItem(fn.NAMING_RULES,a)}static getAlgorithms(){return this.getItem(fn.ALGORITHMS,[])}static setAlgorithms(t){this.setItem(fn.ALGORITHMS,t)}static getAlgorithmFile(){const t=localStorage.getItem(fn.ALGORITHM_FILE);return t?JSON.parse(t):null}static setAlgorithmFile(t){this.setItem(fn.ALGORITHM_FILE,t)}static getRootData(){return this.getItem(fn.ROOT_DATA,{})}static setRootData(t){this.setItem(fn.ROOT_DATA,t)}static clearAll(){Object.values(fn).forEach(t=>localStorage.removeItem(t))}}var Up={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Uh=kt.createContext&&kt.createContext(Up),hi=function(){return hi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},hi.apply(this,arguments)},_2=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Wp(e){return e&&e.map(function(t,n){return kt.createElement(t.tag,hi({key:n},t.attr),Wp(t.child))})}function Gi(e){return function(t){return kt.createElement(E2,hi({attr:hi({},e.attr)},t),Wp(e.child))}}function E2(e){var t=function(n){var r=e.attr,i=e.size,a=e.title,l=_2(e,["attr","size","title"]),u=i||n.size||"1em",h;return n.className&&(h=n.className),e.className&&(h=(h?h+" ":"")+e.className),kt.createElement("svg",hi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,l,{className:h,style:hi(hi({color:e.color||n.color},n.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),a&&kt.createElement("title",null,a),e.children)};return Uh!==void 0?kt.createElement(Uh.Consumer,null,function(n){return t(n)}):t(Up)}function N2(e){return Gi({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m6 9 6 6 6-6"}}]})(e)}function M2(e){return Gi({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m18 15-6-6-6 6"}}]})(e)}function Zp(e){return Gi({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"9",cy:"12",r:"1"}},{tag:"circle",attr:{cx:"9",cy:"5",r:"1"}},{tag:"circle",attr:{cx:"9",cy:"19",r:"1"}},{tag:"circle",attr:{cx:"15",cy:"12",r:"1"}},{tag:"circle",attr:{cx:"15",cy:"5",r:"1"}},{tag:"circle",attr:{cx:"15",cy:"19",r:"1"}}]})(e)}function Is(e){return Gi({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}},{tag:"path",attr:{d:"m15 5 4 4"}}]})(e)}function ds(e){return Gi({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M5 12h14"}},{tag:"path",attr:{d:"M12 5v14"}}]})(e)}function D2(e){return Gi({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}}]})(e)}function hs(e){return Gi({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 6h18"}},{tag:"path",attr:{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}},{tag:"path",attr:{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}},{tag:"line",attr:{x1:"10",x2:"10",y1:"11",y2:"17"}},{tag:"line",attr:{x1:"14",x2:"14",y1:"11",y2:"17"}}]})(e)}class mr{static validateData(t){var n,r,i;try{T2(t);const a=t;if(a.config&&Array.isArray(a.config.systemVariables)){const l=a.config.systemVariables,u=new Set((a.dimensions||[]).map(h=>h.id));for(const h of l){if(!h.id||!h.name||!h.type)return{isValid:!1,errors:[`System variable is missing required fields (id, name, type): ${JSON.stringify(h)}`]};if(!["string","number","boolean","color"].includes(h.type))return{isValid:!1,errors:[`System variable ${h.id} has invalid type: ${h.type}`]};if(h.modeBased){if(!h.dimensionId)return{isValid:!1,errors:[`System variable ${h.id} is mode-based but missing dimensionId.`]};if(!u.has(h.dimensionId))return{isValid:!1,errors:[`System variable ${h.id} references non-existent dimensionId: ${h.dimensionId}`]};if(!Array.isArray(h.valuesByMode)||h.valuesByMode.length===0)return{isValid:!1,errors:[`System variable ${h.id} is mode-based but has no valuesByMode array.`]};for(const f of h.valuesByMode)if(!Array.isArray(f.modeIds)||typeof f.value>"u")return{isValid:!1,errors:[`System variable ${h.id} has invalid valuesByMode entry: ${JSON.stringify(f)}`]}}}}if(a.tokens){const l=new Set(((n=a.resolvedValueTypes)==null?void 0:n.map(u=>u.id))||[]);if(l.size===0)return{isValid:!1,errors:["No resolvedValueTypes found in data. Your system data must include all value types required by your schema."]};for(const u of a.tokens){const h=u.resolvedValueTypeId;if(!h)return{isValid:!1,errors:[`Token ${u.id} is missing required resolvedValueTypeId`]};if(!l.has(h))return{isValid:!1,errors:[`Token ${u.id} has invalid resolvedValueTypeId "${h}". Must be one of: ${Array.from(l).join(", ")}`]};for(const f of u.valuesByMode){const p=f.value;if("tokenId"in p&&!a.tokens.find(y=>y.id===p.tokenId))return{isValid:!1,errors:[`Token ${u.id} references non-existent token ${p.tokenId} in valuesByMode`]}}if(u.tokenCollectionId){const f=a.tokenCollections.find(p=>p.id===u.tokenCollectionId);if(!f)return{isValid:!1,errors:[`Token ${u.id} references non-existent collection ${u.tokenCollectionId}`]};if(!f.resolvedValueTypeIds.includes(u.resolvedValueTypeId))return{isValid:!1,errors:[`Token ${u.id} has type ${u.resolvedValueTypeId} which is not supported by collection ${f.id}`]}}}if(a.dimensions){const u=new Set(a.dimensions.map(h=>h.id));if(a.dimensionOrder){for(const f of a.dimensionOrder)if(!u.has(f))return{isValid:!1,errors:[`dimensionOrder contains ID "${f}" that does not exist in dimensions`]};const h=new Set(a.dimensionOrder);for(const f of a.dimensions)if(!h.has(f.id))return{isValid:!1,errors:[`Dimension "${f.id}" is not included in dimensionOrder`]};if(new Set(a.dimensionOrder).size!==a.dimensionOrder.length)return{isValid:!1,errors:["dimensionOrder contains duplicate IDs"]}}for(const h of a.dimensions){if(!h.resolvedValueTypeIds)return{isValid:!1,errors:[`Dimension ${h.id} is missing required resolvedValueTypeIds`]};for(const f of h.resolvedValueTypeIds)if(!l.has(f))return{isValid:!1,errors:[`Dimension ${h.id} has invalid resolvedValueTypeId "${f}". Must be one of: ${Array.from(l).join(", ")}`]}}}if(a.tokenCollections)for(const u of a.tokenCollections){const h=u.resolvedValueTypeIds;if(!h||h.length===0)return{isValid:!1,errors:[`Collection ${u.id} is missing required resolvedValueTypeIds`]};for(const f of h)if(!l.has(f))return{isValid:!1,errors:[`Collection ${u.id} has invalid resolvedValueTypeId "${f}". Must be one of: ${Array.from(l).join(", ")}`]}}if(a.taxonomies)for(const u of a.taxonomies){if(!u.terms||u.terms.length===0)return{isValid:!1,errors:[`Taxonomy ${u.id} must have at least one term`]};if(u.resolvedValueTypeIds){for(const h of u.resolvedValueTypeIds)if(!l.has(h))return{isValid:!1,errors:[`Taxonomy ${u.id} has invalid resolvedValueTypeId "${h}". Must be one of: ${Array.from(l).join(", ")}`]}}}if(a.themes&&a.themes.filter(h=>h.isDefault).length!==1)return{isValid:!1,errors:["Exactly one theme must be marked as default"]};if((r=a.namingRules)!=null&&r.taxonomyOrder){const u=new Set(((i=a.taxonomies)==null?void 0:i.map(h=>h.id))||[]);for(const h of a.namingRules.taxonomyOrder)if(!u.has(h))return{isValid:!1,errors:[`namingRules.taxonomyOrder contains ID "${h}" that does not exist in taxonomies`]}}}return{isValid:!0}}catch(a){return a&&typeof a=="object"&&"errors"in a?{isValid:!1,errors:a.errors}:{isValid:!1,errors:[a instanceof Error?a.message:String(a)]}}}}function R2({themes:e,setThemes:t}){const{colorMode:n}=tn(),[r,i]=z.useState(!1),[a,l]=z.useState(null),[u,h]=z.useState({id:"",displayName:"",description:"",isDefault:!1}),f=Hn(),p=[],g=[],y=[],b=[],A=[],D=(E=null)=>{l(E),h(E!==null?e[E]:{id:"",displayName:"",description:"",isDefault:!1}),i(!0)},j=()=>{i(!1),l(null)},w=(E,I)=>{h(H=>({...H,[E]:I}))},C=E=>{const I={tokenCollections:g,dimensions:y,tokens:p,platforms:b,taxonomies:A,themes:E,version:"1.0.0",versionHistory:[]};return mr.validateData(I).isValid?(t(E),!0):(f({title:"Schema Validation Failed",description:"Your change would make the data invalid. See the Validation tab for details.",status:"error",duration:4e3,isClosable:!0}),!1)},_=()=>{if(!u.displayName.trim()){f({title:"Required Field Missing",description:"Display name is required for themes.",status:"error",duration:4e3,isClosable:!0});return}const E=u.id||u.displayName.trim().replace(/\s+/g,"_").toLowerCase();if(!u.id&&e.some(Z=>Z.id===E)){f({title:"Duplicate Theme",description:"A theme with this name already exists. Please choose a different name.",status:"error",duration:4e3,isClosable:!0});return}const I=[...e],H={...u,id:E,isDefault:u.isDefault};a!==null?I[a]=H:I.push(H),H.isDefault&&I.forEach(Z=>{Z.id!==H.id&&(Z.isDefault=!1)}),C(I)&&(i(!1),l(null),f({title:"Theme Saved",description:`Successfully ${a!==null?"updated":"created"} theme "${u.displayName}"`,status:"success",duration:3e3,isClosable:!0}))},N=E=>{const I=e[E],H=e.filter((Z,ae)=>ae!==E);C(H)&&f({title:"Theme Deleted",description:`Successfully deleted theme "${I.displayName}"`,status:"info",duration:3e3,isClosable:!0})};return s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"Themes"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:n==="dark"?"gray.900":"white",children:[s.jsx(Ee,{leftIcon:s.jsx(ds,{}),size:"sm",onClick:()=>D(null),colorScheme:"blue",mb:4,children:"Add Theme"}),s.jsx(ye,{align:"stretch",spacing:2,children:e.map((E,I)=>s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:n==="dark"?"gray.800":"gray.50",borderColor:n==="dark"?"gray.600":"gray.200",children:s.jsxs(ve,{justify:"space-between",align:"center",children:[s.jsxs(Y,{children:[s.jsx(B,{fontSize:"lg",fontWeight:"medium",children:E.displayName}),s.jsx(B,{fontSize:"sm",color:n==="dark"?"gray.400":"gray.600",children:E.description||""}),E.isDefault&&s.jsx(us,{colorScheme:"green",size:"sm",mt:1,children:"Default"})]}),s.jsxs(ve,{children:[s.jsx(mt,{"aria-label":"Edit theme",icon:s.jsx(Is,{}),size:"sm",onClick:()=>D(I),colorScheme:n==="dark"?"blue":"gray"}),s.jsx(mt,{"aria-label":"Delete theme",icon:s.jsx(hs,{}),size:"sm",colorScheme:"red",onClick:()=>N(I)})]})]})},E.id))})]}),s.jsxs(zn,{isOpen:r,onClose:j,size:"lg",children:[s.jsx(vn,{}),s.jsxs(Pn,{bg:n==="dark"?"gray.900":"white",children:[s.jsx(wn,{children:a!==null?"Edit Theme":"Add Theme"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Display Name"}),s.jsx(ut,{value:u.displayName,onChange:E=>w("displayName",E.target.value),bg:n==="dark"?"gray.700":"white"})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{value:u.description||"",onChange:E=>w("description",E.target.value),bg:n==="dark"?"gray.700":"white"})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Default Theme"}),s.jsx(Ee,{colorScheme:u.isDefault?"green":"gray",onClick:()=>w("isDefault",!u.isDefault),size:"sm",children:u.isDefault?"Default Theme":"Set as Default"})]})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:j,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:_,children:"Save"})]})]})]})]})}const O2=({themes:e,setThemes:t})=>{const{colorMode:n}=tn();return s.jsx(ye,{p:4,bg:n==="dark"?"gray.900":"gray.50",flex:"1",align:"stretch",spacing:0,children:s.jsx(Yl,{maxW:"1000px",p:0,children:s.jsx(R2,{themes:e,setThemes:t})})})};function V2(e){const t=e.length,n=e.filter(l=>l.private).length,r=t-n,i=e.filter(l=>l.themeable).length,a=t-i;return{total:t,privateCount:n,publicCount:r,privatePercent:t?n/t*100:0,publicPercent:t?r/t*100:0,themeableCount:i,nonThemeableCount:a,themeablePercent:t?i/t*100:0,nonThemeablePercent:t?a/t*100:0}}function z2(e,t){return t.map(n=>{const r=e.filter(i=>Array.isArray(i.valuesByMode)&&i.valuesByMode.some(a=>Array.isArray(a.platformOverrides)&&a.platformOverrides.some(l=>l.platformId===n.id))).length;return{platformId:n.id,platformName:n.displayName,count:r}})}function P2(e){const t=e.length,n=e.map(r=>({themeId:r.id,themeName:r.displayName,percentWithOverride:0}));return{totalThemes:t,themeOverrides:n}}function B2(){return{version:"v1.0.0",date:"2024-01-01"}}function F2(){return[{id:1,description:'Token "Primary Color" updated',date:"2024-06-01"},{id:2,description:'Theme "Dark" created',date:"2024-05-30"},{id:3,description:'Platform "iOS" added',date:"2024-05-28"}]}const L2=({tokens:e,platforms:t,themes:n})=>{const{colorMode:r}=tn(),i=V2(e),a=z2(e,t),l=P2(n),u=B2(),h=F2();return s.jsx(Y,{p:0,borderWidth:0,borderRadius:"md",bg:r==="dark"?"gray.900":"gray.50",children:s.jsxs(Y,{p:8,children:[s.jsx(yt,{size:"xl",mb:8,children:"Dashboard"}),s.jsxs(Qa,{columns:{base:1,md:2},spacing:8,mb:8,children:[s.jsxs(Y,{p:6,borderWidth:1,borderRadius:"md",bg:"chakra-body-bg",children:[s.jsx(yt,{size:"md",mb:4,children:"Tokens"}),s.jsxs(Qa,{columns:2,spacing:4,mb:4,children:[s.jsxs(Ki,{children:[s.jsx(Qi,{children:"Total"}),s.jsx(ea,{children:i.total})]}),s.jsxs(Ki,{children:[s.jsx(Qi,{children:"Private"}),s.jsx(ea,{children:i.privateCount}),s.jsxs(Jo,{children:[i.privatePercent.toFixed(1),"%"]})]}),s.jsxs(Ki,{children:[s.jsx(Qi,{children:"Public"}),s.jsx(ea,{children:i.publicCount}),s.jsxs(Jo,{children:[i.publicPercent.toFixed(1),"%"]})]}),s.jsxs(Ki,{children:[s.jsx(Qi,{children:"Themeable"}),s.jsx(ea,{children:i.themeableCount}),s.jsxs(Jo,{children:[i.themeablePercent.toFixed(1),"%"]})]}),s.jsxs(Ki,{children:[s.jsx(Qi,{children:"Not Themeable"}),s.jsx(ea,{children:i.nonThemeableCount}),s.jsxs(Jo,{children:[i.nonThemeablePercent.toFixed(1),"%"]})]})]})]}),s.jsxs(Y,{p:6,borderWidth:1,borderRadius:"md",bg:"chakra-body-bg",children:[s.jsx(yt,{size:"md",mb:4,children:"Platforms"}),s.jsxs(Bs,{size:"sm",variant:"simple",children:[s.jsx(ai,{children:s.jsxs(ir,{children:[s.jsx(pn,{children:"Platform"}),s.jsx(pn,{isNumeric:!0,children:"Tokens w/ Overrides"})]})}),s.jsx(Fs,{children:a.map(f=>s.jsxs(ir,{children:[s.jsx(sn,{children:f.platformName}),s.jsx(sn,{isNumeric:!0,children:f.count})]},f.platformId))})]})]})]}),s.jsxs(Qa,{columns:{base:1,md:2},spacing:8,mb:8,children:[s.jsxs(Y,{p:6,borderWidth:1,borderRadius:"md",bg:"chakra-body-bg",children:[s.jsx(yt,{size:"md",mb:4,children:"Themes"}),s.jsxs(Ki,{children:[s.jsx(Qi,{children:"Total Themes"}),s.jsx(ea,{children:l.totalThemes})]}),s.jsx(Ss,{my:4}),s.jsx(yt,{size:"sm",mb:2,children:"Theme Overrides"}),s.jsxs(Bs,{size:"sm",variant:"simple",children:[s.jsx(ai,{children:s.jsxs(ir,{children:[s.jsx(pn,{children:"Theme"}),s.jsx(pn,{isNumeric:!0,children:"% Tokens w/ Override"})]})}),s.jsx(Fs,{children:l.themeOverrides.map(f=>s.jsxs(ir,{children:[s.jsx(sn,{children:f.themeName}),s.jsxs(sn,{isNumeric:!0,children:[f.percentWithOverride,"%"]})]},f.themeId))})]})]}),s.jsxs(Y,{p:6,borderWidth:1,borderRadius:"md",bg:"chakra-body-bg",children:[s.jsx(yt,{size:"md",mb:4,children:"Releases"}),s.jsxs(ye,{align:"start",spacing:2,children:[s.jsxs(B,{children:[s.jsx("b",{children:"Latest Version:"})," ",u.version]}),s.jsxs(B,{children:[s.jsx("b",{children:"Date:"})," ",u.date]}),s.jsx(us,{colorScheme:"gray",children:"Placeholder"})]})]})]}),s.jsxs(Y,{p:6,borderWidth:1,borderRadius:"md",bg:"chakra-body-bg",children:[s.jsx(yt,{size:"md",mb:4,children:"Latest Activity"}),s.jsxs(ye,{align:"start",spacing:2,children:[h.map(f=>s.jsxs(ve,{spacing:4,children:[s.jsx(B,{children:f.description}),s.jsx(B,{color:"gray.500",fontSize:"sm",children:f.date})]},f.id)),s.jsx(us,{colorScheme:"gray",children:"Placeholder"})]})]})]})})};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),G2=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),Wh=e=>{const t=G2(e);return t.charAt(0).toUpperCase()+t.slice(1)},Yp=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),H2=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var q2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=z.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:l,...u},h)=>z.createElement("svg",{ref:h,...q2,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:Yp("lucide",i),...!a&&!H2(u)&&{"aria-hidden":"true"},...u},[...l.map(([f,p])=>z.createElement(f,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=(e,t)=>{const n=z.forwardRef(({className:r,...i},a)=>z.createElement(U2,{ref:a,iconNode:t,className:Yp(`lucide-${$2(Wh(e))}`,`lucide-${e}`,r),...i}));return n.displayName=Wh(e),n};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Zh=rt("arrow-right",W2);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=[["circle",{cx:"9",cy:"9",r:"7",key:"p2h5vp"}],["circle",{cx:"15",cy:"15",r:"7",key:"19ennj"}]],Jp=rt("blend",Z2);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=[["path",{d:"M12 13V7",key:"h0r20n"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"m9 10 3 3 3-3",key:"zt5b4y"}]],J2=rt("book-down",Y2);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],K2=rt("book-marked",X2);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=[["path",{d:"m13.11 7.664 1.78 2.672",key:"go2gg9"}],["path",{d:"m14.162 12.788-3.324 1.424",key:"11x848"}],["path",{d:"m20 4-6.06 1.515",key:"1wxxh7"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["circle",{cx:"12",cy:"6",r:"2",key:"1jj5th"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}],["circle",{cx:"9",cy:"15",r:"2",key:"lf2ghp"}]],e4=rt("chart-network",Q2);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Qc=rt("check",t4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],cl=rt("chevron-down",n4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],s4=rt("chevron-left",r4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],a4=rt("chevron-right",i4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],l4=rt("circle-alert",o4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Xp=rt("circle-check-big",c4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Kp=rt("circle",u4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Yh=rt("clock",d4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],f4=rt("columns-2",h4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Jh=rt("database",p4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],g4=rt("download",m4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=[["path",{d:"m15 15 6 6",key:"1s409w"}],["path",{d:"m15 9 6-6",key:"ko1vev"}],["path",{d:"M21 16v5h-5",key:"1ck2sf"}],["path",{d:"M21 8V3h-5",key:"1qoq8a"}],["path",{d:"M3 16v5h5",key:"1t08am"}],["path",{d:"m3 21 6-6",key:"wwnumi"}],["path",{d:"M3 8V3h5",key:"1ln10m"}],["path",{d:"M9 9 3 3",key:"v551iv"}]],Qp=rt("expand",y4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]],eo=rt("file-code",x4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=[["path",{d:"M20 17a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3.9a2 2 0 0 1-1.69-.9l-.81-1.2a2 2 0 0 0-1.67-.9H8a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2Z",key:"4u7rpt"}],["path",{d:"M2 8v11a2 2 0 0 0 2 2h14",key:"1eicx1"}]],em=rt("folders",b4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],w4=rt("funnel",v4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],k4=rt("git-branch",S4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],tm=rt("git-commit-horizontal",j4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C4=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],T4=rt("git-pull-request",C4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],A4=rt("github",I4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _4=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],$u=rt("grip-vertical",_4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],nm=rt("history",E4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Xh=rt("info",N4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],D4=rt("layers",M4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],O4=rt("layout-dashboard",R4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V4=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],z4=rt("list-ordered",V4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=[["path",{d:"M5 12h14",key:"1ays0h"}]],jd=rt("minus",P4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=[["path",{d:"M18 8V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8",key:"10dyio"}],["path",{d:"M10 19v-3.96 3.15",key:"1irgej"}],["path",{d:"M7 19h5",key:"qswx4l"}],["rect",{width:"6",height:"10",x:"16",y:"12",rx:"2",key:"1egngj"}]],rm=rt("monitor-smartphone",B4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=[["path",{d:"m18 8 4 4-4 4",key:"1ak13k"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}]],sm=rt("move-horizontal",F4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m8 18 4 4 4-4",key:"bh5tu3"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}]],im=rt("move-vertical",L4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Kl=rt("palette",$4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=[["path",{d:"M8 21s-4-3-4-9 4-9 4-9",key:"uto9ud"}],["path",{d:"M16 3s4 3 4 9-4 9-4 9",key:"4w2vsq"}]],H4=rt("parentheses",G4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=[["path",{d:"M13 7 8.7 2.7a2.41 2.41 0 0 0-3.4 0L2.7 5.3a2.41 2.41 0 0 0 0 3.4L7 13",key:"orapub"}],["path",{d:"m8 6 2-2",key:"115y1s"}],["path",{d:"m18 16 2-2",key:"ee94s4"}],["path",{d:"m17 11 4.3 4.3c.94.94.94 2.46 0 3.4l-2.6 2.6c-.94.94-2.46.94-3.4 0L11 17",key:"cfq27r"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Al=rt("pencil-ruler",q4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Kh=rt("play",U4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ts=rt("plus",W4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],Y4=rt("redo-2",Z4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],_l=rt("rotate-ccw",J4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X4=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],am=rt("ruler",X4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K4=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Cd=rt("save",K4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],om=rt("search",Q4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gu=rt("settings",eb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],nb=rt("sparkle",tb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]],sb=rt("split",rb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M9 17c2 0 2.8-1 2.8-2.8V10c0-2 1-3.3 3.2-3",key:"m1af9g"}],["path",{d:"M9 11.2h5.7",key:"3zgcl2"}]],ii=rt("square-function",ib);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Td=rt("square-pen",ab);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=[["path",{d:"M21 11a8 8 0 0 0-8-8",key:"1lxwo5"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1dv2y5"}]],lm=rt("square-round-corner",ob);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=[["path",{d:"M4 10c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"4i38lg"}],["path",{d:"M10 16c-1.1 0-2-.9-2-2v-4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"mlte4a"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2",key:"1fa9i4"}]],cm=rt("square-stack",lb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=[["line",{x1:"6",x2:"6",y1:"4",y2:"20",key:"fy8qot"}],["polygon",{points:"10,4 20,12 10,20",key:"1mc1pf"}]],ub=rt("step-forward",cb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],El=rt("tag",db);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],fb=rt("tags",hb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=[["path",{d:"M12 20h-1a2 2 0 0 1-2-2 2 2 0 0 1-2 2H6",key:"1528k5"}],["path",{d:"M13 8h7a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-7",key:"13ksps"}],["path",{d:"M5 16H4a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2h1",key:"1n9rhb"}],["path",{d:"M6 4h1a2 2 0 0 1 2 2 2 2 0 0 1 2-2h1",key:"1mj8rg"}],["path",{d:"M9 6v12",key:"velyjx"}]],mb=rt("text-cursor-input",pb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],um=rt("timer",gb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ws=rt("trash-2",yb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xb=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Hu=rt("triangle-alert",xb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],dm=rt("type",bb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],hm=rt("undo-2",vb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]],Sb=rt("unlink",wb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],jb=rt("users",kb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=[["path",{d:"M8 21s-4-3-4-9 4-9 4-9",key:"uto9ud"}],["path",{d:"M16 3s4 3 4 9-4 9-4 9",key:"4w2vsq"}],["line",{x1:"15",x2:"9",y1:"9",y2:"15",key:"f7djnv"}],["line",{x1:"9",x2:"15",y1:"9",y2:"15",key:"1shsy8"}]],Nl=rt("variable",Cb);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],fm=rt("x",Tb),Ib=({size:e=40,color:t="inherit"})=>s.jsx("span",{style:{display:"inline-block",color:t},children:s.jsx("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":"Logo",children:s.jsx("path",{d:"M10.4902 1.35589C11.4183 0.820116 12.5621 0.820141 13.4902 1.35589L20.4492 5.37444C21.3774 5.9103 21.9491 6.90039 21.9492 7.9721V16.0082C21.9492 17.08 21.3774 18.07 20.4492 18.6059L13.5 22.6186V15.6987C14.9656 15.1052 15.9998 13.669 16 11.9907C16 9.78154 14.2091 7.99065 12 7.99065C9.79088 7.99065 8.00002 9.78154 8 11.9907C8.00017 13.669 9.03444 15.1052 10.5 15.6987V22.6293C10.4968 22.6275 10.4934 22.6263 10.4902 22.6244L3.53125 18.6059C2.60305 18.07 2.03125 17.08 2.03125 16.0082V7.9721C2.03133 6.90039 2.60311 5.9103 3.53125 5.37444L10.4902 1.35589Z",fill:"currentColor"})})}),pm=({size:e=24})=>s.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M21 16V8C20.9996 7.64927 20.9071 7.30481 20.7315 7.00116C20.556 6.69752 20.3037 6.44536 20 6.27L13 2.27C12.696 2.09446 12.3511 2.00205 12 2.00205C11.6489 2.00205 11.304 2.09446 11 2.27L4 6.27C3.69626 6.44536 3.44398 6.69752 3.26846 7.00116C3.09294 7.30481 3.00036 7.64927 3 8V16C3.00036 16.3507 3.09294 16.6952 3.26846 16.9988C3.44398 17.3025 3.69626 17.5546 4 17.73L11 21.73C11.304 21.9055 11.6489 21.998 12 21.998C12.3511 21.998 12.696 21.9055 13 21.73L20 17.73C20.3037 17.5546 20.556 17.3025 20.7315 16.9988C20.9071 16.6952 20.9996 16.3507 21 16Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"12",r:"3.5",stroke:"currentColor",strokeWidth:"2"}),s.jsx("line",{x1:"3.03381",y1:"6.55748",x2:"9.05547",y2:"10.468",stroke:"currentColor",strokeWidth:"2"}),s.jsx("line",{y1:"-1",x2:"7.18",y2:"-1",transform:"matrix(-0.838671 0.544639 0.544639 0.838671 21.5108 7.39615)",stroke:"currentColor",strokeWidth:"2"}),s.jsx("line",{x1:"12",y1:"16.1429",x2:"12",y2:"21.6525",stroke:"currentColor",strokeWidth:"2"})]}),Ab=[{id:"dashboard",label:"Dashboard",icon:O4,route:"/dashboard"},{id:"tokens",label:"Tokens",children:[{id:"tokens",label:"Tokens",icon:pm,route:"/tokens/tokens"},{id:"collections",label:"Collections",icon:em,route:"/tokens/collections"},{id:"system-variables",label:"System Variables",icon:Jp,route:"/tokens/system-variables"},{id:"algorithms",label:"Algorithms",icon:ii,route:"/tokens/algorithms"},{id:"analysis",label:"Analysis",icon:e4,route:"/tokens/analysis"}]},{id:"setup",label:"Setup",children:[{id:"dimensions",label:"Dimensions",icon:cm,route:"/dimensions"},{id:"classification",label:"Classification",icon:El,route:"/classification"},{id:"naming-rules",label:"Naming Rules",icon:z4,route:"/naming-rules"},{id:"value-types",label:"Value Types",icon:Al,route:"/value-types"}]},{id:"themes",label:"Themes",icon:Kl,route:"/themes"},{id:"publishing",label:"Publishing",children:[{id:"platforms",label:"Platforms",icon:rm,route:"/platforms"},{id:"export-settings",label:"Export Settings",icon:Gu,route:"/export-settings"},{id:"validation",label:"Validation",icon:Xp,route:"/validation"},{id:"version-history",label:"Version History",icon:nm,route:"/version-history"}]},{id:"access",label:"Access",icon:jb,route:"/access"},{id:"schemas",label:"Schemas",children:[{id:"core-data",label:"Core Data",icon:eo,route:"/schemas/core-data"},{id:"theme-overrides",label:"Theme Overrides",icon:eo,route:"/schemas/theme-overrides"},{id:"algorithm-data",label:"Algorithm Data",icon:eo,route:"/schemas/algorithm-data"}]}],_b=()=>{const[e,t]=z.useState(!1),{colorMode:n}=tn(),r=wx(),i=n==="dark"?"gray.800":"white",a=n==="dark"?"gray.700":"gray.200",l=(u,h=!1)=>{const f=r.pathname===u.route,p=u.icon;if(u.children&&!h)return e?null:s.jsx(B,{fontSize:"xs",fontWeight:"bold",color:"gray.500",textTransform:"uppercase",letterSpacing:"wider",mt:4,mb:2,px:2,children:u.label},u.id);const g=s.jsxs(Y,{as:Sx,to:u.route,display:"flex",alignItems:"center",p:2,borderRadius:"md",bg:f?"blue.500":"transparent",color:f?"white":"inherit",_hover:{bg:f?"blue.600":n==="dark"?"gray.700":"gray.100"},cursor:"pointer",role:"menuitem","aria-current":f?"page":void 0,tabIndex:0,textDecoration:"none",children:[p&&s.jsx(p,{size:20}),!e&&s.jsx(B,{ml:3,fontSize:"sm",children:u.label})]},u.id);return e?s.jsx(er,{label:u.label,placement:"right",children:g},u.id):g};return s.jsx(Y,{as:"nav",position:"relative",w:e?"64px":"220px",h:"100vh",bg:i,borderRight:"1px",borderColor:a,transition:"width 0.2s",role:"navigation","aria-label":"Main navigation",children:s.jsxs(ye,{spacing:0,align:"stretch",h:"full",children:[s.jsxs(Y,{px:4,py:3,borderBottom:"1px",borderColor:a,display:"flex",gap:2,justifyContent:"center",alignItems:"center",children:[s.jsx(Ib,{size:28,color:n==="dark"?"white":"black"}),!e&&s.jsxs(B,{fontSize:"sm",lineHeight:"1",fontWeight:"bold",children:["Design System",s.jsx("br",{}),"Foundry"]})]}),s.jsx(ye,{spacing:1,align:"stretch",p:4,flex:1,children:Ab.map(u=>u.children?s.jsxs(Y,{children:[l(u),s.jsx(ye,{spacing:1,align:"stretch",ml:0,mt:1,children:u.children.map(h=>l(h,!0))},`${u.id}-children`)]},u.id):l(u))}),s.jsx(Y,{px:4,py:2,borderBottom:"1px",borderColor:a,children:s.jsx(Ee,{"aria-label":e?"Expand sidebar":"Collapse sidebar",size:"sm",leftIcon:e?s.jsx(a4,{size:16}):s.jsx(s4,{size:16}),onClick:()=>t(!e),variant:"ghost",w:"full",gap:1,justifyContent:"flex-start",children:!e&&"Collapse"})})]})})},Eb=e=>{switch(e){case"token":return eo;case"theme":return Kl;case"dimension":return D4;case"mode":return Gu;case"resolvedValueType":return El;case"taxonomy":return Jh;case"term":return El;case"algorithm":return ii;case"collection":return Jh;case"platform":return Gu;default:return eo}},Nb=e=>{switch(e){case"added":return ts;case"removed":return jd;case"modified":return Td}},Er=(e,t=50)=>{if(e==null)return"null";if(typeof e=="string")return e.length>t?`${e.substring(0,t)}...`:e;if(typeof e=="object"){const n=JSON.stringify(e);return n.length>t?`${n.substring(0,t)}...`:n}return String(e)},Mb=(e,t)=>{var a,l,u;const n=[],r=new Map,i=new Map;e==null||e.forEach((h,f)=>{var p;if(typeof h=="object"&&h!==null){const g=((p=h.modeIds)==null?void 0:p.join(","))||`index-${f}`;r.set(g,h)}}),t==null||t.forEach((h,f)=>{var p;if(typeof h=="object"&&h!==null){const g=((p=h.modeIds)==null?void 0:p.join(","))||`index-${f}`;i.set(g,h)}});for(const[h,f]of i){const p=r.get(h);p?JSON.stringify(p.value)!==JSON.stringify(f.value)&&n.push({field:"valuesByMode",oldValue:p.value,newValue:f.value,context:`Modified for modes: ${((l=f.modeIds)==null?void 0:l.join(", "))||"global"}`}):n.push({field:"valuesByMode",newValue:f.value,context:`Added for modes: ${((a=f.modeIds)==null?void 0:a.join(", "))||"global"}`})}for(const[h,f]of r)i.has(h)||n.push({field:"valuesByMode",oldValue:f.value,context:`Removed for modes: ${((u=f.modeIds)==null?void 0:u.join(", "))||"global"}`});return n},Db=(e,t)=>{const n=[],r=new Map,i=new Map;e==null||e.forEach(a=>{typeof a=="object"&&a!==null&&r.set(a.platformId,a)}),t==null||t.forEach(a=>{typeof a=="object"&&a!==null&&i.set(a.platformId,a)});for(const[a,l]of i){const u=r.get(a);u?u.value!==l.value&&n.push({field:"platformOverrides",oldValue:u.value,newValue:l.value,context:`Modified for platform: ${a}`}):n.push({field:"platformOverrides",newValue:l.value,context:`Added for platform: ${a}`})}for(const[a,l]of r)i.has(a)||n.push({field:"platformOverrides",oldValue:l.value,context:`Removed for platform: ${a}`});return n},Qh=(e,t,n="id")=>{const r=[],i=new Map,a=new Map;e==null||e.forEach(l=>{typeof l=="object"&&l!==null&&i.set(l[n],l)}),t==null||t.forEach(l=>{typeof l=="object"&&l!==null&&a.set(l[n],l)});for(const[l,u]of a)if(!i.get(l)){const f=u;r.push({field:"array",newValue:f.name||f.displayName||l,context:`Added ${l}`})}for(const[l,u]of i)if(!a.has(l)){const h=u;r.push({field:"array",oldValue:h.name||h.displayName||l,context:`Removed ${l}`})}return r},Rb=(e,t)=>{const n=[];if(!e||!t)return n;const r=e.tokens||[],i=t.tokens||[],a=new Map,l=new Map;r.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&a.set(J.id,J)}}),i.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&l.set(J.id,J)}});for(const[F,J]of l)if(!a.has(F)){const pe=J;n.push({type:"added",entityType:"token",entityId:F,entityName:pe.displayName||F,changes:[{field:"token",newValue:`Added token: ${pe.displayName||F} (${pe.resolvedValueTypeId||"unknown"})`}]})}for(const[F,J]of a)if(!l.has(F)){const pe=J;n.push({type:"removed",entityType:"token",entityId:F,entityName:pe.displayName||F,changes:[{field:"token",oldValue:`Removed token: ${pe.displayName||F}`}]})}for(const[F,J]of l){const pe=a.get(F);if(pe){const G=[],ge=J,W=pe;["displayName","description","tokenTier","status","themeable","private"].forEach(ue=>{W[ue]!==ge[ue]&&G.push({field:ue,oldValue:Er(W[ue]),newValue:Er(ge[ue])})});const Q=Mb(W.valuesByMode||[],ge.valuesByMode||[]);G.push(...Q);const fe=W.valuesByMode||[],xe=ge.valuesByMode||[];if(fe.length>0||xe.length>0)for(let ue=0;ue<Math.max(fe.length,xe.length);ue++){const ke=fe[ue],q=xe[ue];if(ke!=null&&ke.platformOverrides||q!=null&&q.platformOverrides){const re=Db((ke==null?void 0:ke.platformOverrides)||[],(q==null?void 0:q.platformOverrides)||[]);G.push(...re)}}G.length>0&&n.push({type:"modified",entityType:"token",entityId:F,entityName:ge.displayName||F,changes:G})}}const u=e.themes||[],h=t.themes||[],f=new Map,p=new Map;u.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&f.set(J.id,J)}}),h.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&p.set(J.id,J)}});for(const[F,J]of p)if(f.has(F)){const pe=f.get(F),G=[],ge=pe,W=J;["displayName","description","isDefault"].forEach(L=>{ge[L]!==W[L]&&G.push({field:L,oldValue:Er(ge[L]),newValue:Er(W[L])})}),G.length>0&&n.push({type:"modified",entityType:"theme",entityId:F,entityName:W.displayName||F,changes:G})}else{const pe=J;n.push({type:"added",entityType:"theme",entityId:F,entityName:pe.displayName||F,changes:[{field:"theme",newValue:`Added theme: ${pe.displayName||F}`}]})}for(const[F,J]of f)if(!p.has(F)){const pe=J;n.push({type:"removed",entityType:"theme",entityId:F,entityName:pe.displayName||F,changes:[{field:"theme",oldValue:`Removed theme: ${pe.displayName||F}`}]})}const g=e.dimensions||[],y=t.dimensions||[],b=new Map,A=new Map;g.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&b.set(J.id,J)}}),y.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&A.set(J.id,J)}});for(const[F,J]of A)if(b.has(F)){const pe=b.get(F),G=[],ge=pe,W=J;["displayName","description","required","defaultMode"].forEach(Q=>{ge[Q]!==W[Q]&&G.push({field:Q,oldValue:Er(ge[Q]),newValue:Er(W[Q])})});const L=Qh(ge.modes||[],W.modes||[]);G.push(...L),G.length>0&&n.push({type:"modified",entityType:"dimension",entityId:F,entityName:W.displayName||F,changes:G})}else{const pe=J;n.push({type:"added",entityType:"dimension",entityId:F,entityName:pe.displayName||F,changes:[{field:"dimension",newValue:`Added dimension: ${pe.displayName||F}`}]})}for(const[F,J]of b)if(!A.has(F)){const pe=J;n.push({type:"removed",entityType:"dimension",entityId:F,entityName:pe.displayName||F,changes:[{field:"dimension",oldValue:`Removed dimension: ${pe.displayName||F}`}]})}const D=e.resolvedValueTypes||[],j=t.resolvedValueTypes||[],w=new Map,C=new Map;D.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&w.set(J.id,J)}}),j.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&C.set(J.id,J)}});for(const[F,J]of C)if(w.has(F)){const pe=w.get(F),G=[],ge=pe,W=J;["displayName","description","type"].forEach(L=>{ge[L]!==W[L]&&G.push({field:L,oldValue:Er(ge[L]),newValue:Er(W[L])})}),G.length>0&&n.push({type:"modified",entityType:"resolvedValueType",entityId:F,entityName:W.displayName||F,changes:G})}else{const pe=J;n.push({type:"added",entityType:"resolvedValueType",entityId:F,entityName:pe.displayName||F,changes:[{field:"resolvedValueType",newValue:`Added value type: ${pe.displayName||F}`}]})}for(const[F,J]of w)if(!C.has(F)){const pe=J;n.push({type:"removed",entityType:"resolvedValueType",entityId:F,entityName:pe.displayName||F,changes:[{field:"resolvedValueType",oldValue:`Removed value type: ${pe.displayName||F}`}]})}const _=e.taxonomies||[],N=t.taxonomies||[],E=new Map,I=new Map;_.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&E.set(J.id,J)}}),N.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&I.set(J.id,J)}});for(const[F,J]of I)if(E.has(F)){const pe=E.get(F),G=[],ge=pe,W=J;["name","description"].forEach(Q=>{ge[Q]!==W[Q]&&G.push({field:Q,oldValue:Er(ge[Q]),newValue:Er(W[Q])})});const L=Qh(ge.terms||[],W.terms||[]);G.push(...L),G.length>0&&n.push({type:"modified",entityType:"taxonomy",entityId:F,entityName:W.name||F,changes:G})}else{const pe=J;n.push({type:"added",entityType:"taxonomy",entityId:F,entityName:pe.name||F,changes:[{field:"taxonomy",newValue:`Added taxonomy: ${pe.name||F}`}]})}for(const[F,J]of E)if(!I.has(F)){const pe=J;n.push({type:"removed",entityType:"taxonomy",entityId:F,entityName:pe.name||F,changes:[{field:"taxonomy",oldValue:`Removed taxonomy: ${pe.name||F}`}]})}const H=e.algorithms||[],Z=t.algorithms||[],ae=new Map,ne=new Map;H.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&ae.set(J.id,J)}}),Z.forEach(F=>{if(typeof F=="object"&&F!==null){const J=F;J.id&&ne.set(J.id,J)}});for(const[F,J]of ne)if(ae.has(F)){const pe=ae.get(F),G=[],ge=pe,W=J;["name","description","resolvedValueTypeId"].forEach(L=>{ge[L]!==W[L]&&G.push({field:L,oldValue:Er(ge[L]),newValue:Er(W[L])})}),G.length>0&&n.push({type:"modified",entityType:"algorithm",entityId:F,entityName:W.name||F,changes:G})}else{const pe=J;n.push({type:"added",entityType:"algorithm",entityId:F,entityName:pe.name||F,changes:[{field:"algorithm",newValue:`Added algorithm: ${pe.name||F}`}]})}for(const[F,J]of ae)if(!ne.has(F)){const pe=J;n.push({type:"removed",entityType:"algorithm",entityId:F,entityName:pe.name||F,changes:[{field:"algorithm",oldValue:`Removed algorithm: ${pe.name||F}`}]})}return n},mm=({previousData:e,currentData:t})=>{const{colorMode:n}=tn();if(!e||!t)return s.jsx(Y,{p:4,textAlign:"center",children:s.jsx(B,{color:"gray.500",children:"No data available for comparison"})});const r=Rb(e,t);if(r.length===0)return s.jsx(Y,{p:4,textAlign:"center",children:s.jsx(B,{color:"gray.500",children:"No changes detected"})});const i=r.reduce((a,l)=>(a[l.entityType]||(a[l.entityType]=[]),a[l.entityType].push(l),a),{});return s.jsxs(Y,{children:[s.jsxs(B,{fontSize:"md",fontWeight:"bold",mb:4,children:["Changes (",r.length," changes)"]}),s.jsx(ex,{allowMultiple:!0,children:Object.entries(i).map(([a,l])=>{const u=Eb(a),h=a.charAt(0).toUpperCase()+a.slice(1);return s.jsxs(tx,{children:[s.jsxs(nx,{children:[s.jsxs(ve,{flex:"1",justify:"flex-start",children:[s.jsx(u,{size:16}),s.jsx(B,{fontWeight:"medium",children:h}),s.jsx(pt,{colorScheme:"blue",ml:"auto",children:l.length})]}),s.jsx(rx,{})]}),s.jsx(sx,{children:s.jsx(ye,{spacing:3,align:"stretch",children:l.map((f,p)=>{const g=Nb(f.type),y=f.type==="added"?"green":f.type==="removed"?"red":"orange";return s.jsxs(Y,{p:3,border:"1px",borderColor:n==="dark"?"gray.600":"gray.200",borderRadius:"md",bg:n==="dark"?"gray.700":"gray.50",children:[s.jsxs(ve,{spacing:2,mb:2,children:[s.jsx(g,{size:16,color:y==="green"?"#22c55e":y==="red"?"#ef4444":"#f97316"}),s.jsx(pt,{colorScheme:y,size:"sm",children:f.type.toUpperCase()}),s.jsx(B,{fontWeight:"medium",fontSize:"sm",children:f.entityName})]}),s.jsx(ye,{spacing:1,align:"stretch",children:f.changes.map((b,A)=>s.jsxs(Y,{pl:4,children:[b.context&&s.jsx(B,{fontSize:"xs",color:"gray.500",mb:1,children:b.context}),b.oldValue!==void 0&&b.oldValue!==null&&s.jsxs(B,{fontSize:"sm",color:"red.500",children:[s.jsx(B,{as:"span",fontWeight:"medium",children:"-"})," ",String(Er(b.oldValue))]}),b.newValue!==void 0&&b.newValue!==null&&s.jsxs(B,{fontSize:"sm",color:"green.500",children:[s.jsx(B,{as:"span",fontWeight:"medium",children:"+"})," ",String(Er(b.newValue))]})]},A))})]},`${f.entityId}-${p}`)})})})]},a)})})]})},Vn={clientId:"Ov23li4XeOJKztYd3mkd",clientSecret:"656ec47fd3d79e8d5e22af6e8b75322032fa3b92",redirectUri:"http://localhost:4001/auth/github/callback",scope:"repo",apiBaseUrl:"https://api.github.com",authUrl:"https://github.com/login/oauth/authorize",tokenUrl:"https://github.com/login/oauth/access_token"};class os{static encryptToken(t){return btoa(t)}static decryptToken(t){return atob(t)}static storeGitHubToken(t){try{const n=this.encryptToken(t);localStorage.setItem(this.TOKEN_KEY,n)}catch(n){console.error("Failed to store GitHub token:",n)}}static getGitHubToken(){try{const t=localStorage.getItem(this.TOKEN_KEY);return t?this.decryptToken(t):null}catch(t){return console.error("Failed to retrieve GitHub token:",t),null}}static clearGitHubToken(){localStorage.removeItem(this.TOKEN_KEY)}static storeGitHubUser(t){try{localStorage.setItem(this.USER_KEY,JSON.stringify(t))}catch(n){console.error("Failed to store GitHub user:",n)}}static getGitHubUser(){try{const t=localStorage.getItem(this.USER_KEY);return t?JSON.parse(t):null}catch(t){return console.error("Failed to retrieve GitHub user:",t),null}}static clearGitHubUser(){localStorage.removeItem(this.USER_KEY)}static storeSelectedRepo(t){try{localStorage.setItem(this.REPO_KEY,JSON.stringify(t))}catch(n){console.error("Failed to store selected repo:",n)}}static getSelectedRepo(){try{const t=localStorage.getItem(this.REPO_KEY);return t?JSON.parse(t):null}catch(t){return console.error("Failed to retrieve selected repo:",t),null}}static clearSelectedRepo(){localStorage.removeItem(this.REPO_KEY)}static clearAllGitHubData(){this.clearGitHubToken(),this.clearGitHubUser(),this.clearSelectedRepo()}}bs(os,"TOKEN_KEY","github_token_encrypted"),bs(os,"USER_KEY","github_user"),bs(os,"REPO_KEY","github_repo");class cn{static generateState(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}static generateCodeVerifier(){const t=new Uint8Array(32);return crypto.getRandomValues(t),btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}static async generateCodeChallenge(t){const r=new TextEncoder().encode(t),i=await crypto.subtle.digest("SHA-256",r);return btoa(String.fromCharCode(...new Uint8Array(i))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}static async initiateAuth(){const t=this.generateState(),n=this.generateCodeVerifier(),r=await this.generateCodeChallenge(n);localStorage.setItem("github_oauth_state",t),localStorage.setItem("github_oauth_code_verifier",n);const i=new URLSearchParams({client_id:Vn.clientId,redirect_uri:Vn.redirectUri,scope:Vn.scope,state:t,code_challenge:r,code_challenge_method:"S256"});window.location.href=`${Vn.authUrl}?${i}`}static async handleCallback(t,n){const r=localStorage.getItem("github_oauth_state"),i=localStorage.getItem("github_oauth_code_verifier");if(console.log("OAuth callback - Received state:",n),console.log("OAuth callback - Stored state:",r),console.log("OAuth callback - Code verifier exists:",!!i),!r)throw new Error("No stored state parameter found. The OAuth flow may have been interrupted.");if(!i)throw new Error("No stored code verifier found. The OAuth flow may have been interrupted.");if(n!==r)throw console.error("State mismatch - Received:",n,"Stored:",r),new Error("Invalid state parameter - possible CSRF attack or OAuth flow interruption");localStorage.removeItem("github_oauth_state"),localStorage.removeItem("github_oauth_code_verifier");try{const a=await this.exchangeCodeForTokenWithPKCE(t,i);os.storeGitHubToken(a);const l=await this.fetchCurrentUser(a);return os.storeGitHubUser(l),this.startTokenRefreshMonitor(),l}catch(a){throw console.error("Failed to handle OAuth callback:",a),a}}static async exchangeCodeForTokenWithPKCE(t,n){const i=await fetch("/api/github/token",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({client_id:Vn.clientId,client_secret:Vn.clientSecret,code:t,redirect_uri:Vn.redirectUri,code_verifier:n})});if(!i.ok){const l=await i.text();throw console.error("Token exchange failed:",i.status,l),new Error(`Failed to get access token: ${i.statusText}`)}const a=await i.json();if(a.error)throw new Error(`OAuth error: ${a.error_description||a.error}`);return a.access_token}static async exchangeCodeForToken(t){const n=await fetch(Vn.tokenUrl,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({client_id:Vn.clientId,client_secret:Vn.clientSecret,code:t,redirect_uri:Vn.redirectUri})});if(!n.ok)throw new Error(`Failed to get access token: ${n.statusText}`);const r=await n.json();if(r.error)throw new Error(`OAuth error: ${r.error_description||r.error}`);return r.access_token}static async fetchCurrentUser(t){const n=await fetch(`${Vn.apiBaseUrl}/user`,{headers:{Authorization:`token ${t}`,Accept:"application/vnd.github.v3+json"}});if(!n.ok)throw new Error(`Failed to get user info: ${n.statusText}`);return n.json()}static hasStaleOAuthState(){return localStorage.getItem("github_oauth_state")!==null}static isAuthenticated(){return os.getGitHubToken()!==null}static getCurrentUser(){return os.getGitHubUser()}static clearOAuthState(){localStorage.removeItem("github_oauth_state"),localStorage.removeItem("github_oauth_code_verifier")}static logout(){os.clearAllGitHubData(),this.clearOAuthState(),this.stopTokenRefreshMonitor()}static startTokenRefreshMonitor(){this.refreshTokenInterval=setInterval(()=>{this.handleTokenRefresh()},30*60*1e3)}static stopTokenRefreshMonitor(){this.refreshTokenInterval&&(clearInterval(this.refreshTokenInterval),this.refreshTokenInterval=null)}static async handleTokenRefresh(){if(!this.refreshInProgress){this.refreshInProgress=!0;try{const t=os.getGitHubToken();if(!t)return;const n=await this.fetchCurrentUser(t);os.storeGitHubUser(n)}catch(t){console.error("Token refresh failed:",t),this.logout()}finally{this.refreshInProgress=!1}}}static async getValidAccessToken(){const t=os.getGitHubToken();if(!t)throw new Error("No GitHub token available");try{return await this.fetchCurrentUser(t),t}catch{throw this.logout(),new Error("GitHub token is invalid - please re-authenticate")}}}bs(cn,"refreshInProgress",!1),bs(cn,"refreshTokenInterval",null);class An{static async getOrganizations(){const t=await cn.getValidAccessToken(),n=await fetch(`${Vn.apiBaseUrl}/user`,{headers:{Authorization:`token ${t}`,Accept:"application/vnd.github.v3+json"}});if(!n.ok)throw new Error(`Failed to fetch user info: ${n.statusText}`);const r=await n.json(),i=await fetch(`${Vn.apiBaseUrl}/user/orgs?per_page=100`,{headers:{Authorization:`token ${t}`,Accept:"application/vnd.github.v3+json"}});if(!i.ok)throw new Error(`Failed to fetch organizations: ${i.statusText}`);const a=await i.json();return[{id:r.id,login:r.login,name:r.name||r.login,avatar_url:r.avatar_url,type:"User"},...a]}static async getRepositories(){const t=await cn.getValidAccessToken();let n=[],r=1;const i=100;let a=!0;for(;a;){const l=await fetch(`${Vn.apiBaseUrl}/user/repos?sort=updated&per_page=${i}&page=${r}`,{headers:{Authorization:`token ${t}`,Accept:"application/vnd.github.v3+json"}});if(!l.ok)throw new Error(`Failed to fetch repositories: ${l.statusText}`);const u=await l.json();u.length===0?a=!1:(n=n.concat(u),r++,r>10&&(a=!1))}return n}static async getBranches(t){const n=await cn.getValidAccessToken(),r=await fetch(`${Vn.apiBaseUrl}/repos/${t}/branches`,{headers:{Authorization:`token ${n}`,Accept:"application/vnd.github.v3+json"}});if(!r.ok)throw new Error(`Failed to fetch branches: ${r.statusText}`);return r.json()}static async getFileContent(t,n,r){const i=await cn.getValidAccessToken(),a=await fetch(`${Vn.apiBaseUrl}/repos/${t}/contents/${n}?ref=${r}`,{headers:{Authorization:`token ${i}`,Accept:"application/vnd.github.v3+json"}});if(!a.ok)throw new Error(`Failed to fetch file content: ${a.statusText}`);const l=await a.json();if(l.content&&l.encoding==="base64")try{const u=atob(l.content);return{...l,content:u}}catch{throw new Error("Failed to decode file content")}return l}static async createFile(t,n,r,i,a="Update token data"){const l=await cn.getValidAccessToken();let u;try{u=(await this.getFileContent(t,n,i)).sha}catch{}const h={message:a,content:btoa(r),branch:i};u&&(h.sha=u);const f=await fetch(`${Vn.apiBaseUrl}/repos/${t}/contents/${n}`,{method:"PUT",headers:{Authorization:`token ${l}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(h)});if(!f.ok)throw new Error(`Failed to create/update file: ${f.statusText}`)}static async createPullRequest(t,n,r,i,a){const l=await cn.getValidAccessToken(),u=await fetch(`${Vn.apiBaseUrl}/repos/${t}/pulls`,{method:"POST",headers:{Authorization:`token ${l}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify({title:n,body:r,head:i,base:a})});if(!u.ok)throw new Error(`Failed to create pull request: ${u.statusText}`);return u.json()}static async createBranch(t,n,r){const i=await cn.getValidAccessToken(),a=await fetch(`${Vn.apiBaseUrl}/repos/${t}/branches/${n}`,{headers:{Authorization:`token ${i}`,Accept:"application/vnd.github.v3+json"}});if(!a.ok)throw new Error(`Failed to get base branch info: ${a.statusText}`);const l=await a.json(),u=await fetch(`${Vn.apiBaseUrl}/repos/${t}/git/refs`,{method:"POST",headers:{Authorization:`token ${i}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify({ref:`refs/heads/${r}`,sha:l.commit.sha})});if(!u.ok)throw new Error(`Failed to create branch: ${u.statusText}`)}static async scanRepositoryForValidFiles(t,n){const r=await cn.getValidAccessToken(),i=await this.getAllJsonFiles(t,n,r),a=[];for(const l of i)try{const u=await this.getFileContent(t,l.path,n),h=this.identifyFileType(u.content);h!=="unknown"&&a.push({path:l.path,name:l.name,type:h,size:l.size,lastModified:l.lastModified||new Date().toISOString()})}catch(u){console.warn(`Failed to validate file ${l.path}:`,u)}return a.sort((l,u)=>new Date(u.lastModified).getTime()-new Date(l.lastModified).getTime())}static async getAllJsonFiles(t,n,r,i=""){const a=await fetch(`${Vn.apiBaseUrl}/repos/${t}/contents/${i}?ref=${n}`,{headers:{Authorization:`token ${r}`,Accept:"application/vnd.github.v3+json"}});if(!a.ok)throw new Error(`Failed to fetch directory contents: ${a.statusText}`);const l=await a.json(),u=[];for(const h of l)if(h.type==="file"&&h.name.endsWith(".json"))u.push({path:h.path,name:h.name,size:h.size,lastModified:h.updated_at});else if(h.type==="dir"){const f=await this.getAllJsonFiles(t,n,r,h.path);u.push(...f)}return u}static identifyFileType(t){try{const n=JSON.parse(t);return n.tokenCollections&&n.dimensions&&n.tokens&&n.platforms?"schema":n.systemId&&n.themeId&&n.tokenOverrides?"theme-override":"unknown"}catch{return"unknown"}}static getSelectedRepositoryInfo(){try{const t=localStorage.getItem("github_selected_repo");return t?JSON.parse(t):null}catch(t){return console.error("Failed to parse selected repository info:",t),null}}static hasSelectedRepository(){return this.getSelectedRepositoryInfo()!==null}}const gm=({isOpen:e,onClose:t,onFileSelected:n})=>{const[r,i]=z.useState([]),[a,l]=z.useState(null),[u,h]=z.useState([]),[f,p]=z.useState([]),[g,y]=z.useState(null),[b,A]=z.useState([]),[D,j]=z.useState(""),[w,C]=z.useState([]),[_,N]=z.useState(null),[E,I]=z.useState(!1),[H,Z]=z.useState(null),[ae,ne]=z.useState(""),F=Hn();z.useEffect(()=>{e&&r.length===0&&J()},[e]),z.useEffect(()=>{e&&r.length>0&&u.length>0&&ge()},[e,r,u]);const J=async()=>{I(!0),Z("orgs"),ne("");const q=setTimeout(()=>{H==="orgs"&&F({title:"Loading Organizations",description:"Fetching your GitHub organizations and repositories...",status:"info",duration:3e3,isClosable:!0})},1e3);try{const re=await An.getOrganizations();i(re),re.length>0&&(l(re[0]),await pe(re[0]))}catch(re){console.error("Failed to load organizations:",re),ne("Failed to load organizations. Please try again."),F({title:"Error",description:"Failed to load organizations from GitHub.",status:"error",duration:5e3,isClosable:!0})}finally{clearTimeout(q),I(!1),Z(null)}},pe=async q=>{I(!0),Z("repos"),ne("");const re=setTimeout(()=>{H==="repos"&&F({title:"Loading Repositories",description:`Fetching repositories for ${q.name||q.login}...`,status:"info",duration:3e3,isClosable:!0})},1e3);try{const Se=await An.getRepositories(),we=Se.filter(Ce=>Ce.full_name.split("/")[0]===q.login);h(Se),p(we)}catch(Se){console.error("Failed to load repositories:",Se),ne("Failed to load repositories. Please try again."),F({title:"Error",description:"Failed to load repositories from GitHub.",status:"error",duration:5e3,isClosable:!0})}finally{clearTimeout(re),I(!1),Z(null)}},G=async q=>{const re=r.find(Se=>Se.login===q);re&&(l(re),y(null),j(""),C([]),N(null),ne(""),await pe(re))},ge=async()=>{try{const q=localStorage.getItem("github_selected_repo");if(!q)return;const re=JSON.parse(q),Se=f.find(we=>we.full_name===re.fullName);if(!Se){console.log("Current repository not found in available repositories");return}y(Se),ne(""),I(!0),Z("branches");try{const we=await An.getBranches(Se.full_name);A(we);const Ce=we.find(Le=>Le.name===re.branch);if(Ce){j(Ce.name),Z("files");const Le=await An.scanRepositoryForValidFiles(Se.full_name,Ce.name);C(Le);const ft=Le.find(vt=>vt.path===re.filePath);ft?N(ft):ne(`Previous file "${re.filePath}" not found in this branch. Please select a different file.`)}else ne(`Previous branch "${re.branch}" not found. Please select a different branch.`)}catch(we){console.error("Failed to preload current selection:",we),ne("Failed to load current selection. Please try again.")}finally{I(!1),Z(null)}}catch(q){console.error("Failed to parse current repository info:",q)}},W=async q=>{const re=f.find(Ce=>Ce.full_name===q);if(!re)return;const Se=_;y(re),j(""),C([]),N(null),ne(""),I(!0),Z("branches");const we=setTimeout(()=>{H==="branches"&&F({title:"Loading Branches",description:`Fetching branches for ${re.name}...`,status:"info",duration:3e3,isClosable:!0})},1e3);try{const Ce=await An.getBranches(re.full_name);if(A(Ce),Ce.length>0){const Le=Ce.find(ft=>ft.name===re.default_branch)||Ce[0];j(Le.name),Se?await Q(re.full_name,Le.name,Se):await fe(re.full_name,Le.name)}}catch(Ce){console.error("Failed to load branches:",Ce),ne("Failed to load branches for this repository."),F({title:"Error",description:"Failed to load branches from GitHub.",status:"error",duration:5e3,isClosable:!0})}finally{clearTimeout(we),I(!1),Z(null)}},L=async q=>{const re=_;j(q),C([]),N(null),ne(""),g&&(re?await Q(g.full_name,q,re):await fe(g.full_name,q))},Q=async(q,re,Se)=>{try{const we=await An.scanRepositoryForValidFiles(q,re);C(we),we.length>0&&await xe(we,Se)}catch(we){console.error("Failed to load and match files:",we)}},fe=async(q,re)=>{I(!0),Z("files");const Se=setTimeout(()=>{H==="files"&&F({title:"Scanning Repository",description:`Scanning ${q.split("/")[1]} for valid design system files...`,status:"info",duration:3e3,isClosable:!0})},1e3);try{const we=await An.scanRepositoryForValidFiles(q,re);C(we),we.length===0&&ne("No valid token files found in this repository. Please ensure you have files that match the schema.json or theme-override.json format.")}catch(we){console.error("Failed to scan repository:",we),ne("Failed to scan repository for valid files."),F({title:"Error",description:"Failed to scan repository for valid files.",status:"error",duration:5e3,isClosable:!0})}finally{clearTimeout(Se),I(!1),Z(null)}},xe=async(q,re)=>{const Se=q.find(we=>we.name===re.name);if(Se){N(Se),F({title:"File Matched",description:`Found matching file: ${Se.name}`,status:"success",duration:3e3,isClosable:!0});return}try{let we,Ce;try{const Le=await An.getFileContent(g.full_name,re.path,D),ft=JSON.parse(Le.content);we=ft.systemId,Ce=ft.themeId}catch(Le){console.error("Failed to get previous file content for ID matching:",Le)}for(const Le of q)try{const ft=await An.getFileContent(g.full_name,Le.path,D),vt=JSON.parse(ft.content);if(re.type==="schema"&&Le.type==="schema"&&we){if(vt.systemId===we){N(Le),F({title:"System Matched",description:`Found file with matching system: ${Le.name}`,status:"success",duration:3e3,isClosable:!0});return}}else if(re.type==="theme-override"&&Le.type==="theme-override"&&Ce&&vt.themeId===Ce){N(Le),F({title:"Theme Matched",description:`Found file with matching theme: ${Le.name}`,status:"success",duration:3e3,isClosable:!0});return}}catch(ft){console.error(`Failed to check file ${Le.name} for ID matching:`,ft)}}catch(we){console.error("Failed to match files by ID:",we)}F({title:"No Matching File Found",description:"No file with the same name or matching ID was found in this branch.",status:"info",duration:4e3,isClosable:!0})},ue=async()=>{if(!(!_||!g||!D)){I(!0),ne("");try{const q=await An.getFileContent(g.full_name,_.path,D),re=JSON.parse(q.content),Se={fullName:g.full_name,branch:D,filePath:_.path,fileType:_.type};localStorage.setItem("github_selected_repo",JSON.stringify(Se)),_.type==="schema"?(he.setCollections(re.tokenCollections||[]),he.setDimensions(re.dimensions||[]),he.setTokens(re.tokens||[]),he.setPlatforms(re.platforms||[]),he.setThemes(re.themes||[]),he.setTaxonomies(re.taxonomies||[]),he.setValueTypes(re.resolvedValueTypes||[]),he.setRootData({systemName:re.systemName,systemId:re.systemId,description:re.description,version:re.version,versionHistory:re.versionHistory})):_.type==="theme-override"&&console.log("Theme override data loaded:",re);const we=window.refreshAppData;we&&we(),F({title:"File Loaded Successfully",description:`Loaded ${_.name} from ${g.full_name}`,status:"success",duration:5e3,isClosable:!0}),n(re,_.type),t()}catch(q){console.error("Failed to load file:",q),ne("Failed to load the selected file. Please try again."),F({title:"Error",description:"Failed to load the selected file from GitHub.",status:"error",duration:5e3,isClosable:!0})}finally{I(!1)}}},ke=()=>{I(!1),Z(null),ne(""),y(null),j(""),C([]),N(null),t()};return s.jsxs(zn,{isOpen:e,onClose:ke,size:"xl",scrollBehavior:"inside",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:"Select source file"}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:6,align:"stretch",children:[g&&D&&_&&s.jsxs(xn,{status:"info",variant:"subtle",children:[s.jsx(bn,{}),s.jsxs(Y,{children:[s.jsx(Oi,{children:"Current Selection"}),s.jsxs(or,{children:["Repository: ",s.jsx("strong",{children:g.full_name}),s.jsx("br",{}),"Branch: ",s.jsx("strong",{children:D}),s.jsx("br",{}),"File: ",s.jsx("strong",{children:_.name})]})]})]}),E&&H==="branches"&&g&&s.jsxs(xn,{status:"info",variant:"subtle",children:[s.jsx(bn,{}),s.jsxs(or,{children:["Loading current selection: ",g.full_name,"..."]})]}),E&&H==="files"&&g&&D&&s.jsxs(xn,{status:"info",variant:"subtle",children:[s.jsx(bn,{}),s.jsxs(or,{children:["Scanning for matching files in ",g.full_name,"/",D,"..."]})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Organization"}),s.jsx(Zt,{value:(a==null?void 0:a.login)||"",onChange:q=>G(q.target.value),placeholder:"Select an organization",isDisabled:E,children:r.map(q=>s.jsxs("option",{value:q.login,children:[q.name||q.login," (",q.type==="User"?"Personal":"Organization",")"]},q.login))}),H==="orgs"&&s.jsxs(ve,{mt:2,children:[s.jsx(cs,{size:"sm"}),s.jsx(B,{fontSize:"sm",children:"Loading organizations..."})]})]}),s.jsxs(Ge,{isRequired:!0,isDisabled:!a||E,children:[s.jsx(Ue,{children:"Repository"}),s.jsx(Zt,{value:(g==null?void 0:g.full_name)||"",onChange:q=>W(q.target.value),placeholder:"Select a repository",isDisabled:!a||E,children:f.map(q=>s.jsxs("option",{value:q.full_name,children:[q.full_name," ",q.private?"(Private)":""]},q.full_name))}),H==="repos"&&s.jsxs(ve,{mt:2,children:[s.jsx(cs,{size:"sm"}),s.jsx(B,{fontSize:"sm",children:"Loading repositories..."})]})]}),s.jsxs(Ge,{isRequired:!0,isDisabled:!g||E,children:[s.jsx(Ue,{children:"Branch"}),s.jsx(Zt,{value:D,onChange:q=>L(q.target.value),placeholder:"Select a branch",isDisabled:!g||E,children:b.map(q=>s.jsx("option",{value:q.name,children:q.name},q.name))}),H==="branches"&&s.jsxs(ve,{mt:2,children:[s.jsx(cs,{size:"sm"}),s.jsx(B,{fontSize:"sm",children:"Loading branches..."})]})]}),s.jsxs(Ge,{isRequired:!0,isDisabled:!D||E,children:[s.jsx(Ue,{children:"File"}),s.jsx(Zt,{value:(_==null?void 0:_.path)||"",onChange:q=>{const re=w.find(Se=>Se.path===q.target.value);N(re||null)},placeholder:"Select a file",isDisabled:!D||E,children:w.map(q=>s.jsxs("option",{value:q.path,children:[q.name," (",q.type==="schema"?"Core Data":"Theme Override",")"]},q.path))}),H==="files"&&s.jsxs(ve,{mt:2,children:[s.jsx(cs,{size:"sm"}),s.jsx(B,{fontSize:"sm",children:"Scanning for valid files..."})]})]}),ae&&s.jsxs(xn,{status:"error",children:[s.jsx(bn,{}),s.jsxs(Y,{children:[s.jsx(Oi,{children:"Error"}),s.jsx(or,{children:ae})]})]})]})}),s.jsx(Xn,{children:s.jsxs(ve,{spacing:3,children:[s.jsx(Ee,{variant:"ghost",onClick:ke,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:ue,isDisabled:!_||E,isLoading:E,children:"Load File"})]})})]})]})};class eu{static async saveToGitHub(t={}){try{const n=An.getSelectedRepositoryInfo();if(!n)throw new Error("No repository selected. Please load a file from GitHub first.");const r=this.getCurrentDataForFileType(n.fileType),i=JSON.stringify(r,null,2),l=new Blob([i]).size/(1024*1024);if(l>=1)throw new Error(`File size (${l.toFixed(2)}MB) exceeds GitHub's 1MB limit. Please reduce the data size.`);l>=.9&&console.warn(`File size (${l.toFixed(2)}MB) is approaching GitHub's 1MB limit.`);const u=t.message||`Update ${n.filePath} - ${new Date().toLocaleString()}`;return t.createPullRequest&&t.targetBranch?await this.createPullRequestWithChanges(n,i,u,t.targetBranch,t.prTitle,t.prDescription):(await An.createFile(n.fullName,n.filePath,i,n.branch,u),{success:!0,message:`Successfully saved changes to ${n.filePath}`})}catch(n){return console.error("Failed to save to GitHub:",n),{success:!1,message:n instanceof Error?n.message:"Failed to save to GitHub"}}}static async createPullRequestWithChanges(t,n,r,i,a,l){const u=Date.now(),h=`update-${t.filePath.replace(/[^a-zA-Z0-9]/g,"-")}-${u}`;await An.createBranch(t.fullName,t.branch,h),await An.createFile(t.fullName,t.filePath,n,h,r);const f=`Update ${t.filePath}`,p=this.generatePullRequestDescription(t.fileType),g=await An.createPullRequest(t.fullName,a||f,l||p,h,i);return{success:!0,message:`Successfully created pull request #${g.number}`,pullRequestUrl:g.html_url}}static getCurrentDataForFileType(t){var n;if(t==="schema"){const r=he.getRootData();return{tokenCollections:he.getCollections(),dimensions:he.getDimensions(),tokens:he.getTokens(),platforms:he.getPlatforms(),themes:he.getThemes(),taxonomies:he.getTaxonomies(),resolvedValueTypes:he.getValueTypes(),namingRules:{taxonomyOrder:((n=he.getNamingRules())==null?void 0:n.taxonomyOrder)||[]},versionHistory:r.versionHistory||[],systemName:r.systemName||"Design System",systemId:r.systemId||"design-system",description:r.description||"A comprehensive design system with tokens, dimensions, and themes",version:r.version||"1.0.0"}}else if(t==="theme-override")return{systemId:"design-system",themeId:"default-theme",tokenOverrides:{},version:"1.0.0"};throw new Error(`Unsupported file type: ${t}`)}static generatePullRequestDescription(t){const n=new Date().toISOString();let r=`## Changes Made

`;return r+=`- **File Type**: ${t==="schema"?"Core Data":"Theme Override"}
`,r+=`- **Timestamp**: ${n}
`,r+=`- **Generated By**: Token Model Manager

`,r+=`## Summary

`,r+="This pull request contains updates to the design system data. ",r+=`Please review the changes and ensure they align with the design system requirements.

`,r+=`## Change Log

`,r+=`- Data updated via Token Model Manager interface
`,r+=`- All changes validated against schema constraints
`,r+=`- File size verified within GitHub limits

`,r+=`## Next Steps

`,r+=`1. Review the changes in this pull request
`,r+=`2. Test the updated design system data
`,r+=`3. Merge if changes are approved
`,r}static hasUnsavedChanges(){return An.getSelectedRepositoryInfo()!==null}static getFileSizeWarning(t){const n=JSON.stringify(t,null,2),i=new Blob([n]).size/(1024*1024);return i>=1?{warning:!1,error:!0,sizeMB:i,message:`File size (${i.toFixed(2)}MB) exceeds GitHub's 1MB limit`}:i>=.9?{warning:!0,error:!1,sizeMB:i,message:`File size (${i.toFixed(2)}MB) is approaching GitHub's 1MB limit`}:{warning:!1,error:!1,sizeMB:i}}}const Ob=({isOpen:e,onClose:t,saveMode:n,onSuccess:r})=>{const[i,a]=z.useState(""),[l,u]=z.useState(""),[h,f]=z.useState(""),[p,g]=z.useState(""),[y,b]=z.useState([]),[A,D]=z.useState(!1),[j,w]=z.useState(null),C=Hn();z.useEffect(()=>{e&&(a(""),u(""),f(""),g(""),w(null),_(),N(),E())},[e,n]);const _=async()=>{try{const ae=An.getSelectedRepositoryInfo();if(!ae)return;const ne=await An.getBranches(ae.fullName);b(ne);const F=ne.find(J=>J.name==="main"||J.name==="master")||ne[0];F&&g(F.name)}catch(ae){console.error("Failed to load branches:",ae),C({title:"Error",description:"Failed to load repository branches.",status:"error",duration:5e3,isClosable:!0})}},N=()=>{const ae=An.getSelectedRepositoryInfo();if(!ae)return;const ne=new Date().toLocaleString();a(`Update ${ae.filePath} - ${ne}`),u(`Update ${ae.filePath}`),f(`Update design system data in ${ae.filePath}

- Changes made via Token Model Manager
- Timestamp: ${ne}
- File type: ${ae.fileType==="schema"?"Core Data":"Theme Override"}`)},E=()=>{const ae=An.getSelectedRepositoryInfo();if(!ae)return;const ne=eu.getCurrentDataForFileType(ae.fileType),F=eu.getFileSizeWarning(ne);w(F)},I=async()=>{D(!0);try{const ae={message:i,createPullRequest:n==="pullRequest",targetBranch:n==="pullRequest"?p:void 0,prTitle:n==="pullRequest"?l:void 0,prDescription:n==="pullRequest"?h:void 0},ne=await eu.saveToGitHub(ae);ne.success?(C({title:"Success",description:ne.message,status:"success",duration:5e3,isClosable:!0}),ne.pullRequestUrl&&window.open(ne.pullRequestUrl,"_blank"),r==null||r(ne),t()):C({title:"Error",description:ne.message,status:"error",duration:5e3,isClosable:!0})}catch(ae){console.error("Save failed:",ae),C({title:"Error",description:"Failed to save to GitHub.",status:"error",duration:5e3,isClosable:!0})}finally{D(!1)}},H=()=>{D(!1),a(""),u(""),f(""),g(""),w(null),t()},Z=An.getSelectedRepositoryInfo();return s.jsxs(zn,{isOpen:e,onClose:H,size:"xl",scrollBehavior:"inside",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:n==="direct"?"Save to GitHub":"Create Pull Request"}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:6,align:"stretch",children:[Z&&s.jsxs(Y,{p:4,bg:"gray.50",borderRadius:"md",children:[s.jsxs(B,{fontWeight:"bold",children:["Repository: ",Z.fullName]}),s.jsxs(B,{children:["Branch: ",Z.branch]}),s.jsxs(B,{children:["File: ",Z.filePath]}),s.jsxs(B,{children:["Type: ",Z.fileType==="schema"?"Core Data":"Theme Override"]})]}),j&&(j.warning||j.error)&&s.jsxs(xn,{status:j.error?"error":"warning",children:[s.jsx(bn,{}),s.jsxs(Y,{children:[s.jsx(Oi,{children:"File Size Warning"}),s.jsx(or,{children:j.message})]})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Commit Message"}),s.jsx(ut,{value:i,onChange:ae=>a(ae.target.value),placeholder:"Describe your changes..."})]}),n==="pullRequest"&&s.jsxs(s.Fragment,{children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Target Branch"}),s.jsx(Zt,{value:p,onChange:ae=>g(ae.target.value),placeholder:"Select target branch",children:y.map(ae=>s.jsxs("option",{value:ae.name,children:[ae.name," ",ae.name===(Z==null?void 0:Z.branch)&&"(Current)"]},ae.name))})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Pull Request Title"}),s.jsx(ut,{value:l,onChange:ae=>u(ae.target.value),placeholder:"Pull request title..."})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Pull Request Description"}),s.jsx(Np,{value:h,onChange:ae=>f(ae.target.value),placeholder:"Describe the changes in this pull request...",rows:6})]})]})]})}),s.jsx(Xn,{children:s.jsxs(ve,{spacing:3,children:[s.jsx(Ee,{variant:"ghost",onClick:H,isDisabled:A,children:"Cancel"}),s.jsx(Ee,{colorScheme:n==="direct"?"blue":"green",onClick:I,isLoading:A,loadingText:n==="direct"?"Saving...":"Creating PR...",isDisabled:!i||n==="pullRequest"&&(!p||!l),children:n==="direct"?"Save to GitHub":"Create Pull Request"})]})})]})]})},Vb=({hasChanges:e=!1,changeCount:t=0,currentData:n,baselineData:r,dataSource:i,setDataSource:a,dataOptions:l,onResetData:u,onExportData:h,isGitHubConnected:f=!1,githubUser:p,selectedRepoInfo:g,onGitHubConnect:y,onGitHubDisconnect:b,onFileSelected:A})=>{const{colorMode:D}=tn(),j=D==="dark"?"gray.700":"gray.200",w=D==="dark"?"gray.800":"white",{isOpen:C,onOpen:_,onClose:N}=ca(),[E,I]=z.useState(!1),[H,Z]=z.useState(!1),[ae,ne]=z.useState("direct"),[F,J]=z.useState(!1),[pe,G]=z.useState(!1),[ge,W]=z.useState(!1),L=Hn(),Q=z.useRef(null);z.useEffect(()=>{f&&G(!1),cn.hasStaleOAuthState()||G(!1)},[f]);const fe=()=>{let jt="Design System Manager",Bt="";const Fn=he.getRootData().systemName||"Design System";if(g){if(g.fileType==="schema")jt=Fn;else if(g.fileType==="theme-override"){const Ct=he.getThemes(),kn=Ct.find(ee=>ee.isDefault)||Ct[0],Ln=(kn==null?void 0:kn.displayName)||"Default Theme";jt=`${Fn}: ${Ln}`}Bt=`(${g.branch})`}else{const Ct=he.getCollections(),kn=he.getThemes();if(Ct&&Ct.length>0)jt=Fn;else if(kn&&kn.length>0){const Ln=kn.find(Ve=>Ve.isDefault)||kn[0],ee=(Ln==null?void 0:Ln.displayName)||"Default Theme";jt=`${Fn}: ${ee}`}}return{title:jt,subtitle:Bt}},{title:xe,subtitle:ue}=fe(),ke=()=>{_()},q=async()=>{G(!0);try{await new Promise(jt=>setTimeout(jt,100)),y&&await y()}catch(jt){console.error("GitHub connection error:",jt),G(!1),L({title:"GitHub Connection Failed",description:jt instanceof Error?jt.message:"Failed to connect to GitHub. Please try again.",status:"error",duration:5e3,isClosable:!0})}},re=()=>{b&&b(),I(!1),Z(!1),J(!1),G(!1)},Se=(jt,Bt)=>{A&&A(jt,Bt),window.dispatchEvent(new CustomEvent(sr)),I(!1)},we=async()=>{if(g)try{const jt=await An.getFileContent(g.fullName,g.filePath,g.branch),Bt=JSON.parse(jt.content);g.fileType==="schema"?(he.setCollections(Bt.tokenCollections||[]),he.setDimensions(Bt.dimensions||[]),he.setTokens(Bt.tokens||[]),he.setPlatforms(Bt.platforms||[]),he.setThemes(Bt.themes||[]),he.setTaxonomies(Bt.taxonomies||[]),he.setValueTypes(Bt.resolvedValueTypes||[]),he.setRootData({systemName:Bt.systemName,systemId:Bt.systemId,description:Bt.description,version:Bt.version,versionHistory:Bt.versionHistory})):g.fileType==="theme-override"&&console.log("Theme override data loaded:",Bt);const qn=window.refreshAppData;qn&&qn(),window.dispatchEvent(new CustomEvent(sr)),L({title:"Reloaded",description:`Successfully reloaded ${g.filePath}`,status:"success",duration:3e3,isClosable:!0})}catch{L({title:"Reload Failed",description:"Failed to reload file from GitHub.",status:"error",duration:5e3,isClosable:!0})}},Ce=()=>{window.dispatchEvent(new CustomEvent(sr))},Le=()=>{ne("direct"),Z(!0)},ft=()=>{ne("pullRequest"),Z(!0)},vt=jt=>{a&&a(jt)},on=()=>{W(!0)},Rt=async()=>{if(g&&p)try{await we(),L({title:"Data Reset",description:`Data has been reset to ${g.filePath} from GitHub.`,status:"success",duration:3e3,isClosable:!0})}catch{L({title:"Reset Failed",description:"Failed to reload data from GitHub. Please try again.",status:"error",duration:5e3,isClosable:!0})}else u&&(u(),window.dispatchEvent(new CustomEvent(sr)),L({title:"Data Reset",description:"Data has been reset to baseline.",status:"info",duration:3e3,isClosable:!0}));W(!1)},nn=()=>{W(!1)},Ir=()=>{h&&(h(),L({title:"Data Exported",description:"Data has been exported successfully.",status:"success",duration:3e3,isClosable:!0}))};return s.jsxs(s.Fragment,{children:[s.jsxs(Y,{as:"header",borderBottom:"1px",borderColor:j,bg:w,px:4,py:3,display:"flex",alignItems:"center",justifyContent:"space-between",children:[s.jsxs(ve,{spacing:2,alignItems:"baseline",children:[s.jsx(B,{fontSize:"md",fontWeight:"bold",children:xe}),s.jsx(B,{fontSize:"xs",children:ue})]}),s.jsxs(ve,{spacing:2,children:[!f&&l&&i&&a&&s.jsx(ve,{spacing:2,children:s.jsx(Zt,{size:"sm",value:i,onChange:jt=>vt(jt.target.value),minW:"200px",children:l.map(jt=>s.jsx("option",{value:jt.value,children:jt.label},jt.value))})}),p?s.jsxs(ve,{spacing:2,children:[s.jsxs(pa,{placement:"bottom-end",isOpen:F,onClose:()=>J(!1),children:[s.jsx(ma,{children:s.jsxs(us,{size:"md",colorScheme:"gray",variant:"subtle",borderRadius:"full",gap:2,cursor:"pointer",_hover:{bg:"gray.100"},_dark:{_hover:{bg:"gray.700"}},onClick:()=>J(!0),children:[s.jsx(ix,{size:"2xs",src:p.avatar_url}),s.jsx(Bi,{fontSize:"xs",children:p.login})]})}),s.jsxs(so,{p:0,w:"auto",minW:"200px",children:[s.jsx(Mp,{}),s.jsx(io,{p:0,children:s.jsxs(ye,{spacing:0,align:"stretch",children:[s.jsx(Ee,{variant:"ghost",size:"sm",justifyContent:"flex-start",borderRadius:0,onClick:()=>{window.open(`https://github.com/${p.login}`,"_blank"),J(!1)},children:"View Profile"}),g&&s.jsx(Ee,{variant:"ghost",size:"sm",justifyContent:"flex-start",borderRadius:0,onClick:()=>{window.open(`https://github.com/${g.fullName}/pulls?q=author:${p.login}`,"_blank"),J(!1)},children:"My Pull Requests"}),s.jsx(Ee,{variant:"ghost",size:"sm",justifyContent:"flex-start",borderRadius:0,colorScheme:"red",onClick:()=>{re(),J(!1)},children:"Disconnect from GitHub"})]})})]})]}),s.jsx(er,{label:"Select Repository",children:s.jsx(mt,{"aria-label":"Select Repository",icon:s.jsx(K2,{size:16}),size:"sm",variant:"ghost",onClick:()=>I(!0)})})]}):s.jsx(er,{label:pe?"Connecting to GitHub...":"Connect GitHub",children:s.jsx(mt,{"aria-label":"Connect GitHub",icon:pe?s.jsx(cs,{size:"sm"}):s.jsx(A4,{size:16}),size:"sm",variant:"ghost",onClick:q,isLoading:pe,isDisabled:pe})}),g&&p&&s.jsxs(ve,{spacing:2,children:[s.jsx(er,{label:"Reload from GitHub",children:s.jsx(mt,{"aria-label":"Reload from GitHub",icon:s.jsx(J2,{size:16}),size:"sm",variant:"ghost",onClick:we})}),s.jsx(er,{label:"Commit Changes to GitHub",children:s.jsx(mt,{"aria-label":"Commit Changes to GitHub",icon:s.jsx(Cd,{size:16}),size:"sm",variant:"ghost",onClick:Le})}),s.jsx(er,{label:"Create Pull Request",children:s.jsx(mt,{"aria-label":"Create Pull Request",icon:s.jsx(T4,{size:16}),size:"sm",variant:"ghost",onClick:ft})})]}),(h||u)&&s.jsxs(ve,{spacing:2,children:[h&&s.jsx(er,{label:"Export Data",children:s.jsx(mt,{"aria-label":"Export Data",icon:s.jsx(g4,{size:16}),size:"sm",variant:"ghost",onClick:Ir})}),u&&s.jsx(er,{label:"Reset Data",children:s.jsx(mt,{"aria-label":"Reset Data",icon:s.jsx(hm,{size:16}),size:"sm",variant:"ghost",onClick:on})})]}),s.jsxs(Y,{position:"relative",children:[s.jsx(er,{label:"History",placement:"bottom",children:s.jsx(mt,{"aria-label":"History",icon:s.jsx(nm,{size:16}),variant:"ghost",size:"sm",onClick:ke})}),e&&s.jsx(pt,{position:"absolute",top:"-2px",right:"-2px",colorScheme:"red",variant:"solid",size:"sm",borderRadius:"full",minW:"18px",h:"18px",fontSize:"xs",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1,children:t>99?"99+":t})]})]})]}),s.jsx(gm,{isOpen:E,onClose:()=>I(!1),onFileSelected:Se}),s.jsx(Ob,{isOpen:H,onClose:()=>{Z(!1),ne("direct")},saveMode:ae,onSuccess:Ce}),s.jsxs(zn,{isOpen:C,onClose:N,size:"xl",scrollBehavior:"inside",closeOnOverlayClick:!0,closeOnEsc:!0,isCentered:!0,children:[s.jsx(vn,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),s.jsxs(Pn,{children:[s.jsx(wn,{children:"Change History"}),s.jsx(cr,{}),s.jsx(Sn,{pb:6,children:s.jsx(mm,{currentData:n,previousData:r})})]})]}),s.jsx(bl,{isOpen:ge,onClose:nn,leastDestructiveRef:Q,children:s.jsx(vn,{children:s.jsxs(vl,{children:[s.jsx(wn,{children:g&&p?"Reset to GitHub source?":"Reset data?"}),s.jsx(Sn,{children:g&&p?`This will reload all data from ${g.filePath} on GitHub and you will lose all of your local changes. This cannot be undone.`:"This will revert to the original state and you will lose all of your changes. This cannot be undone."}),s.jsxs(Xn,{children:[s.jsx(Ee,{ref:Q,onClick:nn,children:"Cancel"}),s.jsx(Ee,{colorScheme:"red",onClick:Rt,ml:3,children:g&&p?"Reset to GitHub":"Reset data"})]})]})})})]})},sr="token-model:data-change",zb=({dataSource:e,setDataSource:t,dataOptions:n,onResetData:r,onExportData:i,isGitHubConnected:a=!1,githubUser:l,selectedRepoInfo:u,onGitHubConnect:h,onGitHubDisconnect:f,onFileSelected:p,children:g})=>{const{colorMode:y}=tn(),[b,A]=z.useState(!1),[D,j]=z.useState(0),[w,C]=z.useState(null),[_,N]=z.useState(null),E=z.useRef({}),I=z.useRef(!1),H=z.useRef(null),Z=z.useCallback(()=>({tokens:he.getTokens(),collections:he.getCollections(),modes:he.getModes(),resolvedValueTypes:he.getValueTypes(),dimensions:he.getDimensions(),dimensionOrder:he.getDimensionOrder(),platforms:he.getPlatforms(),themes:he.getThemes(),taxonomies:he.getTaxonomies(),namingRules:he.getNamingRules(),algorithms:he.getAlgorithms(),algorithmFile:he.getAlgorithmFile()}),[]),ae=z.useCallback((J,pe)=>{if(!pe)return!0;if(!J)return!1;const G=["tokens","collections","dimensions","themes","resolvedValueTypes"];for(const ge of G){const W=J[ge],L=pe[ge];if(!W&&L||W&&!L)return!0;if(W&&L){if(Math.abs(W.length-L.length)>5)return!0;const Q=new Set(W.map(re=>{const Se=re;return Se==null?void 0:Se.id}).filter(Boolean)),fe=new Set(L.map(re=>{const Se=re;return Se==null?void 0:Se.id}).filter(Boolean)),xe=Q.size-Array.from(Q).filter(re=>fe.has(re)).length,ue=fe.size-Array.from(fe).filter(re=>Q.has(re)).length,ke=xe+ue,q=Math.max(Q.size,fe.size);if(q>0&&ke/q>.5)return!0}}return!1},[]),ne=z.useCallback(()=>{const J=Z();C(J),N(J),E.current=J,I.current=!0,A(!1),j(0)},[Z]),F=z.useCallback(()=>{if(!I.current){ne();return}const J=Z();if(ae(J,H.current)){ne(),H.current=J;return}C(J);const pe=E.current;if(JSON.stringify(J)!==JSON.stringify(pe)){let ge=0;["tokens","collections","dimensions","themes","resolvedValueTypes","taxonomies","algorithms"].forEach(L=>{const Q=J[L]||[],fe=pe[L]||[];if(Array.isArray(Q)&&Array.isArray(fe)){const xe=new Set(Q.map(we=>{const Ce=we;return Ce==null?void 0:Ce.id}).filter(Boolean)),ue=new Set(fe.map(we=>{const Ce=we;return Ce==null?void 0:Ce.id}).filter(Boolean)),ke=Array.from(xe).filter(we=>!ue.has(we)).length,q=Array.from(ue).filter(we=>!xe.has(we)).length,re=Array.from(xe).filter(we=>ue.has(we));let Se=0;re.forEach(we=>{const Ce=Q.find(ft=>{const vt=ft;return(vt==null?void 0:vt.id)===we}),Le=fe.find(ft=>{const vt=ft;return(vt==null?void 0:vt.id)===we});Ce&&Le&&JSON.stringify(Ce)!==JSON.stringify(Le)&&Se++}),ge+=ke+q+Se}}),A(!0),j(ge)}else A(!1),j(0)},[Z,ae,ne]);return z.useEffect(()=>{ne(),H.current=Z()},[ne,Z]),z.useEffect(()=>{const J=()=>{F()};return window.addEventListener(sr,J),()=>window.removeEventListener(sr,J)},[F]),z.useEffect(()=>{const J=()=>{F()};return window.addEventListener("storage",J),()=>window.removeEventListener("storage",J)},[F]),s.jsxs(Di,{h:"100vh",overflow:"hidden",children:[s.jsx(_b,{}),s.jsxs(Di,{flex:"1",direction:"column",overflow:"hidden",children:[s.jsx(Vb,{hasChanges:b,changeCount:D,currentData:w,baselineData:_,dataSource:e,setDataSource:t,dataOptions:n,onResetData:r,onExportData:i,isGitHubConnected:a,githubUser:l,selectedRepoInfo:u,onGitHubConnect:h,onGitHubDisconnect:f,onFileSelected:p}),s.jsx(Y,{flex:"1",overflow:"auto",p:4,bg:y==="dark"?"gray.900":"gray.50",children:g})]})]})},Pb=typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").matches;console.log("System prefers dark mode:",Pb);const Bb={initialColorMode:"system",useSystemColorMode:!0},qu=ax({config:Bb,styles:{global:{body:{transition:"background-color 0.2s, color 0.2s"}}},components:{VStack:{baseStyle:{bg:"transparent"}},Modal:{baseStyle:{dialog:{bg:"chakra-body-bg",maxH:"calc(100vh - 80px)",my:"40px",overflow:"hidden"},header:{px:6,py:4},body:{px:6,py:4,overflowY:"auto"},footer:{px:6,py:4}}},Popover:{baseStyle:{content:{bg:"chakra-body-bg",borderColor:"chakra-border-color"}}},NumberInput:{baseStyle:{field:{bg:"chakra-body-bg",borderColor:"chakra-border-color"},stepper:{borderColor:"chakra-border-color"}}}},semanticTokens:{colors:{"chakra-body-text":{_light:"gray.800",_dark:"white"},"chakra-body-bg":{_light:"white",_dark:"gray.900"},"chakra-border-color":{_light:"gray.200",_dark:"gray.700"}}}});typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log("System color scheme changed:",e.matches?"dark":"light")});const Wr=(e,t,n,r)=>n?s.jsx(er,{label:`${r} token generated by algorithm`,placement:"top",hasArrow:!0,children:s.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[e,s.jsx("span",{className:"badgeIcon",style:{position:"absolute",top:"-8px",right:"-8px",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(nb,{size:t/2,strokeWidth:3.5})})]})}):e,Id=(e,t=24,n=!1,r)=>{if(!e)return s.jsx(Al,{size:t});const i=r||e;switch(e){case"COLOR":return Wr(s.jsx(Kl,{size:t}),t,n,i);case"DIMENSION":return Wr(s.jsx(am,{size:t}),t,n,i);case"SPACING":return Wr(s.jsx(Qp,{size:t}),t,n,i);case"FONT_FAMILY":case"FONT_WEIGHT":case"FONT_SIZE":return Wr(s.jsx(dm,{size:t}),t,n,i);case"LINE_HEIGHT":return Wr(s.jsx(im,{size:t}),t,n,i);case"LETTER_SPACING":return Wr(s.jsx(sm,{size:t}),t,n,i);case"DURATION":return Wr(s.jsx(um,{size:t}),t,n,i);case"CUBIC_BEZIER":return Wr(s.jsx(Kp,{size:t}),t,n,i);case"BLUR":return Wr(s.jsx(jd,{size:t}),t,n,i);case"SPREAD":return Wr(s.jsx(ts,{size:t}),t,n,i);case"RADIUS":return Wr(s.jsx(lm,{size:t}),t,n,i);default:return Wr(s.jsx(Al,{size:t}),t,n,i)}},Uu=({displayName:e,resolvedValueTypeId:t,resolvedValueTypes:n,value:r,isPill:i=!1,onClick:a})=>{const l=n.find(u=>u.id===t);if(!l)throw new Error(`Unknown value type: ${t}`);return s.jsx(Y,{onClick:a,width:"100%",textAlign:"left",borderRadius:"md",py:1,px:2,bg:i?"gray.100":"transparent",borderWidth:i?"1px":"0",borderColor:"gray.200",children:s.jsxs(ve,{width:"100%",justifyContent:"space-between",children:[s.jsxs(ve,{children:[l.type==="COLOR"&&s.jsx("div",{style:{display:"flex",flexGrow:0,flexShrink:0,width:"16px",height:"16px",borderRadius:"4px",backgroundColor:String(r)}}),l.type!=="COLOR"&&s.jsx("div",{style:{display:"flex",flexGrow:0,flexShrink:0,width:"16px",height:"16px"},children:Id(l.type,16)}),s.jsx(B,{className:"kode-mono",children:e})]}),s.jsx(B,{color:"gray.500",children:String(r)})]})})};function Fb(e,t){console.debug("[getValueTypeFromId] Input:",{resolvedValueTypeId:e,availableTypes:t.map(r=>({id:r.id,type:r.type}))});const n=t.find(r=>r.id===e);return console.debug("[getValueTypeFromId] Found value type:",n),n==null?void 0:n.type}function Lb(e,t){console.debug("[getDefaultValueForType] Input:",{resolvedValueTypeId:e,availableTypes:t.map(i=>({id:i.id,type:i.type}))});const n=t.find(i=>i.id===e);if(console.debug("[getDefaultValueForType] Found value type:",n),!n)throw console.error("[getDefaultValueForType] Error: Unknown value type",{requestedId:e,availableIds:t.map(i=>i.id)}),new Error(`Unknown value type: ${e}`);console.debug("[getDefaultValueForType] Determining default value for type:",n.type);let r;switch(n.type){case"COLOR":r={value:"#000000"};break;case"DIMENSION":case"SPACING":case"FONT_SIZE":case"LINE_HEIGHT":case"LETTER_SPACING":case"BLUR":case"SPREAD":case"RADIUS":r={value:0};break;case"FONT_WEIGHT":r={value:400};break;case"FONT_FAMILY":r={value:"system-ui"};break;case"DURATION":r={value:0};break;case"CUBIC_BEZIER":r={value:"cubic-bezier(0.4, 0, 0.2, 1)"};break;default:n.type==="LINE_HEIGHT"?r={value:1.5}:r={value:""}}return console.debug("[getDefaultValueForType] Generated default value:",r),r}function $b(e,t,n){const r=n.find(a=>a.id===t);if(!r)return String(e);let i;if(typeof e=="string")i=e;else if(typeof e=="object"&&e)if("value"in e)i=e.value;else return"tokenId"in e?`alias:${e.tokenId}`:String(e);else return String(e);switch(r.type){case"COLOR":return typeof i=="string"?i:String(i);case"DIMENSION":case"SPACING":case"FONT_SIZE":case"LINE_HEIGHT":case"LETTER_SPACING":case"DURATION":case"BLUR":case"SPREAD":case"RADIUS":return`${typeof i=="number"?i:Number(i)}px`;case"FONT_WEIGHT":return typeof i=="number"?i.toString():String(i);case"FONT_FAMILY":case"CUBIC_BEZIER":return typeof i=="string"?i:String(i);default:return typeof i=="string"?i:String(i)}}function Gb({tokens:e,collections:t,resolvedValueTypes:n,taxonomies:r,renderAddTokenButton:i,onEditToken:a}){const[l,u]=z.useState("PRIMITIVE"),{colorMode:h}=tn(),[f,p]=z.useState([]),[g,y]=z.useState([]),[b,A]=z.useState([]),[D,j]=z.useState([]),[w,C]=z.useState([]),[_,N]=z.useState(""),[E,I]=z.useState({tokenTier:!1,propertyTypes:!1,codeSyntax:!1,taxonomies:!1,private:!1,themeable:!0,status:!0,collection:!1,generatedByAlgorithm:!1,algorithm:!1}),H=()=>{p([]),y([]),A([]),j([]),C([]),N("")},Z=Array.from(new Set(e.map(L=>L.status||"experimental"))).sort(),ae=e.filter(L=>{var Se;const Q=L.displayName.toLowerCase().includes(_.toLowerCase())||((Se=L.description)==null?void 0:Se.toLowerCase().includes(_.toLowerCase())),fe=_?!0:L.tokenTier===l,xe=f.length===0||f.some(we=>{const Ce=t.find(Le=>Le.id===we);return Ce?!!(L.tokenCollectionId===we||!L.tokenCollectionId&&Ce.resolvedValueTypeIds.includes(L.resolvedValueTypeId)):!1}),ue=g.length===0||g.includes(L.resolvedValueTypeId??""),ke=b.length===0||b.includes(L.status||"experimental"),q=D.length===0||D.includes(L.private),re=w.length===0||w.includes(L.themeable);return Q&&fe&&xe&&ue&&ke&&q&&re}),ne=L=>{const Q=n.find(fe=>fe.id===L);return(Q==null?void 0:Q.type)||L},F=L=>{const Q=n.find(fe=>fe.id===L);return(Q==null?void 0:Q.displayName)||L},J=L=>{var Q;return(Q=L.valuesByMode)!=null&&Q.length?L.valuesByMode.map(fe=>{var Se,we;const xe=fe.value;if(!xe)return null;const ue=n.find(Ce=>Ce.id===L.resolvedValueTypeId);if(!ue)return console.warn("No resolved value type found for token:",{tokenId:L.id,resolvedValueTypeId:L.resolvedValueTypeId}),"-";let ke;const q=Ce=>{if(!Ce||typeof Ce!="object")return null;const Le=Ce;return"tokenId"in Le&&typeof Le.tokenId=="string"?Le.tokenId:"value"in Le&&Le.value&&typeof Le.value=="object"?q(Le.value):null},re=q(xe);if(re){const Ce=e.find(Le=>Le.id===re);if(Ce){const Le=(we=(Se=Ce.valuesByMode)==null?void 0:Se[0])==null?void 0:we.value;if(Le&&"value"in Le){const ft=typeof Le.value=="object"&&Le.value!==null&&"value"in Le.value?Le.value.value:Le.value;ke=s.jsx(Uu,{displayName:Ce.displayName,resolvedValueTypeId:Ce.resolvedValueTypeId,resolvedValueTypes:n,value:ft,isPill:!0})}else ke=Ce.displayName}else ke=re}else if(typeof xe=="object"&&xe!==null&&"value"in xe){const Ce=typeof xe.value=="object"&&xe.value!==null&&"value"in xe.value?xe.value.value:xe.value,Le=$b(Ce,L.resolvedValueTypeId,n);switch(ue.type){case"COLOR":ke=s.jsxs(ve,{spacing:2,children:[s.jsx(Y,{w:4,h:4,borderRadius:"sm",bg:typeof Ce=="string"?Ce:String(Ce),border:"1px solid",borderColor:"gray.200"}),s.jsx(B,{children:Le})]});break;case"DIMENSION":case"SPACING":case"FONT_SIZE":case"LINE_HEIGHT":case"LETTER_SPACING":case"DURATION":case"BLUR":case"SPREAD":case"RADIUS":ke=`${typeof Ce=="number"?Ce:Number(Ce)}px`;break;case"FONT_WEIGHT":ke=typeof Ce=="number"?Ce.toString():String(Ce);break;case"FONT_FAMILY":case"CUBIC_BEZIER":ke=typeof Ce=="string"?Ce:String(Ce);break;default:ke=Le}}else ke=String(xe);return s.jsx(Y,{children:ke},fe.modeIds.join(","))}):"-"},pe=L=>{var Q;return(Q=L.taxonomies)!=null&&Q.length?L.taxonomies.map(fe=>{const xe=r.find(ke=>ke.id===fe.taxonomyId),ue=xe==null?void 0:xe.terms.find(ke=>ke.id===fe.termId);return`${(xe==null?void 0:xe.name)||fe.taxonomyId}: ${(ue==null?void 0:ue.name)||fe.termId}`}).join(`
`):"-"},G=L=>!L.generatedByAlgorithm||!L.algorithmId?"-":L.algorithmId,ge=L=>{a&&a(L)},W=L=>{I(Q=>({...Q,[L]:!Q[L]}))};return s.jsxs(Y,{p:4,children:[s.jsx(Di,{justify:"space-between",align:"center",mb:4,width:"100%",children:s.jsxs(ve,{spacing:4,width:"100%",justify:"space-between",children:[s.jsx(yt,{size:"md",children:"Tokens"}),s.jsxs(ox,{width:"300px",children:[s.jsx(lx,{pointerEvents:"none",children:s.jsx(om,{size:16})}),s.jsx(ut,{placeholder:"Search tokens...",value:_,onChange:L=>N(L.target.value)}),_&&s.jsx(cx,{children:s.jsx(mt,{"aria-label":"Clear search",icon:s.jsx(fm,{size:14}),size:"sm",variant:"ghost",onClick:()=>N("")})})]})]})}),s.jsx(Fi,{onChange:L=>{u(["PRIMITIVE","SEMANTIC","COMPONENT"][L])},mb:4,variant:_?"unstyled":"line",opacity:_?.5:1,children:s.jsxs(Li,{children:[s.jsx(Jn,{isDisabled:!!_,children:"Primitive"}),s.jsx(Jn,{isDisabled:!!_,children:"Semantic"}),s.jsx(Jn,{isDisabled:!!_,children:"Component"})]})}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:h==="dark"?"gray.900":"white",children:[s.jsxs(Di,{gap:2,mb:4,justify:"space-between",width:"100%",children:[i,s.jsxs(ve,{spacing:4,children:[s.jsxs(pa,{placement:"bottom-end",children:[s.jsx(ma,{children:s.jsx(Ee,{leftIcon:s.jsx(w4,{size:16}),size:"sm",variant:"outline",children:"Filters"})}),s.jsx(so,{width:"200px",children:s.jsx(io,{children:s.jsxs(ye,{align:"start",spacing:4,children:[s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"medium",mb:2,children:"Collection"}),s.jsx(ye,{align:"start",spacing:1,children:t.map(L=>s.jsx(Tn,{isChecked:f.includes(L.id),onChange:Q=>{p(fe=>Q.target.checked?[...fe,L.id]:fe.filter(xe=>xe!==L.id))},children:L.name},L.id))})]}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"medium",mb:2,children:"Type"}),s.jsx(ye,{align:"start",spacing:1,children:n.map(L=>s.jsx(Tn,{isChecked:g.includes(L.id),onChange:Q=>{y(fe=>Q.target.checked?[...fe,L.id]:fe.filter(xe=>xe!==L.id))},children:L.displayName},L.id))})]}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"medium",mb:2,children:"Status"}),s.jsx(ye,{align:"start",spacing:1,children:Z.map(L=>s.jsx(Tn,{isChecked:b.includes(L),onChange:Q=>{A(fe=>Q.target.checked?[...fe,L]:fe.filter(xe=>xe!==L))},children:L},L))})]}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"medium",mb:2,children:"Private"}),s.jsxs(ye,{align:"start",spacing:1,children:[s.jsx(Tn,{isChecked:D.includes(!0),onChange:L=>{j(Q=>L.target.checked?[...Q,!0]:Q.filter(fe=>fe!==!0))},children:"Yes"}),s.jsx(Tn,{isChecked:D.includes(!1),onChange:L=>{j(Q=>L.target.checked?[...Q,!1]:Q.filter(fe=>fe!==!1))},children:"No"})]})]}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"medium",mb:2,children:"Themeable"}),s.jsxs(ye,{align:"start",spacing:1,children:[s.jsx(Tn,{isChecked:w.includes(!0),onChange:L=>{C(Q=>L.target.checked?[...Q,!0]:Q.filter(fe=>fe!==!0))},children:"Yes"}),s.jsx(Tn,{isChecked:w.includes(!1),onChange:L=>{C(Q=>L.target.checked?[...Q,!1]:Q.filter(fe=>fe!==!1))},children:"No"})]})]}),s.jsx(Ee,{size:"sm",variant:"ghost",onClick:H,width:"100%",children:"Clear filters"})]})})})]}),s.jsxs(pa,{placement:"bottom-end",children:[s.jsx(ma,{children:s.jsx(Ee,{leftIcon:s.jsx(f4,{size:16}),size:"sm",variant:"outline",children:"Columns"})}),s.jsx(so,{width:"200px",children:s.jsx(io,{children:s.jsxs(ye,{align:"start",spacing:2,children:[s.jsx(Tn,{isChecked:E.collection,onChange:()=>W("collection"),children:"Collection"}),s.jsx(Tn,{isChecked:E.status,onChange:()=>W("status"),children:"Status"}),s.jsx(Tn,{isChecked:E.themeable,onChange:()=>W("themeable"),children:"Themeable"}),s.jsx(Tn,{isChecked:E.private,onChange:()=>W("private"),children:"Private"}),s.jsx(Tn,{isChecked:E.taxonomies,onChange:()=>W("taxonomies"),children:"Taxonomies"}),s.jsx(Tn,{isChecked:E.tokenTier,onChange:()=>W("tokenTier"),children:"Token Tier"}),s.jsx(Tn,{isChecked:E.propertyTypes,onChange:()=>W("propertyTypes"),children:"Property Types"}),s.jsx(Tn,{isChecked:E.codeSyntax,onChange:()=>W("codeSyntax"),children:"Code Syntax"}),s.jsx(Tn,{isChecked:E.generatedByAlgorithm,onChange:()=>W("generatedByAlgorithm"),children:"Generated By Algorithm"}),s.jsx(Tn,{isChecked:E.algorithm,onChange:()=>W("algorithm"),children:"Algorithm"})]})})})]})]})]}),ae.length===0?s.jsx(Dp,{p:8,children:s.jsxs(ye,{spacing:4,children:[s.jsx(Y,{color:"gray.400",children:s.jsx(vr,{as:pm,size:48})}),s.jsxs(ye,{spacing:2,children:[s.jsx(B,{fontSize:"lg",fontWeight:"medium",children:e.length===0?"No tokens found":"No matching tokens"}),s.jsx(B,{color:"gray.500",textAlign:"center",children:e.length===0?"Get started by adding your first token":"Try adjusting your filters or search term"})]}),e.length===0&&i&&s.jsx(Y,{mt:2,children:i})]})}):s.jsxs(Bs,{variant:"simple",children:[s.jsx(ai,{children:s.jsxs(ir,{children:[s.jsx(pn,{children:"Type"}),s.jsx(pn,{children:"Name"}),E.collection&&s.jsx(pn,{children:"Collection"}),s.jsx(pn,{children:"Value"}),E.status&&s.jsx(pn,{children:"Status"}),E.themeable&&s.jsx(pn,{children:"Themeable"}),E.private&&s.jsx(pn,{children:"Private"}),E.taxonomies&&s.jsx(pn,{children:"Taxonomies"}),E.tokenTier&&s.jsx(pn,{children:"Token Tier"}),E.propertyTypes&&s.jsx(pn,{children:"Property Types"}),E.codeSyntax&&s.jsx(pn,{children:"Code Syntax"}),E.generatedByAlgorithm&&s.jsx(pn,{children:"Generated By Algorithm"}),E.algorithm&&s.jsx(pn,{children:"Algorithm"}),s.jsx(pn,{children:"Actions"})]})}),s.jsx(Fs,{children:ae.map(L=>{var Q,fe,xe;return s.jsxs(ir,{children:[s.jsx(sn,{children:s.jsx(ve,{spacing:2,backgroundColor:L.generatedByAlgorithm?"orange.100":"gray.100",borderRadius:"md",p:2,width:"fit-content",children:Id(ne(L.resolvedValueTypeId),20,L.generatedByAlgorithm,F(L.resolvedValueTypeId))})}),s.jsxs(sn,{children:[s.jsx(B,{fontWeight:"medium",children:L.displayName}),L.description&&s.jsx(B,{fontSize:"sm",color:"gray.500",children:L.description})]}),E.collection&&s.jsx(sn,{children:((Q=t.find(ue=>ue.id===L.tokenCollectionId))==null?void 0:Q.name)||L.tokenCollectionId}),s.jsx(sn,{children:J(L)}),E.status&&s.jsx(sn,{children:s.jsx(pt,{colorScheme:L.status==="stable"?"green":L.status==="deprecated"?"red":"yellow",children:L.status||"experimental"})}),E.themeable&&s.jsx(sn,{children:L.themeable?"Yes":"No"}),E.private&&s.jsx(sn,{children:L.private?"Yes":"No"}),E.taxonomies&&s.jsx(sn,{children:pe(L).split(`
`).map((ue,ke)=>s.jsx(B,{fontSize:"sm",children:ue},ke))}),E.tokenTier&&s.jsx(sn,{children:s.jsx(pt,{colorScheme:"blue",children:L.tokenTier})}),E.propertyTypes&&s.jsx(sn,{children:(fe=L.propertyTypes)==null?void 0:fe.map((ue,ke)=>s.jsx(pt,{mr:1,mb:1,colorScheme:"purple",children:ue},ke))}),E.codeSyntax&&s.jsx(sn,{children:(xe=L.codeSyntax)==null?void 0:xe.map((ue,ke)=>s.jsxs(B,{fontSize:"sm",children:[ue.platformId,": ",ue.formattedName]},ke))}),E.generatedByAlgorithm&&s.jsx(sn,{children:L.generatedByAlgorithm?"Yes":"No"}),E.algorithm&&s.jsx(sn,{children:G(L)}),s.jsx(sn,{children:s.jsx(ve,{spacing:2,children:a&&s.jsx(mt,{"aria-label":"Edit token",icon:s.jsx(Td,{size:16}),size:"sm",variant:"ghost",onClick:()=>ge(L)})})})]},L.id)})})]})]})]})}function ym({value:e,onChange:t,label:n="Value Types",isRequired:r=!1,disabled:i=!1,error:a}){const l=he.getValueTypes()||[],u=f=>{f&&t([...e,f])},h=f=>{t(e.filter(p=>p!==f))};return s.jsxs(Ge,{isRequired:r,isInvalid:!!a,isDisabled:i,children:[s.jsx(Ue,{children:n}),s.jsxs(Zt,{value:"",onChange:f=>u(f.target.value),children:[s.jsx("option",{value:"",children:"Add a value type..."}),l.filter(f=>!e.includes(f.id)).map(f=>s.jsx("option",{value:f.id,children:f.displayName},f.id))]}),s.jsx(Y,{mt:2,children:s.jsx(ve,{spacing:2,wrap:"wrap",children:e.map(f=>{const p=l.find(g=>g.id===f);return p?s.jsxs(us,{size:"md",borderRadius:"full",variant:"solid",colorScheme:"blue",children:[s.jsx(Bi,{children:p.displayName}),s.jsx(bd,{onClick:()=>h(f)})]},f):null})})}),a&&s.jsx(B,{color:"red.500",fontSize:"sm",children:a})]})}function Hb({open:e,onClose:t,onSave:n,collection:r,isNew:i=!1,resolvedValueTypes:a}){const[l,u]=z.useState({name:"",description:"",resolvedValueTypeIds:[],private:!1}),[h,f]=z.useState({}),p=Hn();z.useEffect(()=>{if(e){if(r){const b=r;u({name:r.name||"",description:r.description||"",resolvedValueTypeIds:b.resolvedValueTypeIds||[],private:!!r.private})}else u({name:"",description:"",resolvedValueTypeIds:[],private:!1});f({})}},[e,r]);const g=(b,A)=>{u(D=>({...D,[b]:A}))},y=()=>{if(f({}),!l.name||!l.name.trim()){f({name:"Name is required"}),p({title:"Validation Error",description:"Name is required",status:"error",duration:2e3});return}if(!Array.isArray(l.resolvedValueTypeIds)||l.resolvedValueTypeIds.length===0){f({resolvedValueTypeIds:"At least one value type is required"}),p({title:"Validation Error",description:"At least one value type is required",status:"error",duration:2e3});return}n({...r,name:l.name,description:l.description,resolvedValueTypeIds:l.resolvedValueTypeIds,private:!!l.private,id:(r==null?void 0:r.id)||crypto.randomUUID()})};return s.jsxs(zn,{isOpen:e,onClose:t,size:"md",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:i?"Create Collection":"Edit Collection"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{isInvalid:!!h.name,isRequired:!0,children:[s.jsx(Ue,{children:"Name"}),s.jsx(ut,{value:l.name||"",onChange:b=>g("name",b.target.value)}),h.name&&s.jsx(B,{color:"red.500",fontSize:"sm",children:h.name})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{value:l.description||"",onChange:b=>g("description",b.target.value),as:"textarea",rows:2})]}),s.jsx(Ge,{isInvalid:!!h.resolvedValueTypeIds,isRequired:!0,children:s.jsx(ym,{value:l.resolvedValueTypeIds,onChange:b=>g("resolvedValueTypeIds",b),label:"Resolved Value Types",isRequired:!0,error:h.resolvedValueTypeIds})}),s.jsx(Ge,{children:s.jsx(Tn,{isChecked:!!l.private,onChange:b=>g("private",b.target.checked),children:"Private"})})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:t,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:y,children:i?"Create":"Save"})]})]})]})}const Aa=({title:e,cardType:t="algorithm"})=>{let n=null;const r=20;switch(t){case"algorithm":n=s.jsx(ii,{size:r});break;case"collection":n=s.jsx(em,{size:r});break;case"taxonomy":n=s.jsx(El,{size:r});break;case"dimension":n=s.jsx(cm,{size:r});break;case"COLOR":n=s.jsx(Kl,{size:r});break;case"DIMENSION":n=s.jsx(am,{size:r});break;case"SPACING":n=s.jsx(Qp,{size:r});break;case"FONT_FAMILY":case"FONT_WEIGHT":case"FONT_SIZE":n=s.jsx(dm,{size:r});break;case"LINE_HEIGHT":n=s.jsx(im,{size:r});break;case"LETTER_SPACING":n=s.jsx(sm,{size:r});break;case"DURATION":n=s.jsx(um,{size:r});break;case"CUBIC_BEZIER":n=s.jsx(Kp,{size:r});break;case"BLUR":n=s.jsx(jd,{size:r});break;case"SPREAD":n=s.jsx(ts,{size:r});break;case"RADIUS":n=s.jsx(lm,{size:r});break;case"system-variable":n=s.jsx(Jp,{size:r});break;default:n=s.jsx(Al,{size:r});break}return s.jsxs(ve,{children:[n,s.jsx(B,{fontSize:"lg",fontWeight:"bold",children:e})]})};function qb({collections:e,onUpdate:t,tokens:n,resolvedValueTypes:r}){const{colorMode:i}=tn(),[a,l]=z.useState(!1),[u,h]=z.useState(null),[f,p]=z.useState(!1),g=Hn();function y(_){return n.filter(N=>N.tokenCollectionId===_.id&&!_.resolvedValueTypeIds.includes(N.resolvedValueTypeId)).length}function b(_){return n.filter(N=>N.tokenCollectionId===_.id&&!_.resolvedValueTypeIds.includes(N.resolvedValueTypeId)).map(N=>{const E=r.find(I=>I.id===N.resolvedValueTypeId);return{name:N.displayName,type:(E==null?void 0:E.displayName)||N.resolvedValueTypeId}})}const A=()=>{h(null),p(!0),l(!0)},D=_=>{h(_),p(!1),l(!0)},j=_=>{let N;f?N=[...e,_]:N=e.map(E=>E.id===_.id?_:E),t(N),g({title:f?"Collection created":"Collection updated",status:"success",duration:2e3}),l(!1)},w=()=>{l(!1)},C=_=>{const N=e.filter(E=>E.id!==_);t(N),g({title:"Collection deleted",status:"info",duration:2e3})};return s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"Collections"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:i==="dark"?"gray.900":"white",children:[s.jsx(Ee,{size:"sm",onClick:A,colorScheme:"blue",mb:4,leftIcon:s.jsx(ds,{}),children:"Create New Collection"}),s.jsx(ye,{align:"stretch",spacing:2,children:e.map(_=>{const N=_.resolvedValueTypeIds.length===1;return s.jsxs(Y,{p:3,borderWidth:1,borderRadius:"md",bg:i==="dark"?"gray.800":"gray.50",borderColor:i==="dark"?"gray.600":"gray.200",children:[s.jsxs(ve,{justify:"space-between",align:"center",children:[s.jsx(Y,{children:s.jsxs(ve,{children:[s.jsx(Aa,{title:_.name,cardType:"collection"}),N&&s.jsx(er,{label:"Type-based collections support only one resolved value type",placement:"top",children:s.jsx(us,{size:"sm",colorScheme:"blackAlpha",ml:2,children:"Type-based"})})]})}),s.jsxs(ve,{children:[s.jsx(mt,{"aria-label":"Edit collection",icon:s.jsx(Is,{}),size:"sm",onClick:()=>D(_)}),s.jsx(mt,{"aria-label":"Delete collection",icon:s.jsx(hs,{}),size:"sm",colorScheme:"red",onClick:()=>C(_.id)})]})]}),s.jsxs(ye,{align:"start",spacing:1,mt:2,ml:2,children:[s.jsx(B,{fontSize:"sm",color:"gray.600",children:s.jsx("b",{children:"Value Types:"})}),s.jsx(Jl,{spacing:2,children:Array.isArray(_.resolvedValueTypeIds)&&_.resolvedValueTypeIds.map(E=>{const I=r.find(F=>F.id===E),H=n.filter(F=>F.tokenCollectionId===_.id&&F.resolvedValueTypeId===E).length,Z=n.filter(F=>!F.tokenCollectionId&&F.resolvedValueTypeId===E).length,ae=H+Z,ne=[H>0?`${H} ${H===1?"token is":"tokens are"} assigned to this collection`:null,Z>0?`${Z} ${Z===1?"token is":"tokens are"} compatible but not assigned`:null].filter(Boolean).join(`
`);return I?s.jsx(er,{label:ne,placement:"top",hasArrow:!0,children:s.jsx(us,{size:"md",borderRadius:"full",variant:"subtle",colorScheme:"blue",children:s.jsxs(Bi,{children:[I.displayName," (",ae,")"]})})},E):null})}),y(_)>0&&s.jsxs(xn,{status:"warning",size:"sm",mt:2,borderRadius:"md",children:[s.jsx(bn,{}),b(_).map((E,I)=>s.jsxs(B,{fontSize:"sm",children:["Token '",E.name,"' has type '",E.type,"' which is not supported by collection '",_.name,"'"]},I))]}),_.private&&s.jsx(B,{fontSize:"sm",color:"gray.500",children:s.jsx("b",{children:"Private"})})]})]},_.id)})})]}),s.jsx(Hb,{open:a,onClose:w,onSave:j,collection:u,isNew:f,resolvedValueTypes:r})]})}const Wu=({variable:e,onVariableChange:t,dimensions:n})=>{const[r,i]=z.useState(null);z.useEffect(()=>{if(e.dimensionId){const h=n.find(f=>f.id===e.dimensionId);i(h||null)}},[e.dimensionId,n]);const a=h=>{const f={...e,modeBased:h,dimensionId:h?e.dimensionId:void 0,valuesByMode:h?e.valuesByMode||[]:void 0};t(f)},l=h=>{const f=n.find(g=>g.id===h);i(f||null);const p={...e,dimensionId:h,valuesByMode:f?e.valuesByMode||[]:void 0};t(p)},u=(h,f)=>{const p=e.valuesByMode||[],g=p.findIndex(D=>D.modeIds.includes(h));let y;switch(e.type){case"number":y=f===""?0:Number(f);break;case"boolean":y=f==="true"||f==="1";break;default:y=f}let b;g>=0?(b=[...p],b[g]={...b[g],value:y}):b=[...p,{modeIds:[h],value:y}];const A={...e,valuesByMode:b};t(A)};return s.jsx(Y,{p:4,borderWidth:1,borderRadius:"md",bg:"gray.50",children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(ve,{justify:"space-between",children:[s.jsx(B,{fontWeight:"bold",children:"Mode-Based Variable Settings"}),s.jsx(Rp,{isChecked:e.modeBased||!1,onChange:h=>a(h.target.checked)})]}),e.modeBased&&s.jsxs(s.Fragment,{children:[s.jsx(Ss,{}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Dimension"}),s.jsx(Zt,{value:e.dimensionId||"",onChange:h=>l(h.target.value),placeholder:"Select a dimension",children:n.map(h=>s.jsxs("option",{value:h.id,children:[h.displayName," (",h.modes.length," modes)"]},h.id))})]}),r&&s.jsxs(Y,{children:[s.jsxs(B,{fontWeight:"medium",mb:3,children:["Mode-Specific Values for ",r.displayName,""]}),s.jsx(ye,{spacing:3,align:"stretch",children:r.modes.map(h=>s.jsxs(ve,{spacing:3,children:[s.jsx(pt,{colorScheme:"blue",minW:"80px",children:h.name}),s.jsx(Ge,{children:s.jsx(ut,{placeholder:`Value for ${h.name}`,value:(()=>{var p,g;const f=(g=(p=e.valuesByMode)==null?void 0:p.find(y=>y.modeIds.includes(h.id)))==null?void 0:g.value;return f==null?"":String(f)})(),onChange:f=>u(h.id,f.target.value),size:"sm"})})]},h.id))}),r.modes.length===0&&s.jsx(B,{fontSize:"sm",color:"gray.500",children:"No modes available for this dimension"})]})]})]})})};function Vr(e){let t;return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?t=crypto.randomUUID():t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const r=Math.random()*16|0;return(n==="x"?r:r&3|8).toString(16)}),`${e}Id-${t}`}function fi(e){return`${e}-${crypto.randomUUID()}`}const Ub=({open:e,onClose:t,onSave:n,variable:r,isNew:i=!1,dimensions:a})=>{const l=Hn(),u=/^[a-zA-Z_][a-zA-Z0-9_]*$/,[h,f]=z.useState({id:"",name:"",type:"number",defaultValue:"",description:"",modeBased:!1,valuesByMode:[],dimensionId:void 0}),p=h.name?u.test(h.name):!0;z.useEffect(()=>{f(r?{...r,id:r.id||fi("system-variable")}:{id:fi("system-variable"),name:"",type:"number",defaultValue:"",description:"",modeBased:!1,valuesByMode:[],dimensionId:void 0})},[r]);const g=()=>{var b;if(!((b=h.name)!=null&&b.trim())){l({title:"Error",description:"Please enter a variable name",status:"error",duration:3e3,isClosable:!0});return}if(!p){l({title:"Error",description:"Variable name must start with a letter or underscore and contain only letters, numbers, and underscores.",status:"error",duration:3e3,isClosable:!0});return}if(!h.type){l({title:"Error",description:"Please select a variable type",status:"error",duration:3e3,isClosable:!0});return}if(h.modeBased&&!h.dimensionId){l({title:"Error",description:"Please select a dimension for mode-based variable",status:"error",duration:3e3,isClosable:!0});return}n(h),t()},y=b=>{f(b)};return s.jsxs(zn,{isOpen:e,onClose:t,size:"xl",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:i?"Create New System Variable":"Edit System Variable"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(ve,{spacing:4,children:[s.jsxs(Ge,{isRequired:!0,isInvalid:!!h.name&&!p,children:[s.jsx(Ue,{children:"Variable Name"}),s.jsx(ut,{placeholder:"Variable Name",value:h.name,onChange:b=>f(A=>({...A,name:b.target.value}))}),!p&&h.name&&s.jsx(B,{fontSize:"xs",color:"red.500",children:"Variable names must start with a letter or underscore and contain only letters, numbers, and underscores."})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Type"}),s.jsxs(Zt,{value:h.type,onChange:b=>f(A=>({...A,type:b.target.value})),children:[s.jsx("option",{value:"number",children:"Number"}),s.jsx("option",{value:"string",children:"String"}),s.jsx("option",{value:"boolean",children:"Boolean"}),s.jsx("option",{value:"color",children:"Color"})]})]})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Default Value"}),s.jsx(ut,{placeholder:"Default Value (optional)",value:h.defaultValue||"",onChange:b=>f(A=>({...A,defaultValue:b.target.value}))})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{placeholder:"Description (optional)",value:h.description||"",onChange:b=>f(A=>({...A,description:b.target.value}))})]}),s.jsx(Wu,{variable:h,onVariableChange:y,dimensions:a})]})}),s.jsx(Xn,{children:s.jsxs(ve,{spacing:3,children:[s.jsx(Ee,{variant:"ghost",onClick:t,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:g,isDisabled:!p,children:i?"Create Variable":"Save Changes"})]})})]})]})};class ar{static normalizeSystemVariable(t){return{id:t.id||fi("system-variable"),name:t.name||"",type:t.type||"string",defaultValue:t.defaultValue||"",description:t.description||"",modeBased:t.modeBased||!1,valuesByMode:t.valuesByMode||[],dimensionId:t.dimensionId}}static getSystemVariables(){try{const t=new Map,n=he.getAlgorithmFile();if(n&&n.config&&typeof n.config=="object"){const i=n.config;i.systemVariables&&Array.isArray(i.systemVariables)&&i.systemVariables.forEach(a=>{if(a.id&&typeof a.id=="string"){const l=this.normalizeSystemVariable(a);t.set(a.id,l)}})}return this.getUserSystemVariables().forEach(i=>{i.id&&t.set(i.id,i)}),Array.from(t.values())}catch(t){return console.error("Error loading system variables:",t),[]}}static getUserSystemVariables(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):[]}catch(t){return console.error("Error loading user system variables:",t),[]}}static saveSystemVariable(t){try{const n=he.getAlgorithmFile();if(n&&n.config&&typeof n.config=="object"){const a=n.config;if(a.systemVariables&&Array.isArray(a.systemVariables)){const l=a.systemVariables.findIndex(u=>u.id===t.id);if(l>=0){const u={...t},h={...n,config:{...a,systemVariables:a.systemVariables.map((f,p)=>p===l?u:f)}};return he.setAlgorithmFile(h),!0}}}const r=this.getUserSystemVariables();t.id||(t.id=fi("system-variable"));const i=r.findIndex(a=>a.id===t.id);return i>=0?r[i]={...t}:r.push({...t}),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(r)),!0}catch(n){return console.error("Error saving system variable:",n),!1}}static updateSystemVariable(t){return this.saveSystemVariable(t)}static deleteSystemVariable(t){try{const n=he.getAlgorithmFile();if(n&&n.config&&typeof n.config=="object"){const a=n.config;if(a.systemVariables&&Array.isArray(a.systemVariables)){const l=a.systemVariables.findIndex(u=>u.id===t);if(l>=0){const u={...n,config:{...a,systemVariables:a.systemVariables.filter((h,f)=>f!==l)}};return he.setAlgorithmFile(u),!0}}}const r=this.getUserSystemVariables(),i=r.filter(a=>a.id!==t);return i.length===r.length?!1:(localStorage.setItem(this.STORAGE_KEY,JSON.stringify(i)),!0)}catch(n){return console.error("Error deleting system variable:",n),!1}}static getSystemVariableByName(t){return this.getSystemVariables().find(r=>r.name===t)}static systemVariableExists(t){return this.getSystemVariableByName(t)!==void 0}static exportToConfig(){const t=this.getSystemVariables(),n={};return t.forEach(r=>{r.defaultValue!==void 0&&(n[r.name]=this.parseValue(r.defaultValue,r.type))}),n}static importFromConfig(t){const n=[];for(const[i,a]of Object.entries(t))(typeof a=="string"||typeof a=="number"||typeof a=="boolean")&&n.push({id:`system-${i}`,name:i,type:this.inferType(a),defaultValue:String(a),description:`System variable: ${i}`,modeBased:!1,valuesByMode:[],dimensionId:void 0});const r=he.getAlgorithmFile();if(r){const i=r.config&&typeof r.config=="object"?r.config:{},a={...r,config:{...i,systemVariables:n}};he.setAlgorithmFile(a)}else{const i={schemaVersion:"5.0.0",profile:"basic",metadata:{name:"Algorithm Collection",description:"Algorithm collection",version:"1.0.0",author:"Design System Manager"},config:{systemVariables:n},algorithms:[],execution:{order:[],parallel:!1,onError:"stop"},integration:{targetSchema:"https://designsystem.org/schemas/tokens/v1.0.0",outputFormat:"design-tokens",mergeStrategy:"merge",validation:!0},examples:[]};he.setAlgorithmFile(i)}}static inferType(t){return typeof t=="number"?"number":typeof t=="boolean"?"boolean":typeof t=="string"&&(t.startsWith("#")||t.startsWith("rgb")||t.startsWith("hsl"))?"color":"string"}static parseValue(t,n){if(!t)return"";switch(n){case"number":return Number(t);case"boolean":return t.toLowerCase()==="true";case"color":case"string":default:return t}}static getSystemVariableById(t){return this.getSystemVariables().find(r=>r.id===t)}static getVariableNameById(t){const n=this.getSystemVariableById(t);return n==null?void 0:n.name}static getVariableIdByName(t){const n=this.getSystemVariableByName(t);return n==null?void 0:n.id}}bs(ar,"STORAGE_KEY","systemVariables");function Wb({dimensions:e}){const{colorMode:t}=tn(),[n,r]=z.useState(!1),[i,a]=z.useState(null),[l,u]=z.useState(!1),[h,f]=z.useState([]),p=Hn();z.useEffect(()=>{const w=ar.getSystemVariables();f(w)},[]);const g=()=>{a(null),u(!0),r(!0)},y=w=>{a(w),u(!1),r(!0)},b=w=>{if(ar.saveSystemVariable(w)){const _=ar.getSystemVariables();f(_),p({title:l?"System variable created":"System variable updated",status:"success",duration:2e3})}else p({title:"Error",description:"Failed to save system variable",status:"error",duration:3e3,isClosable:!0});r(!1)},A=()=>{r(!1)},D=w=>{if(ar.deleteSystemVariable(w)){const _=ar.getSystemVariables();f(_),p({title:"System variable deleted",status:"info",duration:2e3})}else p({title:"Error",description:"Failed to delete system variable",status:"error",duration:3e3,isClosable:!0})},j=(w,C)=>{if(!C)return w;const _=e.find(E=>E.id===C);if(!_)return w;const N=_.modes.find(E=>E.id===w);return N?N.name:w};return s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"System Variables"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:t==="dark"?"gray.900":"white",children:[s.jsx(Ee,{size:"sm",onClick:g,colorScheme:"blue",mb:4,leftIcon:s.jsx(ds,{}),children:"Create New System Variable"}),h.length===0?s.jsx(Dp,{p:8,children:s.jsxs(ye,{spacing:4,children:[s.jsx(vr,{as:D2,boxSize:12,color:"gray.400"}),s.jsxs(ye,{spacing:2,children:[s.jsx(B,{fontSize:"lg",fontWeight:"medium",children:"No system variables found"}),s.jsx(B,{color:"gray.500",textAlign:"center",children:"Get started by adding your first system variable"})]}),s.jsx(Y,{mt:2,children:s.jsx(Ee,{size:"sm",onClick:g,colorScheme:"blue",leftIcon:s.jsx(ds,{}),children:"Create New System Variable"})})]})}):s.jsx(ye,{align:"stretch",spacing:2,children:h.map(w=>s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:t==="dark"?"gray.800":"gray.50",borderColor:t==="dark"?"gray.600":"gray.200",children:s.jsxs(ve,{justify:"space-between",align:"center",children:[s.jsxs(Y,{flex:1,children:[s.jsxs(ve,{spacing:2,mb:1,children:[s.jsx(Aa,{title:w.name,cardType:"system-variable"}),s.jsx(pt,{colorScheme:"blue",size:"sm",children:w.type}),w.modeBased&&s.jsx(pt,{colorScheme:"green",size:"sm",children:"Mode-Based"})]}),w.description&&s.jsx(B,{fontSize:"sm",color:"gray.600",mb:1,children:w.description}),w.defaultValue&&!w.modeBased&&s.jsxs(B,{fontSize:"sm",color:"gray.500",children:["Default: ",w.defaultValue]}),w.modeBased&&w.valuesByMode&&w.valuesByMode.length>0&&s.jsxs(Y,{mt:2,children:[s.jsx(B,{fontSize:"xs",color:"gray.500",mb:1,children:"Mode Values:"}),s.jsx(ve,{spacing:2,wrap:"wrap",children:w.valuesByMode.map((C,_)=>s.jsxs(pt,{size:"sm",colorScheme:"purple",variant:"outline",children:[C.modeIds.map(N=>j(N,w.dimensionId)).join(", "),": ",C.value]},C.modeIds.join("-")||_))})]})]}),s.jsxs(ve,{children:[s.jsx(mt,{"aria-label":"Edit system variable",icon:s.jsx(Is,{}),size:"sm",onClick:()=>y(w)}),s.jsx(mt,{"aria-label":"Delete system variable",icon:s.jsx(hs,{}),size:"sm",colorScheme:"red",onClick:()=>D(w.id)})]})]})},w.id))})]}),s.jsx(Ub,{open:n,onClose:A,onSave:b,variable:i,isNew:l,dimensions:e})]})}function br(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Zb=typeof Symbol=="function"&&Symbol.observable||"@@observable",ef=Zb,tf=()=>Math.random().toString(36).substring(7).split("").join("."),Yb={INIT:`@@redux/INIT${tf()}`,REPLACE:`@@redux/REPLACE${tf()}`},nf=Yb;function Jb(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function xm(e,t,n){if(typeof e!="function")throw new Error(br(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(br(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(br(1));return n(xm)(e,t)}let r=e,i=t,a=new Map,l=a,u=0,h=!1;function f(){l===a&&(l=new Map,a.forEach((j,w)=>{l.set(w,j)}))}function p(){if(h)throw new Error(br(3));return i}function g(j){if(typeof j!="function")throw new Error(br(4));if(h)throw new Error(br(5));let w=!0;f();const C=u++;return l.set(C,j),function(){if(w){if(h)throw new Error(br(6));w=!1,f(),l.delete(C),a=null}}}function y(j){if(!Jb(j))throw new Error(br(7));if(typeof j.type>"u")throw new Error(br(8));if(typeof j.type!="string")throw new Error(br(17));if(h)throw new Error(br(9));try{h=!0,i=r(i,j)}finally{h=!1}return(a=l).forEach(C=>{C()}),j}function b(j){if(typeof j!="function")throw new Error(br(10));r=j,y({type:nf.REPLACE})}function A(){const j=g;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(br(11));function C(){const N=w;N.next&&N.next(p())}return C(),{unsubscribe:j(C)}},[ef](){return this}}}return y({type:nf.INIT}),{dispatch:y,subscribe:g,getState:p,replaceReducer:b,[ef]:A}}function rf(e,t){return function(...n){return t(e.apply(this,n))}}function sf(e,t){if(typeof e=="function")return rf(e,t);if(typeof e!="object"||e===null)throw new Error(br(16));const n={};for(const r in e){const i=e[r];typeof i=="function"&&(n[r]=rf(i,t))}return n}function bm(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...r)=>t(n(...r)))}function Xb(...e){return t=>(n,r)=>{const i=t(n,r);let a=()=>{throw new Error(br(15))};const l={getState:i.getState,dispatch:(h,...f)=>a(h,...f)},u=e.map(h=>h(l));return a=bm(...u)(i.dispatch),{...i,dispatch:a}}}var Kb={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Co=z;function Qb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ev=typeof Object.is=="function"?Object.is:Qb,tv=Co.useSyncExternalStore,nv=Co.useRef,rv=Co.useEffect,sv=Co.useMemo,iv=Co.useDebugValue;Kb.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var a=nv(null);if(a.current===null){var l={hasValue:!1,value:null};a.current=l}else l=a.current;a=sv(function(){function h(b){if(!f){if(f=!0,p=b,b=r(b),i!==void 0&&l.hasValue){var A=l.value;if(i(A,b))return g=A}return g=b}if(A=g,ev(p,b))return A;var D=r(b);return i!==void 0&&i(A,D)?(p=b,A):(p=b,g=D)}var f=!1,p,g,y=n===void 0?null:n;return[function(){return h(t())},y===null?void 0:function(){return h(y())}]},[t,n,r,i]);var u=tv(e,a[0],a[1]);return rv(function(){l.hasValue=!0,l.value=u},[u]),iv(u),u};var av=z.version.startsWith("19"),ov=Symbol.for(av?"react.transitional.element":"react.element"),lv=Symbol.for("react.portal"),cv=Symbol.for("react.fragment"),uv=Symbol.for("react.strict_mode"),dv=Symbol.for("react.profiler"),hv=Symbol.for("react.consumer"),fv=Symbol.for("react.context"),vm=Symbol.for("react.forward_ref"),pv=Symbol.for("react.suspense"),mv=Symbol.for("react.suspense_list"),Ad=Symbol.for("react.memo"),gv=Symbol.for("react.lazy"),yv=vm,xv=Ad;function bv(e){if(typeof e=="object"&&e!==null){const{$$typeof:t}=e;switch(t){case ov:switch(e=e.type,e){case cv:case dv:case uv:case pv:case mv:return e;default:switch(e=e&&e.$$typeof,e){case fv:case vm:case gv:case Ad:return e;case hv:return e;default:return t}}case lv:return t}}}function vv(e){return bv(e)===Ad}function wv(e,t,n,r,{areStatesEqual:i,areOwnPropsEqual:a,areStatePropsEqual:l}){let u=!1,h,f,p,g,y;function b(C,_){return h=C,f=_,p=e(h,f),g=t(r,f),y=n(p,g,f),u=!0,y}function A(){return p=e(h,f),t.dependsOnOwnProps&&(g=t(r,f)),y=n(p,g,f),y}function D(){return e.dependsOnOwnProps&&(p=e(h,f)),t.dependsOnOwnProps&&(g=t(r,f)),y=n(p,g,f),y}function j(){const C=e(h,f),_=!l(C,p);return p=C,_&&(y=n(p,g,f)),y}function w(C,_){const N=!a(_,f),E=!i(C,h,_,f);return h=C,f=_,N&&E?A():N?D():E?j():y}return function(_,N){return u?w(_,N):b(_,N)}}function Sv(e,{initMapStateToProps:t,initMapDispatchToProps:n,initMergeProps:r,...i}){const a=t(e,i),l=n(e,i),u=r(e,i);return wv(a,l,u,e,i)}function kv(e,t){const n={};for(const r in e){const i=e[r];typeof i=="function"&&(n[r]=(...a)=>t(i(...a)))}return n}function Zu(e){return function(n){const r=e(n);function i(){return r}return i.dependsOnOwnProps=!1,i}}function af(e){return e.dependsOnOwnProps?!!e.dependsOnOwnProps:e.length!==1}function wm(e,t){return function(r,{displayName:i}){const a=function(u,h){return a.dependsOnOwnProps?a.mapToProps(u,h):a.mapToProps(u,void 0)};return a.dependsOnOwnProps=!0,a.mapToProps=function(u,h){a.mapToProps=e,a.dependsOnOwnProps=af(e);let f=a(u,h);return typeof f=="function"&&(a.mapToProps=f,a.dependsOnOwnProps=af(f),f=a(u,h)),f},a}}function _d(e,t){return(n,r)=>{throw new Error(`Invalid value of type ${typeof e} for ${t} argument when connecting component ${r.wrappedComponentName}.`)}}function jv(e){return e&&typeof e=="object"?Zu(t=>kv(e,t)):e?typeof e=="function"?wm(e):_d(e,"mapDispatchToProps"):Zu(t=>({dispatch:t}))}function Cv(e){return e?typeof e=="function"?wm(e):_d(e,"mapStateToProps"):Zu(()=>({}))}function Tv(e,t,n){return{...n,...e,...t}}function Iv(e){return function(n,{displayName:r,areMergedPropsEqual:i}){let a=!1,l;return function(h,f,p){const g=e(h,f,p);return a?i(g,l)||(l=g):(a=!0,l=g),l}}}function Av(e){return e?typeof e=="function"?Iv(e):_d(e,"mergeProps"):()=>Tv}function _v(e){e()}function Ev(){let e=null,t=null;return{clear(){e=null,t=null},notify(){_v(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=e;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const i=t={callback:n,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!r||e===null||(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var of={notify(){},get:()=>[]};function Sm(e,t){let n,r=of,i=0,a=!1;function l(D){p();const j=r.subscribe(D);let w=!1;return()=>{w||(w=!0,j(),g())}}function u(){r.notify()}function h(){A.onStateChange&&A.onStateChange()}function f(){return a}function p(){i++,n||(n=t?t.addNestedSub(h):e.subscribe(h),r=Ev())}function g(){i--,n&&i===0&&(n(),n=void 0,r.clear(),r=of)}function y(){a||(a=!0,p())}function b(){a&&(a=!1,g())}const A={addNestedSub:l,notifyNestedSubs:u,handleChangeWrapper:h,isSubscribed:f,trySubscribe:y,tryUnsubscribe:b,getListeners:()=>r};return A}var Nv=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Mv=Nv(),Dv=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Rv=Dv(),Ov=()=>Mv||Rv?z.useLayoutEffect:z.useEffect,Ml=Ov();function lf(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function tu(e,t){if(lf(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!lf(e[n[i]],t[n[i]]))return!1;return!0}var Vv={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},zv={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Pv={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},km={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Bv={[yv]:Pv,[xv]:km};function cf(e){return vv(e)?km:Bv[e.$$typeof]||Vv}var Fv=Object.defineProperty,Lv=Object.getOwnPropertyNames,uf=Object.getOwnPropertySymbols,$v=Object.getOwnPropertyDescriptor,Gv=Object.getPrototypeOf,df=Object.prototype;function Yu(e,t){if(typeof t!="string"){if(df){const a=Gv(t);a&&a!==df&&Yu(e,a)}let n=Lv(t);uf&&(n=n.concat(uf(t)));const r=cf(e),i=cf(t);for(let a=0;a<n.length;++a){const l=n[a];if(!zv[l]&&!(i&&i[l])&&!(r&&r[l])){const u=$v(t,l);try{Fv(e,l,u)}catch{}}}}return e}var nu=Symbol.for("react-redux-context"),ru=typeof globalThis<"u"?globalThis:{};function Hv(){if(!z.createContext)return{};const e=ru[nu]??(ru[nu]=new Map);let t=e.get(z.createContext);return t||(t=z.createContext(null),e.set(z.createContext,t)),t}var jm=Hv(),qv=[null,null];function Uv(e,t,n){Ml(()=>e(...t),n)}function Wv(e,t,n,r,i,a){e.current=r,n.current=!1,i.current&&(i.current=null,a())}function Zv(e,t,n,r,i,a,l,u,h,f,p){if(!e)return()=>{};let g=!1,y=null;const b=()=>{if(g||!u.current)return;const D=t.getState();let j,w;try{j=r(D,i.current)}catch(C){w=C,y=C}w||(y=null),j===a.current?l.current||f():(a.current=j,h.current=j,l.current=!0,p())};return n.onStateChange=b,n.trySubscribe(),b(),()=>{if(g=!0,n.tryUnsubscribe(),n.onStateChange=null,y)throw y}}function Yv(e,t){return e===t}function Jv(e,t,n,{pure:r,areStatesEqual:i=Yv,areOwnPropsEqual:a=tu,areStatePropsEqual:l=tu,areMergedPropsEqual:u=tu,forwardRef:h=!1,context:f=jm}={}){const p=f,g=Cv(e),y=jv(t),b=Av(n),A=!!e;return j=>{const w=j.displayName||j.name||"Component",C=`Connect(${w})`,_={shouldHandleStateChanges:A,displayName:C,wrappedComponentName:w,WrappedComponent:j,initMapStateToProps:g,initMapDispatchToProps:y,initMergeProps:b,areStatesEqual:i,areStatePropsEqual:l,areOwnPropsEqual:a,areMergedPropsEqual:u};function N(H){const[Z,ae,ne]=z.useMemo(()=>{const{reactReduxForwardedRef:Rt,...nn}=H;return[H.context,Rt,nn]},[H]),F=z.useMemo(()=>{let Rt=p;return Z!=null&&Z.Consumer,Rt},[Z,p]),J=z.useContext(F),pe=!!H.store&&!!H.store.getState&&!!H.store.dispatch,G=!!J&&!!J.store,ge=pe?H.store:J.store,W=G?J.getServerState:ge.getState,L=z.useMemo(()=>Sv(ge.dispatch,_),[ge]),[Q,fe]=z.useMemo(()=>{if(!A)return qv;const Rt=Sm(ge,pe?void 0:J.subscription),nn=Rt.notifyNestedSubs.bind(Rt);return[Rt,nn]},[ge,pe,J]),xe=z.useMemo(()=>pe?J:{...J,subscription:Q},[pe,J,Q]),ue=z.useRef(void 0),ke=z.useRef(ne),q=z.useRef(void 0),re=z.useRef(!1),Se=z.useRef(!1),we=z.useRef(void 0);Ml(()=>(Se.current=!0,()=>{Se.current=!1}),[]);const Ce=z.useMemo(()=>()=>q.current&&ne===ke.current?q.current:L(ge.getState(),ne),[ge,ne]),Le=z.useMemo(()=>nn=>Q?Zv(A,ge,Q,L,ke,ue,re,Se,q,fe,nn):()=>{},[Q]);Uv(Wv,[ke,ue,re,ne,q,fe]);let ft;try{ft=z.useSyncExternalStore(Le,Ce,W?()=>L(W(),ne):Ce)}catch(Rt){throw we.current&&(Rt.message+=`
The error may be correlated with this previous error:
${we.current.stack}

`),Rt}Ml(()=>{we.current=void 0,q.current=void 0,ue.current=ft});const vt=z.useMemo(()=>z.createElement(j,{...ft,ref:ae}),[ae,j,ft]);return z.useMemo(()=>A?z.createElement(F.Provider,{value:xe},vt):vt,[F,vt,xe])}const I=z.memo(N);if(I.WrappedComponent=j,I.displayName=N.displayName=C,h){const Z=z.forwardRef(function(ne,F){return z.createElement(I,{...ne,reactReduxForwardedRef:F})});return Z.displayName=C,Z.WrappedComponent=j,Yu(Z,j)}return Yu(I,j)}}var Cm=Jv;function Xv(e){const{children:t,context:n,serverState:r,store:i}=e,a=z.useMemo(()=>{const h=Sm(i);return{store:i,subscription:h,getServerState:r?()=>r:void 0}},[i,r]),l=z.useMemo(()=>i.getState(),[i]);Ml(()=>{const{subscription:h}=a;return h.onStateChange=h.notifyNestedSubs,h.trySubscribe(),l!==i.getState()&&h.notifyNestedSubs(),()=>{h.tryUnsubscribe(),h.onStateChange=void 0}},[a,l]);const u=n||jm;return z.createElement(u.Provider,{value:a},t)}var Kv=Xv,lo=function(t){var n=[],r=null,i=function(){for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];n=u,!r&&(r=requestAnimationFrame(function(){r=null,t.apply(void 0,n)}))};return i.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},i};function Tm(e,t){}Tm.bind(null,"warn");Tm.bind(null,"error");function pi(){}function Qv(e,t){return{...e,...t}}function ns(e,t,n){const r=t.map(i=>{const a=Qv(n,i.options);return e.addEventListener(i.eventName,i.fn,a),function(){e.removeEventListener(i.eventName,i.fn,a)}});return function(){r.forEach(a=>{a()})}}const e3="Invariant failed";class Dl extends Error{}Dl.prototype.toString=function(){return this.message};function $e(e,t){throw new Dl(e3)}class t3 extends kt.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=pi,this.onWindowError=n=>{const r=this.getCallbacks();r.isDragging()&&r.tryAbort(),n.error instanceof Dl&&n.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=n=>{this.callbacks=n}}componentDidMount(){this.unbind=ns(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof Dl){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const n3=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,Rl=e=>e+1,r3=e=>`
  You have lifted an item in position ${Rl(e.source.index)}
`,Im=(e,t)=>{const n=e.droppableId===t.droppableId,r=Rl(e.index),i=Rl(t.index);return n?`
      You have moved the item from position ${r}
      to position ${i}
    `:`
    You have moved the item from position ${r}
    in list ${e.droppableId}
    to list ${t.droppableId}
    in position ${i}
  `},Am=(e,t,n)=>t.droppableId===n.droppableId?`
      The item ${e}
      has been combined with ${n.draggableId}`:`
      The item ${e}
      in list ${t.droppableId}
      has been combined with ${n.draggableId}
      in list ${n.droppableId}
    `,s3=e=>{const t=e.destination;if(t)return Im(e.source,t);const n=e.combine;return n?Am(e.draggableId,e.source,n):"You are over an area that cannot be dropped on"},hf=e=>`
  The item has returned to its starting position
  of ${Rl(e.index)}
`,i3=e=>{if(e.reason==="CANCEL")return`
      Movement cancelled.
      ${hf(e.source)}
    `;const t=e.destination,n=e.combine;return t?`
      You have dropped the item.
      ${Im(e.source,t)}
    `:n?`
      You have dropped the item.
      ${Am(e.draggableId,e.source,n)}
    `:`
    The item has been dropped while not over a drop area.
    ${hf(e.source)}
  `},ul={dragHandleUsageInstructions:n3,onDragStart:r3,onDragUpdate:s3,onDragEnd:i3};function a3(e,t){return!!(e===t||Number.isNaN(e)&&Number.isNaN(t))}function _m(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!a3(e[n],t[n]))return!1;return!0}function Gt(e,t){const n=z.useState(()=>({inputs:t,result:e()}))[0],r=z.useRef(!0),i=z.useRef(n),l=r.current||!!(t&&i.current.inputs&&_m(t,i.current.inputs))?i.current:{inputs:t,result:e()};return z.useEffect(()=>{r.current=!1,i.current=l},[l]),l.result}function dt(e,t){return Gt(()=>e,t)}const rr={x:0,y:0},lr=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),zr=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),mi=(e,t)=>e.x===t.x&&e.y===t.y,_a=e=>({x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}),zi=(e,t,n=0)=>e==="x"?{x:t,y:n}:{x:n,y:t},co=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),ff=(e,t)=>Math.min(...t.map(n=>co(e,n))),Em=e=>t=>({x:e(t.x),y:e(t.y)});var o3=(e,t)=>{const n=$i({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return n.width<=0||n.height<=0?null:n};const To=(e,t)=>({top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}),pf=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],l3={top:0,right:0,bottom:0,left:0},c3=(e,t)=>t?To(e,t.scroll.diff.displacement):e,u3=(e,t,n)=>n&&n.increasedBy?{...e,[t.end]:e[t.end]+n.increasedBy[t.line]}:e,d3=(e,t)=>t&&t.shouldClipSubject?o3(t.pageMarginBox,e):$i(e);var wa=({page:e,withPlaceholder:t,axis:n,frame:r})=>{const i=c3(e.marginBox,r),a=u3(i,n,t),l=d3(a,r);return{page:e,withPlaceholder:t,active:l}},Ed=(e,t)=>{e.frame||$e();const n=e.frame,r=zr(t,n.scroll.initial),i=_a(r),a={...n,scroll:{initial:n.scroll.initial,current:t,diff:{value:r,displacement:i},max:n.scroll.max}},l=wa({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:a});return{...e,frame:a,subject:l}};function tr(e,t=_m){let n=null;function r(...i){if(n&&n.lastThis===this&&t(i,n.lastArgs))return n.lastResult;const a=e.apply(this,i);return n={lastResult:a,lastArgs:i,lastThis:this},a}return r.clear=function(){n=null},r}const Nm=tr(e=>e.reduce((t,n)=>(t[n.descriptor.id]=n,t),{})),Mm=tr(e=>e.reduce((t,n)=>(t[n.descriptor.id]=n,t),{})),Ql=tr(e=>Object.values(e)),h3=tr(e=>Object.values(e));var Ea=tr((e,t)=>h3(t).filter(r=>e===r.descriptor.droppableId).sort((r,i)=>r.descriptor.index-i.descriptor.index));function Nd(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function ec(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var tc=tr((e,t)=>t.filter(n=>n.descriptor.id!==e.descriptor.id)),f3=({isMovingForward:e,draggable:t,destination:n,insideDestination:r,previousImpact:i})=>{if(!n.isCombineEnabled||!Nd(i))return null;function l(b){const A={type:"COMBINE",combine:{draggableId:b,droppableId:n.descriptor.id}};return{...i,at:A}}const u=i.displaced.all,h=u.length?u[0]:null;if(e)return h?l(h):null;const f=tc(t,r);if(!h){if(!f.length)return null;const b=f[f.length-1];return l(b.descriptor.id)}const p=f.findIndex(b=>b.descriptor.id===h);p===-1&&$e();const g=p-1;if(g<0)return null;const y=f[g];return l(y.descriptor.id)},Na=(e,t)=>e.descriptor.droppableId===t.descriptor.id;const Dm={point:rr,value:0},uo={invisible:{},visible:{},all:[]},p3={displaced:uo,displacedBy:Dm,at:null};var rs=(e,t)=>n=>e<=n&&n<=t,Rm=e=>{const t=rs(e.top,e.bottom),n=rs(e.left,e.right);return r=>{if(t(r.top)&&t(r.bottom)&&n(r.left)&&n(r.right))return!0;const a=t(r.top)||t(r.bottom),l=n(r.left)||n(r.right);if(a&&l)return!0;const h=r.top<e.top&&r.bottom>e.bottom,f=r.left<e.left&&r.right>e.right;return h&&f?!0:h&&l||f&&a}},m3=e=>{const t=rs(e.top,e.bottom),n=rs(e.left,e.right);return r=>t(r.top)&&t(r.bottom)&&n(r.left)&&n(r.right)};const Md={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Om={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var g3=e=>t=>{const n=rs(t.top,t.bottom),r=rs(t.left,t.right);return i=>e===Md?n(i.top)&&n(i.bottom):r(i.left)&&r(i.right)};const y3=(e,t)=>{const n=t.frame?t.frame.scroll.diff.displacement:rr;return To(e,n)},x3=(e,t,n)=>t.subject.active?n(t.subject.active)(e):!1,b3=(e,t,n)=>n(t)(e),Dd=({target:e,destination:t,viewport:n,withDroppableDisplacement:r,isVisibleThroughFrameFn:i})=>{const a=r?y3(e,t):e;return x3(a,t,i)&&b3(a,n,i)},v3=e=>Dd({...e,isVisibleThroughFrameFn:Rm}),Vm=e=>Dd({...e,isVisibleThroughFrameFn:m3}),w3=e=>Dd({...e,isVisibleThroughFrameFn:g3(e.destination.axis)}),S3=(e,t,n)=>{if(typeof n=="boolean")return n;if(!t)return!0;const{invisible:r,visible:i}=t;if(r[e])return!1;const a=i[e];return a?a.shouldAnimate:!0};function k3(e,t){const n=e.page.marginBox,r={top:t.point.y,right:0,bottom:0,left:t.point.x};return $i(Vp(n,r))}function ho({afterDragging:e,destination:t,displacedBy:n,viewport:r,forceShouldAnimate:i,last:a}){return e.reduce(function(u,h){const f=k3(h,n),p=h.descriptor.id;if(u.all.push(p),!v3({target:f,destination:t,viewport:r,withDroppableDisplacement:!0}))return u.invisible[h.descriptor.id]=!0,u;const y=S3(p,a,i),b={draggableId:p,shouldAnimate:y};return u.visible[p]=b,u},{all:[],visible:{},invisible:{}})}function j3(e,t){if(!e.length)return 0;const n=e[e.length-1].descriptor.index;return t.inHomeList?n:n+1}function mf({insideDestination:e,inHomeList:t,displacedBy:n,destination:r}){const i=j3(e,{inHomeList:t});return{displaced:uo,displacedBy:n,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:i}}}}function Ol({draggable:e,insideDestination:t,destination:n,viewport:r,displacedBy:i,last:a,index:l,forceShouldAnimate:u}){const h=Na(e,n);if(l==null)return mf({insideDestination:t,inHomeList:h,displacedBy:i,destination:n});const f=t.find(A=>A.descriptor.index===l);if(!f)return mf({insideDestination:t,inHomeList:h,displacedBy:i,destination:n});const p=tc(e,t),g=t.indexOf(f),y=p.slice(g);return{displaced:ho({afterDragging:y,destination:n,displacedBy:i,last:a,viewport:r.frame,forceShouldAnimate:u}),displacedBy:i,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function yi(e,t){return!!t.effected[e]}var C3=({isMovingForward:e,destination:t,draggables:n,combine:r,afterCritical:i})=>{if(!t.isCombineEnabled)return null;const a=r.draggableId,u=n[a].descriptor.index;return yi(a,i)?e?u:u-1:e?u+1:u},T3=({isMovingForward:e,isInHomeList:t,insideDestination:n,location:r})=>{if(!n.length)return null;const i=r.index,a=e?i+1:i-1,l=n[0].descriptor.index,u=n[n.length-1].descriptor.index,h=t?u:u+1;return a<l||a>h?null:a},I3=({isMovingForward:e,isInHomeList:t,draggable:n,draggables:r,destination:i,insideDestination:a,previousImpact:l,viewport:u,afterCritical:h})=>{const f=l.at;if(f||$e(),f.type==="REORDER"){const g=T3({isMovingForward:e,isInHomeList:t,location:f.destination,insideDestination:a});return g==null?null:Ol({draggable:n,insideDestination:a,destination:i,viewport:u,last:l.displaced,displacedBy:l.displacedBy,index:g})}const p=C3({isMovingForward:e,destination:i,displaced:l.displaced,draggables:r,combine:f.combine,afterCritical:h});return p==null?null:Ol({draggable:n,insideDestination:a,destination:i,viewport:u,last:l.displaced,displacedBy:l.displacedBy,index:p})},A3=({displaced:e,afterCritical:t,combineWith:n,displacedBy:r})=>{const i=!!(e.visible[n]||e.invisible[n]);return yi(n,t)?i?rr:_a(r.point):i?r.point:rr},_3=({afterCritical:e,impact:t,draggables:n})=>{const r=ec(t);r||$e();const i=r.draggableId,a=n[i].page.borderBox.center,l=A3({displaced:t.displaced,afterCritical:e,combineWith:i,displacedBy:t.displacedBy});return lr(a,l)};const zm=(e,t)=>t.margin[e.start]+t.borderBox[e.size]/2,E3=(e,t)=>t.margin[e.end]+t.borderBox[e.size]/2,Rd=(e,t,n)=>t[e.crossAxisStart]+n.margin[e.crossAxisStart]+n.borderBox[e.crossAxisSize]/2,gf=({axis:e,moveRelativeTo:t,isMoving:n})=>zi(e.line,t.marginBox[e.end]+zm(e,n),Rd(e,t.marginBox,n)),yf=({axis:e,moveRelativeTo:t,isMoving:n})=>zi(e.line,t.marginBox[e.start]-E3(e,n),Rd(e,t.marginBox,n)),N3=({axis:e,moveInto:t,isMoving:n})=>zi(e.line,t.contentBox[e.start]+zm(e,n),Rd(e,t.contentBox,n));var M3=({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:i})=>{const a=Ea(r.descriptor.id,n),l=t.page,u=r.axis;if(!a.length)return N3({axis:u,moveInto:r.page,isMoving:l});const{displaced:h,displacedBy:f}=e,p=h.all[0];if(p){const y=n[p];if(yi(p,i))return yf({axis:u,moveRelativeTo:y.page,isMoving:l});const b=Iu(y.page,f.point);return yf({axis:u,moveRelativeTo:b,isMoving:l})}const g=a[a.length-1];if(g.descriptor.id===t.descriptor.id)return l.borderBox.center;if(yi(g.descriptor.id,i)){const y=Iu(g.page,_a(i.displacedBy.point));return gf({axis:u,moveRelativeTo:y,isMoving:l})}return gf({axis:u,moveRelativeTo:g.page,isMoving:l})},Ju=(e,t)=>{const n=e.frame;return n?lr(t,n.scroll.diff.displacement):t};const D3=({impact:e,draggable:t,droppable:n,draggables:r,afterCritical:i})=>{const a=t.page.borderBox.center,l=e.at;return!n||!l?a:l.type==="REORDER"?M3({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:i}):_3({impact:e,draggables:r,afterCritical:i})};var nc=e=>{const t=D3(e),n=e.droppable;return n?Ju(n,t):t},Pm=(e,t)=>{const n=zr(t,e.scroll.initial),r=_a(n);return{frame:$i({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:n,displacement:r}}}};function xf(e,t){return e.map(n=>t[n])}function R3(e,t){for(let n=0;n<t.length;n++){const r=t[n].visible[e];if(r)return r}return null}var O3=({impact:e,viewport:t,destination:n,draggables:r,maxScrollChange:i})=>{const a=Pm(t,lr(t.scroll.current,i)),l=n.frame?Ed(n,lr(n.frame.scroll.current,i)):n,u=e.displaced,h=ho({afterDragging:xf(u.all,r),destination:n,displacedBy:e.displacedBy,viewport:a.frame,last:u,forceShouldAnimate:!1}),f=ho({afterDragging:xf(u.all,r),destination:l,displacedBy:e.displacedBy,viewport:t.frame,last:u,forceShouldAnimate:!1}),p={},g={},y=[u,h,f];return u.all.forEach(A=>{const D=R3(A,y);if(D){g[A]=D;return}p[A]=!0}),{...e,displaced:{all:u.all,invisible:p,visible:g}}},V3=(e,t)=>lr(e.scroll.diff.displacement,t),Od=({pageBorderBoxCenter:e,draggable:t,viewport:n})=>{const r=V3(n,e),i=zr(r,t.page.borderBox.center);return lr(t.client.borderBox.center,i)},Bm=({draggable:e,destination:t,newPageBorderBoxCenter:n,viewport:r,withDroppableDisplacement:i,onlyOnMainAxis:a=!1})=>{const l=zr(n,e.page.borderBox.center),h={target:To(e.page.borderBox,l),destination:t,withDroppableDisplacement:i,viewport:r};return a?w3(h):Vm(h)},z3=({isMovingForward:e,draggable:t,destination:n,draggables:r,previousImpact:i,viewport:a,previousPageBorderBoxCenter:l,previousClientSelection:u,afterCritical:h})=>{if(!n.isEnabled)return null;const f=Ea(n.descriptor.id,r),p=Na(t,n),g=f3({isMovingForward:e,draggable:t,destination:n,insideDestination:f,previousImpact:i})||I3({isMovingForward:e,isInHomeList:p,draggable:t,draggables:r,destination:n,insideDestination:f,previousImpact:i,viewport:a,afterCritical:h});if(!g)return null;const y=nc({impact:g,draggable:t,droppable:n,draggables:r,afterCritical:h});if(Bm({draggable:t,destination:n,newPageBorderBoxCenter:y,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:Od({pageBorderBoxCenter:y,draggable:t,viewport:a}),impact:g,scrollJumpRequest:null};const A=zr(y,l),D=O3({impact:g,viewport:a,destination:n,draggables:r,maxScrollChange:A});return{clientSelection:u,impact:D,scrollJumpRequest:A}};const yr=e=>{const t=e.subject.active;return t||$e(),t};var P3=({isMovingForward:e,pageBorderBoxCenter:t,source:n,droppables:r,viewport:i})=>{const a=n.subject.active;if(!a)return null;const l=n.axis,u=rs(a[l.start],a[l.end]),h=Ql(r).filter(p=>p!==n).filter(p=>p.isEnabled).filter(p=>!!p.subject.active).filter(p=>Rm(i.frame)(yr(p))).filter(p=>{const g=yr(p);return e?a[l.crossAxisEnd]<g[l.crossAxisEnd]:g[l.crossAxisStart]<a[l.crossAxisStart]}).filter(p=>{const g=yr(p),y=rs(g[l.start],g[l.end]);return u(g[l.start])||u(g[l.end])||y(a[l.start])||y(a[l.end])}).sort((p,g)=>{const y=yr(p)[l.crossAxisStart],b=yr(g)[l.crossAxisStart];return e?y-b:b-y}).filter((p,g,y)=>yr(p)[l.crossAxisStart]===yr(y[0])[l.crossAxisStart]);if(!h.length)return null;if(h.length===1)return h[0];const f=h.filter(p=>rs(yr(p)[l.start],yr(p)[l.end])(t[l.line]));return f.length===1?f[0]:f.length>1?f.sort((p,g)=>yr(p)[l.start]-yr(g)[l.start])[0]:h.sort((p,g)=>{const y=ff(t,pf(yr(p))),b=ff(t,pf(yr(g)));return y!==b?y-b:yr(p)[l.start]-yr(g)[l.start]})[0]};const bf=(e,t)=>{const n=e.page.borderBox.center;return yi(e.descriptor.id,t)?zr(n,t.displacedBy.point):n},B3=(e,t)=>{const n=e.page.borderBox;return yi(e.descriptor.id,t)?To(n,_a(t.displacedBy.point)):n};var F3=({pageBorderBoxCenter:e,viewport:t,destination:n,insideDestination:r,afterCritical:i})=>r.filter(l=>Vm({target:B3(l,i),destination:n,viewport:t.frame,withDroppableDisplacement:!0})).sort((l,u)=>{const h=co(e,Ju(n,bf(l,i))),f=co(e,Ju(n,bf(u,i)));return h<f?-1:f<h?1:l.descriptor.index-u.descriptor.index})[0]||null,Io=tr(function(t,n){const r=n[t.line];return{value:r,point:zi(t.line,r)}});const L3=(e,t,n)=>{const r=e.axis;if(e.descriptor.mode==="virtual")return zi(r.line,t[r.line]);const i=e.subject.page.contentBox[r.size],h=Ea(e.descriptor.id,n).reduce((f,p)=>f+p.client.marginBox[r.size],0)+t[r.line]-i;return h<=0?null:zi(r.line,h)},Fm=(e,t)=>({...e,scroll:{...e.scroll,max:t}}),Lm=(e,t,n)=>{const r=e.frame;Na(t,e)&&$e(),e.subject.withPlaceholder&&$e();const i=Io(e.axis,t.displaceBy).point,a=L3(e,i,n),l={placeholderSize:i,increasedBy:a,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!r){const p=wa({page:e.subject.page,withPlaceholder:l,axis:e.axis,frame:e.frame});return{...e,subject:p}}const u=a?lr(r.scroll.max,a):r.scroll.max,h=Fm(r,u),f=wa({page:e.subject.page,withPlaceholder:l,axis:e.axis,frame:h});return{...e,subject:f,frame:h}},$3=e=>{const t=e.subject.withPlaceholder;t||$e();const n=e.frame;if(!n){const l=wa({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:l}}const r=t.oldFrameMaxScroll;r||$e();const i=Fm(n,r),a=wa({page:e.subject.page,axis:e.axis,frame:i,withPlaceholder:null});return{...e,subject:a,frame:i}};var G3=({previousPageBorderBoxCenter:e,moveRelativeTo:t,insideDestination:n,draggable:r,draggables:i,destination:a,viewport:l,afterCritical:u})=>{if(!t){if(n.length)return null;const g={displaced:uo,displacedBy:Dm,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:0}}},y=nc({impact:g,draggable:r,droppable:a,draggables:i,afterCritical:u}),b=Na(r,a)?a:Lm(a,r,i);return Bm({draggable:r,destination:b,newPageBorderBoxCenter:y,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?g:null}const h=e[a.axis.line]<=t.page.borderBox.center[a.axis.line],f=(()=>{const g=t.descriptor.index;return t.descriptor.id===r.descriptor.id||h?g:g+1})(),p=Io(a.axis,r.displaceBy);return Ol({draggable:r,insideDestination:n,destination:a,viewport:l,displacedBy:p,last:uo,index:f})},H3=({isMovingForward:e,previousPageBorderBoxCenter:t,draggable:n,isOver:r,draggables:i,droppables:a,viewport:l,afterCritical:u})=>{const h=P3({isMovingForward:e,pageBorderBoxCenter:t,source:r,droppables:a,viewport:l});if(!h)return null;const f=Ea(h.descriptor.id,i),p=F3({pageBorderBoxCenter:t,viewport:l,destination:h,insideDestination:f,afterCritical:u}),g=G3({previousPageBorderBoxCenter:t,destination:h,draggable:n,draggables:i,moveRelativeTo:p,insideDestination:f,viewport:l,afterCritical:u});if(!g)return null;const y=nc({impact:g,draggable:n,droppable:h,draggables:i,afterCritical:u});return{clientSelection:Od({pageBorderBoxCenter:y,draggable:n,viewport:l}),impact:g,scrollJumpRequest:null}},Pr=e=>{const t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const q3=(e,t)=>{const n=Pr(e);return n?t[n]:null};var U3=({state:e,type:t})=>{const n=q3(e.impact,e.dimensions.droppables),r=!!n,i=e.dimensions.droppables[e.critical.droppable.id],a=n||i,l=a.axis.direction,u=l==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||l==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(u&&!r)return null;const h=t==="MOVE_DOWN"||t==="MOVE_RIGHT",f=e.dimensions.draggables[e.critical.draggable.id],p=e.current.page.borderBoxCenter,{draggables:g,droppables:y}=e.dimensions;return u?z3({isMovingForward:h,previousPageBorderBoxCenter:p,draggable:f,destination:a,draggables:g,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):H3({isMovingForward:h,previousPageBorderBoxCenter:p,draggable:f,isOver:a,draggables:g,droppables:y,viewport:e.viewport,afterCritical:e.afterCritical})};function Ei(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function $m(e){const t=rs(e.top,e.bottom),n=rs(e.left,e.right);return function(i){return t(i.y)&&n(i.x)}}function W3(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function Z3({pageBorderBox:e,draggable:t,candidates:n}){const r=t.page.borderBox.center,i=n.map(a=>{const l=a.axis,u=zi(a.axis.line,e.center[l.line],a.page.borderBox.center[l.crossAxisLine]);return{id:a.descriptor.id,distance:co(r,u)}}).sort((a,l)=>l.distance-a.distance);return i[0]?i[0].id:null}function Y3({pageBorderBox:e,draggable:t,droppables:n}){const r=Ql(n).filter(i=>{if(!i.isEnabled)return!1;const a=i.subject.active;if(!a||!W3(e,a))return!1;if($m(a)(e.center))return!0;const l=i.axis,u=a.center[l.crossAxisLine],h=e[l.crossAxisStart],f=e[l.crossAxisEnd],p=rs(a[l.crossAxisStart],a[l.crossAxisEnd]),g=p(h),y=p(f);return!g&&!y?!0:g?h<u:f>u});return r.length?r.length===1?r[0].descriptor.id:Z3({pageBorderBox:e,draggable:t,candidates:r}):null}const Gm=(e,t)=>$i(To(e,t));var J3=(e,t)=>{const n=e.frame;return n?Gm(t,n.scroll.diff.value):t};function Hm({displaced:e,id:t}){return!!(e.visible[t]||e.invisible[t])}function X3({draggable:e,closest:t,inHomeList:n}){return t?n&&t.descriptor.index>e.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var K3=({pageBorderBoxWithDroppableScroll:e,draggable:t,destination:n,insideDestination:r,last:i,viewport:a,afterCritical:l})=>{const u=n.axis,h=Io(n.axis,t.displaceBy),f=h.value,p=e[u.start],g=e[u.end],b=tc(t,r).find(D=>{const j=D.descriptor.id,w=D.page.borderBox.center[u.line],C=yi(j,l),_=Hm({displaced:i,id:j});return C?_?g<=w:p<w-f:_?g<=w+f:p<w})||null,A=X3({draggable:t,closest:b,inHomeList:Na(t,n)});return Ol({draggable:t,insideDestination:r,destination:n,viewport:a,last:i,displacedBy:h,index:A})};const Q3=4;var e5=({draggable:e,pageBorderBoxWithDroppableScroll:t,previousImpact:n,destination:r,insideDestination:i,afterCritical:a})=>{if(!r.isCombineEnabled)return null;const l=r.axis,u=Io(r.axis,e.displaceBy),h=u.value,f=t[l.start],p=t[l.end],y=tc(e,i).find(A=>{const D=A.descriptor.id,j=A.page.borderBox,C=j[l.size]/Q3,_=yi(D,a),N=Hm({displaced:n.displaced,id:D});return _?N?p>j[l.start]+C&&p<j[l.end]-C:f>j[l.start]-h+C&&f<j[l.end]-h-C:N?p>j[l.start]+h+C&&p<j[l.end]+h-C:f>j[l.start]+C&&f<j[l.end]-C});return y?{displacedBy:u,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:y.descriptor.id,droppableId:r.descriptor.id}}}:null},qm=({pageOffset:e,draggable:t,draggables:n,droppables:r,previousImpact:i,viewport:a,afterCritical:l})=>{const u=Gm(t.page.borderBox,e),h=Y3({pageBorderBox:u,draggable:t,droppables:r});if(!h)return p3;const f=r[h],p=Ea(f.descriptor.id,n),g=J3(f,u);return e5({pageBorderBoxWithDroppableScroll:g,draggable:t,previousImpact:i,destination:f,insideDestination:p,afterCritical:l})||K3({pageBorderBoxWithDroppableScroll:g,draggable:t,destination:f,insideDestination:p,last:i.displaced,viewport:a,afterCritical:l})},Vd=(e,t)=>({...e,[t.descriptor.id]:t});const t5=({previousImpact:e,impact:t,droppables:n})=>{const r=Pr(e),i=Pr(t);if(!r||r===i)return n;const a=n[r];if(!a.subject.withPlaceholder)return n;const l=$3(a);return Vd(n,l)};var n5=({draggable:e,draggables:t,droppables:n,previousImpact:r,impact:i})=>{const a=t5({previousImpact:r,impact:i,droppables:n}),l=Pr(i);if(!l)return a;const u=n[l];if(Na(e,u)||u.subject.withPlaceholder)return a;const h=Lm(u,e,t);return Vd(a,h)},to=({state:e,clientSelection:t,dimensions:n,viewport:r,impact:i,scrollJumpRequest:a})=>{const l=r||e.viewport,u=n||e.dimensions,h=t||e.current.client.selection,f=zr(h,e.initial.client.selection),p={offset:f,selection:h,borderBoxCenter:lr(e.initial.client.borderBoxCenter,f)},g={selection:lr(p.selection,l.scroll.current),borderBoxCenter:lr(p.borderBoxCenter,l.scroll.current),offset:lr(p.offset,l.scroll.diff.value)},y={client:p,page:g};if(e.phase==="COLLECTING")return{...e,dimensions:u,viewport:l,current:y};const b=u.draggables[e.critical.draggable.id],A=i||qm({pageOffset:g.offset,draggable:b,draggables:u.draggables,droppables:u.droppables,previousImpact:e.impact,viewport:l,afterCritical:e.afterCritical}),D=n5({draggable:b,impact:A,previousImpact:e.impact,draggables:u.draggables,droppables:u.droppables});return{...e,current:y,dimensions:{draggables:u.draggables,droppables:D},impact:A,viewport:l,scrollJumpRequest:a||null,forceShouldAnimate:a?!1:null}};function r5(e,t){return e.map(n=>t[n])}var Um=({impact:e,viewport:t,draggables:n,destination:r,forceShouldAnimate:i})=>{const a=e.displaced,l=r5(a.all,n),u=ho({afterDragging:l,destination:r,displacedBy:e.displacedBy,viewport:t.frame,forceShouldAnimate:i,last:a});return{...e,displaced:u}},Wm=({impact:e,draggable:t,droppable:n,draggables:r,viewport:i,afterCritical:a})=>{const l=nc({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:a});return Od({pageBorderBoxCenter:l,draggable:t,viewport:i})},Zm=({state:e,dimensions:t,viewport:n})=>{e.movementMode!=="SNAP"&&$e();const r=e.impact,i=n||e.viewport,a=t||e.dimensions,{draggables:l,droppables:u}=a,h=l[e.critical.draggable.id],f=Pr(r);f||$e();const p=u[f],g=Um({impact:r,viewport:i,destination:p,draggables:l}),y=Wm({impact:g,draggable:h,droppable:p,draggables:l,viewport:i,afterCritical:e.afterCritical});return to({impact:g,clientSelection:y,state:e,dimensions:a,viewport:i})},s5=e=>({index:e.index,droppableId:e.droppableId}),Ym=({draggable:e,home:t,draggables:n,viewport:r})=>{const i=Io(t.axis,e.displaceBy),a=Ea(t.descriptor.id,n),l=a.indexOf(e);l===-1&&$e();const u=a.slice(l+1),h=u.reduce((y,b)=>(y[b.descriptor.id]=!0,y),{}),f={inVirtualList:t.descriptor.mode==="virtual",displacedBy:i,effected:h};return{impact:{displaced:ho({afterDragging:u,destination:t,displacedBy:i,last:null,viewport:r.frame,forceShouldAnimate:!1}),displacedBy:i,at:{type:"REORDER",destination:s5(e.descriptor)}},afterCritical:f}},i5=(e,t)=>({draggables:e.draggables,droppables:Vd(e.droppables,t)}),a5=({draggable:e,offset:t,initialWindowScroll:n})=>{const r=Iu(e.client,t),i=wl(r,n);return{...e,placeholder:{...e.placeholder,client:r},client:r,page:i}},o5=e=>{const t=e.frame;return t||$e(),t},l5=({additions:e,updatedDroppables:t,viewport:n})=>{const r=n.scroll.diff.value;return e.map(i=>{const a=i.descriptor.droppableId,l=t[a],h=o5(l).scroll.diff.value,f=lr(r,h);return a5({draggable:i,offset:f,initialWindowScroll:n.scroll.initial})})},c5=({state:e,published:t})=>{const n=t.modified.map(w=>{const C=e.dimensions.droppables[w.droppableId];return Ed(C,w.scroll)}),r={...e.dimensions.droppables,...Nm(n)},i=Mm(l5({additions:t.additions,updatedDroppables:r,viewport:e.viewport})),a={...e.dimensions.draggables,...i};t.removals.forEach(w=>{delete a[w]});const l={droppables:r,draggables:a},u=Pr(e.impact),h=u?l.droppables[u]:null,f=l.draggables[e.critical.draggable.id],p=l.droppables[e.critical.droppable.id],{impact:g,afterCritical:y}=Ym({draggable:f,home:p,draggables:a,viewport:e.viewport}),b=h&&h.isCombineEnabled?e.impact:g,A=qm({pageOffset:e.current.page.offset,draggable:l.draggables[e.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:b,viewport:e.viewport,afterCritical:y}),D={...e,phase:"DRAGGING",impact:A,onLiftImpact:g,dimensions:l,afterCritical:y,forceShouldAnimate:!1};return e.phase==="COLLECTING"?D:{...D,phase:"DROP_PENDING",reason:e.reason,isWaiting:!1}};const Xu=e=>e.movementMode==="SNAP",su=(e,t,n)=>{const r=i5(e.dimensions,t);return!Xu(e)||n?to({state:e,dimensions:r}):Zm({state:e,dimensions:r})};function iu(e){return e.isDragging&&e.movementMode==="SNAP"?{...e,scrollJumpRequest:null}:e}const vf={phase:"IDLE",completed:null,shouldFlush:!1};var u5=(e=vf,t)=>{if(t.type==="FLUSH")return{...vf,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&$e();const{critical:n,clientSelection:r,viewport:i,dimensions:a,movementMode:l}=t.payload,u=a.draggables[n.draggable.id],h=a.droppables[n.droppable.id],f={selection:r,borderBoxCenter:u.client.borderBox.center,offset:rr},p={client:f,page:{selection:lr(f.selection,i.scroll.initial),borderBoxCenter:lr(f.selection,i.scroll.initial),offset:lr(f.selection,i.scroll.diff.value)}},g=Ql(a.droppables).every(D=>!D.isFixedOnPage),{impact:y,afterCritical:b}=Ym({draggable:u,home:h,draggables:a.draggables,viewport:i});return{phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:a,initial:p,current:p,isWindowScrollAllowed:g,impact:y,afterCritical:b,onLiftImpact:y,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"?e:(e.phase!=="DRAGGING"&&$e(),{...e,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||$e(),c5({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;Ei(e)||$e();const{client:n}=t.payload;return mi(n,e.current.client.selection)?e:to({state:e,clientSelection:n,impact:Xu(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return iu(e);Ei(e)||$e();const{id:n,newScroll:r}=t.payload,i=e.dimensions.droppables[n];if(!i)return e;const a=Ed(i,r);return su(e,a,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;Ei(e)||$e();const{id:n,isEnabled:r}=t.payload,i=e.dimensions.droppables[n];i||$e(),i.isEnabled===r&&$e();const a={...i,isEnabled:r};return su(e,a,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;Ei(e)||$e();const{id:n,isCombineEnabled:r}=t.payload,i=e.dimensions.droppables[n];i||$e(),i.isCombineEnabled===r&&$e();const a={...i,isCombineEnabled:r};return su(e,a,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;Ei(e)||$e(),e.isWindowScrollAllowed||$e();const n=t.payload.newScroll;if(mi(e.viewport.scroll.current,n))return iu(e);const r=Pm(e.viewport,n);return Xu(e)?Zm({state:e,viewport:r}):to({state:e,viewport:r})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!Ei(e))return e;const n=t.payload.maxScroll;if(mi(n,e.viewport.scroll.max))return e;const r={...e.viewport,scroll:{...e.viewport.scroll,max:n}};return{...e,viewport:r}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&$e();const n=U3({state:e,type:t.type});return n?to({state:e,impact:n.impact,clientSelection:n.clientSelection,scrollJumpRequest:n.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){const n=t.payload.reason;return e.phase!=="COLLECTING"&&$e(),{...e,phase:"DROP_PENDING",isWaiting:!0,reason:n}}if(t.type==="DROP_ANIMATE"){const{completed:n,dropDuration:r,newHomeClientOffset:i}=t.payload;return e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||$e(),{phase:"DROP_ANIMATING",completed:n,dropDuration:r,newHomeClientOffset:i,dimensions:e.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:n}=t.payload;return{phase:"IDLE",completed:n,shouldFlush:!1}}return e};function Qt(e,t){return e instanceof Object&&"type"in e&&e.type===t}const d5=e=>({type:"BEFORE_INITIAL_CAPTURE",payload:e}),h5=e=>({type:"LIFT",payload:e}),f5=e=>({type:"INITIAL_PUBLISH",payload:e}),p5=e=>({type:"PUBLISH_WHILE_DRAGGING",payload:e}),m5=()=>({type:"COLLECTION_STARTING",payload:null}),g5=e=>({type:"UPDATE_DROPPABLE_SCROLL",payload:e}),y5=e=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}),x5=e=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}),Jm=e=>({type:"MOVE",payload:e}),b5=e=>({type:"MOVE_BY_WINDOW_SCROLL",payload:e}),v5=e=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}),w5=()=>({type:"MOVE_UP",payload:null}),S5=()=>({type:"MOVE_DOWN",payload:null}),k5=()=>({type:"MOVE_RIGHT",payload:null}),j5=()=>({type:"MOVE_LEFT",payload:null}),zd=()=>({type:"FLUSH",payload:null}),C5=e=>({type:"DROP_ANIMATE",payload:e}),Pd=e=>({type:"DROP_COMPLETE",payload:e}),Xm=e=>({type:"DROP",payload:e}),T5=e=>({type:"DROP_PENDING",payload:e}),Km=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var I5=e=>({getState:t,dispatch:n})=>r=>i=>{if(!Qt(i,"LIFT")){r(i);return}const{id:a,clientSelection:l,movementMode:u}=i.payload,h=t();h.phase==="DROP_ANIMATING"&&n(Pd({completed:h.completed})),t().phase!=="IDLE"&&$e(),n(zd()),n(d5({draggableId:a,movementMode:u}));const p={draggableId:a,scrollOptions:{shouldPublishImmediately:u==="SNAP"}},{critical:g,dimensions:y,viewport:b}=e.startPublishing(p);n(f5({critical:g,dimensions:y,clientSelection:l,movementMode:u,viewport:b}))},A5=e=>()=>t=>n=>{Qt(n,"INITIAL_PUBLISH")&&e.dragging(),Qt(n,"DROP_ANIMATE")&&e.dropping(n.payload.completed.result.reason),(Qt(n,"FLUSH")||Qt(n,"DROP_COMPLETE"))&&e.resting(),t(n)};const Bd={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},fo={opacity:{drop:0,combining:.7},scale:{drop:.75}},Qm={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},_i=`${Qm.outOfTheWay}s ${Bd.outOfTheWay}`,no={fluid:`opacity ${_i}`,snap:`transform ${_i}, opacity ${_i}`,drop:e=>{const t=`${e}s ${Bd.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${_i}`,placeholder:`height ${_i}, width ${_i}, margin ${_i}`},wf=e=>mi(e,rr)?void 0:`translate(${e.x}px, ${e.y}px)`,Ku={moveTo:wf,drop:(e,t)=>{const n=wf(e);if(n)return t?`${n} scale(${fo.scale.drop})`:n}},{minDropTime:Qu,maxDropTime:eg}=Qm,_5=eg-Qu,Sf=1500,E5=.6;var N5=({current:e,destination:t,reason:n})=>{const r=co(e,t);if(r<=0)return Qu;if(r>=Sf)return eg;const i=r/Sf,a=Qu+_5*i,l=n==="CANCEL"?a*E5:a;return Number(l.toFixed(2))},M5=({impact:e,draggable:t,dimensions:n,viewport:r,afterCritical:i})=>{const{draggables:a,droppables:l}=n,u=Pr(e),h=u?l[u]:null,f=l[t.descriptor.droppableId],p=Wm({impact:e,draggable:t,draggables:a,afterCritical:i,droppable:h||f,viewport:r});return zr(p,t.client.borderBox.center)},D5=({draggables:e,reason:t,lastImpact:n,home:r,viewport:i,onLiftImpact:a})=>!n.at||t!=="DROP"?{impact:Um({draggables:e,impact:a,destination:r,viewport:i,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:n.at.type==="REORDER"?{impact:n,didDropInsideDroppable:!0}:{impact:{...n,displaced:uo},didDropInsideDroppable:!0};const R5=({getState:e,dispatch:t})=>n=>r=>{if(!Qt(r,"DROP")){n(r);return}const i=e(),a=r.payload.reason;if(i.phase==="COLLECTING"){t(T5({reason:a}));return}if(i.phase==="IDLE")return;i.phase==="DROP_PENDING"&&i.isWaiting&&$e(),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||$e();const u=i.critical,h=i.dimensions,f=h.draggables[i.critical.draggable.id],{impact:p,didDropInsideDroppable:g}=D5({reason:a,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),y=g?Nd(p):null,b=g?ec(p):null,A={index:u.draggable.index,droppableId:u.droppable.id},D={draggableId:f.descriptor.id,type:f.descriptor.type,source:A,reason:a,mode:i.movementMode,destination:y,combine:b},j=M5({impact:p,draggable:f,dimensions:h,viewport:i.viewport,afterCritical:i.afterCritical}),w={critical:i.critical,afterCritical:i.afterCritical,result:D,impact:p};if(!(!mi(i.current.client.offset,j)||!!D.combine)){t(Pd({completed:w}));return}const _=N5({current:i.current.client.offset,destination:j,reason:a});t(C5({newHomeClientOffset:j,dropDuration:_,completed:w}))};var tg=()=>({x:window.pageXOffset,y:window.pageYOffset});function O5(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||e()}}}function V5({onWindowScroll:e}){function t(){e(tg())}const n=lo(t),r=O5(n);let i=pi;function a(){return i!==pi}function l(){a()&&$e(),i=ns(window,[r])}function u(){a()||$e(),n.cancel(),i(),i=pi}return{start:l,stop:u,isActive:a}}const z5=e=>Qt(e,"DROP_COMPLETE")||Qt(e,"DROP_ANIMATE")||Qt(e,"FLUSH"),P5=e=>{const t=V5({onWindowScroll:n=>{e.dispatch(b5({newScroll:n}))}});return n=>r=>{!t.isActive()&&Qt(r,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&z5(r)&&t.stop(),n(r)}};var B5=e=>{let t=!1,n=!1;const r=setTimeout(()=>{n=!0}),i=a=>{t||n||(t=!0,e(a),clearTimeout(r))};return i.wasCalled=()=>t,i},F5=()=>{const e=[],t=i=>{const a=e.findIndex(u=>u.timerId===i);a===-1&&$e();const[l]=e.splice(a,1);l.callback()};return{add:i=>{const a=setTimeout(()=>t(a)),l={timerId:a,callback:i};e.push(l)},flush:()=>{if(!e.length)return;const i=[...e];e.length=0,i.forEach(a=>{clearTimeout(a.timerId),a.callback()})}}};const L5=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.droppableId===t.droppableId&&e.index===t.index,$5=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.draggableId===t.draggableId&&e.droppableId===t.droppableId,G5=(e,t)=>{if(e===t)return!0;const n=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,r=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return n&&r},Ha=(e,t)=>{t()},Ko=(e,t)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t});function au(e,t,n,r){if(!e){n(r(t));return}const i=B5(n);e(t,{announce:i}),i.wasCalled()||n(r(t))}var H5=(e,t)=>{const n=F5();let r=null;const i=(g,y)=>{r&&$e(),Ha("onBeforeCapture",()=>{const b=e().onBeforeCapture;b&&b({draggableId:g,mode:y})})},a=(g,y)=>{r&&$e(),Ha("onBeforeDragStart",()=>{const b=e().onBeforeDragStart;b&&b(Ko(g,y))})},l=(g,y)=>{r&&$e();const b=Ko(g,y);r={mode:y,lastCritical:g,lastLocation:b.source,lastCombine:null},n.add(()=>{Ha("onDragStart",()=>au(e().onDragStart,b,t,ul.onDragStart))})},u=(g,y)=>{const b=Nd(y),A=ec(y);r||$e();const D=!G5(g,r.lastCritical);D&&(r.lastCritical=g);const j=!L5(r.lastLocation,b);j&&(r.lastLocation=b);const w=!$5(r.lastCombine,A);if(w&&(r.lastCombine=A),!D&&!j&&!w)return;const C={...Ko(g,r.mode),combine:A,destination:b};n.add(()=>{Ha("onDragUpdate",()=>au(e().onDragUpdate,C,t,ul.onDragUpdate))})},h=()=>{r||$e(),n.flush()},f=g=>{r||$e(),r=null,Ha("onDragEnd",()=>au(e().onDragEnd,g,t,ul.onDragEnd))};return{beforeCapture:i,beforeStart:a,start:l,update:u,flush:h,drop:f,abort:()=>{if(!r)return;const g={...Ko(r.lastCritical,r.mode),combine:null,destination:null,reason:"CANCEL"};f(g)}}},q5=(e,t)=>{const n=H5(e,t);return r=>i=>a=>{if(Qt(a,"BEFORE_INITIAL_CAPTURE")){n.beforeCapture(a.payload.draggableId,a.payload.movementMode);return}if(Qt(a,"INITIAL_PUBLISH")){const u=a.payload.critical;n.beforeStart(u,a.payload.movementMode),i(a),n.start(u,a.payload.movementMode);return}if(Qt(a,"DROP_COMPLETE")){const u=a.payload.completed.result;n.flush(),i(a),n.drop(u);return}if(i(a),Qt(a,"FLUSH")){n.abort();return}const l=r.getState();l.phase==="DRAGGING"&&n.update(l.critical,l.impact)}};const U5=e=>t=>n=>{if(!Qt(n,"DROP_ANIMATION_FINISHED")){t(n);return}const r=e.getState();r.phase!=="DROP_ANIMATING"&&$e(),e.dispatch(Pd({completed:r.completed}))},W5=e=>{let t=null,n=null;function r(){n&&(cancelAnimationFrame(n),n=null),t&&(t(),t=null)}return i=>a=>{if((Qt(a,"FLUSH")||Qt(a,"DROP_COMPLETE")||Qt(a,"DROP_ANIMATION_FINISHED"))&&r(),i(a),!Qt(a,"DROP_ANIMATE"))return;const l={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){e.getState().phase==="DROP_ANIMATING"&&e.dispatch(Km())}};n=requestAnimationFrame(()=>{n=null,t=ns(window,[l])})}};var Z5=e=>()=>t=>n=>{(Qt(n,"DROP_COMPLETE")||Qt(n,"FLUSH")||Qt(n,"DROP_ANIMATE"))&&e.stopPublishing(),t(n)},Y5=e=>{let t=!1;return()=>n=>r=>{if(Qt(r,"INITIAL_PUBLISH")){t=!0,e.tryRecordFocus(r.payload.critical.draggable.id),n(r),e.tryRestoreFocusRecorded();return}if(n(r),!!t){if(Qt(r,"FLUSH")){t=!1,e.tryRestoreFocusRecorded();return}if(Qt(r,"DROP_COMPLETE")){t=!1;const i=r.payload.completed.result;i.combine&&e.tryShiftRecord(i.draggableId,i.combine.draggableId),e.tryRestoreFocusRecorded()}}}};const J5=e=>Qt(e,"DROP_COMPLETE")||Qt(e,"DROP_ANIMATE")||Qt(e,"FLUSH");var X5=e=>t=>n=>r=>{if(J5(r)){e.stop(),n(r);return}if(Qt(r,"INITIAL_PUBLISH")){n(r);const i=t.getState();i.phase!=="DRAGGING"&&$e(),e.start(i);return}n(r),e.scroll(t.getState())};const K5=e=>t=>n=>{if(t(n),!Qt(n,"PUBLISH_WHILE_DRAGGING"))return;const r=e.getState();r.phase==="DROP_PENDING"&&(r.isWaiting||e.dispatch(Xm({reason:r.reason})))},Q5=bm;var e6=({dimensionMarshal:e,focusMarshal:t,styleMarshal:n,getResponders:r,announce:i,autoScroller:a})=>xm(u5,Q5(Xb(A5(n),Z5(e),I5(e),R5,U5,W5,K5,X5(a),P5,Y5(t),q5(r,i))));const ou=()=>({additions:{},removals:{},modified:{}});function t6({registry:e,callbacks:t}){let n=ou(),r=null;const i=()=>{r||(t.collectionStarting(),r=requestAnimationFrame(()=>{r=null;const{additions:h,removals:f,modified:p}=n,g=Object.keys(h).map(A=>e.draggable.getById(A).getDimension(rr)).sort((A,D)=>A.descriptor.index-D.descriptor.index),y=Object.keys(p).map(A=>{const j=e.droppable.getById(A).callbacks.getScrollWhileDragging();return{droppableId:A,scroll:j}}),b={additions:g,removals:Object.keys(f),modified:y};n=ou(),t.publish(b)}))};return{add:h=>{const f=h.descriptor.id;n.additions[f]=h,n.modified[h.descriptor.droppableId]=!0,n.removals[f]&&delete n.removals[f],i()},remove:h=>{const f=h.descriptor;n.removals[f.id]=!0,n.modified[f.droppableId]=!0,n.additions[f.id]&&delete n.additions[f.id],i()},stop:()=>{r&&(cancelAnimationFrame(r),r=null,n=ou())}}}var ng=({scrollHeight:e,scrollWidth:t,height:n,width:r})=>{const i=zr({x:t,y:e},{x:r,y:n});return{x:Math.max(0,i.x),y:Math.max(0,i.y)}},rg=()=>{const e=document.documentElement;return e||$e(),e},sg=()=>{const e=rg();return ng({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},n6=()=>{const e=tg(),t=sg(),n=e.y,r=e.x,i=rg(),a=i.clientWidth,l=i.clientHeight,u=r+a,h=n+l;return{frame:$i({top:n,left:r,right:u,bottom:h}),scroll:{initial:e,current:e,max:t,diff:{value:rr,displacement:rr}}}},r6=({critical:e,scrollOptions:t,registry:n})=>{const r=n6(),i=r.scroll.current,a=e.droppable,l=n.droppable.getAllByType(a.type).map(p=>p.callbacks.getDimensionAndWatchScroll(i,t)),u=n.draggable.getAllByType(e.draggable.type).map(p=>p.getDimension(i));return{dimensions:{draggables:Mm(u),droppables:Nm(l)},critical:e,viewport:r}};function kf(e,t,n){return!(n.descriptor.id===t.id||n.descriptor.type!==t.type||e.droppable.getById(n.descriptor.droppableId).descriptor.mode!=="virtual")}var s6=(e,t)=>{let n=null;const r=t6({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),i=(y,b)=>{e.droppable.exists(y)||$e(),n&&t.updateDroppableIsEnabled({id:y,isEnabled:b})},a=(y,b)=>{n&&(e.droppable.exists(y)||$e(),t.updateDroppableIsCombineEnabled({id:y,isCombineEnabled:b}))},l=(y,b)=>{n&&(e.droppable.exists(y)||$e(),t.updateDroppableScroll({id:y,newScroll:b}))},u=(y,b)=>{n&&e.droppable.getById(y).callbacks.scroll(b)},h=()=>{if(!n)return;r.stop();const y=n.critical.droppable;e.droppable.getAllByType(y.type).forEach(b=>b.callbacks.dragStopped()),n.unsubscribe(),n=null},f=y=>{n||$e();const b=n.critical.draggable;y.type==="ADDITION"&&kf(e,b,y.value)&&r.add(y.value),y.type==="REMOVAL"&&kf(e,b,y.value)&&r.remove(y.value)};return{updateDroppableIsEnabled:i,updateDroppableIsCombineEnabled:a,scrollDroppable:u,updateDroppableScroll:l,startPublishing:y=>{n&&$e();const b=e.draggable.getById(y.draggableId),A=e.droppable.getById(b.descriptor.droppableId),D={draggable:b.descriptor,droppable:A.descriptor},j=e.subscribe(f);return n={critical:D,unsubscribe:j},r6({critical:D,registry:e,scrollOptions:y.scrollOptions})},stopPublishing:h}},ig=(e,t)=>e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP",i6=e=>{window.scrollBy(e.x,e.y)};const a6=tr(e=>Ql(e).filter(t=>!(!t.isEnabled||!t.frame))),o6=(e,t)=>a6(t).find(r=>(r.frame||$e(),$m(r.frame.pageMarginBox)(e)))||null;var l6=({center:e,destination:t,droppables:n})=>{if(t){const i=n[t];return i.frame?i:null}return o6(e,n)};const po={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var c6=(e,t,n=()=>po)=>{const r=n(),i=e[t.size]*r.startFromPercentage,a=e[t.size]*r.maxScrollAtPercentage;return{startScrollingFrom:i,maxScrollValueAt:a}},ag=({startOfRange:e,endOfRange:t,current:n})=>{const r=t-e;return r===0?0:(n-e)/r},Fd=1,u6=(e,t,n=()=>po)=>{const r=n();if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return r.maxPixelScroll;if(e===t.startScrollingFrom)return Fd;const a=1-ag({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),l=r.maxPixelScroll*r.ease(a);return Math.ceil(l)},d6=(e,t,n)=>{const r=n(),i=r.durationDampening.accelerateAt,a=r.durationDampening.stopDampeningAt,l=t,u=a,f=Date.now()-l;if(f>=a)return e;if(f<i)return Fd;const p=ag({startOfRange:i,endOfRange:u,current:f}),g=e*r.ease(p);return Math.ceil(g)},jf=({distanceToEdge:e,thresholds:t,dragStartTime:n,shouldUseTimeDampening:r,getAutoScrollerOptions:i})=>{const a=u6(e,t,i);return a===0?0:r?Math.max(d6(a,n,i),Fd):a},Cf=({container:e,distanceToEdges:t,dragStartTime:n,axis:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const l=c6(e,r,a);return t[r.end]<t[r.start]?jf({distanceToEdge:t[r.end],thresholds:l,dragStartTime:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a}):-1*jf({distanceToEdge:t[r.start],thresholds:l,dragStartTime:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a})},h6=({container:e,subject:t,proposedScroll:n})=>{const r=t.height>e.height,i=t.width>e.width;return!i&&!r?n:i&&r?null:{x:i?0:n.x,y:r?0:n.y}};const f6=Em(e=>e===0?0:e);var og=({dragStartTime:e,container:t,subject:n,center:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const l={top:r.y-t.top,right:t.right-r.x,bottom:t.bottom-r.y,left:r.x-t.left},u=Cf({container:t,distanceToEdges:l,dragStartTime:e,axis:Md,shouldUseTimeDampening:i,getAutoScrollerOptions:a}),h=Cf({container:t,distanceToEdges:l,dragStartTime:e,axis:Om,shouldUseTimeDampening:i,getAutoScrollerOptions:a}),f=f6({x:h,y:u});if(mi(f,rr))return null;const p=h6({container:t,subject:n,proposedScroll:f});return p?mi(p,rr)?null:p:null};const p6=Em(e=>e===0?0:e>0?1:-1),Ld=(()=>{const e=(t,n)=>t<0?t:t>n?t-n:0;return({current:t,max:n,change:r})=>{const i=lr(t,r),a={x:e(i.x,n.x),y:e(i.y,n.y)};return mi(a,rr)?null:a}})(),lg=({max:e,current:t,change:n})=>{const r={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},i=p6(n),a=Ld({max:r,current:t,change:i});return!a||i.x!==0&&a.x===0||i.y!==0&&a.y===0},$d=(e,t)=>lg({current:e.scroll.current,max:e.scroll.max,change:t}),m6=(e,t)=>{if(!$d(e,t))return null;const n=e.scroll.max,r=e.scroll.current;return Ld({current:r,max:n,change:t})},Gd=(e,t)=>{const n=e.frame;return n?lg({current:n.scroll.current,max:n.scroll.max,change:t}):!1},g6=(e,t)=>{const n=e.frame;return!n||!Gd(e,t)?null:Ld({current:n.scroll.current,max:n.scroll.max,change:t})};var y6=({viewport:e,subject:t,center:n,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const l=og({dragStartTime:r,container:e.frame,subject:t,center:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a});return l&&$d(e,l)?l:null},x6=({droppable:e,subject:t,center:n,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const l=e.frame;if(!l)return null;const u=og({dragStartTime:r,container:l.pageMarginBox,subject:t,center:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a});return u&&Gd(e,u)?u:null},Tf=({state:e,dragStartTime:t,shouldUseTimeDampening:n,scrollWindow:r,scrollDroppable:i,getAutoScrollerOptions:a})=>{const l=e.current.page.borderBoxCenter,h=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){const g=e.viewport,y=y6({dragStartTime:t,viewport:g,subject:h,center:l,shouldUseTimeDampening:n,getAutoScrollerOptions:a});if(y){r(y);return}}const f=l6({center:l,destination:Pr(e.impact),droppables:e.dimensions.droppables});if(!f)return;const p=x6({dragStartTime:t,droppable:f,subject:h,center:l,shouldUseTimeDampening:n,getAutoScrollerOptions:a});p&&i(f.descriptor.id,p)},b6=({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:n=()=>po})=>{const r=lo(e),i=lo(t);let a=null;const l=f=>{a||$e();const{shouldUseTimeDampening:p,dragStartTime:g}=a;Tf({state:f,scrollWindow:r,scrollDroppable:i,dragStartTime:g,shouldUseTimeDampening:p,getAutoScrollerOptions:n})};return{start:f=>{a&&$e();const p=Date.now();let g=!1;const y=()=>{g=!0};Tf({state:f,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:y,scrollDroppable:y,getAutoScrollerOptions:n}),a={dragStartTime:p,shouldUseTimeDampening:g},g&&l(f)},stop:()=>{a&&(r.cancel(),i.cancel(),a=null)},scroll:l}},v6=({move:e,scrollDroppable:t,scrollWindow:n})=>{const r=(u,h)=>{const f=lr(u.current.client.selection,h);e({client:f})},i=(u,h)=>{if(!Gd(u,h))return h;const f=g6(u,h);if(!f)return t(u.descriptor.id,h),null;const p=zr(h,f);return t(u.descriptor.id,p),zr(h,p)},a=(u,h,f)=>{if(!u||!$d(h,f))return f;const p=m6(h,f);if(!p)return n(f),null;const g=zr(f,p);return n(g),zr(f,g)};return u=>{const h=u.scrollJumpRequest;if(!h)return;const f=Pr(u.impact);f||$e();const p=i(u.dimensions.droppables[f],h);if(!p)return;const g=u.viewport,y=a(u.isWindowScrollAllowed,g,p);y&&r(u,y)}},w6=({scrollDroppable:e,scrollWindow:t,move:n,getAutoScrollerOptions:r})=>{const i=b6({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:r}),a=v6({move:n,scrollWindow:t,scrollDroppable:e});return{scroll:h=>{if(!(r().disabled||h.phase!=="DRAGGING")){if(h.movementMode==="FLUID"){i.scroll(h);return}h.scrollJumpRequest&&a(h)}},start:i.start,stop:i.stop}};const Sa="data-rfd",ka=(()=>{const e=`${Sa}-drag-handle`;return{base:e,draggableId:`${e}-draggable-id`,contextId:`${e}-context-id`}})(),ed=(()=>{const e=`${Sa}-draggable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),S6=(()=>{const e=`${Sa}-droppable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),If={contextId:`${Sa}-scroll-container-context-id`},k6=e=>t=>`[${t}="${e}"]`,qa=(e,t)=>e.map(n=>{const r=n.styles[t];return r?`${n.selector} { ${r} }`:""}).join(" "),j6="pointer-events: none;";var C6=e=>{const t=k6(e),n=(()=>{const u=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(ka.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:u,dragging:j6,dropAnimating:u}}})(),r=(()=>{const u=`
      transition: ${no.outOfTheWay};
    `;return{selector:t(ed.contextId),styles:{dragging:u,dropAnimating:u,userCancel:u}}})(),i={selector:t(S6.contextId),styles:{always:"overflow-anchor: none;"}},l=[r,n,i,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:qa(l,"always"),resting:qa(l,"resting"),dragging:qa(l,"dragging"),dropAnimating:qa(l,"dropAnimating"),userCancel:qa(l,"userCancel")}};const Br=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?z.useLayoutEffect:z.useEffect,lu=()=>{const e=document.querySelector("head");return e||$e(),e},Af=e=>{const t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};function T6(e,t){const n=Gt(()=>C6(e),[e]),r=z.useRef(null),i=z.useRef(null),a=dt(tr(g=>{const y=i.current;y||$e(),y.textContent=g}),[]),l=dt(g=>{const y=r.current;y||$e(),y.textContent=g},[]);Br(()=>{!r.current&&!i.current||$e();const g=Af(t),y=Af(t);return r.current=g,i.current=y,g.setAttribute(`${Sa}-always`,e),y.setAttribute(`${Sa}-dynamic`,e),lu().appendChild(g),lu().appendChild(y),l(n.always),a(n.resting),()=>{const b=A=>{const D=A.current;D||$e(),lu().removeChild(D),A.current=null};b(r),b(i)}},[t,l,a,n.always,n.resting,e]);const u=dt(()=>a(n.dragging),[a,n.dragging]),h=dt(g=>{if(g==="DROP"){a(n.dropAnimating);return}a(n.userCancel)},[a,n.dropAnimating,n.userCancel]),f=dt(()=>{i.current&&a(n.resting)},[a,n.resting]);return Gt(()=>({dragging:u,dropping:h,resting:f}),[u,h,f])}function cg(e,t){return Array.from(e.querySelectorAll(t))}var ug=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function rc(e){return e instanceof ug(e).HTMLElement}function I6(e,t){const n=`[${ka.contextId}="${e}"]`,r=cg(document,n);if(!r.length)return null;const i=r.find(a=>a.getAttribute(ka.draggableId)===t);return!i||!rc(i)?null:i}function A6(e){const t=z.useRef({}),n=z.useRef(null),r=z.useRef(null),i=z.useRef(!1),a=dt(function(y,b){const A={id:y,focus:b};return t.current[y]=A,function(){const j=t.current;j[y]!==A&&delete j[y]}},[]),l=dt(function(y){const b=I6(e,y);b&&b!==document.activeElement&&b.focus()},[e]),u=dt(function(y,b){n.current===y&&(n.current=b)},[]),h=dt(function(){r.current||i.current&&(r.current=requestAnimationFrame(()=>{r.current=null;const y=n.current;y&&l(y)}))},[l]),f=dt(function(y){n.current=null;const b=document.activeElement;b&&b.getAttribute(ka.draggableId)===y&&(n.current=y)},[]);return Br(()=>(i.current=!0,function(){i.current=!1;const y=r.current;y&&cancelAnimationFrame(y)}),[]),Gt(()=>({register:a,tryRecordFocus:f,tryRestoreFocusRecorded:h,tryShiftRecord:u}),[a,f,h,u])}function _6(){const e={draggables:{},droppables:{}},t=[];function n(g){return t.push(g),function(){const b=t.indexOf(g);b!==-1&&t.splice(b,1)}}function r(g){t.length&&t.forEach(y=>y(g))}function i(g){return e.draggables[g]||null}function a(g){const y=i(g);return y||$e(),y}const l={register:g=>{e.draggables[g.descriptor.id]=g,r({type:"ADDITION",value:g})},update:(g,y)=>{const b=e.draggables[y.descriptor.id];b&&b.uniqueId===g.uniqueId&&(delete e.draggables[y.descriptor.id],e.draggables[g.descriptor.id]=g)},unregister:g=>{const y=g.descriptor.id,b=i(y);b&&g.uniqueId===b.uniqueId&&(delete e.draggables[y],e.droppables[g.descriptor.droppableId]&&r({type:"REMOVAL",value:g}))},getById:a,findById:i,exists:g=>!!i(g),getAllByType:g=>Object.values(e.draggables).filter(y=>y.descriptor.type===g)};function u(g){return e.droppables[g]||null}function h(g){const y=u(g);return y||$e(),y}const f={register:g=>{e.droppables[g.descriptor.id]=g},unregister:g=>{const y=u(g.descriptor.id);y&&g.uniqueId===y.uniqueId&&delete e.droppables[g.descriptor.id]},getById:h,findById:u,exists:g=>!!u(g),getAllByType:g=>Object.values(e.droppables).filter(y=>y.descriptor.type===g)};function p(){e.draggables={},e.droppables={},t.length=0}return{draggable:l,droppable:f,subscribe:n,clean:p}}function E6(){const e=Gt(_6,[]);return z.useEffect(()=>function(){e.clean()},[e]),e}var Hd=kt.createContext(null),Vl=()=>{const e=document.body;return e||$e(),e};const N6={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},M6=e=>`rfd-announcement-${e}`;function D6(e){const t=Gt(()=>M6(e),[e]),n=z.useRef(null);return z.useEffect(function(){const a=document.createElement("div");return n.current=a,a.id=t,a.setAttribute("aria-live","assertive"),a.setAttribute("aria-atomic","true"),vd(a.style,N6),Vl().appendChild(a),function(){setTimeout(function(){const h=Vl();h.contains(a)&&h.removeChild(a),a===n.current&&(n.current=null)})}},[t]),dt(i=>{const a=n.current;if(a){a.textContent=i;return}},[])}const R6={separator:"::"};function qd(e,t=R6){const n=kt.useId();return Gt(()=>`${e}${t.separator}${n}`,[t.separator,e,n])}function O6({contextId:e,uniqueId:t}){return`rfd-hidden-text-${e}-${t}`}function V6({contextId:e,text:t}){const n=qd("hidden-text",{separator:"-"}),r=Gt(()=>O6({contextId:e,uniqueId:n}),[n,e]);return z.useEffect(function(){const a=document.createElement("div");return a.id=r,a.textContent=t,a.style.display="none",Vl().appendChild(a),function(){const u=Vl();u.contains(a)&&u.removeChild(a)}},[r,t]),r}var sc=kt.createContext(null);function dg(e){const t=z.useRef(e);return z.useEffect(()=>{t.current=e}),t}function z6(){let e=null;function t(){return!!e}function n(l){return l===e}function r(l){e&&$e();const u={abandon:l};return e=u,u}function i(){e||$e(),e=null}function a(){e&&(e.abandon(),i())}return{isClaimed:t,isActive:n,claim:r,release:i,tryAbandon:a}}function mo(e){return e.phase==="IDLE"||e.phase==="DROP_ANIMATING"?!1:e.isDragging}const P6=9,B6=13,Ud=27,hg=32,F6=33,L6=34,$6=35,G6=36,H6=37,q6=38,U6=39,W6=40,Z6={[B6]:!0,[P6]:!0};var fg=e=>{Z6[e.keyCode]&&e.preventDefault()};const ic=(()=>{const e="visibilitychange";return typeof document>"u"?e:[e,`ms${e}`,`webkit${e}`,`moz${e}`,`o${e}`].find(r=>`on${r}`in document)||e})(),pg=0,_f=5;function Y6(e,t){return Math.abs(t.x-e.x)>=_f||Math.abs(t.y-e.y)>=_f}const Ef={type:"IDLE"};function J6({cancel:e,completed:t,getPhase:n,setPhase:r}){return[{eventName:"mousemove",fn:i=>{const{button:a,clientX:l,clientY:u}=i;if(a!==pg)return;const h={x:l,y:u},f=n();if(f.type==="DRAGGING"){i.preventDefault(),f.actions.move(h);return}f.type!=="PENDING"&&$e();const p=f.point;if(!Y6(p,h))return;i.preventDefault();const g=f.actions.fluidLift(h);r({type:"DRAGGING",actions:g})}},{eventName:"mouseup",fn:i=>{const a=n();if(a.type!=="DRAGGING"){e();return}i.preventDefault(),a.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:i=>{n().type==="DRAGGING"&&i.preventDefault(),e()}},{eventName:"keydown",fn:i=>{if(n().type==="PENDING"){e();return}if(i.keyCode===Ud){i.preventDefault(),e();return}fg(i)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{n().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:i=>{const a=n();if(a.type==="IDLE"&&$e(),a.actions.shouldRespectForcePress()){e();return}i.preventDefault()}},{eventName:ic,fn:e}]}function X6(e){const t=z.useRef(Ef),n=z.useRef(pi),r=Gt(()=>({eventName:"mousedown",fn:function(g){if(g.defaultPrevented||g.button!==pg||g.ctrlKey||g.metaKey||g.shiftKey||g.altKey)return;const y=e.findClosestDraggableId(g);if(!y)return;const b=e.tryGetLock(y,l,{sourceEvent:g});if(!b)return;g.preventDefault();const A={x:g.clientX,y:g.clientY};n.current(),f(b,A)}}),[e]),i=Gt(()=>({eventName:"webkitmouseforcewillbegin",fn:p=>{if(p.defaultPrevented)return;const g=e.findClosestDraggableId(p);if(!g)return;const y=e.findOptionsForDraggable(g);y&&(y.shouldRespectForcePress||e.canGetLock(g)&&p.preventDefault())}}),[e]),a=dt(function(){const g={passive:!1,capture:!0};n.current=ns(window,[i,r],g)},[i,r]),l=dt(()=>{t.current.type!=="IDLE"&&(t.current=Ef,n.current(),a())},[a]),u=dt(()=>{const p=t.current;l(),p.type==="DRAGGING"&&p.actions.cancel({shouldBlockNextClick:!0}),p.type==="PENDING"&&p.actions.abort()},[l]),h=dt(function(){const g={capture:!0,passive:!1},y=J6({cancel:u,completed:l,getPhase:()=>t.current,setPhase:b=>{t.current=b}});n.current=ns(window,y,g)},[u,l]),f=dt(function(g,y){t.current.type!=="IDLE"&&$e(),t.current={type:"PENDING",point:y,actions:g},h()},[h]);Br(function(){return a(),function(){n.current()}},[a])}function K6(){}const Q6={[L6]:!0,[F6]:!0,[G6]:!0,[$6]:!0};function e7(e,t){function n(){t(),e.cancel()}function r(){t(),e.drop()}return[{eventName:"keydown",fn:i=>{if(i.keyCode===Ud){i.preventDefault(),n();return}if(i.keyCode===hg){i.preventDefault(),r();return}if(i.keyCode===W6){i.preventDefault(),e.moveDown();return}if(i.keyCode===q6){i.preventDefault(),e.moveUp();return}if(i.keyCode===U6){i.preventDefault(),e.moveRight();return}if(i.keyCode===H6){i.preventDefault(),e.moveLeft();return}if(Q6[i.keyCode]){i.preventDefault();return}fg(i)}},{eventName:"mousedown",fn:n},{eventName:"mouseup",fn:n},{eventName:"click",fn:n},{eventName:"touchstart",fn:n},{eventName:"resize",fn:n},{eventName:"wheel",fn:n,options:{passive:!0}},{eventName:ic,fn:n}]}function t7(e){const t=z.useRef(K6),n=Gt(()=>({eventName:"keydown",fn:function(a){if(a.defaultPrevented||a.keyCode!==hg)return;const l=e.findClosestDraggableId(a);if(!l)return;const u=e.tryGetLock(l,p,{sourceEvent:a});if(!u)return;a.preventDefault();let h=!0;const f=u.snapLift();t.current();function p(){h||$e(),h=!1,t.current(),r()}t.current=ns(window,e7(f,p),{capture:!0,passive:!1})}}),[e]),r=dt(function(){const a={passive:!1,capture:!0};t.current=ns(window,[n],a)},[n]);Br(function(){return r(),function(){t.current()}},[r])}const cu={type:"IDLE"},n7=120,r7=.15;function s7({cancel:e,getPhase:t}){return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:n=>{n.preventDefault()}},{eventName:"keydown",fn:n=>{if(t().type!=="DRAGGING"){e();return}n.keyCode===Ud&&n.preventDefault(),e()}},{eventName:ic,fn:e}]}function i7({cancel:e,completed:t,getPhase:n}){return[{eventName:"touchmove",options:{capture:!1},fn:r=>{const i=n();if(i.type!=="DRAGGING"){e();return}i.hasMoved=!0;const{clientX:a,clientY:l}=r.touches[0],u={x:a,y:l};r.preventDefault(),i.actions.move(u)}},{eventName:"touchend",fn:r=>{const i=n();if(i.type!=="DRAGGING"){e();return}r.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:r=>{if(n().type!=="DRAGGING"){e();return}r.preventDefault(),e()}},{eventName:"touchforcechange",fn:r=>{const i=n();i.type==="IDLE"&&$e();const a=r.touches[0];if(!a||!(a.force>=r7))return;const u=i.actions.shouldRespectForcePress();if(i.type==="PENDING"){u&&e();return}if(u){if(i.hasMoved){r.preventDefault();return}e();return}r.preventDefault()}},{eventName:ic,fn:e}]}function a7(e){const t=z.useRef(cu),n=z.useRef(pi),r=dt(function(){return t.current},[]),i=dt(function(b){t.current=b},[]),a=Gt(()=>({eventName:"touchstart",fn:function(b){if(b.defaultPrevented)return;const A=e.findClosestDraggableId(b);if(!A)return;const D=e.tryGetLock(A,u,{sourceEvent:b});if(!D)return;const j=b.touches[0],{clientX:w,clientY:C}=j,_={x:w,y:C};n.current(),g(D,_)}}),[e]),l=dt(function(){const b={capture:!0,passive:!1};n.current=ns(window,[a],b)},[a]),u=dt(()=>{const y=t.current;y.type!=="IDLE"&&(y.type==="PENDING"&&clearTimeout(y.longPressTimerId),i(cu),n.current(),l())},[l,i]),h=dt(()=>{const y=t.current;u(),y.type==="DRAGGING"&&y.actions.cancel({shouldBlockNextClick:!0}),y.type==="PENDING"&&y.actions.abort()},[u]),f=dt(function(){const b={capture:!0,passive:!1},A={cancel:h,completed:u,getPhase:r},D=ns(window,i7(A),b),j=ns(window,s7(A),b);n.current=function(){D(),j()}},[h,r,u]),p=dt(function(){const b=r();b.type!=="PENDING"&&$e();const A=b.actions.fluidLift(b.point);i({type:"DRAGGING",actions:A,hasMoved:!1})},[r,i]),g=dt(function(b,A){r().type!=="IDLE"&&$e();const D=setTimeout(p,n7);i({type:"PENDING",point:A,actions:b,longPressTimerId:D}),f()},[f,r,i,p]);Br(function(){return l(),function(){n.current();const A=r();A.type==="PENDING"&&(clearTimeout(A.longPressTimerId),i(cu))}},[r,l,i]),Br(function(){return ns(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const o7=["input","button","textarea","select","option","optgroup","video","audio"];function mg(e,t){if(t==null)return!1;if(o7.includes(t.tagName.toLowerCase()))return!0;const r=t.getAttribute("contenteditable");return r==="true"||r===""?!0:t===e?!1:mg(e,t.parentElement)}function l7(e,t){const n=t.target;return rc(n)?mg(e,n):!1}var c7=e=>$i(e.getBoundingClientRect()).center;function u7(e){return e instanceof ug(e).Element}const d7=(()=>{const e="matches";return typeof document>"u"?e:[e,"msMatchesSelector","webkitMatchesSelector"].find(r=>r in Element.prototype)||e})();function gg(e,t){return e==null?null:e[d7](t)?e:gg(e.parentElement,t)}function h7(e,t){return e.closest?e.closest(t):gg(e,t)}function f7(e){return`[${ka.contextId}="${e}"]`}function p7(e,t){const n=t.target;if(!u7(n))return null;const r=f7(e),i=h7(n,r);return!i||!rc(i)?null:i}function m7(e,t){const n=p7(e,t);return n?n.getAttribute(ka.draggableId):null}function g7(e,t){const n=`[${ed.contextId}="${e}"]`,i=cg(document,n).find(a=>a.getAttribute(ed.id)===t);return!i||!rc(i)?null:i}function y7(e){e.preventDefault()}function Qo({expected:e,phase:t,isLockActive:n,shouldWarn:r}){return!(!n()||e!==t)}function yg({lockAPI:e,store:t,registry:n,draggableId:r}){if(e.isClaimed())return!1;const i=n.draggable.findById(r);return!(!i||!i.options.isEnabled||!ig(t.getState(),r))}function x7({lockAPI:e,contextId:t,store:n,registry:r,draggableId:i,forceSensorStop:a,sourceEvent:l}){if(!yg({lockAPI:e,store:n,registry:r,draggableId:i}))return null;const h=r.draggable.getById(i),f=g7(t,h.descriptor.id);if(!f||l&&!h.options.canDragInteractiveElements&&l7(f,l))return null;const p=e.claim(a||pi);let g="PRE_DRAG";function y(){return h.options.shouldRespectForcePress}function b(){return e.isActive(p)}function A(E,I){Qo({expected:E,phase:g,isLockActive:b,shouldWarn:!0})&&n.dispatch(I())}const D=A.bind(null,"DRAGGING");function j(E){function I(){e.release(),g="COMPLETED"}g!=="PRE_DRAG"&&(I(),$e()),n.dispatch(h5(E.liftActionArgs)),g="DRAGGING";function H(Z,ae={shouldBlockNextClick:!1}){if(E.cleanup(),ae.shouldBlockNextClick){const ne=ns(window,[{eventName:"click",fn:y7,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(ne)}I(),n.dispatch(Xm({reason:Z}))}return{isActive:()=>Qo({expected:"DRAGGING",phase:g,isLockActive:b,shouldWarn:!1}),shouldRespectForcePress:y,drop:Z=>H("DROP",Z),cancel:Z=>H("CANCEL",Z),...E.actions}}function w(E){const I=lo(Z=>{D(()=>Jm({client:Z}))});return{...j({liftActionArgs:{id:i,clientSelection:E,movementMode:"FLUID"},cleanup:()=>I.cancel(),actions:{move:I}}),move:I}}function C(){const E={moveUp:()=>D(w5),moveRight:()=>D(k5),moveDown:()=>D(S5),moveLeft:()=>D(j5)};return j({liftActionArgs:{id:i,clientSelection:c7(f),movementMode:"SNAP"},cleanup:pi,actions:E})}function _(){Qo({expected:"PRE_DRAG",phase:g,isLockActive:b,shouldWarn:!0})&&e.release()}return{isActive:()=>Qo({expected:"PRE_DRAG",phase:g,isLockActive:b,shouldWarn:!1}),shouldRespectForcePress:y,fluidLift:w,snapLift:C,abort:_}}const b7=[X6,t7,a7];function v7({contextId:e,store:t,registry:n,customSensors:r,enableDefaultSensors:i}){const a=[...i?b7:[],...r||[]],l=z.useState(()=>z6())[0],u=dt(function(j,w){mo(j)&&!mo(w)&&l.tryAbandon()},[l]);Br(function(){let j=t.getState();return t.subscribe(()=>{const C=t.getState();u(j,C),j=C})},[l,t,u]),Br(()=>l.tryAbandon,[l.tryAbandon]);const h=dt(D=>yg({lockAPI:l,registry:n,store:t,draggableId:D}),[l,n,t]),f=dt((D,j,w)=>x7({lockAPI:l,registry:n,contextId:e,store:t,draggableId:D,forceSensorStop:j||null,sourceEvent:w&&w.sourceEvent?w.sourceEvent:null}),[e,l,n,t]),p=dt(D=>m7(e,D),[e]),g=dt(D=>{const j=n.draggable.findById(D);return j?j.options:null},[n.draggable]),y=dt(function(){l.isClaimed()&&(l.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(zd()))},[l,t]),b=dt(()=>l.isClaimed(),[l]),A=Gt(()=>({canGetLock:h,tryGetLock:f,findClosestDraggableId:p,findOptionsForDraggable:g,tryReleaseLock:y,isLockClaimed:b}),[h,f,p,g,y,b]);for(let D=0;D<a.length;D++)a[D](A)}const w7=e=>({onBeforeCapture:t=>{const n=()=>{e.onBeforeCapture&&e.onBeforeCapture(t)};wd.flushSync(n)},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),S7=e=>({...po,...e.autoScrollerOptions,durationDampening:{...po.durationDampening,...e.autoScrollerOptions}});function Ua(e){return e.current||$e(),e.current}function k7(e){const{contextId:t,setCallbacks:n,sensors:r,nonce:i,dragHandleUsageInstructions:a}=e,l=z.useRef(null),u=dg(e),h=dt(()=>w7(u.current),[u]),f=dt(()=>S7(u.current),[u]),p=D6(t),g=V6({contextId:t,text:a}),y=T6(t,i),b=dt(ne=>{Ua(l).dispatch(ne)},[]),A=Gt(()=>sf({publishWhileDragging:p5,updateDroppableScroll:g5,updateDroppableIsEnabled:y5,updateDroppableIsCombineEnabled:x5,collectionStarting:m5},b),[b]),D=E6(),j=Gt(()=>s6(D,A),[D,A]),w=Gt(()=>w6({scrollWindow:i6,scrollDroppable:j.scrollDroppable,getAutoScrollerOptions:f,...sf({move:Jm},b)}),[j.scrollDroppable,b,f]),C=A6(t),_=Gt(()=>e6({announce:p,autoScroller:w,dimensionMarshal:j,focusMarshal:C,getResponders:h,styleMarshal:y}),[p,w,j,C,h,y]);l.current=_;const N=dt(()=>{const ne=Ua(l);ne.getState().phase!=="IDLE"&&ne.dispatch(zd())},[]),E=dt(()=>{const ne=Ua(l).getState();return ne.phase==="DROP_ANIMATING"?!0:ne.phase==="IDLE"?!1:ne.isDragging},[]),I=Gt(()=>({isDragging:E,tryAbort:N}),[E,N]);n(I);const H=dt(ne=>ig(Ua(l).getState(),ne),[]),Z=dt(()=>Ei(Ua(l).getState()),[]),ae=Gt(()=>({marshal:j,focus:C,contextId:t,canLift:H,isMovementAllowed:Z,dragHandleUsageInstructionsId:g,registry:D}),[t,j,g,C,H,Z,D]);return v7({contextId:t,store:_,registry:D,customSensors:r||null,enableDefaultSensors:e.enableDefaultSensors!==!1}),z.useEffect(()=>N,[N]),kt.createElement(sc.Provider,{value:ae},kt.createElement(Kv,{context:Hd,store:_},e.children))}function j7(){return kt.useId()}function ac(e){const t=j7(),n=e.dragHandleUsageInstructions||ul.dragHandleUsageInstructions;return kt.createElement(t3,null,r=>kt.createElement(k7,{nonce:e.nonce,contextId:t,setCallbacks:r,dragHandleUsageInstructions:n,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children))}const Nf={dragging:5e3,dropAnimating:4500},C7=(e,t)=>t?no.drop(t.duration):e?no.snap:no.fluid,T7=(e,t)=>{if(e)return t?fo.opacity.drop:fo.opacity.combining},I7=e=>e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP";function A7(e){const n=e.dimension.client,{offset:r,combineWith:i,dropping:a}=e,l=!!i,u=I7(e),h=!!a,f=h?Ku.drop(r,l):Ku.moveTo(r);return{position:"fixed",top:n.marginBox.top,left:n.marginBox.left,boxSizing:"border-box",width:n.borderBox.width,height:n.borderBox.height,transition:C7(u,a),transform:f,opacity:T7(l,h),zIndex:h?Nf.dropAnimating:Nf.dragging,pointerEvents:"none"}}function _7(e){return{transform:Ku.moveTo(e.offset),transition:e.shouldAnimateDisplacement?void 0:"none"}}function E7(e){return e.type==="DRAGGING"?A7(e):_7(e)}function N7(e,t,n=rr){const r=window.getComputedStyle(t),i=t.getBoundingClientRect(),a=dx(i,r),l=wl(a,n),u={client:a,tagName:t.tagName.toLowerCase(),display:r.display},h={x:a.marginBox.width,y:a.marginBox.height};return{descriptor:e,placeholder:u,displaceBy:h,client:a,page:l}}function M7(e){const t=qd("draggable"),{descriptor:n,registry:r,getDraggableRef:i,canDragInteractiveElements:a,shouldRespectForcePress:l,isEnabled:u}=e,h=Gt(()=>({canDragInteractiveElements:a,shouldRespectForcePress:l,isEnabled:u}),[a,u,l]),f=dt(b=>{const A=i();return A||$e(),N7(n,A,b)},[n,i]),p=Gt(()=>({uniqueId:t,descriptor:n,options:h,getDimension:f}),[n,f,h,t]),g=z.useRef(p),y=z.useRef(!0);Br(()=>(r.draggable.register(g.current),()=>r.draggable.unregister(g.current)),[r.draggable]),Br(()=>{if(y.current){y.current=!1;return}const b=g.current;g.current=p,r.draggable.update(p,b)},[p,r.draggable])}var Wd=kt.createContext(null);function zl(e){const t=z.useContext(e);return t||$e(),t}function D7(e){e.preventDefault()}const R7=e=>{const t=z.useRef(null),n=dt((I=null)=>{t.current=I},[]),r=dt(()=>t.current,[]),{contextId:i,dragHandleUsageInstructionsId:a,registry:l}=zl(sc),{type:u,droppableId:h}=zl(Wd),f=Gt(()=>({id:e.draggableId,index:e.index,type:u,droppableId:h}),[e.draggableId,e.index,u,h]),{children:p,draggableId:g,isEnabled:y,shouldRespectForcePress:b,canDragInteractiveElements:A,isClone:D,mapped:j,dropAnimationFinished:w}=e;if(!D){const I=Gt(()=>({descriptor:f,registry:l,getDraggableRef:r,canDragInteractiveElements:A,shouldRespectForcePress:b,isEnabled:y}),[f,l,r,A,b,y]);M7(I)}const C=Gt(()=>y?{tabIndex:0,role:"button","aria-describedby":a,"data-rfd-drag-handle-draggable-id":g,"data-rfd-drag-handle-context-id":i,draggable:!1,onDragStart:D7}:null,[i,a,g,y]),_=dt(I=>{j.type==="DRAGGING"&&j.dropping&&I.propertyName==="transform"&&wd.flushSync(w)},[w,j]),N=Gt(()=>{const I=E7(j),H=j.type==="DRAGGING"&&j.dropping?_:void 0;return{innerRef:n,draggableProps:{"data-rfd-draggable-context-id":i,"data-rfd-draggable-id":g,style:I,onTransitionEnd:H},dragHandleProps:C}},[i,C,g,j,_,n]),E=Gt(()=>({draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}),[f.droppableId,f.id,f.index,f.type]);return kt.createElement(kt.Fragment,null,p(N,j.snapshot,E))};var xg=(e,t)=>e===t,bg=e=>{const{combine:t,destination:n}=e;return n?n.droppableId:t?t.droppableId:null};const O7=e=>e.combine?e.combine.draggableId:null,V7=e=>e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null;function z7(){const e=tr((i,a)=>({x:i,y:a})),t=tr((i,a,l=null,u=null,h=null)=>({isDragging:!0,isClone:a,isDropAnimating:!!h,dropAnimation:h,mode:i,draggingOver:l,combineWith:u,combineTargetFor:null})),n=tr((i,a,l,u,h=null,f=null,p=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:h,combineWith:f,mode:a,offset:i,dimension:l,forceShouldAnimate:p,snapshot:t(a,u,h,f,null)}}));return(i,a)=>{if(mo(i)){if(i.critical.draggable.id!==a.draggableId)return null;const l=i.current.client.offset,u=i.dimensions.draggables[a.draggableId],h=Pr(i.impact),f=V7(i.impact),p=i.forceShouldAnimate;return n(e(l.x,l.y),i.movementMode,u,a.isClone,h,f,p)}if(i.phase==="DROP_ANIMATING"){const l=i.completed;if(l.result.draggableId!==a.draggableId)return null;const u=a.isClone,h=i.dimensions.draggables[a.draggableId],f=l.result,p=f.mode,g=bg(f),y=O7(f),A={duration:i.dropDuration,curve:Bd.drop,moveTo:i.newHomeClientOffset,opacity:y?fo.opacity.drop:null,scale:y?fo.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:h,dropping:A,draggingOver:g,combineWith:y,mode:p,forceShouldAnimate:null,snapshot:t(p,u,g,y,A)}}}return null}}function vg(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}const P7={mapped:{type:"SECONDARY",offset:rr,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:vg(null)}};function B7(){const e=tr((l,u)=>({x:l,y:u})),t=tr(vg),n=tr((l,u=null,h)=>({mapped:{type:"SECONDARY",offset:l,combineTargetFor:u,shouldAnimateDisplacement:h,snapshot:t(u)}})),r=l=>l?n(rr,l,!0):null,i=(l,u,h,f)=>{const p=h.displaced.visible[l],g=!!(f.inVirtualList&&f.effected[l]),y=ec(h),b=y&&y.draggableId===l?u:null;if(!p){if(!g)return r(b);if(h.displaced.invisible[l])return null;const j=_a(f.displacedBy.point),w=e(j.x,j.y);return n(w,b,!0)}if(g)return r(b);const A=h.displacedBy.point,D=e(A.x,A.y);return n(D,b,p.shouldAnimate)};return(l,u)=>{if(mo(l))return l.critical.draggable.id===u.draggableId?null:i(u.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){const h=l.completed;return h.result.draggableId===u.draggableId?null:i(u.draggableId,h.result.draggableId,h.impact,h.afterCritical)}return null}}const F7=()=>{const e=z7(),t=B7();return(r,i)=>e(r,i)||t(r,i)||P7},L7={dropAnimationFinished:Km},$7=Cm(F7,L7,null,{context:Hd,areStatePropsEqual:xg})(R7);function wg(e){return zl(Wd).isUsingCloneFor===e.draggableId&&!e.isClone?null:kt.createElement($7,e)}function go(e){const t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,n=!!e.disableInteractiveElementBlocking,r=!!e.shouldRespectForcePress;return kt.createElement(wg,vd({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:n,shouldRespectForcePress:r}))}const Sg=e=>t=>e===t,G7=Sg("scroll"),H7=Sg("auto"),Mf=(e,t)=>t(e.overflowX)||t(e.overflowY),q7=e=>{const t=window.getComputedStyle(e),n={overflowX:t.overflowX,overflowY:t.overflowY};return Mf(n,G7)||Mf(n,H7)},U7=()=>!1,kg=e=>e==null?null:e===document.body?U7()?e:null:e===document.documentElement?null:q7(e)?e:kg(e.parentElement);var td=e=>({x:e.scrollLeft,y:e.scrollTop});const jg=e=>e?window.getComputedStyle(e).position==="fixed"?!0:jg(e.parentElement):!1;var W7=e=>{const t=kg(e),n=jg(e);return{closestScrollable:t,isFixedOnPage:n}},Z7=({descriptor:e,isEnabled:t,isCombineEnabled:n,isFixedOnPage:r,direction:i,client:a,page:l,closest:u})=>{const h=(()=>{if(!u)return null;const{scrollSize:y,client:b}=u,A=ng({scrollHeight:y.scrollHeight,scrollWidth:y.scrollWidth,height:b.paddingBox.height,width:b.paddingBox.width});return{pageMarginBox:u.page.marginBox,frameClient:b,scrollSize:y,shouldClipSubject:u.shouldClipSubject,scroll:{initial:u.scroll,current:u.scroll,max:A,diff:{value:rr,displacement:rr}}}})(),f=i==="vertical"?Md:Om,p=wa({page:l,withPlaceholder:null,axis:f,frame:h});return{descriptor:e,isCombineEnabled:n,isFixedOnPage:r,axis:f,isEnabled:t,client:a,page:l,frame:h,subject:p}};const Y7=(e,t)=>{const n=Op(e);if(!t||e!==t)return n;const r=n.paddingBox.top-t.scrollTop,i=n.paddingBox.left-t.scrollLeft,a=r+t.scrollHeight,l=i+t.scrollWidth,h=Vp({top:r,right:l,bottom:a,left:i},n.border);return ux({borderBox:h,margin:n.margin,border:n.border,padding:n.padding})};var J7=({ref:e,descriptor:t,env:n,windowScroll:r,direction:i,isDropDisabled:a,isCombineEnabled:l,shouldClipSubject:u})=>{const h=n.closestScrollable,f=Y7(e,h),p=wl(f,r),g=(()=>{if(!h)return null;const b=Op(h),A={scrollHeight:h.scrollHeight,scrollWidth:h.scrollWidth};return{client:b,page:wl(b,r),scroll:td(h),scrollSize:A,shouldClipSubject:u}})();return Z7({descriptor:t,isEnabled:!a,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:i,client:f,page:p,closest:g})};const X7={passive:!1},K7={passive:!0};var Df=e=>e.shouldPublishImmediately?X7:K7;const el=e=>e&&e.env.closestScrollable||null;function Q7(e){const t=z.useRef(null),n=zl(sc),r=qd("droppable"),{registry:i,marshal:a}=n,l=dg(e),u=Gt(()=>({id:e.droppableId,type:e.type,mode:e.mode}),[e.droppableId,e.mode,e.type]),h=z.useRef(u),f=Gt(()=>tr((N,E)=>{t.current||$e();const I={x:N,y:E};a.updateDroppableScroll(u.id,I)}),[u.id,a]),p=dt(()=>{const N=t.current;return!N||!N.env.closestScrollable?rr:td(N.env.closestScrollable)},[]),g=dt(()=>{const N=p();f(N.x,N.y)},[p,f]),y=Gt(()=>lo(g),[g]),b=dt(()=>{const N=t.current,E=el(N);if(N&&E||$e(),N.scrollOptions.shouldPublishImmediately){g();return}y()},[y,g]),A=dt((N,E)=>{t.current&&$e();const I=l.current,H=I.getDroppableRef();H||$e();const Z=W7(H),ae={ref:H,descriptor:u,env:Z,scrollOptions:E};t.current=ae;const ne=J7({ref:H,descriptor:u,env:Z,windowScroll:N,direction:I.direction,isDropDisabled:I.isDropDisabled,isCombineEnabled:I.isCombineEnabled,shouldClipSubject:!I.ignoreContainerClipping}),F=Z.closestScrollable;return F&&(F.setAttribute(If.contextId,n.contextId),F.addEventListener("scroll",b,Df(ae.scrollOptions))),ne},[n.contextId,u,b,l]),D=dt(()=>{const N=t.current,E=el(N);return N&&E||$e(),td(E)},[]),j=dt(()=>{const N=t.current;N||$e();const E=el(N);t.current=null,E&&(y.cancel(),E.removeAttribute(If.contextId),E.removeEventListener("scroll",b,Df(N.scrollOptions)))},[b,y]),w=dt(N=>{const E=t.current;E||$e();const I=el(E);I||$e(),I.scrollTop+=N.y,I.scrollLeft+=N.x},[]),C=Gt(()=>({getDimensionAndWatchScroll:A,getScrollWhileDragging:D,dragStopped:j,scroll:w}),[j,A,D,w]),_=Gt(()=>({uniqueId:r,descriptor:u,callbacks:C}),[C,u,r]);Br(()=>(h.current=_.descriptor,i.droppable.register(_),()=>{t.current&&j(),i.droppable.unregister(_)}),[C,u,j,_,a,i.droppable]),Br(()=>{t.current&&a.updateDroppableIsEnabled(h.current.id,!e.isDropDisabled)},[e.isDropDisabled,a]),Br(()=>{t.current&&a.updateDroppableIsCombineEnabled(h.current.id,e.isCombineEnabled)},[e.isCombineEnabled,a])}function uu(){}const Rf={width:0,height:0,margin:l3},e8=({isAnimatingOpenOnMount:e,placeholder:t,animate:n})=>e||n==="close"?Rf:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},t8=({isAnimatingOpenOnMount:e,placeholder:t,animate:n})=>{const r=e8({isAnimatingOpenOnMount:e,placeholder:t,animate:n});return{display:t.display,boxSizing:"border-box",width:r.width,height:r.height,marginTop:r.margin.top,marginRight:r.margin.right,marginBottom:r.margin.bottom,marginLeft:r.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:n!=="none"?no.placeholder:null}},n8=e=>{const t=z.useRef(null),n=dt(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:r,onTransitionEnd:i,onClose:a,contextId:l}=e,[u,h]=z.useState(e.animate==="open");z.useEffect(()=>u?r!=="open"?(n(),h(!1),uu):t.current?uu:(t.current=setTimeout(()=>{t.current=null,h(!1)}),n):uu,[r,u,n]);const f=dt(g=>{g.propertyName==="height"&&(i(),r==="close"&&a())},[r,a,i]),p=t8({isAnimatingOpenOnMount:u,animate:e.animate,placeholder:e.placeholder});return kt.createElement(e.placeholder.tagName,{style:p,"data-rfd-placeholder-context-id":l,onTransitionEnd:f,ref:e.innerRef})};var r8=kt.memo(n8);class s8 extends kt.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,n){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:n.isVisible?{isVisible:!0,data:n.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const i8=e=>{const t=z.useContext(sc);t||$e();const{contextId:n,isMovementAllowed:r}=t,i=z.useRef(null),a=z.useRef(null),{children:l,droppableId:u,type:h,mode:f,direction:p,ignoreContainerClipping:g,isDropDisabled:y,isCombineEnabled:b,snapshot:A,useClone:D,updateViewportMaxScroll:j,getContainerForClone:w}=e,C=dt(()=>i.current,[]),_=dt((F=null)=>{i.current=F},[]);dt(()=>a.current,[]);const N=dt((F=null)=>{a.current=F},[]),E=dt(()=>{r()&&j({maxScroll:sg()})},[r,j]);Q7({droppableId:u,type:h,mode:f,direction:p,isDropDisabled:y,isCombineEnabled:b,ignoreContainerClipping:g,getDroppableRef:C});const I=Gt(()=>kt.createElement(s8,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},({onClose:F,data:J,animate:pe})=>kt.createElement(r8,{placeholder:J,onClose:F,innerRef:N,animate:pe,contextId:n,onTransitionEnd:E})),[n,E,e.placeholder,e.shouldAnimatePlaceholder,N]),H=Gt(()=>({innerRef:_,placeholder:I,droppableProps:{"data-rfd-droppable-id":u,"data-rfd-droppable-context-id":n}}),[n,u,I,_]),Z=D?D.dragging.draggableId:null,ae=Gt(()=>({droppableId:u,type:h,isUsingCloneFor:Z}),[u,Z,h]);function ne(){if(!D)return null;const{dragging:F,render:J}=D,pe=kt.createElement(wg,{draggableId:F.draggableId,index:F.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(G,ge)=>J(G,ge,F));return bx.createPortal(pe,w())}return kt.createElement(Wd.Provider,{value:ae},l(H,A),ne())};function a8(){return document.body||$e(),document.body}const Of={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:a8},Cg=e=>{let t={...e},n;for(n in Of)e[n]===void 0&&(t={...t,[n]:Of[n]});return t},du=(e,t)=>e===t.droppable.type,Vf=(e,t)=>t.draggables[e.draggable.id],o8=()=>{const e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...e,shouldAnimatePlaceholder:!1},n=tr(a=>({draggableId:a.id,type:a.type,source:{index:a.index,droppableId:a.droppableId}})),r=tr((a,l,u,h,f,p)=>{const g=f.descriptor.id;if(f.descriptor.droppableId===a){const A=p?{render:p,dragging:n(f.descriptor)}:null,D={isDraggingOver:u,draggingOverWith:u?g:null,draggingFromThisWith:g,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!1,snapshot:D,useClone:A}}if(!l)return t;if(!h)return e;const b={isDraggingOver:u,draggingOverWith:g,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!0,snapshot:b,useClone:null}});return(a,l)=>{const u=Cg(l),h=u.droppableId,f=u.type,p=!u.isDropDisabled,g=u.renderClone;if(mo(a)){const y=a.critical;if(!du(f,y))return t;const b=Vf(y,a.dimensions),A=Pr(a.impact)===h;return r(h,p,A,A,b,g)}if(a.phase==="DROP_ANIMATING"){const y=a.completed;if(!du(f,y.critical))return t;const b=Vf(y.critical,a.dimensions);return r(h,p,bg(y.result)===h,Pr(y.impact)===h,b,g)}if(a.phase==="IDLE"&&a.completed&&!a.shouldFlush){const y=a.completed;if(!du(f,y.critical))return t;const b=Pr(y.impact)===h,A=!!(y.impact.at&&y.impact.at.type==="COMBINE"),D=y.critical.droppable.id===h;return b?A?e:t:D?e:t}return t}},l8={updateViewportMaxScroll:v5},oc=Cm(o8,l8,(e,t,n)=>({...Cg(n),...e,...t}),{context:Hd,areStatePropsEqual:xg})(i8);var c8=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],Tg=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],u8="-----------------------------------------------------------------------------------------------------------------------------------------------------",Ig="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",hu={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},fu="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",d8={5:fu,"5module":fu+" export import",6:fu+" const class extends export import super"},h8=/^in(stanceof)?$/,f8=new RegExp("["+Ig+"]"),p8=new RegExp("["+Ig+u8+"]");function nd(e,t){for(var n=65536,r=0;r<t.length;r+=2){if(n+=t[r],n>e)return!1;if(n+=t[r+1],n>=e)return!0}return!1}function Ts(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&f8.test(String.fromCharCode(e)):t===!1?!1:nd(e,Tg)}function xi(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&p8.test(String.fromCharCode(e)):t===!1?!1:nd(e,Tg)||nd(e,c8)}var Wt=function(t,n){n===void 0&&(n={}),this.label=t,this.keyword=n.keyword,this.beforeExpr=!!n.beforeExpr,this.startsExpr=!!n.startsExpr,this.isLoop=!!n.isLoop,this.isAssign=!!n.isAssign,this.prefix=!!n.prefix,this.postfix=!!n.postfix,this.binop=n.binop||null,this.updateContext=null};function Zr(e,t){return new Wt(e,{beforeExpr:!0,binop:t})}var Yr={beforeExpr:!0},_r={startsExpr:!0},Zd={};function zt(e,t){return t===void 0&&(t={}),t.keyword=e,Zd[e]=new Wt(e,t)}var O={num:new Wt("num",_r),regexp:new Wt("regexp",_r),string:new Wt("string",_r),name:new Wt("name",_r),privateId:new Wt("privateId",_r),eof:new Wt("eof"),bracketL:new Wt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Wt("]"),braceL:new Wt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Wt("}"),parenL:new Wt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Wt(")"),comma:new Wt(",",Yr),semi:new Wt(";",Yr),colon:new Wt(":",Yr),dot:new Wt("."),question:new Wt("?",Yr),questionDot:new Wt("?."),arrow:new Wt("=>",Yr),template:new Wt("template"),invalidTemplate:new Wt("invalidTemplate"),ellipsis:new Wt("...",Yr),backQuote:new Wt("`",_r),dollarBraceL:new Wt("${",{beforeExpr:!0,startsExpr:!0}),eq:new Wt("=",{beforeExpr:!0,isAssign:!0}),assign:new Wt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Wt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Wt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Zr("||",1),logicalAND:Zr("&&",2),bitwiseOR:Zr("|",3),bitwiseXOR:Zr("^",4),bitwiseAND:Zr("&",5),equality:Zr("==/!=/===/!==",6),relational:Zr("</>/<=/>=",7),bitShift:Zr("<</>>/>>>",8),plusMin:new Wt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Zr("%",10),star:Zr("*",10),slash:Zr("/",10),starstar:new Wt("**",{beforeExpr:!0}),coalesce:Zr("??",1),_break:zt("break"),_case:zt("case",Yr),_catch:zt("catch"),_continue:zt("continue"),_debugger:zt("debugger"),_default:zt("default",Yr),_do:zt("do",{isLoop:!0,beforeExpr:!0}),_else:zt("else",Yr),_finally:zt("finally"),_for:zt("for",{isLoop:!0}),_function:zt("function",_r),_if:zt("if"),_return:zt("return",Yr),_switch:zt("switch"),_throw:zt("throw",Yr),_try:zt("try"),_var:zt("var"),_const:zt("const"),_while:zt("while",{isLoop:!0}),_with:zt("with"),_new:zt("new",{beforeExpr:!0,startsExpr:!0}),_this:zt("this",_r),_super:zt("super",_r),_class:zt("class",_r),_extends:zt("extends",Yr),_export:zt("export"),_import:zt("import",_r),_null:zt("null",_r),_true:zt("true",_r),_false:zt("false",_r),_in:zt("in",{beforeExpr:!0,binop:7}),_instanceof:zt("instanceof",{beforeExpr:!0,binop:7}),_typeof:zt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:zt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:zt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Dr=/\r\n?|\n|\u2028|\u2029/,m8=new RegExp(Dr.source,"g");function Ma(e){return e===10||e===13||e===8232||e===8233}function Ag(e,t,n){n===void 0&&(n=e.length);for(var r=t;r<n;r++){var i=e.charCodeAt(r);if(Ma(i))return r<n-1&&i===13&&e.charCodeAt(r+1)===10?r+2:r+1}return-1}var _g=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,pr=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Eg=Object.prototype,g8=Eg.hasOwnProperty,y8=Eg.toString,Da=Object.hasOwn||function(e,t){return g8.call(e,t)},zf=Array.isArray||function(e){return y8.call(e)==="[object Array]"},Pf=Object.create(null);function oi(e){return Pf[e]||(Pf[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function qs(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var x8=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,yo=function(t,n){this.line=t,this.column=n};yo.prototype.offset=function(t){return new yo(this.line,this.column+t)};var lc=function(t,n,r){this.start=n,this.end=r,t.sourceFile!==null&&(this.source=t.sourceFile)};function Ng(e,t){for(var n=1,r=0;;){var i=Ag(e,r,t);if(i<0)return new yo(n,t-r);++n,r=i}}var rd={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Bf=!1;function b8(e){var t={};for(var n in rd)t[n]=e&&Da(e,n)?e[n]:rd[n];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!Bf&&typeof console=="object"&&console.warn&&(Bf=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),zf(t.onToken)){var r=t.onToken;t.onToken=function(i){return r.push(i)}}return zf(t.onComment)&&(t.onComment=v8(t,t.onComment)),t}function v8(e,t){return function(n,r,i,a,l,u){var h={type:n?"Block":"Line",value:r,start:i,end:a};e.locations&&(h.loc=new lc(this,l,u)),e.ranges&&(h.range=[i,a]),t.push(h)}}var xo=1,Ra=2,Yd=4,Mg=8,Jd=16,Dg=32,cc=64,Rg=128,Hi=256,Ao=512,uc=xo|Ra|Hi;function Xd(e,t){return Ra|(e?Yd:0)|(t?Mg:0)}var Pl=0,Kd=1,Zs=2,Og=3,Vg=4,zg=5,Kn=function(t,n,r){this.options=t=b8(t),this.sourceFile=t.sourceFile,this.keywords=oi(d8[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var i="";t.allowReserved!==!0&&(i=hu[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(i+=" await")),this.reservedWords=oi(i);var a=(i?i+" ":"")+hu.strict;this.reservedWordsStrict=oi(a),this.reservedWordsStrictBind=oi(a+" "+hu.strictBind),this.input=String(n),this.containsEsc=!1,r?(this.pos=r,this.lineStart=this.input.lastIndexOf(`
`,r-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Dr).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=O.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(xo),this.regexpState=null,this.privateNameStack=[]},As={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Kn.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};As.inFunction.get=function(){return(this.currentVarScope().flags&Ra)>0};As.inGenerator.get=function(){return(this.currentVarScope().flags&Mg)>0};As.inAsync.get=function(){return(this.currentVarScope().flags&Yd)>0};As.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],n=t.flags;if(n&(Hi|Ao))return!1;if(n&Ra)return(n&Yd)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};As.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags;return(t&cc)>0||this.options.allowSuperOutsideMethod};As.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Rg)>0};As.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};As.allowNewDotTarget.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],n=t.flags;if(n&(Hi|Ao)||n&Ra&&!(n&Jd))return!0}return!1};As.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Hi)>0};Kn.extend=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];for(var r=this,i=0;i<t.length;i++)r=t[i](r);return r};Kn.parse=function(t,n){return new this(n,t).parse()};Kn.parseExpressionAt=function(t,n,r){var i=new this(r,t,n);return i.nextToken(),i.parseExpression()};Kn.tokenizer=function(t,n){return new this(n,t)};Object.defineProperties(Kn.prototype,As);var Cr=Kn.prototype,w8=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Cr.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){pr.lastIndex=e,e+=pr.exec(this.input)[0].length;var t=w8.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){pr.lastIndex=e+t[0].length;var n=pr.exec(this.input),r=n.index+n[0].length,i=this.input.charAt(r);return i===";"||i==="}"||Dr.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(i)||i==="!"&&this.input.charAt(r+1)==="=")}e+=t[0].length,pr.lastIndex=e,e+=pr.exec(this.input)[0].length,this.input[e]===";"&&e++}};Cr.eat=function(e){return this.type===e?(this.next(),!0):!1};Cr.isContextual=function(e){return this.type===O.name&&this.value===e&&!this.containsEsc};Cr.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1};Cr.expectContextual=function(e){this.eatContextual(e)||this.unexpected()};Cr.canInsertSemicolon=function(){return this.type===O.eof||this.type===O.braceR||Dr.test(this.input.slice(this.lastTokEnd,this.start))};Cr.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Cr.semicolon=function(){!this.eat(O.semi)&&!this.insertSemicolon()&&this.unexpected()};Cr.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};Cr.expect=function(e){this.eat(e)||this.unexpected()};Cr.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var dc=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Cr.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var n=t?e.parenthesizedAssign:e.parenthesizedBind;n>-1&&this.raiseRecoverable(n,t?"Assigning to rvalue":"Parenthesized pattern")}};Cr.checkExpressionErrors=function(e,t){if(!e)return!1;var n=e.shorthandAssign,r=e.doubleProto;if(!t)return n>=0||r>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),r>=0&&this.raiseRecoverable(r,"Redefinition of __proto__ property")};Cr.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Cr.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var at=Kn.prototype;at.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==O.eof;){var n=this.parseStatement(null,!0,t);e.body.push(n)}if(this.inModule)for(var r=0,i=Object.keys(this.undefinedExports);r<i.length;r+=1){var a=i[r];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var Qd={kind:"loop"},S8={kind:"switch"};at.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;pr.lastIndex=this.pos;var t=pr.exec(this.input),n=this.pos+t[0].length,r=this.input.charCodeAt(n);if(r===91||r===92)return!0;if(e)return!1;if(r===123||r>55295&&r<56320)return!0;if(Ts(r,!0)){for(var i=n+1;xi(r=this.input.charCodeAt(i),!0);)++i;if(r===92||r>55295&&r<56320)return!0;var a=this.input.slice(n,i);if(!h8.test(a))return!0}return!1};at.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;pr.lastIndex=this.pos;var e=pr.exec(this.input),t=this.pos+e[0].length,n;return!Dr.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(xi(n=this.input.charCodeAt(t+8))||n>55295&&n<56320))};at.isUsingKeyword=function(e,t){if(this.options.ecmaVersion<17||!this.isContextual(e?"await":"using"))return!1;pr.lastIndex=this.pos;var n=pr.exec(this.input),r=this.pos+n[0].length;if(Dr.test(this.input.slice(this.pos,r)))return!1;if(e){var i=r+5,a;if(this.input.slice(r,i)!=="using"||i===this.input.length||xi(a=this.input.charCodeAt(i))||a>55295&&a<56320)return!1;pr.lastIndex=i;var l=pr.exec(this.input);if(l&&Dr.test(this.input.slice(i,i+l[0].length)))return!1}if(t){var u=r+2,h;if(this.input.slice(r,u)==="of"&&(u===this.input.length||!xi(h=this.input.charCodeAt(u))&&!(h>55295&&h<56320)))return!1}var f=this.input.charCodeAt(r);return Ts(f,!0)||f===92};at.isAwaitUsing=function(e){return this.isUsingKeyword(!0,e)};at.isUsing=function(e){return this.isUsingKeyword(!1,e)};at.parseStatement=function(e,t,n){var r=this.type,i=this.startNode(),a;switch(this.isLet(e)&&(r=O._var,a="let"),r){case O._break:case O._continue:return this.parseBreakContinueStatement(i,r.keyword);case O._debugger:return this.parseDebuggerStatement(i);case O._do:return this.parseDoStatement(i);case O._for:return this.parseForStatement(i);case O._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(i,!1,!e);case O._class:return e&&this.unexpected(),this.parseClass(i,!0);case O._if:return this.parseIfStatement(i);case O._return:return this.parseReturnStatement(i);case O._switch:return this.parseSwitchStatement(i);case O._throw:return this.parseThrowStatement(i);case O._try:return this.parseTryStatement(i);case O._const:case O._var:return a=a||this.value,e&&a!=="var"&&this.unexpected(),this.parseVarStatement(i,a);case O._while:return this.parseWhileStatement(i);case O._with:return this.parseWithStatement(i);case O.braceL:return this.parseBlock(!0,i);case O.semi:return this.parseEmptyStatement(i);case O._export:case O._import:if(this.options.ecmaVersion>10&&r===O._import){pr.lastIndex=this.pos;var l=pr.exec(this.input),u=this.pos+l[0].length,h=this.input.charCodeAt(u);if(h===40||h===46)return this.parseExpressionStatement(i,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===O._import?this.parseImport(i):this.parseExport(i,n);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(i,!0,!e);var f=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(f)return t&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),f==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(i,!1,f),this.semicolon(),this.finishNode(i,"VariableDeclaration");var p=this.value,g=this.parseExpression();return r===O.name&&g.type==="Identifier"&&this.eat(O.colon)?this.parseLabeledStatement(i,p,g,e):this.parseExpressionStatement(i,g)}};at.parseBreakContinueStatement=function(e,t){var n=t==="break";this.next(),this.eat(O.semi)||this.insertSemicolon()?e.label=null:this.type!==O.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var i=this.labels[r];if((e.label==null||i.name===e.label.name)&&(i.kind!=null&&(n||i.kind==="loop")||e.label&&n))break}return r===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,n?"BreakStatement":"ContinueStatement")};at.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")};at.parseDoStatement=function(e){return this.next(),this.labels.push(Qd),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(O._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(O.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")};at.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Qd),this.enterScope(0),this.expect(O.parenL),this.type===O.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var n=this.isLet();if(this.type===O._var||this.type===O._const||n){var r=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),this.parseForAfterInit(e,r,t)}var a=this.isContextual("let"),l=!1,u=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(u){var h=this.startNode();return this.next(),u==="await using"&&this.next(),this.parseVar(h,!0,u),this.finishNode(h,"VariableDeclaration"),this.parseForAfterInit(e,h,t)}var f=this.containsEsc,p=new dc,g=this.start,y=t>-1?this.parseExprSubscripts(p,"await"):this.parseExpression(!0,p);return this.type===O._in||(l=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===O._in&&this.unexpected(t),e.await=!0):l&&this.options.ecmaVersion>=8&&(y.start===g&&!f&&y.type==="Identifier"&&y.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),a&&l&&this.raise(y.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(y,!1,p),this.checkLValPattern(y),this.parseForIn(e,y)):(this.checkExpressionErrors(p,!0),t>-1&&this.unexpected(t),this.parseFor(e,y))};at.parseForAfterInit=function(e,t,n){return(this.type===O._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&t.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===O._in?n>-1&&this.unexpected(n):e.await=n>-1),this.parseForIn(e,t)):(n>-1&&this.unexpected(n),this.parseFor(e,t))};at.parseFunctionStatement=function(e,t,n){return this.next(),this.parseFunction(e,ro|(n?0:sd),!1,t)};at.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(O._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")};at.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(O.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")};at.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(O.braceL),this.labels.push(S8),this.enterScope(0);for(var t,n=!1;this.type!==O.braceR;)if(this.type===O._case||this.type===O._default){var r=this.type===O._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),r?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(O.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")};at.parseThrowStatement=function(e){return this.next(),Dr.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var k8=[];at.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?Dg:0),this.checkLValPattern(e,t?Vg:Zs),this.expect(O.parenR),e};at.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===O._catch){var t=this.startNode();this.next(),this.eat(O.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(O._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")};at.parseVarStatement=function(e,t,n){return this.next(),this.parseVar(e,!1,t,n),this.semicolon(),this.finishNode(e,"VariableDeclaration")};at.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(Qd),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")};at.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")};at.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")};at.parseLabeledStatement=function(e,t,n,r){for(var i=0,a=this.labels;i<a.length;i+=1){var l=a[i];l.name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var u=this.type.isLoop?"loop":this.type===O._switch?"switch":null,h=this.labels.length-1;h>=0;h--){var f=this.labels[h];if(f.statementStart===e.start)f.statementStart=this.start,f.kind=u;else break}return this.labels.push({name:t,kind:u,statementStart:this.start}),e.body=this.parseStatement(r?r.indexOf("label")===-1?r+"label":r:"label"),this.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")};at.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")};at.parseBlock=function(e,t,n){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(O.braceL),e&&this.enterScope(0);this.type!==O.braceR;){var r=this.parseStatement(null);t.body.push(r)}return n&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")};at.parseFor=function(e,t){return e.init=t,this.expect(O.semi),e.test=this.type===O.semi?null:this.parseExpression(),this.expect(O.semi),e.update=this.type===O.parenR?null:this.parseExpression(),this.expect(O.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")};at.parseForIn=function(e,t){var n=this.type===O._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!n||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(O.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,n?"ForInStatement":"ForOfStatement")};at.parseVar=function(e,t,n,r){for(e.declarations=[],e.kind=n;;){var i=this.startNode();if(this.parseVarId(i,n),this.eat(O.eq)?i.init=this.parseMaybeAssign(t):!r&&n==="const"&&!(this.type===O._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!r&&(n==="using"||n==="await using")&&this.options.ecmaVersion>=17&&this.type!==O._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+n+" declaration"):!r&&i.id.type!=="Identifier"&&!(t&&(this.type===O._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):i.init=null,e.declarations.push(this.finishNode(i,"VariableDeclarator")),!this.eat(O.comma))break}return e};at.parseVarId=function(e,t){e.id=t==="using"||t==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?Kd:Zs,!1)};var ro=1,sd=2,Pg=4;at.parseFunction=function(e,t,n,r,i){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!r)&&(this.type===O.star&&t&sd&&this.unexpected(),e.generator=this.eat(O.star)),this.options.ecmaVersion>=8&&(e.async=!!r),t&ro&&(e.id=t&Pg&&this.type!==O.name?null:this.parseIdent(),e.id&&!(t&sd)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?Kd:Zs:Og));var a=this.yieldPos,l=this.awaitPos,u=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Xd(e.async,e.generator)),t&ro||(e.id=this.type===O.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,n,!1,i),this.yieldPos=a,this.awaitPos=l,this.awaitIdentPos=u,this.finishNode(e,t&ro?"FunctionDeclaration":"FunctionExpression")};at.parseFunctionParams=function(e){this.expect(O.parenL),e.params=this.parseBindingList(O.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};at.parseClass=function(e,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var r=this.enterClassBody(),i=this.startNode(),a=!1;for(i.body=[],this.expect(O.braceL);this.type!==O.braceR;){var l=this.parseClassElement(e.superClass!==null);l&&(i.body.push(l),l.type==="MethodDefinition"&&l.kind==="constructor"?(a&&this.raiseRecoverable(l.start,"Duplicate constructor in the same class"),a=!0):l.key&&l.key.type==="PrivateIdentifier"&&j8(r,l)&&this.raiseRecoverable(l.key.start,"Identifier '#"+l.key.name+"' has already been declared"))}return this.strict=n,this.next(),e.body=this.finishNode(i,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")};at.parseClassElement=function(e){if(this.eat(O.semi))return null;var t=this.options.ecmaVersion,n=this.startNode(),r="",i=!1,a=!1,l="method",u=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(O.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===O.star?u=!0:r="static"}if(n.static=u,!r&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===O.star)&&!this.canInsertSemicolon()?a=!0:r="async"),!r&&(t>=9||!a)&&this.eat(O.star)&&(i=!0),!r&&!a&&!i){var h=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?l=h:r=h)}if(r?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=r,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),t<13||this.type===O.parenL||l!=="method"||i||a){var f=!n.static&&Bl(n,"constructor"),p=f&&e;f&&l!=="method"&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=f?"constructor":l,this.parseClassMethod(n,i,a,p)}else this.parseClassField(n);return n};at.isClassElementNameStart=function(){return this.type===O.name||this.type===O.privateId||this.type===O.num||this.type===O.string||this.type===O.bracketL||this.type.keyword};at.parseClassElementName=function(e){this.type===O.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)};at.parseClassMethod=function(e,t,n,r){var i=e.key;e.kind==="constructor"?(t&&this.raise(i.start,"Constructor can't be a generator"),n&&this.raise(i.start,"Constructor can't be an async method")):e.static&&Bl(e,"prototype")&&this.raise(i.start,"Classes may not have a static property named prototype");var a=e.value=this.parseMethod(t,n,r);return e.kind==="get"&&a.params.length!==0&&this.raiseRecoverable(a.start,"getter should have no params"),e.kind==="set"&&a.params.length!==1&&this.raiseRecoverable(a.start,"setter should have exactly one param"),e.kind==="set"&&a.params[0].type==="RestElement"&&this.raiseRecoverable(a.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")};at.parseClassField=function(e){return Bl(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&Bl(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(O.eq)?(this.enterScope(Ao|cc),e.value=this.parseMaybeAssign(),this.exitScope()):e.value=null,this.semicolon(),this.finishNode(e,"PropertyDefinition")};at.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(Hi|cc);this.type!==O.braceR;){var n=this.parseStatement(null);e.body.push(n)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")};at.parseClassId=function(e,t){this.type===O.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,Zs,!1)):(t===!0&&this.unexpected(),e.id=null)};at.parseClassSuper=function(e){e.superClass=this.eat(O._extends)?this.parseExprSubscripts(null,!1):null};at.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared};at.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,n=e.used;if(this.options.checkPrivateFields)for(var r=this.privateNameStack.length,i=r===0?null:this.privateNameStack[r-1],a=0;a<n.length;++a){var l=n[a];Da(t,l.name)||(i?i.used.push(l):this.raiseRecoverable(l.start,"Private field '#"+l.name+"' must be declared in an enclosing class"))}};function j8(e,t){var n=t.key.name,r=e[n],i="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(i=(t.static?"s":"i")+t.kind),r==="iget"&&i==="iset"||r==="iset"&&i==="iget"||r==="sget"&&i==="sset"||r==="sset"&&i==="sget"?(e[n]="true",!1):r?!0:(e[n]=i,!1)}function Bl(e,t){var n=e.computed,r=e.key;return!n&&(r.type==="Identifier"&&r.name===t||r.type==="Literal"&&r.value===t)}at.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==O.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")};at.parseExport=function(e,t){if(this.next(),this.eat(O.star))return this.parseExportAllDeclaration(e,t);if(this.eat(O._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[]);else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==O.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var n=0,r=e.specifiers;n<r.length;n+=1){var i=r[n];this.checkUnreserved(i.local),this.checkLocalExport(i.local),i.local.type==="Literal"&&this.raise(i.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[])}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")};at.parseExportDeclaration=function(e){return this.parseStatement(null)};at.parseExportDefaultDeclaration=function(){var e;if(this.type===O._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,ro|Pg,!1,e)}else if(this.type===O._class){var n=this.startNode();return this.parseClass(n,"nullableID")}else{var r=this.parseMaybeAssign();return this.semicolon(),r}};at.checkExport=function(e,t,n){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),Da(e,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),e[t]=!0)};at.checkPatternExport=function(e,t){var n=t.type;if(n==="Identifier")this.checkExport(e,t,t.start);else if(n==="ObjectPattern")for(var r=0,i=t.properties;r<i.length;r+=1){var a=i[r];this.checkPatternExport(e,a)}else if(n==="ArrayPattern")for(var l=0,u=t.elements;l<u.length;l+=1){var h=u[l];h&&this.checkPatternExport(e,h)}else n==="Property"?this.checkPatternExport(e,t.value):n==="AssignmentPattern"?this.checkPatternExport(e,t.left):n==="RestElement"&&this.checkPatternExport(e,t.argument)};at.checkVariableExport=function(e,t){if(e)for(var n=0,r=t;n<r.length;n+=1){var i=r[n];this.checkPatternExport(e,i.id)}};at.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};at.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};at.parseExportSpecifiers=function(e){var t=[],n=!0;for(this.expect(O.braceL);!this.eat(O.braceR);){if(n)n=!1;else if(this.expect(O.comma),this.afterTrailingComma(O.braceR))break;t.push(this.parseExportSpecifier(e))}return t};at.parseImport=function(e){return this.next(),this.type===O.string?(e.specifiers=k8,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===O.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")};at.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,Zs),this.finishNode(e,"ImportSpecifier")};at.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,Zs),this.finishNode(e,"ImportDefaultSpecifier")};at.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,Zs),this.finishNode(e,"ImportNamespaceSpecifier")};at.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===O.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(O.comma)))return e;if(this.type===O.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(O.braceL);!this.eat(O.braceR);){if(t)t=!1;else if(this.expect(O.comma),this.afterTrailingComma(O.braceR))break;e.push(this.parseImportSpecifier())}return e};at.parseWithClause=function(){var e=[];if(!this.eat(O._with))return e;this.expect(O.braceL);for(var t={},n=!0;!this.eat(O.braceR);){if(n)n=!1;else if(this.expect(O.comma),this.afterTrailingComma(O.braceR))break;var r=this.parseImportAttribute(),i=r.key.type==="Identifier"?r.key.name:r.key.value;Da(t,i)&&this.raiseRecoverable(r.key.start,"Duplicate attribute key '"+i+"'"),t[i]=!0,e.push(r)}return e};at.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===O.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(O.colon),this.type!==O.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")};at.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===O.string){var e=this.parseLiteral(this.value);return x8.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)};at.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)};at.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var is=Kn.prototype;is.toAssignable=function(e,t,n){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,i=e.properties;r<i.length;r+=1){var a=i[r];this.toAssignable(a,t),a.type==="RestElement"&&(a.argument.type==="ArrayPattern"||a.argument.type==="ObjectPattern")&&this.raise(a.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return e};is.toAssignableList=function(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r];i&&this.toAssignable(i,t)}if(n){var a=e[n-1];this.options.ecmaVersion===6&&t&&a&&a.type==="RestElement"&&a.argument.type!=="Identifier"&&this.unexpected(a.argument.start)}return e};is.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")};is.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==O.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")};is.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case O.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(O.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case O.braceL:return this.parseObj(!0)}return this.parseIdent()};is.parseBindingList=function(e,t,n,r){for(var i=[],a=!0;!this.eat(e);)if(a?a=!1:this.expect(O.comma),t&&this.type===O.comma)i.push(null);else{if(n&&this.afterTrailingComma(e))break;if(this.type===O.ellipsis){var l=this.parseRestBinding();this.parseBindingListItem(l),i.push(l),this.type===O.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else i.push(this.parseAssignableListItem(r))}return i};is.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};is.parseBindingListItem=function(e){return e};is.parseMaybeDefault=function(e,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(O.eq))return n;var r=this.startNodeAt(e,t);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")};is.checkLValSimple=function(e,t,n){t===void 0&&(t=Pl);var r=t!==Pl;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(r?"Binding ":"Assigning to ")+e.name+" in strict mode"),r&&(t===Zs&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),n&&(Da(n,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),n[e.name]=!0),t!==zg&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":r&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return r&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,n);default:this.raise(e.start,(r?"Binding":"Assigning to")+" rvalue")}};is.checkLValPattern=function(e,t,n){switch(t===void 0&&(t=Pl),e.type){case"ObjectPattern":for(var r=0,i=e.properties;r<i.length;r+=1){var a=i[r];this.checkLValInnerPattern(a,t,n)}break;case"ArrayPattern":for(var l=0,u=e.elements;l<u.length;l+=1){var h=u[l];h&&this.checkLValInnerPattern(h,t,n)}break;default:this.checkLValSimple(e,t,n)}};is.checkLValInnerPattern=function(e,t,n){switch(t===void 0&&(t=Pl),e.type){case"Property":this.checkLValInnerPattern(e.value,t,n);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,n);break;case"RestElement":this.checkLValPattern(e.argument,t,n);break;default:this.checkLValPattern(e,t,n)}};var as=function(t,n,r,i,a){this.token=t,this.isExpr=!!n,this.preserveSpace=!!r,this.override=i,this.generator=!!a},_n={b_stat:new as("{",!1),b_expr:new as("{",!0),b_tmpl:new as("${",!1),p_stat:new as("(",!1),p_expr:new as("(",!0),q_tmpl:new as("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new as("function",!1),f_expr:new as("function",!0),f_expr_gen:new as("function",!0,!1,null,!0),f_gen:new as("function",!1,!1,null,!0)},Oa=Kn.prototype;Oa.initialContext=function(){return[_n.b_stat]};Oa.curContext=function(){return this.context[this.context.length-1]};Oa.braceIsBlock=function(e){var t=this.curContext();return t===_n.f_expr||t===_n.f_stat?!0:e===O.colon&&(t===_n.b_stat||t===_n.b_expr)?!t.isExpr:e===O._return||e===O.name&&this.exprAllowed?Dr.test(this.input.slice(this.lastTokEnd,this.start)):e===O._else||e===O.semi||e===O.eof||e===O.parenR||e===O.arrow?!0:e===O.braceL?t===_n.b_stat:e===O._var||e===O._const||e===O.name?!1:!this.exprAllowed};Oa.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1};Oa.updateContext=function(e){var t,n=this.type;n.keyword&&e===O.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,e):this.exprAllowed=n.beforeExpr};Oa.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)};O.parenR.updateContext=O.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===_n.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr};O.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?_n.b_stat:_n.b_expr),this.exprAllowed=!0};O.dollarBraceL.updateContext=function(){this.context.push(_n.b_tmpl),this.exprAllowed=!0};O.parenL.updateContext=function(e){var t=e===O._if||e===O._for||e===O._with||e===O._while;this.context.push(t?_n.p_stat:_n.p_expr),this.exprAllowed=!0};O.incDec.updateContext=function(){};O._function.updateContext=O._class.updateContext=function(e){e.beforeExpr&&e!==O._else&&!(e===O.semi&&this.curContext()!==_n.p_stat)&&!(e===O._return&&Dr.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===O.colon||e===O.braceL)&&this.curContext()===_n.b_stat)?this.context.push(_n.f_expr):this.context.push(_n.f_stat),this.exprAllowed=!1};O.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};O.backQuote.updateContext=function(){this.curContext()===_n.q_tmpl?this.context.pop():this.context.push(_n.q_tmpl),this.exprAllowed=!1};O.star.updateContext=function(e){if(e===O._function){var t=this.context.length-1;this.context[t]===_n.f_expr?this.context[t]=_n.f_expr_gen:this.context[t]=_n.f_gen}this.exprAllowed=!0};O.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==O.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var bt=Kn.prototype;bt.checkPropClash=function(e,t,n){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var r=e.key,i;switch(r.type){case"Identifier":i=r.name;break;case"Literal":i=String(r.value);break;default:return}var a=e.kind;if(this.options.ecmaVersion>=6){i==="__proto__"&&a==="init"&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=r.start):this.raiseRecoverable(r.start,"Redefinition of __proto__ property")),t.proto=!0);return}i="$"+i;var l=t[i];if(l){var u;a==="init"?u=this.strict&&l.init||l.get||l.set:u=l.init||l[a],u&&this.raiseRecoverable(r.start,"Redefinition of property")}else l=t[i]={init:!1,get:!1,set:!1};l[a]=!0}};bt.parseExpression=function(e,t){var n=this.start,r=this.startLoc,i=this.parseMaybeAssign(e,t);if(this.type===O.comma){var a=this.startNodeAt(n,r);for(a.expressions=[i];this.eat(O.comma);)a.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(a,"SequenceExpression")}return i};bt.parseMaybeAssign=function(e,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var r=!1,i=-1,a=-1,l=-1;t?(i=t.parenthesizedAssign,a=t.trailingComma,l=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new dc,r=!0);var u=this.start,h=this.startLoc;(this.type===O.parenL||this.type===O.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var f=this.parseMaybeConditional(e,t);if(n&&(f=n.call(this,f,u,h)),this.type.isAssign){var p=this.startNodeAt(u,h);return p.operator=this.value,this.type===O.eq&&(f=this.toAssignable(f,!1,t)),r||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=f.start&&(t.shorthandAssign=-1),this.type===O.eq?this.checkLValPattern(f):this.checkLValSimple(f),p.left=f,this.next(),p.right=this.parseMaybeAssign(e),l>-1&&(t.doubleProto=l),this.finishNode(p,"AssignmentExpression")}else r&&this.checkExpressionErrors(t,!0);return i>-1&&(t.parenthesizedAssign=i),a>-1&&(t.trailingComma=a),f};bt.parseMaybeConditional=function(e,t){var n=this.start,r=this.startLoc,i=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return i;if(this.eat(O.question)){var a=this.startNodeAt(n,r);return a.test=i,a.consequent=this.parseMaybeAssign(),this.expect(O.colon),a.alternate=this.parseMaybeAssign(e),this.finishNode(a,"ConditionalExpression")}return i};bt.parseExprOps=function(e,t){var n=this.start,r=this.startLoc,i=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||i.start===n&&i.type==="ArrowFunctionExpression"?i:this.parseExprOp(i,n,r,-1,e)};bt.parseExprOp=function(e,t,n,r,i){var a=this.type.binop;if(a!=null&&(!i||this.type!==O._in)&&a>r){var l=this.type===O.logicalOR||this.type===O.logicalAND,u=this.type===O.coalesce;u&&(a=O.logicalAND.binop);var h=this.value;this.next();var f=this.start,p=this.startLoc,g=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,i),f,p,a,i),y=this.buildBinary(t,n,e,g,h,l||u);return(l&&this.type===O.coalesce||u&&(this.type===O.logicalOR||this.type===O.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(y,t,n,r,i)}return e};bt.buildBinary=function(e,t,n,r,i,a){r.type==="PrivateIdentifier"&&this.raise(r.start,"Private identifier can only be left side of binary expression");var l=this.startNodeAt(e,t);return l.left=n,l.operator=i,l.right=r,this.finishNode(l,a?"LogicalExpression":"BinaryExpression")};bt.parseMaybeUnary=function(e,t,n,r){var i=this.start,a=this.startLoc,l;if(this.isContextual("await")&&this.canAwait)l=this.parseAwait(r),t=!0;else if(this.type.prefix){var u=this.startNode(),h=this.type===O.incDec;u.operator=this.value,u.prefix=!0,this.next(),u.argument=this.parseMaybeUnary(null,!0,h,r),this.checkExpressionErrors(e,!0),h?this.checkLValSimple(u.argument):this.strict&&u.operator==="delete"&&Bg(u.argument)?this.raiseRecoverable(u.start,"Deleting local variable in strict mode"):u.operator==="delete"&&id(u.argument)?this.raiseRecoverable(u.start,"Private fields can not be deleted"):t=!0,l=this.finishNode(u,h?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===O.privateId)(r||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),l=this.parsePrivateIdent(),this.type!==O._in&&this.unexpected();else{if(l=this.parseExprSubscripts(e,r),this.checkExpressionErrors(e))return l;for(;this.type.postfix&&!this.canInsertSemicolon();){var f=this.startNodeAt(i,a);f.operator=this.value,f.prefix=!1,f.argument=l,this.checkLValSimple(l),this.next(),l=this.finishNode(f,"UpdateExpression")}}if(!n&&this.eat(O.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(i,a,l,this.parseMaybeUnary(null,!1,!1,r),"**",!1);else return l};function Bg(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&Bg(e.expression)}function id(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&id(e.expression)||e.type==="ParenthesizedExpression"&&id(e.expression)}bt.parseExprSubscripts=function(e,t){var n=this.start,r=this.startLoc,i=this.parseExprAtom(e,t);if(i.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return i;var a=this.parseSubscripts(i,n,r,!1,t);return e&&a.type==="MemberExpression"&&(e.parenthesizedAssign>=a.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=a.start&&(e.parenthesizedBind=-1),e.trailingComma>=a.start&&(e.trailingComma=-1)),a};bt.parseSubscripts=function(e,t,n,r,i){for(var a=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,l=!1;;){var u=this.parseSubscript(e,t,n,r,a,l,i);if(u.optional&&(l=!0),u===e||u.type==="ArrowFunctionExpression"){if(l){var h=this.startNodeAt(t,n);h.expression=u,u=this.finishNode(h,"ChainExpression")}return u}e=u}};bt.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(O.arrow)};bt.parseSubscriptAsyncArrow=function(e,t,n,r){return this.parseArrowExpression(this.startNodeAt(e,t),n,!0,r)};bt.parseSubscript=function(e,t,n,r,i,a,l){var u=this.options.ecmaVersion>=11,h=u&&this.eat(O.questionDot);r&&h&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var f=this.eat(O.bracketL);if(f||h&&this.type!==O.parenL&&this.type!==O.backQuote||this.eat(O.dot)){var p=this.startNodeAt(t,n);p.object=e,f?(p.property=this.parseExpression(),this.expect(O.bracketR)):this.type===O.privateId&&e.type!=="Super"?p.property=this.parsePrivateIdent():p.property=this.parseIdent(this.options.allowReserved!=="never"),p.computed=!!f,u&&(p.optional=h),e=this.finishNode(p,"MemberExpression")}else if(!r&&this.eat(O.parenL)){var g=new dc,y=this.yieldPos,b=this.awaitPos,A=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var D=this.parseExprList(O.parenR,this.options.ecmaVersion>=8,!1,g);if(i&&!h&&this.shouldParseAsyncArrow())return this.checkPatternErrors(g,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=y,this.awaitPos=b,this.awaitIdentPos=A,this.parseSubscriptAsyncArrow(t,n,D,l);this.checkExpressionErrors(g,!0),this.yieldPos=y||this.yieldPos,this.awaitPos=b||this.awaitPos,this.awaitIdentPos=A||this.awaitIdentPos;var j=this.startNodeAt(t,n);j.callee=e,j.arguments=D,u&&(j.optional=h),e=this.finishNode(j,"CallExpression")}else if(this.type===O.backQuote){(h||a)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var w=this.startNodeAt(t,n);w.tag=e,w.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(w,"TaggedTemplateExpression")}return e};bt.parseExprAtom=function(e,t,n){this.type===O.slash&&this.readRegexp();var r,i=this.potentialArrowAt===this.start;switch(this.type){case O._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),r=this.startNode(),this.next(),this.type===O.parenL&&!this.allowDirectSuper&&this.raise(r.start,"super() call outside constructor of a subclass"),this.type!==O.dot&&this.type!==O.bracketL&&this.type!==O.parenL&&this.unexpected(),this.finishNode(r,"Super");case O._this:return r=this.startNode(),this.next(),this.finishNode(r,"ThisExpression");case O.name:var a=this.start,l=this.startLoc,u=this.containsEsc,h=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!u&&h.name==="async"&&!this.canInsertSemicolon()&&this.eat(O._function))return this.overrideContext(_n.f_expr),this.parseFunction(this.startNodeAt(a,l),0,!1,!0,t);if(i&&!this.canInsertSemicolon()){if(this.eat(O.arrow))return this.parseArrowExpression(this.startNodeAt(a,l),[h],!1,t);if(this.options.ecmaVersion>=8&&h.name==="async"&&this.type===O.name&&!u&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return h=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(O.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(a,l),[h],!0,t)}return h;case O.regexp:var f=this.value;return r=this.parseLiteral(f.value),r.regex={pattern:f.pattern,flags:f.flags},r;case O.num:case O.string:return this.parseLiteral(this.value);case O._null:case O._true:case O._false:return r=this.startNode(),r.value=this.type===O._null?null:this.type===O._true,r.raw=this.type.keyword,this.next(),this.finishNode(r,"Literal");case O.parenL:var p=this.start,g=this.parseParenAndDistinguishExpression(i,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(g)&&(e.parenthesizedAssign=p),e.parenthesizedBind<0&&(e.parenthesizedBind=p)),g;case O.bracketL:return r=this.startNode(),this.next(),r.elements=this.parseExprList(O.bracketR,!0,!0,e),this.finishNode(r,"ArrayExpression");case O.braceL:return this.overrideContext(_n.b_expr),this.parseObj(!1,e);case O._function:return r=this.startNode(),this.next(),this.parseFunction(r,0);case O._class:return this.parseClass(this.startNode(),!1);case O._new:return this.parseNew();case O.backQuote:return this.parseTemplate();case O._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}};bt.parseExprAtomDefault=function(){this.unexpected()};bt.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===O.parenL&&!e)return this.parseDynamicImport(t);if(this.type===O.dot){var n=this.startNodeAt(t.start,t.loc&&t.loc.start);return n.name="import",t.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};bt.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(O.parenR)?e.options=null:(this.expect(O.comma),this.afterTrailingComma(O.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(O.parenR)||(this.expect(O.comma),this.afterTrailingComma(O.parenR)||this.unexpected())));else if(!this.eat(O.parenR)){var t=this.start;this.eat(O.comma)&&this.eat(O.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")};bt.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")};bt.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.value!=null?t.value.toString():t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};bt.parseParenExpression=function(){this.expect(O.parenL);var e=this.parseExpression();return this.expect(O.parenR),e};bt.shouldParseArrow=function(e){return!this.canInsertSemicolon()};bt.parseParenAndDistinguishExpression=function(e,t){var n=this.start,r=this.startLoc,i,a=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var l=this.start,u=this.startLoc,h=[],f=!0,p=!1,g=new dc,y=this.yieldPos,b=this.awaitPos,A;for(this.yieldPos=0,this.awaitPos=0;this.type!==O.parenR;)if(f?f=!1:this.expect(O.comma),a&&this.afterTrailingComma(O.parenR,!0)){p=!0;break}else if(this.type===O.ellipsis){A=this.start,h.push(this.parseParenItem(this.parseRestBinding())),this.type===O.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else h.push(this.parseMaybeAssign(!1,g,this.parseParenItem));var D=this.lastTokEnd,j=this.lastTokEndLoc;if(this.expect(O.parenR),e&&this.shouldParseArrow(h)&&this.eat(O.arrow))return this.checkPatternErrors(g,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=y,this.awaitPos=b,this.parseParenArrowList(n,r,h,t);(!h.length||p)&&this.unexpected(this.lastTokStart),A&&this.unexpected(A),this.checkExpressionErrors(g,!0),this.yieldPos=y||this.yieldPos,this.awaitPos=b||this.awaitPos,h.length>1?(i=this.startNodeAt(l,u),i.expressions=h,this.finishNodeAt(i,"SequenceExpression",D,j)):i=h[0]}else i=this.parseParenExpression();if(this.options.preserveParens){var w=this.startNodeAt(n,r);return w.expression=i,this.finishNode(w,"ParenthesizedExpression")}else return i};bt.parseParenItem=function(e){return e};bt.parseParenArrowList=function(e,t,n,r){return this.parseArrowExpression(this.startNodeAt(e,t),n,!1,r)};var C8=[];bt.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===O.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var n=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var r=this.start,i=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),r,i,!0,!1),this.eat(O.parenL)?e.arguments=this.parseExprList(O.parenR,this.options.ecmaVersion>=8,!1):e.arguments=C8,this.finishNode(e,"NewExpression")};bt.parseTemplateElement=function(e){var t=e.isTagged,n=this.startNode();return this.type===O.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),n.tail=this.type===O.backQuote,this.finishNode(n,"TemplateElement")};bt.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:t});for(n.quasis=[r];!r.tail;)this.type===O.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(O.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(O.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")};bt.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===O.name||this.type===O.num||this.type===O.string||this.type===O.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===O.star)&&!Dr.test(this.input.slice(this.lastTokEnd,this.start))};bt.parseObj=function(e,t){var n=this.startNode(),r=!0,i={};for(n.properties=[],this.next();!this.eat(O.braceR);){if(r)r=!1;else if(this.expect(O.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(O.braceR))break;var a=this.parseProperty(e,t);e||this.checkPropClash(a,i,t),n.properties.push(a)}return this.finishNode(n,e?"ObjectPattern":"ObjectExpression")};bt.parseProperty=function(e,t){var n=this.startNode(),r,i,a,l;if(this.options.ecmaVersion>=9&&this.eat(O.ellipsis))return e?(n.argument=this.parseIdent(!1),this.type===O.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(n,"RestElement")):(n.argument=this.parseMaybeAssign(!1,t),this.type===O.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(n,"SpreadElement"));this.options.ecmaVersion>=6&&(n.method=!1,n.shorthand=!1,(e||t)&&(a=this.start,l=this.startLoc),e||(r=this.eat(O.star)));var u=this.containsEsc;return this.parsePropertyName(n),!e&&!u&&this.options.ecmaVersion>=8&&!r&&this.isAsyncProp(n)?(i=!0,r=this.options.ecmaVersion>=9&&this.eat(O.star),this.parsePropertyName(n)):i=!1,this.parsePropertyValue(n,e,r,i,a,l,t,u),this.finishNode(n,"Property")};bt.parseGetterSetter=function(e){var t=e.key.name;this.parsePropertyName(e),e.value=this.parseMethod(!1),e.kind=t;var n=e.kind==="get"?0:1;if(e.value.params.length!==n){var r=e.value.start;e.kind==="get"?this.raiseRecoverable(r,"getter should have no params"):this.raiseRecoverable(r,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")};bt.parsePropertyValue=function(e,t,n,r,i,a,l,u){(n||r)&&this.type===O.colon&&this.unexpected(),this.eat(O.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,l),e.kind="init"):this.options.ecmaVersion>=6&&this.type===O.parenL?(t&&this.unexpected(),e.method=!0,e.value=this.parseMethod(n,r),e.kind="init"):!t&&!u&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==O.comma&&this.type!==O.braceR&&this.type!==O.eq?((n||r)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((n||r)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=i),t?e.value=this.parseMaybeDefault(i,a,this.copyNode(e.key)):this.type===O.eq&&l?(l.shorthandAssign<0&&(l.shorthandAssign=this.start),e.value=this.parseMaybeDefault(i,a,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.kind="init",e.shorthand=!0):this.unexpected()};bt.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(O.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(O.bracketR),e.key;e.computed=!1}return e.key=this.type===O.num||this.type===O.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};bt.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)};bt.parseMethod=function(e,t,n){var r=this.startNode(),i=this.yieldPos,a=this.awaitPos,l=this.awaitIdentPos;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=e),this.options.ecmaVersion>=8&&(r.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Xd(t,r.generator)|cc|(n?Rg:0)),this.expect(O.parenL),r.params=this.parseBindingList(O.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1,!0,!1),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=l,this.finishNode(r,"FunctionExpression")};bt.parseArrowExpression=function(e,t,n,r){var i=this.yieldPos,a=this.awaitPos,l=this.awaitIdentPos;return this.enterScope(Xd(n,!1)|Jd),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,r),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=l,this.finishNode(e,"ArrowFunctionExpression")};bt.parseFunctionBody=function(e,t,n,r){var i=t&&this.type!==O.braceL,a=this.strict,l=!1;if(i)e.body=this.parseMaybeAssign(r),e.expression=!0,this.checkParams(e,!1);else{var u=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!a||u)&&(l=this.strictDirective(this.end),l&&u&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var h=this.labels;this.labels=[],l&&(this.strict=!0),this.checkParams(e,!a&&!l&&!t&&!n&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,zg),e.body=this.parseBlock(!1,void 0,l&&!a),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=h}this.exitScope()};bt.isSimpleParamList=function(e){for(var t=0,n=e;t<n.length;t+=1){var r=n[t];if(r.type!=="Identifier")return!1}return!0};bt.checkParams=function(e,t){for(var n=Object.create(null),r=0,i=e.params;r<i.length;r+=1){var a=i[r];this.checkLValInnerPattern(a,Kd,t?null:n)}};bt.parseExprList=function(e,t,n,r){for(var i=[],a=!0;!this.eat(e);){if(a)a=!1;else if(this.expect(O.comma),t&&this.afterTrailingComma(e))break;var l=void 0;n&&this.type===O.comma?l=null:this.type===O.ellipsis?(l=this.parseSpread(r),r&&this.type===O.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):l=this.parseMaybeAssign(!1,r),i.push(l)}return i};bt.checkUnreserved=function(e){var t=e.start,n=e.end,r=e.name;if(this.inGenerator&&r==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&r==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&uc)&&r==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(r==="arguments"||r==="await")&&this.raise(t,"Cannot use "+r+" in class static initialization block"),this.keywords.test(r)&&this.raise(t,"Unexpected keyword '"+r+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,n).indexOf("\\")!==-1)){var i=this.strict?this.reservedWordsStrict:this.reservedWords;i.test(r)&&(!this.inAsync&&r==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+r+"' is reserved"))}};bt.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};bt.parseIdentNode=function(){var e=this.startNode();return this.type===O.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=O.name):this.unexpected(),e};bt.parsePrivateIdent=function(){var e=this.startNode();return this.type===O.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e};bt.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===O.semi||this.canInsertSemicolon()||this.type!==O.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(O.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")};bt.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var Fl=Kn.prototype;Fl.raise=function(e,t){var n=Ng(this.input,e);t+=" ("+n.line+":"+n.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var r=new SyntaxError(t);throw r.pos=e,r.loc=n,r.raisedAt=this.pos,r};Fl.raiseRecoverable=Fl.raise;Fl.curPosition=function(){if(this.options.locations)return new yo(this.curLine,this.pos-this.lineStart)};var wi=Kn.prototype,T8=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};wi.enterScope=function(e){this.scopeStack.push(new T8(e))};wi.exitScope=function(){this.scopeStack.pop()};wi.treatFunctionsAsVarInScope=function(e){return e.flags&Ra||!this.inModule&&e.flags&xo};wi.declareName=function(e,t,n){var r=!1;if(t===Zs){var i=this.currentScope();r=i.lexical.indexOf(e)>-1||i.functions.indexOf(e)>-1||i.var.indexOf(e)>-1,i.lexical.push(e),this.inModule&&i.flags&xo&&delete this.undefinedExports[e]}else if(t===Vg){var a=this.currentScope();a.lexical.push(e)}else if(t===Og){var l=this.currentScope();this.treatFunctionsAsVar?r=l.lexical.indexOf(e)>-1:r=l.lexical.indexOf(e)>-1||l.var.indexOf(e)>-1,l.functions.push(e)}else for(var u=this.scopeStack.length-1;u>=0;--u){var h=this.scopeStack[u];if(h.lexical.indexOf(e)>-1&&!(h.flags&Dg&&h.lexical[0]===e)||!this.treatFunctionsAsVarInScope(h)&&h.functions.indexOf(e)>-1){r=!0;break}if(h.var.push(e),this.inModule&&h.flags&xo&&delete this.undefinedExports[e],h.flags&uc)break}r&&this.raiseRecoverable(n,"Identifier '"+e+"' has already been declared")};wi.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)};wi.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};wi.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(uc|Ao|Hi))return t}};wi.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(uc|Ao|Hi)&&!(t.flags&Jd))return t}};var hc=function(t,n,r){this.type="",this.start=n,this.end=0,t.options.locations&&(this.loc=new lc(t,r)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[n,0])},_o=Kn.prototype;_o.startNode=function(){return new hc(this,this.start,this.startLoc)};_o.startNodeAt=function(e,t){return new hc(this,e,t)};function Fg(e,t,n,r){return e.type=t,e.end=n,this.options.locations&&(e.loc.end=r),this.options.ranges&&(e.range[1]=n),e}_o.finishNode=function(e,t){return Fg.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)};_o.finishNodeAt=function(e,t,n,r){return Fg.call(this,e,t,n,r)};_o.copyNode=function(e){var t=new hc(this,e.start,this.startLoc);for(var n in e)t[n]=e[n];return t};var I8="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",Lg="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",$g=Lg+" Extended_Pictographic",Gg=$g,Hg=Gg+" EBase EComp EMod EPres ExtPict",qg=Hg,A8=qg,_8={9:Lg,10:$g,11:Gg,12:Hg,13:qg,14:A8},E8="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",N8={9:"",10:"",11:"",12:"",13:"",14:E8},Ff="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Ug="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Wg=Ug+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Zg=Wg+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Yg=Zg+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",Jg=Yg+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",M8=Jg+" "+I8,D8={9:Ug,10:Wg,11:Zg,12:Yg,13:Jg,14:M8},Xg={};function R8(e){var t=Xg[e]={binary:oi(_8[e]+" "+Ff),binaryOfStrings:oi(N8[e]),nonBinary:{General_Category:oi(Ff),Script:oi(D8[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var pu=0,Lf=[9,10,11,12,13,14];pu<Lf.length;pu+=1){var O8=Lf[pu];R8(O8)}var st=Kn.prototype,Ll=function(t,n){this.parent=t,this.base=n||this};Ll.prototype.separatedFrom=function(t){for(var n=this;n;n=n.parent)for(var r=t;r;r=r.parent)if(n.base===r.base&&n!==r)return!0;return!1};Ll.prototype.sibling=function(){return new Ll(this.parent,this.base)};var _s=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=Xg[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};_s.prototype.reset=function(t,n,r){var i=r.indexOf("v")!==-1,a=r.indexOf("u")!==-1;this.start=t|0,this.source=n+"",this.flags=r,i&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=a&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=a&&this.parser.options.ecmaVersion>=9)};_s.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};_s.prototype.at=function(t,n){n===void 0&&(n=!1);var r=this.source,i=r.length;if(t>=i)return-1;var a=r.charCodeAt(t);if(!(n||this.switchU)||a<=55295||a>=57344||t+1>=i)return a;var l=r.charCodeAt(t+1);return l>=56320&&l<=57343?(a<<10)+l-56613888:a};_s.prototype.nextIndex=function(t,n){n===void 0&&(n=!1);var r=this.source,i=r.length;if(t>=i)return i;var a=r.charCodeAt(t),l;return!(n||this.switchU)||a<=55295||a>=57344||t+1>=i||(l=r.charCodeAt(t+1))<56320||l>57343?t+1:t+2};_s.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};_s.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};_s.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};_s.prototype.eat=function(t,n){return n===void 0&&(n=!1),this.current(n)===t?(this.advance(n),!0):!1};_s.prototype.eatChars=function(t,n){n===void 0&&(n=!1);for(var r=this.pos,i=0,a=t;i<a.length;i+=1){var l=a[i],u=this.at(r,n);if(u===-1||u!==l)return!1;r=this.nextIndex(r,n)}return this.pos=r,!0};st.validateRegExpFlags=function(e){for(var t=e.validFlags,n=e.flags,r=!1,i=!1,a=0;a<n.length;a++){var l=n.charAt(a);t.indexOf(l)===-1&&this.raise(e.start,"Invalid regular expression flag"),n.indexOf(l,a+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),l==="u"&&(r=!0),l==="v"&&(i=!0)}this.options.ecmaVersion>=15&&r&&i&&this.raise(e.start,"Invalid regular expression flag")};function V8(e){for(var t in e)return!0;return!1}st.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&V8(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))};st.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,n=e.backReferenceNames;t<n.length;t+=1){var r=n[t];e.groupNames[r]||e.raise("Invalid named capture referenced")}};st.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new Ll(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")};st.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););};st.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1};st.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!n,!0}return e.pos=t,!1};st.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1};st.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)};st.regexp_eatBracedQuantifier=function(e,t){var n=e.pos;if(e.eat(123)){var r=0,i=-1;if(this.regexp_eatDecimalDigits(e)&&(r=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue),e.eat(125)))return i!==-1&&i<r&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=n}return!1};st.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)};st.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1};st.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var n=this.regexp_eatModifiers(e),r=e.eat(45);if(n||r){for(var i=0;i<n.length;i++){var a=n.charAt(i);n.indexOf(a,i+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(r){var l=this.regexp_eatModifiers(e);!n&&!l&&e.current()===58&&e.raise("Invalid regular expression modifiers");for(var u=0;u<l.length;u++){var h=l.charAt(u);(l.indexOf(h,u+1)>-1||n.indexOf(h)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1};st.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1};st.regexp_eatModifiers=function(e){for(var t="",n=0;(n=e.current())!==-1&&z8(n);)t+=qs(n),e.advance();return t};function z8(e){return e===105||e===109||e===115}st.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)};st.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1};st.regexp_eatSyntaxCharacter=function(e){var t=e.current();return Kg(t)?(e.lastIntValue=t,e.advance(),!0):!1};function Kg(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}st.regexp_eatPatternCharacters=function(e){for(var t=e.pos,n=0;(n=e.current())!==-1&&!Kg(n);)e.advance();return e.pos!==t};st.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1};st.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,n=e.groupNames[e.lastStringValue];if(n)if(t)for(var r=0,i=n;r<i.length;r+=1){var a=i[r];a.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(n||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}};st.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1};st.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=qs(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=qs(e.lastIntValue);return!0}return!1};st.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,r=e.current(n);return e.advance(n),r===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(r=e.lastIntValue),P8(r)?(e.lastIntValue=r,!0):(e.pos=t,!1)};function P8(e){return Ts(e,!0)||e===36||e===95}st.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,n=this.options.ecmaVersion>=11,r=e.current(n);return e.advance(n),r===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,n)&&(r=e.lastIntValue),B8(r)?(e.lastIntValue=r,!0):(e.pos=t,!1)};function B8(e){return xi(e,!0)||e===36||e===95||e===8204||e===8205}st.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)};st.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var n=e.lastIntValue;if(e.switchU)return n>e.maxBackReference&&(e.maxBackReference=n),!0;if(n<=e.numCapturingParens)return!0;e.pos=t}return!1};st.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1};st.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)};st.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1};st.regexp_eatZero=function(e){return e.current()===48&&!fc(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1};st.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1};st.regexp_eatControlLetter=function(e){var t=e.current();return Qg(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function Qg(e){return e>=65&&e<=90||e>=97&&e<=122}st.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var n=e.pos,r=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var i=e.lastIntValue;if(r&&i>=55296&&i<=56319){var a=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var l=e.lastIntValue;if(l>=56320&&l<=57343)return e.lastIntValue=(i-55296)*1024+(l-56320)+65536,!0}e.pos=a,e.lastIntValue=i}return!0}if(r&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&F8(e.lastIntValue))return!0;r&&e.raise("Invalid unicode escape"),e.pos=n}return!1};function F8(e){return e>=0&&e<=1114111}st.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1};st.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var e1=0,Us=1,es=2;st.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(L8(t))return e.lastIntValue=-1,e.advance(),Us;var n=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((n=t===80)||t===112)){e.lastIntValue=-1,e.advance();var r;if(e.eat(123)&&(r=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return n&&r===es&&e.raise("Invalid property name"),r;e.raise("Invalid property name")}return e1};function L8(e){return e===100||e===68||e===115||e===83||e===119||e===87}st.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var n=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var r=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,n,r),Us}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,i)}return e1};st.regexp_validateUnicodePropertyNameAndValue=function(e,t,n){Da(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(n)||e.raise("Invalid property value")};st.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return Us;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return es;e.raise("Invalid property name")};st.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";t1(t=e.current());)e.lastStringValue+=qs(t),e.advance();return e.lastStringValue!==""};function t1(e){return Qg(e)||e===95}st.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";$8(t=e.current());)e.lastStringValue+=qs(t),e.advance();return e.lastStringValue!==""};function $8(e){return t1(e)||fc(e)}st.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)};st.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),n=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&n===es&&e.raise("Negated character class may contain strings"),!0}return!1};st.regexp_classContents=function(e){return e.current()===93?Us:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),Us)};st.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var n=e.lastIntValue;e.switchU&&(t===-1||n===-1)&&e.raise("Invalid character class"),t!==-1&&n!==-1&&t>n&&e.raise("Range out of order in character class")}}};st.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var n=e.current();(n===99||s1(n))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var r=e.current();return r!==93?(e.lastIntValue=r,e.advance(),!0):!1};st.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)};st.regexp_classSetExpression=function(e){var t=Us,n;if(!this.regexp_eatClassSetRange(e))if(n=this.regexp_eatClassSetOperand(e)){n===es&&(t=es);for(var r=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(n=this.regexp_eatClassSetOperand(e))){n!==es&&(t=Us);continue}e.raise("Invalid character in character class")}if(r!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(r!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(n=this.regexp_eatClassSetOperand(e),!n)return t;n===es&&(t=es)}};st.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var n=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var r=e.lastIntValue;return n!==-1&&r!==-1&&n>r&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1};st.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?Us:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)};st.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var n=e.eat(94),r=this.regexp_classContents(e);if(e.eat(93))return n&&r===es&&e.raise("Negated character class may contain strings"),r;e.pos=t}if(e.eat(92)){var i=this.regexp_eatCharacterClassEscape(e);if(i)return i;e.pos=t}return null};st.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var n=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return n}else e.raise("Invalid escape");e.pos=t}return null};st.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===es&&(t=es);return t};st.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?Us:es};st.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var n=e.current();return n<0||n===e.lookahead()&&G8(n)||H8(n)?!1:(e.advance(),e.lastIntValue=n,!0)};function G8(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function H8(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}st.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return q8(t)?(e.lastIntValue=t,e.advance(),!0):!1};function q8(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}st.regexp_eatClassControlLetter=function(e){var t=e.current();return fc(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1};st.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1};st.regexp_eatDecimalDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;fc(n=e.current());)e.lastIntValue=10*e.lastIntValue+(n-48),e.advance();return e.pos!==t};function fc(e){return e>=48&&e<=57}st.regexp_eatHexDigits=function(e){var t=e.pos,n=0;for(e.lastIntValue=0;n1(n=e.current());)e.lastIntValue=16*e.lastIntValue+r1(n),e.advance();return e.pos!==t};function n1(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function r1(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}st.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var n=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+n*8+e.lastIntValue:e.lastIntValue=t*8+n}else e.lastIntValue=t;return!0}return!1};st.regexp_eatOctalDigit=function(e){var t=e.current();return s1(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function s1(e){return e>=48&&e<=55}st.regexp_eatFixedHexDigits=function(e,t){var n=e.pos;e.lastIntValue=0;for(var r=0;r<t;++r){var i=e.current();if(!n1(i))return e.pos=n,!1;e.lastIntValue=16*e.lastIntValue+r1(i),e.advance()}return!0};var e0=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new lc(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},Ot=Kn.prototype;Ot.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new e0(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};Ot.getToken=function(){return this.next(),new e0(this)};typeof Symbol<"u"&&(Ot[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===O.eof,value:t}}}});Ot.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(O.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())};Ot.readToken=function(e){return Ts(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)};Ot.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888};Ot.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(n===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var r=void 0,i=t;(r=Ag(this.input,i,this.pos))>-1;)++this.curLine,i=this.lineStart=r;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,n),t,this.pos,e,this.curPosition())};Ot.skipLineComment=function(e){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!Ma(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,n,this.curPosition())};Ot.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&_g.test(String.fromCharCode(e)))++this.pos;else break e}}};Ot.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=e,this.value=t,this.updateContext(n)};Ot.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(O.ellipsis)):(++this.pos,this.finishToken(O.dot))};Ot.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(O.assign,2):this.finishOp(O.slash,1)};Ot.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),n=1,r=e===42?O.star:O.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++n,r=O.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(O.assign,n+1):this.finishOp(r,n)};Ot.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(O.assign,3)}return this.finishOp(e===124?O.logicalOR:O.logicalAND,2)}return t===61?this.finishOp(O.assign,2):this.finishOp(e===124?O.bitwiseOR:O.bitwiseAND,1)};Ot.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(O.assign,2):this.finishOp(O.bitwiseXOR,1)};Ot.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Dr.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(O.incDec,2):t===61?this.finishOp(O.assign,2):this.finishOp(O.plusMin,1)};Ot.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),n=1;return t===e?(n=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+n)===61?this.finishOp(O.assign,n+1):this.finishOp(O.bitShift,n)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(n=2),this.finishOp(O.relational,n))};Ot.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(O.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(O.arrow)):this.finishOp(e===61?O.eq:O.prefix,1)};Ot.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(O.questionDot,2)}if(t===63){if(e>=12){var r=this.input.charCodeAt(this.pos+2);if(r===61)return this.finishOp(O.assign,3)}return this.finishOp(O.coalesce,2)}}return this.finishOp(O.question,1)};Ot.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),Ts(t,!0)||t===92))return this.finishToken(O.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+qs(t)+"'")};Ot.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(O.parenL);case 41:return++this.pos,this.finishToken(O.parenR);case 59:return++this.pos,this.finishToken(O.semi);case 44:return++this.pos,this.finishToken(O.comma);case 91:return++this.pos,this.finishToken(O.bracketL);case 93:return++this.pos,this.finishToken(O.bracketR);case 123:return++this.pos,this.finishToken(O.braceL);case 125:return++this.pos,this.finishToken(O.braceR);case 58:return++this.pos,this.finishToken(O.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(O.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(O.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+qs(e)+"'")};Ot.finishOp=function(e,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,n)};Ot.readRegexp=function(){for(var e,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(Dr.test(r)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if(r==="[")t=!0;else if(r==="]"&&t)t=!1;else if(r==="/"&&!t)break;e=r==="\\"}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var a=this.pos,l=this.readWord1();this.containsEsc&&this.unexpected(a);var u=this.regexpState||(this.regexpState=new _s(this));u.reset(n,i,l),this.validateRegExpFlags(u),this.validateRegExpPattern(u);var h=null;try{h=new RegExp(i,l)}catch{}return this.finishToken(O.regexp,{pattern:i,flags:l,value:h})};Ot.readInt=function(e,t,n){for(var r=this.options.ecmaVersion>=12&&t===void 0,i=n&&this.input.charCodeAt(this.pos)===48,a=this.pos,l=0,u=0,h=0,f=t??1/0;h<f;++h,++this.pos){var p=this.input.charCodeAt(this.pos),g=void 0;if(r&&p===95){i&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),u===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),h===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),u=p;continue}if(p>=97?g=p-97+10:p>=65?g=p-65+10:p>=48&&p<=57?g=p-48:g=1/0,g>=e)break;u=p,l=l*e+g}return r&&u===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===a||t!=null&&this.pos-a!==t?null:l};function U8(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function i1(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}Ot.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var n=this.readInt(e);return n==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(n=i1(this.input.slice(t,this.pos)),++this.pos):Ts(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(O.num,n)};Ot.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var n=this.pos-t>=2&&this.input.charCodeAt(t)===48;n&&this.strict&&this.raise(t,"Invalid number");var r=this.input.charCodeAt(this.pos);if(!n&&!e&&this.options.ecmaVersion>=11&&r===110){var i=i1(this.input.slice(t,this.pos));return++this.pos,Ts(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(O.num,i)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),r===46&&!n&&(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),(r===69||r===101)&&!n&&(r=this.input.charCodeAt(++this.pos),(r===43||r===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),Ts(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a=U8(this.input.slice(t,this.pos),n);return this.finishToken(O.num,a)};Ot.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var n=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(n,"Code point out of bounds")}else t=this.readHexChar(4);return t};Ot.readString=function(e){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var r=this.input.charCodeAt(this.pos);if(r===e)break;r===92?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):r===8232||r===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(Ma(r)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(O.string,t)};var a1={};Ot.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===a1)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1};Ot.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw a1;this.raise(e,t)};Ot.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(n===96||n===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===O.template||this.type===O.invalidTemplate)?n===36?(this.pos+=2,this.finishToken(O.dollarBraceL)):(++this.pos,this.finishToken(O.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(O.template,e));if(n===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(Ma(n)){switch(e+=this.input.slice(t,this.pos),++this.pos,n){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(n);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};Ot.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(O.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};Ot.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return qs(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(r,8);return i>255&&(r=r.slice(0,-1),i=parseInt(r,8)),this.pos+=r.length-1,t=this.input.charCodeAt(this.pos),(r!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-r.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return Ma(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};Ot.readHexChar=function(e){var t=this.pos,n=this.readInt(16,e);return n===null&&this.invalidStringToken(t,"Bad character escape sequence"),n};Ot.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,n=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(xi(i,r))this.pos+=i<=65535?1:2;else if(i===92){this.containsEsc=!0,e+=this.input.slice(n,this.pos);var a=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var l=this.readCodePoint();(t?Ts:xi)(l,r)||this.invalidStringToken(a,"Invalid Unicode escape"),e+=qs(l),n=this.pos}else break;t=!1}return e+this.input.slice(n,this.pos)};Ot.readWord=function(){var e=this.readWord1(),t=O.name;return this.keywords.test(e)&&(t=Zd[e]),this.finishToken(t,e)};var W8="8.15.0";Kn.acorn={Parser:Kn,version:W8,defaultOptions:rd,Position:yo,SourceLocation:lc,getLineInfo:Ng,Node:hc,TokenType:Wt,tokTypes:O,keywordTypes:Zd,TokContext:as,tokContexts:_n,isIdentifierChar:xi,isIdentifierStart:Ts,Token:e0,isNewLine:Ma,lineBreak:Dr,lineBreakG:m8,nonASCIIwhitespace:_g};function Z8(e,t){return Kn.parse(e,t)}class Nr{static parseExpression(t){try{const n=Z8(t,{ecmaVersion:2020,sourceType:"module",allowReturnOutsideFunction:!0,allowAwaitOutsideFunction:!0}),r=this.convertAcornNode(n.body[0]);return r.metadata={astVersion:this.AST_VERSION,validationErrors:[],complexity:this.calculateComplexity(r)},r}catch(n){return{type:"literal",value:t,metadata:{astVersion:this.AST_VERSION,validationErrors:[n instanceof Error?n.message:String(n)],complexity:"low"}}}}static generateJavaScript(t){var n;switch(t.type){case"binary":{if(!t.left||!t.right||!t.operator)throw new Error("Invalid binary operation: missing left, right, or operator");return`(${this.generateJavaScript(t.left)} ${t.operator} ${this.generateJavaScript(t.right)})`}case"unary":{if(!t.operand||!t.operator)throw new Error("Invalid unary operation: missing operand or operator");return`${t.operator}${this.generateJavaScript(t.operand)}`}case"variable":{if(!t.variableName)throw new Error("Invalid variable: missing variable name");return t.variableName}case"literal":{if(t.value===void 0)throw new Error("Invalid literal: missing value");return typeof t.value=="string"?`"${t.value}"`:String(t.value)}case"function":{if(!t.functionName)throw new Error("Invalid function call: missing function name");const r=((n=t.arguments)==null?void 0:n.map(i=>this.generateJavaScript(i)).join(", "))||"";return`${t.functionName}(${r})`}case"assignment":{if(!t.variableName||!t.expression)throw new Error("Invalid assignment: missing variable name or expression");return`${t.variableName} = ${this.generateJavaScript(t.expression)}`}case"group":{if(!t.body)throw new Error("Invalid group: missing body expression");return`(${this.generateJavaScript(t.body)})`}default:throw new Error(`Unsupported AST node type: ${t.type}`)}}static validateAST(t){const n=[];try{if(!t||typeof t!="object")return n.push("Invalid AST structure: AST must be an object"),n;t.type||n.push("Missing required field: type"),this.validateNode(t,n),this.checkCommonIssues(t,n)}catch(r){n.push(`Validation error: ${r instanceof Error?r.message:"Unknown error"}`)}return n}static validateNode(t,n){if(t)switch(t.type){case"binary":(!t.left||!t.right||!t.operator)&&n.push("Invalid binary expression: missing left, right, or operator"),this.validateNode(t.left,n),this.validateNode(t.right,n);break;case"unary":(!t.operand||!t.operator)&&n.push("Invalid unary expression: missing operand or operator"),this.validateNode(t.operand,n);break;case"function":t.functionName||n.push("Invalid function call: missing function name"),t.arguments&&t.arguments.forEach(r=>{this.validateNode(r,n)});break;case"variable":t.variableName||n.push("Invalid variable: missing variable name");break;case"literal":t.value===void 0&&n.push("Invalid literal: missing value");break;case"assignment":t.variableName||n.push("Invalid assignment: missing variable name"),t.expression||n.push("Invalid assignment: missing expression"),t.expression&&this.validateNode(t.expression,n);break;case"group":t.body||n.push("Invalid group: missing body expression"),t.body&&this.validateNode(t.body,n);break}}static checkCommonIssues(t,n){var r;if(t.type==="binary"&&t.operator==="/"&&((r=t.right)==null?void 0:r.type)==="literal"&&t.right.value===0&&n.push("Warning: Division by zero detected"),t.type==="variable"&&t.variableName&&!["n","base","exponent","value","value1","value2"].includes(t.variableName)&&!t.variableName.startsWith("system_")&&n.push(`Warning: Variable '${t.variableName}' may be undefined`),t.type==="binary"||t.type==="function"){const i=this.calculateComplexityScore(t);i>5&&n.push(`Warning: Complex expression detected (complexity: ${i}). Consider breaking into smaller parts.`)}t.left&&this.checkCommonIssues(t.left,n),t.right&&this.checkCommonIssues(t.right,n),t.operand&&this.checkCommonIssues(t.operand,n),t.expression&&this.checkCommonIssues(t.expression,n),t.body&&this.checkCommonIssues(t.body,n),t.arguments&&t.arguments.forEach(i=>{this.checkCommonIssues(i,n)})}static convertAcornNode(t){switch(t.type){case"ExpressionStatement":return this.convertAcornNode(t.expression);case"BinaryExpression":{const n=t;return{type:"binary",operator:n.operator,left:this.convertAcornNode(n.left),right:this.convertAcornNode(n.right)}}case"UnaryExpression":{const n=t;return{type:"unary",operator:n.operator,operand:this.convertAcornNode(n.argument)}}case"Identifier":return{type:"variable",variableName:t.name};case"Literal":{const n=t;return{type:"literal",value:n.value===null?void 0:n.value}}case"CallExpression":{const n=t;return{type:"function",functionName:this.getFunctionName(n.callee),arguments:n.arguments.map(r=>this.convertAcornNode(r))}}case"AssignmentExpression":{const n=t;return{type:"assignment",variableName:n.left.name,expression:this.convertAcornNode(n.right)}}case"ParenthesizedExpression":{const n=t;return{type:"group",body:this.convertAcornNode(n.expression)}}case"MemberExpression":{const n=t;return n.object.name==="Math"&&n.property.type==="Identifier"?{type:"function",functionName:`Math.${n.property.name}`,arguments:[]}:{type:"literal",value:this.generateMemberExpression(n)}}default:return{type:"literal",value:this.generateCodeFromNode(t)}}}static getFunctionName(t){if(t.type==="Identifier")return t.name;if(t.type==="MemberExpression"){const n=t;return`${this.getFunctionName(n.object)}.${n.property.name}`}return"unknown"}static generateMemberExpression(t){return t.object.type==="Identifier"&&t.property.type==="Identifier"?`${t.object.name}.${t.property.name}`:"unknown"}static generateCodeFromNode(t){return JSON.stringify(t)}static calculateComplexity(t){const n=this.calculateComplexityScore(t);return n<=3?"low":n<=8?"medium":"high"}static calculateComplexityScore(t){let n=1;switch(t.type){case"binary":n+=this.calculateComplexityScore(t.left),n+=this.calculateComplexityScore(t.right);break;case"unary":n+=this.calculateComplexityScore(t.operand);break;case"function":n+=2,t.arguments&&t.arguments.forEach(r=>{n+=this.calculateComplexityScore(r)});break;case"group":t.body&&(n+=this.calculateComplexityScore(t.body));break;case"assignment":t.expression&&(n+=this.calculateComplexityScore(t.expression));break}return n}static extractVariables(t){const n=[],r=i=>{switch(i.type==="variable"&&i.variableName&&n.push(i.variableName),i.type){case"binary":i.left&&r(i.left),i.right&&r(i.right);break;case"unary":i.operand&&r(i.operand);break;case"function":i.arguments&&i.arguments.forEach(a=>r(a));break;case"assignment":i.expression&&r(i.expression);break;case"group":i.body&&r(i.body);break}};return r(t),[...new Set(n)]}static optimizeExpression(t){if(!t)return t;try{const n=this.cloneAST(t);return this.constantFolding(n),this.removeRedundantOperations(n),this.simplifyExpressions(n),n}catch(n){return console.warn("Expression optimization failed:",n),t}}static constantFolding(t){var n;if(t)switch(t.type){case"binary":if(t.left&&t.right&&(this.constantFolding(t.left),this.constantFolding(t.right),t.left.type==="literal"&&t.right.type==="literal")){const r=Number(t.left.value),i=Number(t.right.value);if(!isNaN(r)&&!isNaN(i)){let a;switch(t.operator){case"+":a=r+i;break;case"-":a=r-i;break;case"*":a=r*i;break;case"/":a=i!==0?r/i:NaN;break;case"^":a=Math.pow(r,i);break;default:return}isNaN(a)||(t.type="literal",t.value=a,delete t.left,delete t.right,delete t.operator)}}break;case"unary":if(t.operand&&(this.constantFolding(t.operand),t.operand.type==="literal")){const r=Number(t.operand.value);if(!isNaN(r)){let i;switch(t.operator){case"-":i=-r;break;case"!":i=r?0:1;break;default:return}t.type="literal",t.value=i,delete t.operand,delete t.operator}}break;case"function":if(t.arguments&&(t.arguments.forEach(r=>this.constantFolding(r)),(n=t.functionName)!=null&&n.startsWith("Math.")&&t.arguments.length>0&&t.arguments.every(i=>i.type==="literal"))){const i=t.arguments.map(a=>Number(a.value));if(i.every(a=>!isNaN(a))){let a;switch(t.functionName){case"Math.abs":a=Math.abs(i[0]);break;case"Math.round":a=Math.round(i[0]);break;case"Math.floor":a=Math.floor(i[0]);break;case"Math.ceil":a=Math.ceil(i[0]);break;case"Math.sqrt":a=Math.sqrt(i[0]);break;case"Math.pow":a=Math.pow(i[0],i[1]);break;case"Math.min":a=Math.min(...i);break;case"Math.max":a=Math.max(...i);break;default:return}isNaN(a)||(t.type="literal",t.value=a,delete t.functionName,delete t.arguments)}}break;case"group":t.body&&this.constantFolding(t.body);break;case"assignment":t.expression&&this.constantFolding(t.expression);break}}static removeRedundantOperations(t){if(t)switch(t.type){case"binary":if(t.left&&t.right){if(this.removeRedundantOperations(t.left),this.removeRedundantOperations(t.right),t.operator==="+"&&t.right.type==="literal"&&t.right.value===0){this.replaceNode(t,t.left);return}if(t.operator==="+"&&t.left.type==="literal"&&t.left.value===0){this.replaceNode(t,t.right);return}if(t.operator==="*"&&t.right.type==="literal"&&t.right.value===1){this.replaceNode(t,t.left);return}if(t.operator==="*"&&t.left.type==="literal"&&t.left.value===1){this.replaceNode(t,t.right);return}if(t.operator==="^"&&t.right.type==="literal"&&t.right.value===1){this.replaceNode(t,t.left);return}if(t.operator==="^"&&t.right.type==="literal"&&t.right.value===0){t.type="literal",t.value=1,delete t.left,delete t.right,delete t.operator;return}}break;case"unary":if(t.operand&&(this.removeRedundantOperations(t.operand),t.operator==="-"&&t.operand.type==="unary"&&t.operand.operator==="-")){this.replaceNode(t,t.operand.operand);return}break;case"group":if(t.body&&(this.removeRedundantOperations(t.body),t.body.type==="literal"||t.body.type==="variable")){this.replaceNode(t,t.body);return}break;case"function":t.arguments&&t.arguments.forEach(n=>this.removeRedundantOperations(n));break;case"assignment":t.expression&&this.removeRedundantOperations(t.expression);break}}static simplifyExpressions(t){if(t)switch(t.type){case"binary":t.left&&t.right&&(this.simplifyExpressions(t.left),this.simplifyExpressions(t.right),t.operator==="+"&&t.left.type==="variable"&&t.right.type==="variable"&&t.left.variableName===t.right.variableName&&(t.operator="*",t.left={type:"literal",value:2}));break;case"unary":t.operand&&this.simplifyExpressions(t.operand);break;case"group":t.body&&this.simplifyExpressions(t.body);break;case"function":t.arguments&&t.arguments.forEach(n=>this.simplifyExpressions(n));break;case"assignment":t.expression&&this.simplifyExpressions(t.expression);break}}static cloneAST(t){if(!t)return t;const n={type:t.type};return t.operator&&(n.operator=t.operator),t.value!==void 0&&(n.value=t.value),t.variableName&&(n.variableName=t.variableName),t.functionName&&(n.functionName=t.functionName),t.expression&&(n.expression=this.cloneAST(t.expression)),t.body&&(n.body=this.cloneAST(t.body)),t.left&&(n.left=this.cloneAST(t.left)),t.right&&(n.right=this.cloneAST(t.right)),t.operand&&(n.operand=this.cloneAST(t.operand)),t.arguments&&(n.arguments=t.arguments.map(r=>this.cloneAST(r))),t.metadata&&(n.metadata={...t.metadata}),n}static replaceNode(t,n){Object.assign(t,n)}static generateCode(t){var n;if(!t)return"";try{switch(t.type){case"literal":return String(t.value);case"variable":return t.variableName||"";case"binary":{const r=this.generateCode(t.left),i=this.generateCode(t.right);return`${r} ${t.operator} ${i}`}case"unary":{const r=this.generateCode(t.operand);return`${t.operator}${r}`}case"function":{const r=((n=t.arguments)==null?void 0:n.map(i=>this.generateCode(i)).join(", "))||"";return`${t.functionName}(${r})`}case"group":return`(${this.generateCode(t.body)})`;case"assignment":{const r=this.generateCode(t.expression);return`${t.variableName} = ${r}`}default:return""}}catch(r){return console.warn("Code generation failed:",r),""}}}bs(Nr,"AST_VERSION","1.0.0");class ri{static getAllVariableMappings(t){const n=ar.getSystemVariables(),r=t.map(a=>({id:a.id,name:a.name,type:"algorithm"})),i=n.map(a=>({id:a.id,name:a.name,type:"system"}));return[...r,...i]}static getVariableNameById(t,n){const r=n.find(i=>i.id===t);return r?r.name:ar.getVariableNameById(t)}static getVariableIdByName(t,n){const r=n.find(i=>i.name===t);return r?r.id:ar.getVariableIdByName(t)}static convertFormulaToIds(t,n){const r=this.getAllVariableMappings(n);return t.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\b/g,(i,a)=>{if(["Math","Array","Object","String","Number","Boolean","Date","RegExp","Function","undefined","null","true","false","NaN","Infinity"].includes(a)||/^\d+(\.\d+)?$/.test(a))return i;const u=r.find(h=>h.name===a);return u?u.id:i})}static convertFormulaToNames(t,n){const r=this.getAllVariableMappings(n);return t.replace(/\b([a-zA-Z0-9-_]+)\b/g,(i,a)=>{if(["Math","Array","Object","String","Number","Boolean","Date","RegExp","Function","undefined","null","true","false","NaN","Infinity"].includes(a)||/^\d+(\.\d+)?$/.test(a))return i;const u=r.find(h=>h.id===a);return u?u.name:i})}static convertLatexToIds(t,n){const r=this.getAllVariableMappings(n);return t.replace(/\{([a-zA-Z_][a-zA-Z0-9_]*)\}/g,(i,a)=>{const l=r.find(u=>u.name===a);return l?`{${l.id}}`:i})}static convertLatexToNames(t,n){const r=this.getAllVariableMappings(n);return t.replace(/\{([a-zA-Z0-9-_]+)\}/g,(i,a)=>{const l=r.find(u=>u.id===a);return l?`{${l.name}}`:i})}static convertASTToIds(t,n){if(!t||typeof t!="object")return t;const r=this.getAllVariableMappings(n);if(t.type==="variable"&&t.variableName){const a=r.find(l=>l.name===t.variableName);if(a)return{...t,variableName:a.id}}const i={...t};return i.left&&(i.left=this.convertASTToIds(i.left,n)),i.right&&(i.right=this.convertASTToIds(i.right,n)),i.operand&&(i.operand=this.convertASTToIds(i.operand,n)),i.arguments&&Array.isArray(i.arguments)&&(i.arguments=i.arguments.map(a=>this.convertASTToIds(a,n))),i.expression&&(i.expression=this.convertASTToIds(i.expression,n)),i.body&&(i.body=this.convertASTToIds(i.body,n)),i}static convertASTToNames(t,n){if(!t||typeof t!="object")return t;const r=this.getAllVariableMappings(n);if(t.type==="variable"&&t.variableName){const a=r.find(l=>l.id===t.variableName);if(a)return{...t,variableName:a.name}}const i={...t};return i.left&&(i.left=this.convertASTToNames(i.left,n)),i.right&&(i.right=this.convertASTToNames(i.right,n)),i.operand&&(i.operand=this.convertASTToNames(i.operand,n)),i.arguments&&Array.isArray(i.arguments)&&(i.arguments=i.arguments.map(a=>this.convertASTToNames(a,n))),i.expression&&(i.expression=this.convertASTToNames(i.expression,n)),i.body&&(i.body=this.convertASTToNames(i.body,n)),i}static createEvaluationContext(t,n=[]){const r={};return t.forEach(i=>{r[i.name]=this.parseVariableValue(i.defaultValue||"",i.type)}),n.forEach(i=>{r[i.name]=this.parseVariableValue(i.defaultValue||"",i.type)}),r}static parseVariableValue(t,n){switch(n){case"number":return parseFloat(t)||0;case"boolean":return t==="true"||t==="1";case"string":default:return t}}}const $f=[{id:"+",label:"Add (+)",symbol:"+",latex:"+"},{id:"-",label:"Subtract (-)",symbol:"-",latex:"-"},{id:"",label:"Multiply ()",symbol:"*",latex:"\\times"},{id:"/",label:"Divide ()",symbol:"/",latex:"\\div"},{id:"^",label:"Power (^)",symbol:"^",latex:"^"},{id:"%",label:"Modulo (%)",symbol:"%",latex:"\\bmod"},{id:"=",label:"Equals (=)",symbol:"=",latex:"="}],Gf=[{id:"=",label:"Equals (=)",symbol:"=",latex:"="},{id:">",label:"Greater Than (>)",symbol:">",latex:">"},{id:"<",label:"Less Than (<)",symbol:"<",latex:"<"},{id:">=",label:"Greater Than or Equal ()",symbol:">=",latex:"\\geq"},{id:"<=",label:"Less Than or Equal ()",symbol:"<=",latex:"\\leq"},{id:"!=",label:"Not Equal ()",symbol:"!=",latex:"\\neq"}];function mu(e){if(!e||e.trim()==="")return"";try{let t=e;return t=t.replace(/Math\.pow\(([^,]+),\s*([^)]+)\)/g,"$1^{$2}"),t=t.replace(/Math\.sqrt\(([^)]+)\)/g,"\\sqrt{$1}"),t=t.replace(/Math\.abs\(([^)]+)\)/g,"|$1|"),t=t.replace(/Math\.floor\(([^)]+)\)/g,"\\lfloor $1 \\rfloor"),t=t.replace(/Math\.ceil\(([^)]+)\)/g,"\\lceil $1 \\rceil"),t=t.replace(/Math\.round\(([^)]+)\)/g,"\\text{round}($1)"),t=t.replace(/Math\.min\(([^)]+)\)/g,"\\min($1)"),t=t.replace(/Math\.max\(([^)]+)\)/g,"\\max($1)"),t=t.replace(/\*/g,"\\cdot "),t=t.replace(/\//g,"\\div "),t=t.replace(/==/g,"="),t=t.replace(/!=/g,"\\neq "),t=t.replace(/>=/g,"\\geq "),t=t.replace(/<=/g,"\\leq "),t=t.replace(/&&/g,"\\land "),t=t.replace(/\|\|/g,"\\lor "),t=t.replace(/!/g,"\\neg "),t=t.replace(/\[([^\]]+)\]/g,"[$1]"),t=t.replace(/(\d+)\.\.(\d+)/g,"[$1, $1+1, ..., $2]"),t=t.replace(/\s+/g," ").trim(),t}catch(t){return console.warn("LaTeX conversion error:",t),e}}const Y8=({block:e,index:t,onDelete:n,colorMode:r,isGroupDropTarget:i,onClick:a})=>{const l=(h,f)=>{const p=r==="dark";return h.startsWith("Math.")?{bg:p?"purple.800":"purple.100",color:p?"purple.200":"purple.800",border:p?"purple.600":"purple.300"}:["+","-","*","/","^","==","!=",">","<",">=","<=","&&","||","!"].includes(h)?{bg:p?"orange.800":"orange.100",color:p?"orange.200":"orange.800",border:p?"orange.600":"orange.300"}:/^\d+(\.\d+)?$/.test(h)?{bg:p?"green.800":"green.100",color:p?"green.200":"green.800",border:p?"green.600":"green.300"}:f==="variable"?{bg:p?"blue.800":"blue.100",color:p?"blue.200":"blue.800",border:p?"blue.600":"blue.300"}:f==="array"||f==="range"?{bg:p?"teal.800":"teal.100",color:p?"teal.200":"teal.800",border:p?"teal.600":"teal.300"}:{bg:p?"gray.700":"white",color:p?"gray.200":"gray.800",border:p?"gray.600":"gray.200"}},u=l(e.content,e.type);return e.type==="group"?s.jsx(go,{draggableId:e.id,index:t,children:(h,f)=>{var p;return s.jsxs(Y,{ref:h.innerRef,...h.draggableProps,p:2,bg:r==="dark"?"gray.700":"white",borderRadius:"md",boxShadow:f.isDragging?"md":"sm",borderWidth:1,borderColor:r==="dark"?"gray.600":"gray.200",children:[s.jsxs(ve,{spacing:2,mb:2,children:[s.jsx(Y,{...h.dragHandleProps,cursor:"grab",children:s.jsx($u,{size:16})}),s.jsx(pt,{colorScheme:"green",children:"Group"}),s.jsx(mt,{"aria-label":"Delete group",icon:s.jsx(ws,{size:16}),size:"xs",colorScheme:"red",onClick:g=>{g.stopPropagation(),n(e.id)}})]}),s.jsx(Y,{p:2,bg:i?"blue.100":r==="dark"?"gray.800":"gray.50",borderRadius:"md",minH:"50px",children:s.jsx(ve,{spacing:2,wrap:"wrap",children:(p=e.children)==null?void 0:p.map(g=>{const y=l(g.content,g.type);return s.jsx(Y,{p:1,bg:y.bg,color:y.color,borderRadius:"sm",borderWidth:1,borderColor:y.border,cursor:a&&(g.type==="variable"||g.type==="operator")?"pointer":"default",onClick:()=>a&&a(g),_hover:a&&(g.type==="variable"||g.type==="operator")?{opacity:.8,transform:"scale(1.05)"}:{},children:s.jsx(pt,{size:"sm",colorScheme:g.type==="variable"?"blue":g.type==="operator"?"purple":g.type==="value"?"gray":"green",bg:"transparent",color:"inherit",children:g.content})},g.id)})})})]})}}):s.jsx(go,{draggableId:e.id,index:t,children:(h,f)=>s.jsxs(ve,{ref:h.innerRef,...h.draggableProps,...h.dragHandleProps,p:2,bg:u.bg,color:u.color,borderRadius:"md",boxShadow:f.isDragging?"md":"sm",borderWidth:1,borderColor:u.border,cursor:a&&(e.type==="variable"||e.type==="operator")?"pointer":"default",onClick:()=>a&&a(e),_hover:a&&(e.type==="variable"||e.type==="operator")?{opacity:.8,transform:"scale(1.02)"}:{},children:[s.jsx(Y,{cursor:"grab",children:s.jsx($u,{size:16})}),s.jsx(pt,{colorScheme:e.type==="variable"?"blue":e.type==="operator"?"purple":e.type==="value"?"gray":e.type==="array"?"orange":e.type==="range"?"teal":"green",children:e.type==="array"&&e.arrayValues?`[${e.arrayValues.join(", ")}]`:e.type==="range"&&e.rangeStart!==void 0?`${e.rangeStart}..${e.rangeEnd} (${e.rangeStep})`:e.content}),s.jsx(mt,{"aria-label":"Delete block",icon:s.jsx(ws,{size:16}),size:"xs",colorScheme:"red",onClick:p=>{p.stopPropagation(),n(e.id)}})]})})},Hf=({variables:e,value:t,onChange:n,mode:r="formula"})=>{const{colorMode:i}=tn(),[a,l]=z.useState(()=>{if(!t)return[];const le=ri.convertFormulaToNames(t,e),Te=gu(le);return console.log("FormulaEditor: Parsed blocks for expression:",le,Te),Te}),{isOpen:u,onOpen:h,onClose:f}=ca(),{isOpen:p,onOpen:g,onClose:y}=ca(),{isOpen:b,onOpen:A,onClose:D}=ca(),[j,w]=z.useState(null),[C,_]=z.useState(""),[N,E]=z.useState(""),[I,H]=z.useState(""),[Z,ae]=z.useState("0"),[ne,F]=z.useState("10"),[J,pe]=z.useState("1"),[G,ge]=z.useState([]),[W,L]=z.useState(null),[Q,fe]=z.useState(null),[xe,ue]=z.useState([]),[ke,q]=z.useState("low"),[re,Se]=z.useState(!1),[we,Ce]=z.useState([]),[Le,ft]=z.useState(0),[vt,on]=z.useState(null),Rt=[...e,...G];z.useEffect(()=>{const le=()=>{const Je=ar.getSystemVariables(),et=[{id:"system_n",name:"n",type:"number",defaultValue:"0"},...Je];ge(et)};le();const Te=()=>{le()};return window.addEventListener("focus",Te),()=>{window.removeEventListener("focus",Te)}},[]);const nn=r==="formula"?$f:Gf,Ir=nn.map(le=>s.jsx(Ur,{onClick:()=>kn(le.id),children:le.label},le.id)),jt=le=>{if(le.length===0)return"Formula is empty. Add variables, values, or operators.";const Te=le.some(Mt=>Mt.type==="operator"),Je=le.filter(Mt=>Mt.type==="variable"||Mt.type==="value").length,et=le.filter(Mt=>Mt.type==="operator").length;if(Te&&et>Je)return`Formula has ${et} operators but only ${Je} values. Consider adding more values or variables.`;if(Te&&Je<2)return"Formula has operators but needs at least 2 values or variables to be valid.";const gt=le.filter(Mt=>Mt.type==="variable").map(Mt=>Mt.content),Tt=G.map(Mt=>Mt.name),ln=e.map(Mt=>Mt.name),Xt=gt.filter(Mt=>!Tt.includes(Mt)&&!ln.includes(Mt));if(Xt.length>0)return`Undefined variables detected: ${Xt.join(", ")}. Make sure all variables are defined in the Variables tab.`;const Ht=gt.filter(Mt=>Tt.includes(Mt));return Ht.length>0?`Using system variables: ${Ht.join(", ")}. These will be automatically available during execution.`:""},Bt=le=>{if(!le.destination){E("");return}const{source:Te,destination:Je}=le,et=Array.from(a),[gt]=et.splice(Te.index,1),Tt=et[Je.index];if(Tt&&Tt.type==="group"){Tt.children=Tt.children||[],Tt.children.push(gt),l(et),E("");return}et.splice(Je.index,0,gt),l(et),E("")},qn=()=>{E("")},Fn=le=>{if(!le.destination){E("");return}const Te=a[le.destination.index];Te&&Te.type==="group"?E(Te.id):E("")},Ct=le=>{const Te={id:`var_${Date.now()}`,type:"variable",content:le.name};l(Je=>[...Je,Te])},kn=le=>{const Je=(r==="formula"?$f:Gf).find(gt=>gt.id===le);if(!Je)return;const et={id:`op_${Date.now()}`,type:"operator",content:Je.symbol};l(gt=>[...gt,et])},Ln=()=>{const le={id:`group_${Date.now()}`,type:"group",content:"()",children:[]};l(Te=>[...Te,le])},ee=()=>{w({id:`value_${Date.now()}`,type:"value",content:"",value:""}),h()},Ve=()=>{H(""),g()},Ie=()=>{ae("0"),F("10"),pe("1"),A()},Ne=le=>{if(!j)return;const Te={...j,content:String(le),value:le};l(Je=>[...Je,Te]),f()},ot=()=>{const le=I.split(",").map(Te=>Te.trim()).filter(Te=>Te!=="").map(Te=>Number(Te)).filter(Te=>!isNaN(Te));if(le.length>0){const Te={id:`array_${Date.now()}`,type:"array",content:`[${le.join(", ")}]`,arrayValues:le};l(Je=>[...Je,Te]),y()}},Ke=()=>{const le=Number(Z),Te=Number(ne),Je=Number(J);if(!isNaN(le)&&!isNaN(Te)&&!isNaN(Je)&&Je>0){const et={id:`range_${Date.now()}`,type:"range",content:`${le}..${Te} (step ${Je})`,rangeStart:le,rangeEnd:Te,rangeStep:Je};l(gt=>[...gt,et]),D()}},Et=le=>{const Te=Je=>Je.filter(et=>et.id===le?!1:(et.children&&(et.children=Te(et.children)),!0));l(Je=>Te(Je))},Ae=le=>{le.type==="variable"?(L(le.id),fe("variable")):le.type==="operator"&&(L(le.id),fe("operator"))},be=le=>{W&&(l(Te=>Te.map(Je=>Je.id===W?{...Je,content:le.name}:Je)),L(null),fe(null))},Oe=le=>{if(W){const Te=a.map(Je=>Je.id===W?{...Je,content:le}:Je);l(Te),L(null),fe(null)}},Pe=le=>{const Te=[];return Rt.forEach(gt=>{gt.name.toLowerCase().includes(le.toLowerCase())&&Te.push({id:gt.id,label:gt.name,type:"variable"})}),[{id:"+",label:"Addition (+)",type:"operator"},{id:"-",label:"Subtraction (-)",type:"operator"},{id:"*",label:"Multiplication (*)",type:"operator"},{id:"/",label:"Division (/)",type:"operator"},{id:"^",label:"Power (^)",type:"operator"},{id:"Math.sqrt",label:"Square Root (Math.sqrt)",type:"operator"},{id:"Math.abs",label:"Absolute Value (Math.abs)",type:"operator"},{id:"Math.round",label:"Round (Math.round)",type:"operator"},{id:"Math.min",label:"Minimum (Math.min)",type:"operator"},{id:"Math.max",label:"Maximum (Math.max)",type:"operator"}].forEach(gt=>{gt.label.toLowerCase().includes(le.toLowerCase())&&Te.push(gt)}),[{id:"pow",label:"Power (a^b)",type:"template"},{id:"sqrt",label:"Square Root",type:"template"},{id:"abs",label:"Absolute Value",type:"template"},{id:"round",label:"Round to Integer",type:"template"},{id:"min",label:"Minimum of Values",type:"template"},{id:"max",label:"Maximum of Values",type:"template"}].forEach(gt=>{gt.label.toLowerCase().includes(le.toLowerCase())&&Te.push(gt)}),Te.slice(0,8)},qe=le=>{if(le.length>=2){const Te=Pe(le);Ce(Te),Se(Te.length>0),ft(0)}else Se(!1)},Qe=le=>{if(le.type==="variable"){const Te=Rt.find(Je=>Je.id===le.id);Te&&Ct(Te)}else le.type==="operator"?kn(le.id):le.type==="template"&&je(le.id);Se(!1)},je=le=>{const Te=[];switch(le){case"pow":Te.push({id:`var_${Date.now()}_1`,type:"variable",content:"base"},{id:`op_${Date.now()}_1`,type:"operator",content:"^"},{id:`var_${Date.now()}_2`,type:"variable",content:"exponent"});break;case"sqrt":Te.push({id:`op_${Date.now()}_1`,type:"operator",content:"Math.sqrt"},{id:`group_${Date.now()}_1`,type:"group",content:"()",children:[{id:`var_${Date.now()}_1`,type:"variable",content:"value"}]});break;case"abs":Te.push({id:`op_${Date.now()}_1`,type:"operator",content:"Math.abs"},{id:`group_${Date.now()}_1`,type:"group",content:"()",children:[{id:`var_${Date.now()}_1`,type:"variable",content:"value"}]});break;case"round":Te.push({id:`op_${Date.now()}_1`,type:"operator",content:"Math.round"},{id:`group_${Date.now()}_1`,type:"group",content:"()",children:[{id:`var_${Date.now()}_1`,type:"variable",content:"value"}]});break;case"min":Te.push({id:`op_${Date.now()}_1`,type:"operator",content:"Math.min"},{id:`group_${Date.now()}_1`,type:"group",content:"()",children:[{id:`var_${Date.now()}_1`,type:"variable",content:"value1"},{id:`op_${Date.now()}_2`,type:"operator",content:","},{id:`var_${Date.now()}_2`,type:"variable",content:"value2"}]});break;case"max":Te.push({id:`op_${Date.now()}_1`,type:"operator",content:"Math.max"},{id:`group_${Date.now()}_1`,type:"group",content:"()",children:[{id:`var_${Date.now()}_1`,type:"variable",content:"value1"},{id:`op_${Date.now()}_2`,type:"operator",content:","},{id:`var_${Date.now()}_2`,type:"variable",content:"value2"}]});break}l([...a,...Te])};z.useEffect(()=>{const le=Tt=>{let ln="",Xt=0;for(;Xt<Tt.length;){const Ht=Tt[Xt];switch(Ht.type){case"variable":ln+=Ht.content;break;case"operator":if(Ht.content==="^"){const Mt=ln.trim();if(Xt++,Xt<Tt.length){const dr=le([Tt[Xt]]),ps=/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(Mt),En=/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(dr);ps||En?ln=`Math.pow(${Mt}, ${dr})`:ln+=` ^ ${dr}`}}else ln+=` ${Ht.content} `;break;case"group":ln+=`(${Ht.children?le(Ht.children):""})`;break;case"value":ln+=Ht.content;break;case"array":Ht.arrayValues&&(ln+=`[${Ht.arrayValues.join(", ")}]`);break;case"range":if(Ht.rangeStart!==void 0&&Ht.rangeEnd!==void 0&&Ht.rangeStep!==void 0){const Mt=[];for(let dr=Ht.rangeStart;dr<=Ht.rangeEnd;dr+=Ht.rangeStep)Mt.push(dr);ln+=`[${Mt.join(", ")}]`}break;default:ln+=""}Xt++}return ln.trim()};if(a.length===0){if(t&&t.trim()!==""){const Tt=mu(t),ln=Nr.parseExpression(t);console.log("FormulaEditor: Converting JavaScript to LaTeX for empty blocks:",{javascript:t,latex:Tt,ast:ln}),n(t,Tt,ln)}_("");return}const Te=le(a),Je=mu(Te);let et;try{et=Nr.parseExpression(Te),ue([]),q(Nr.calculateComplexity(et))}catch(Tt){console.error("AST generation error:",Tt),et={type:"literal",value:Te,metadata:{astVersion:"1.0.0",validationErrors:[Tt instanceof Error?Tt.message:"Unknown error"],complexity:"low"}},ue([Tt instanceof Error?Tt.message:"Unknown error"]),q("low")}const gt=jt(a);_(gt),Te!==t&&n(Te,Je,et)},[a,n,e,r,t]);const un=le=>{let Te="",Je=0;for(;Je<le.length;){const et=le[Je];switch(et.type){case"variable":Te+=et.content;break;case"operator":if(et.content==="^"){const gt=Te.trim();if(Je++,Je<le.length){const Tt=un([le[Je]]),ln=/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(gt),Xt=/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(Tt);ln||Xt?Te=`Math.pow(${gt}, ${Tt})`:Te+=` ^ ${Tt}`}}else Te+=` ${et.content} `;break;case"group":Te+=`(${et.children?un(et.children):""})`;break;case"value":Te+=et.content;break;case"array":et.arrayValues&&(Te+=`[${et.arrayValues.join(", ")}]`);break;case"range":if(et.rangeStart!==void 0&&et.rangeEnd!==void 0&&et.rangeStep!==void 0){const gt=[];for(let Tt=et.rangeStart;Tt<=et.rangeEnd;Tt+=et.rangeStep)gt.push(Tt);Te+=`[${gt.join(", ")}]`}break;default:Te+=""}Je++}return Te.trim()};z.useEffect(()=>{if(t){const le=ri.convertFormulaToNames(t,e),Te=gu(le);l(Te)}else l([])},[t,e]),z.useEffect(()=>{if(a.length>0){const le=un(a),Te=mu(le);let Je;try{Je=Nr.parseExpression(le),ue([]),q(Nr.calculateComplexity(Je))}catch(et){console.error("AST generation error:",et),Je={type:"literal",value:le,metadata:{astVersion:"1.0.0",validationErrors:[et instanceof Error?et.message:"Unknown error"],complexity:"low"}},ue([et instanceof Error?et.message:"Unknown error"]),q("low")}n(le,Te,Je)}else n("","",{type:"literal",value:"",metadata:{astVersion:"1.0.0",validationErrors:[],complexity:"low"}})},[a,n,e]);const ur=()=>{if(a.length!==0)try{const le=un(a),Te=Nr.parseExpression(le),Je=Nr.optimizeExpression(Te),et=Nr.generateCode(Je),gt=[],Tt=Nr.calculateComplexity(Te),ln=Nr.calculateComplexity(Je);if(ln!==Tt&&gt.push(`Complexity reduced from ${Tt} to ${ln}`),le!==et&&gt.push("Expression simplified"),Je.type==="literal"&&Te.type!=="literal"&&gt.push("Constant expression evaluated"),on({original:le,optimized:et,improvements:gt}),gt.length>0){const Xt=gu(et);l(Xt)}}catch(le){console.warn("Optimization failed:",le),on({original:un(a),optimized:un(a),improvements:["No optimizations found"]})}};return s.jsxs(Y,{children:[s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(ve,{spacing:2,wrap:"wrap",children:[s.jsxs(Y,{position:"relative",flex:"1",maxW:"300px",children:[s.jsx(ut,{placeholder:"Type to search variables, operators, or templates...",size:"sm",onChange:le=>qe(le.target.value),onKeyDown:le=>{le.key==="ArrowDown"?(le.preventDefault(),ft(Te=>Te<we.length-1?Te+1:0)):le.key==="ArrowUp"?(le.preventDefault(),ft(Te=>Te>0?Te-1:we.length-1)):le.key==="Enter"&&re&&we.length>0?(le.preventDefault(),Qe(we[Le])):le.key==="Escape"&&Se(!1)}}),re&&we.length>0&&s.jsx(Y,{position:"absolute",top:"100%",left:0,right:0,bg:i==="dark"?"gray.800":"white",border:"1px solid",borderColor:i==="dark"?"gray.600":"gray.200",borderRadius:"md",boxShadow:"lg",zIndex:1e3,maxH:"200px",overflowY:"auto",children:we.map((le,Te)=>s.jsx(Y,{px:3,py:2,cursor:"pointer",bg:Te===Le?i==="dark"?"blue.600":"blue.100":"transparent",_hover:{bg:i==="dark"?"blue.600":"blue.100"},onClick:()=>Qe(le),children:s.jsxs(ve,{spacing:2,children:[s.jsx(Y,{fontSize:"sm",fontWeight:"medium",children:le.label}),s.jsx(pt,{size:"sm",colorScheme:le.type==="variable"?"green":le.type==="operator"?"blue":"purple",children:le.type})]})},le.id))})]}),s.jsxs($a,{children:[s.jsxs(Xc,{as:Ee,size:"sm",rightIcon:s.jsx(cl,{size:16}),leftIcon:s.jsx(Nl,{size:16}),children:["Variable (",Rt.length,")"]}),s.jsxs(Ga,{children:[G.length>0&&s.jsxs(s.Fragment,{children:[G.map(le=>s.jsxs(Ur,{onClick:()=>Ct(le),icon:s.jsx(ts,{size:16}),children:[le.name,le.id==="system_n"&&s.jsx(pt,{ml:2,size:"sm",colorScheme:"green",children:"Built-in"}),le.id!=="system_n"&&le.id.startsWith("system-")&&s.jsx(pt,{ml:2,size:"sm",colorScheme:"blue",children:"System"})]},le.id)),e.length>0&&s.jsx(Ss,{})]}),e.map(le=>s.jsx(Ur,{onClick:()=>Ct(le),icon:s.jsx(ts,{size:16}),children:le.name},le.id))]})]}),s.jsxs($a,{children:[s.jsx(Xc,{as:Ee,rightIcon:s.jsx(cl,{size:16}),leftIcon:r==="formula"?s.jsx(ii,{size:16}):s.jsx(sb,{size:16}),size:"sm",children:r==="formula"?"Math Operator":"Condition"}),s.jsx(Ga,{children:Ir})]}),s.jsx(Ee,{"aria-label":"Add parentheses group",leftIcon:s.jsx(H4,{size:16}),size:"sm",onClick:Ln,children:"Parentheses"}),s.jsx(Ee,{"aria-label":"Add value",leftIcon:s.jsx(mb,{size:16}),size:"sm",onClick:ee,children:"Value"}),s.jsx(Ee,{"aria-label":"Add array",leftIcon:s.jsx(ii,{size:16}),size:"sm",onClick:Ve,children:"Array"}),s.jsx(Ee,{"aria-label":"Add range",leftIcon:s.jsx(ii,{size:16}),size:"sm",onClick:Ie,children:"Range"}),s.jsxs($a,{children:[s.jsx(Xc,{as:Ee,rightIcon:s.jsx(cl,{size:16}),leftIcon:s.jsx(ii,{size:16}),size:"sm",children:"Templates"}),s.jsxs(Ga,{children:[s.jsx(Ur,{onClick:()=>je("pow"),children:"Power (a^b)"}),s.jsx(Ur,{onClick:()=>je("sqrt"),children:"Square Root"}),s.jsx(Ur,{onClick:()=>je("abs"),children:"Absolute Value"}),s.jsx(Ur,{onClick:()=>je("round"),children:"Round to Integer"}),s.jsx(Ur,{onClick:()=>je("min"),children:"Minimum of Values"}),s.jsx(Ur,{onClick:()=>je("max"),children:"Maximum of Values"})]})]}),s.jsx(Ee,{"aria-label":"Optimize expression",leftIcon:s.jsx(ii,{size:16}),size:"sm",onClick:ur,colorScheme:"green",children:"Optimize"})]}),s.jsx(Y,{p:4,bg:i==="dark"?"gray.800":"gray.50",borderRadius:"md",minH:"100px",children:s.jsx(ac,{onDragEnd:Bt,onDragStart:qn,onDragUpdate:Fn,children:s.jsx(oc,{droppableId:"formula-blocks",direction:"horizontal",children:le=>s.jsxs(ve,{ref:le.innerRef,...le.droppableProps,spacing:2,wrap:"wrap",minH:"60px",align:"start",children:[a.map((Te,Je)=>s.jsx(Y8,{block:Te,index:Je,onDelete:Et,colorMode:i,isGroupDropTarget:N===Te.id,onClick:Ae},Te.id)),le.placeholder]})})})}),C&&s.jsxs(xn,{status:"warning",borderRadius:"md",children:[s.jsx(bn,{}),s.jsx(or,{fontSize:"sm",children:C})]}),xe.length>0&&s.jsxs(xn,{status:"error",borderRadius:"md",children:[s.jsx(bn,{}),s.jsxs(ye,{align:"start",spacing:1,children:[s.jsx(Oi,{fontSize:"sm",children:"Syntax Errors"}),s.jsx(or,{fontSize:"sm",children:xe.map((le,Te)=>s.jsxs(Y,{color:"red.200",children:[" ",le]},Te))})]})]}),ke!=="low"&&s.jsxs(xn,{status:ke==="high"?"warning":"info",borderRadius:"md",children:[s.jsx(bn,{}),s.jsxs(or,{fontSize:"sm",children:["Formula complexity: ",s.jsx(pt,{colorScheme:ke==="high"?"orange":"blue",children:ke}),ke==="high"&&" - Consider breaking into smaller expressions"]})]}),vt&&s.jsxs(xn,{status:"success",borderRadius:"md",children:[s.jsx(bn,{}),s.jsxs(ye,{align:"start",spacing:2,children:[s.jsx(Oi,{fontSize:"sm",children:"Optimization Applied"}),s.jsx(or,{fontSize:"sm",children:s.jsxs(ye,{align:"start",spacing:1,children:[s.jsxs(Y,{children:[s.jsx("strong",{children:"Original:"})," ",s.jsx("code",{children:vt.original})]}),s.jsxs(Y,{children:[s.jsx("strong",{children:"Optimized:"})," ",s.jsx("code",{children:vt.optimized})]}),vt.improvements.length>0&&s.jsxs(Y,{children:[s.jsx("strong",{children:"Improvements:"}),vt.improvements.map((le,Te)=>s.jsxs(Y,{ml:2,color:"green.200",children:[" ",le]},Te))]})]})})]})]})]}),s.jsxs(zn,{isOpen:u,onClose:f,children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:"Enter Value"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,pb:4,children:[s.jsx(ut,{placeholder:"Enter a value",onChange:le=>{j&&w({...j,content:le.target.value,value:le.target.value})}}),s.jsx(Ee,{leftIcon:s.jsx(Qc,{size:16}),colorScheme:"blue",onClick:()=>j&&Ne(j.value||""),children:"Add Value"})]})})]})]}),s.jsxs(zn,{isOpen:p,onClose:y,children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:"Create Array"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,pb:4,children:[s.jsx(ut,{placeholder:"Enter numbers separated by commas (e.g., 1, 2, 3, 4, 5)",value:I,onChange:le=>H(le.target.value)}),s.jsx(Ee,{leftIcon:s.jsx(Qc,{size:16}),colorScheme:"blue",onClick:ot,children:"Create Array"})]})})]})]}),s.jsxs(zn,{isOpen:b,onClose:D,children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:"Create Range"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,pb:4,children:[s.jsxs(ve,{spacing:2,children:[s.jsx(ut,{placeholder:"Start",value:Z,onChange:le=>ae(le.target.value)}),s.jsx(ut,{placeholder:"End",value:ne,onChange:le=>F(le.target.value)}),s.jsx(ut,{placeholder:"Step",value:J,onChange:le=>pe(le.target.value)})]}),s.jsx(Ee,{leftIcon:s.jsx(Qc,{size:16}),colorScheme:"blue",onClick:Ke,children:"Create Range"})]})})]})]}),s.jsx($a,{isOpen:Q==="variable",onClose:()=>fe(null),children:s.jsxs(Ga,{children:[G.length>0&&s.jsxs(s.Fragment,{children:[G.map(le=>s.jsxs(Ur,{onClick:()=>be(le),icon:s.jsx(ts,{size:16}),children:[le.name,le.id==="system_n"&&s.jsx(pt,{ml:2,size:"sm",colorScheme:"green",children:"Built-in"}),le.id!=="system_n"&&le.id.startsWith("system-")&&s.jsx(pt,{ml:2,size:"sm",colorScheme:"blue",children:"System"})]},le.id)),e.length>0&&s.jsx(Ss,{})]}),e.map(le=>s.jsx(Ur,{onClick:()=>be(le),icon:s.jsx(ts,{size:16}),children:le.name},le.id))]})}),s.jsx($a,{isOpen:Q==="operator",onClose:()=>fe(null),children:s.jsx(Ga,{children:nn.map(le=>s.jsx(Ur,{onClick:()=>Oe(le.id),children:le.label},le.id))})})]})};function gu(e){if(!e||e.trim()==="")return[];if(e.includes("Math.pow(")){let n=e;const r=e.match(/Math\.pow\(([^,]+),\s*([^)]+)\)/g);return r&&r.forEach(i=>{const a=i.match(/Math\.pow\(([^,]+),\s*([^)]+)\)/);if(a){const l=a[1].trim(),u=a[2].trim(),h=`${l} ^ ${u}`;n=n.replace(i,h)}}),dl(n)}if(/\[.*\]|\d+\.\.\d+/.test(e)){const n=X8(e);return[...dl(e),...n]}return dl(e)}function J8(e){const t=[];let n=0;for(;n<e.length;){const r=e[n];if(/\s/.test(r)){n++;continue}if(/\d/.test(r)){let i="";for(;n<e.length&&/\d|\./.test(e[n]);)i+=e[n],n++;t.push({type:"number",value:i,position:n-i.length});continue}if(/[+\-*/^=<>!&|]/.test(r)){let i=r;if(n++,n<e.length){const a=e[n];(r==="="&&a==="="||r==="!"&&a==="="||r==="<"&&a==="="||r===">"&&a==="="||r==="&"&&a==="&"||r==="|"&&a==="|")&&(i+=a,n++)}t.push({type:"operator",value:i,position:n-i.length});continue}if(r==="("||r===")"){t.push({type:"parenthesis",value:r,position:n}),n++;continue}if(/[a-zA-Z_]/.test(r)){let i="";for(;n<e.length&&/[a-zA-Z0-9_]/.test(e[n]);)i+=e[n],n++;t.push({type:"variable",value:i,position:n-i.length});continue}n++}return t}function dl(e){const t=J8(e),n=[];let r=0;for(;r<t.length;){const i=t[r];switch(i.type){case"variable":if(i.value==="Math"&&r+2<t.length&&t[r+1].value==="."&&t[r+2].type==="variable"){const a=t[r+2].value;n.push({id:`op_${Date.now()}_${Math.random()}`,type:"operator",content:`Math.${a}`}),r+=2}else n.push({id:`var_${Date.now()}_${Math.random()}`,type:"variable",content:i.value});break;case"number":n.push({id:`value_${Date.now()}_${Math.random()}`,type:"value",content:i.value,value:parseFloat(i.value)});break;case"operator":i.value==="^"?n.push({id:`op_${Date.now()}_${Math.random()}`,type:"operator",content:"^"}):n.push({id:`op_${Date.now()}_${Math.random()}`,type:"operator",content:i.value});break;case"parenthesis":if(i.value==="("){let a=1,l=r+1,u="";for(;l<t.length&&a>0;)t[l].value==="("&&a++,t[l].value===")"&&a--,a>0&&(u+=t[l].value),l++;if(a===0){const h=dl(u);n.push({id:`group_${Date.now()}_${Math.random()}`,type:"group",content:"()",children:h}),r=l-1}else n.push({id:`var_${Date.now()}_${Math.random()}`,type:"variable",content:i.value})}break}r++}return n}function X8(e){const t=[],n=/\[([^\]]+)\]/g;let r;for(;(r=n.exec(e))!==null;){const u=r[1].split(",").map(h=>h.trim()).map(h=>Number(h)).filter(h=>!isNaN(h));u.length>0&&t.push({id:`array_${Date.now()}_${Math.random()}`,type:"array",content:r[0],arrayValues:u})}const i=/(\d+)\.\.(\d+)(?::(\d+))?/g;let a;for(;(a=i.exec(e))!==null;){const l=Number(a[1]),u=Number(a[2]),h=a[3]?Number(a[3]):1;!isNaN(l)&&!isNaN(u)&&!isNaN(h)&&t.push({id:`range_${Date.now()}_${Math.random()}`,type:"range",content:`${l}..${u} (step ${h})`,rangeStart:l,rangeEnd:u,rangeStep:h})}return t}var ad={exports:{}},yu={exports:{}},qf;function K8(){return qf||(qf=1,function(e,t){(function(r,i){e.exports=i()})(typeof self<"u"?self:Bp,function(){return function(){var n={};(function(){n.d=function(c,o){for(var d in o)n.o(o,d)&&!n.o(c,d)&&Object.defineProperty(c,d,{enumerable:!0,get:o[d]})}})(),function(){n.o=function(c,o){return Object.prototype.hasOwnProperty.call(c,o)}}();var r={};n.d(r,{default:function(){return Yy}});class i{constructor(o,d){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;let m="KaTeX parse error: "+o,x,S;const T=d&&d.loc;if(T&&T.start<=T.end){const P=T.lexer.input;x=T.start,S=T.end,x===P.length?m+=" at end of input: ":m+=" at position "+(x+1)+": ";const X=P.slice(x,S).replace(/[^]/g,"$&");let ie;x>15?ie=""+P.slice(x-15,x):ie=P.slice(0,x);let oe;S+15<P.length?oe=P.slice(S,S+15)+"":oe=P.slice(S),m+=ie+X+oe}const R=new Error(m);return R.name="ParseError",R.__proto__=i.prototype,R.position=x,x!=null&&S!=null&&(R.length=S-x),R.rawMessage=o,R}}i.prototype.__proto__=Error.prototype;var a=i;const l=function(c,o){return c.indexOf(o)!==-1},u=function(c,o){return c===void 0?o:c},h=/([A-Z])/g,f=function(c){return c.replace(h,"-$1").toLowerCase()},p={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},g=/[&><"']/g;function y(c){return String(c).replace(g,o=>p[o])}const b=function(c){return c.type==="ordgroup"||c.type==="color"?c.body.length===1?b(c.body[0]):c:c.type==="font"?b(c.body):c},A=function(c){const o=b(c);return o.type==="mathord"||o.type==="textord"||o.type==="atom"},D=function(c){if(!c)throw new Error("Expected non-null, but got "+String(c));return c};var w={contains:l,deflt:u,escape:y,hyphenate:f,getBaseElem:b,isCharacterBox:A,protocolFromUrl:function(c){const o=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(c);return o?o[2]!==":"||!/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(o[1])?null:o[1].toLowerCase():"_relative"}};const C={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:c=>"#"+c},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(c,o)=>(o.push(c),o)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:c=>Math.max(0,c),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:c=>Math.max(0,c),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:c=>Math.max(0,c),cli:"-e, --max-expand <n>",cliProcessor:c=>c==="Infinity"?1/0:parseInt(c)},globalGroup:{type:"boolean",cli:!1}};function _(c){if(c.default)return c.default;const o=c.type,d=Array.isArray(o)?o[0]:o;if(typeof d!="string")return d.enum[0];switch(d){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class N{constructor(o){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,o=o||{};for(const d in C)if(C.hasOwnProperty(d)){const m=C[d];this[d]=o[d]!==void 0?m.processor?m.processor(o[d]):o[d]:_(m)}}reportNonstrict(o,d,m){let x=this.strict;if(typeof x=="function"&&(x=x(o,d,m)),!(!x||x==="ignore")){if(x===!0||x==="error")throw new a("LaTeX-incompatible input and strict mode is set to 'error': "+(d+" ["+o+"]"),m);x==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(d+" ["+o+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+x+"': "+d+" ["+o+"]"))}}useStrictBehavior(o,d,m){let x=this.strict;if(typeof x=="function")try{x=x(o,d,m)}catch{x="error"}return!x||x==="ignore"?!1:x===!0||x==="error"?!0:x==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(d+" ["+o+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+x+"': "+d+" ["+o+"]")),!1)}isTrusted(o){if(o.url&&!o.protocol){const m=w.protocolFromUrl(o.url);if(m==null)return!1;o.protocol=m}return!!(typeof this.trust=="function"?this.trust(o):this.trust)}}class E{constructor(o,d,m){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=o,this.size=d,this.cramped=m}sup(){return G[ge[this.id]]}sub(){return G[W[this.id]]}fracNum(){return G[L[this.id]]}fracDen(){return G[Q[this.id]]}cramp(){return G[fe[this.id]]}text(){return G[xe[this.id]]}isTight(){return this.size>=2}}const I=0,H=1,Z=2,ae=3,ne=4,F=5,J=6,pe=7,G=[new E(I,0,!1),new E(H,0,!0),new E(Z,1,!1),new E(ae,1,!0),new E(ne,2,!1),new E(F,2,!0),new E(J,3,!1),new E(pe,3,!0)],ge=[ne,F,ne,F,J,pe,J,pe],W=[F,F,F,F,pe,pe,pe,pe],L=[Z,ae,ne,F,J,pe,J,pe],Q=[ae,ae,F,F,pe,pe,pe,pe],fe=[H,H,ae,ae,F,F,pe,pe],xe=[I,H,Z,ae,Z,ae,Z,ae];var ue={DISPLAY:G[I],TEXT:G[Z],SCRIPT:G[ne],SCRIPTSCRIPT:G[J]};const ke=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function q(c){for(let o=0;o<ke.length;o++){const d=ke[o];for(let m=0;m<d.blocks.length;m++){const x=d.blocks[m];if(c>=x[0]&&c<=x[1])return d.name}}return null}const re=[];ke.forEach(c=>c.blocks.forEach(o=>re.push(...o)));function Se(c){for(let o=0;o<re.length;o+=2)if(c>=re[o]&&c<=re[o+1])return!0;return!1}const we=80,Ce=function(c,o){return"M95,"+(622+c+o)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+c/2.075+" -"+c+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+c)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+c)+" "+o+"h400000v"+(40+c)+"h-400000z"},Le=function(c,o){return"M263,"+(601+c+o)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+c/2.084+" -"+c+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+c)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+c)+" "+o+"h400000v"+(40+c)+"h-400000z"},ft=function(c,o){return"M983 "+(10+c+o)+`
l`+c/3.13+" -"+c+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+c)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+c)+" "+o+"h400000v"+(40+c)+"h-400000z"},vt=function(c,o){return"M424,"+(2398+c+o)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+c/4.223+" -"+c+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+c)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+c)+" "+o+`
h400000v`+(40+c)+"h-400000z"},on=function(c,o){return"M473,"+(2713+c+o)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+c/5.298+" -"+c+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+c)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+c)+" "+o+"h400000v"+(40+c)+"H1017.7z"},Rt=function(c){const o=c/2;return"M400000 "+c+" H0 L"+o+" 0 l65 45 L145 "+(c-80)+" H400000z"},nn=function(c,o,d){const m=d-54-o-c;return"M702 "+(c+o)+"H400000"+(40+c)+`
H742v`+m+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+o+"H400000v"+(40+c)+"H742z"},Ir=function(c,o,d){o=1e3*o;let m="";switch(c){case"sqrtMain":m=Ce(o,we);break;case"sqrtSize1":m=Le(o,we);break;case"sqrtSize2":m=ft(o,we);break;case"sqrtSize3":m=vt(o,we);break;case"sqrtSize4":m=on(o,we);break;case"sqrtTall":m=nn(o,we,d)}return m},jt=function(c,o){switch(c){case"":return"M291 0 H417 V"+o+" H291z M291 0 H417 V"+o+" H291z";case"":return"M145 0 H188 V"+o+" H145z M145 0 H188 V"+o+" H145z";case"":return"M145 0 H188 V"+o+" H145z M145 0 H188 V"+o+" H145z"+("M367 0 H410 V"+o+" H367z M367 0 H410 V"+o+" H367z");case"":return"M457 0 H583 V"+o+" H457z M457 0 H583 V"+o+" H457z";case"":return"M319 0 H403 V"+o+" H319z M319 0 H403 V"+o+" H319z";case"":return"M263 0 H347 V"+o+" H263z M263 0 H347 V"+o+" H263z";case"":return"M384 0 H504 V"+o+" H384z M384 0 H504 V"+o+" H384z";case"":return"M312 0 H355 V"+o+" H312z M312 0 H355 V"+o+" H312z";case"":return"M257 0 H300 V"+o+" H257z M257 0 H300 V"+o+" H257z"+("M478 0 H521 V"+o+" H478z M478 0 H521 V"+o+" H478z");default:return""}},Bt={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},qn=function(c,o){switch(c){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+o+` v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v`+o+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+o+` v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v`+o+" v1759 h84z";case"vert":return"M145 15 v585 v"+o+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-o+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+o+" v585 h43z";case"doublevert":return"M145 15 v585 v"+o+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-o+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+o+` v585 h43z
M367 15 v585 v`+o+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-o+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+o+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+o+` v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v`+o+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+o+` v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v`+o+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+o+` v602 h84z
M403 1759 V0 H319 V1759 v`+o+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+o+` v602 h84z
M347 1759 V0 h-84 V1759 v`+o+" v602 h84z";case"lparen":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,`+(o+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-`+(o+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case"rparen":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(o+9)+`
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-`+(o+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error("Unknown stretchy delimiter.")}};class Fn{constructor(o){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=o,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(o){return w.contains(this.classes,o)}toNode(){const o=document.createDocumentFragment();for(let d=0;d<this.children.length;d++)o.appendChild(this.children[d].toNode());return o}toMarkup(){let o="";for(let d=0;d<this.children.length;d++)o+=this.children[d].toMarkup();return o}toText(){const o=d=>d.toText();return this.children.map(o).join("")}}var Ct={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}};const kn={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},Ln={:"A",:"D",:"o",:"a",:"d",:"o",:"A",:"B",:"B",:"F",:"A",:"E",:"K",:"3",:"N",:"N",:"K",:"N",:"M",:"H",:"O",:"N",:"P",:"C",:"T",:"y",:"O",:"X",:"U",:"h",:"W",:"W",:"B",:"X",:"B",:"3",:"X",:"R",:"a",:"b",:"a",:"r",:"y",:"e",:"m",:"e",:"n",:"n",:"n",:"n",:"m",:"n",:"o",:"n",:"p",:"c",:"o",:"y",:"b",:"x",:"n",:"n",:"w",:"w",:"a",:"m",:"a",:"e",:"m",:"r"};function ee(c,o){Ct[c]=o}function Ve(c,o,d){if(!Ct[o])throw new Error("Font metrics not found for font: "+o+".");let m=c.charCodeAt(0),x=Ct[o][m];if(!x&&c[0]in Ln&&(m=Ln[c[0]].charCodeAt(0),x=Ct[o][m]),!x&&d==="text"&&Se(m)&&(x=Ct[o][77]),x)return{depth:x[0],height:x[1],italic:x[2],skew:x[3],width:x[4]}}const Ie={};function Ne(c){let o;if(c>=5?o=0:c>=3?o=1:o=2,!Ie[o]){const d=Ie[o]={cssEmPerMu:kn.quad[o]/18};for(const m in kn)kn.hasOwnProperty(m)&&(d[m]=kn[m][o])}return Ie[o]}const ot=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],Ke=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],Et=function(c,o){return o.size<2?c:ot[c-1][o.size-1]};class Ae{constructor(o){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=o.style,this.color=o.color,this.size=o.size||Ae.BASESIZE,this.textSize=o.textSize||this.size,this.phantom=!!o.phantom,this.font=o.font||"",this.fontFamily=o.fontFamily||"",this.fontWeight=o.fontWeight||"",this.fontShape=o.fontShape||"",this.sizeMultiplier=Ke[this.size-1],this.maxSize=o.maxSize,this.minRuleThickness=o.minRuleThickness,this._fontMetrics=void 0}extend(o){const d={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(const m in o)o.hasOwnProperty(m)&&(d[m]=o[m]);return new Ae(d)}havingStyle(o){return this.style===o?this:this.extend({style:o,size:Et(this.textSize,o)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(o){return this.size===o&&this.textSize===o?this:this.extend({style:this.style.text(),size:o,textSize:o,sizeMultiplier:Ke[o-1]})}havingBaseStyle(o){o=o||this.style.text();const d=Et(Ae.BASESIZE,o);return this.size===d&&this.textSize===Ae.BASESIZE&&this.style===o?this:this.extend({style:o,size:d})}havingBaseSizing(){let o;switch(this.style.id){case 4:case 5:o=3;break;case 6:case 7:o=1;break;default:o=6}return this.extend({style:this.style.text(),size:o})}withColor(o){return this.extend({color:o})}withPhantom(){return this.extend({phantom:!0})}withFont(o){return this.extend({font:o})}withTextFontFamily(o){return this.extend({fontFamily:o,font:""})}withTextFontWeight(o){return this.extend({fontWeight:o,font:""})}withTextFontShape(o){return this.extend({fontShape:o,font:""})}sizingClasses(o){return o.size!==this.size?["sizing","reset-size"+o.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==Ae.BASESIZE?["sizing","reset-size"+this.size,"size"+Ae.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=Ne(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}Ae.BASESIZE=6;var be=Ae;const Oe={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},Pe={ex:!0,em:!0,mu:!0},qe=function(c){return typeof c!="string"&&(c=c.unit),c in Oe||c in Pe||c==="ex"},Qe=function(c,o){let d;if(c.unit in Oe)d=Oe[c.unit]/o.fontMetrics().ptPerEm/o.sizeMultiplier;else if(c.unit==="mu")d=o.fontMetrics().cssEmPerMu;else{let m;if(o.style.isTight()?m=o.havingStyle(o.style.text()):m=o,c.unit==="ex")d=m.fontMetrics().xHeight;else if(c.unit==="em")d=m.fontMetrics().quad;else throw new a("Invalid unit: '"+c.unit+"'");m!==o&&(d*=m.sizeMultiplier/o.sizeMultiplier)}return Math.min(c.number*d,o.maxSize)},je=function(c){return+c.toFixed(4)+"em"},un=function(c){return c.filter(o=>o).join(" ")},ur=function(c,o,d){if(this.classes=c||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=d||{},o){o.style.isTight()&&this.classes.push("mtight");const m=o.getColor();m&&(this.style.color=m)}},le=function(c){const o=document.createElement(c);o.className=un(this.classes);for(const d in this.style)this.style.hasOwnProperty(d)&&(o.style[d]=this.style[d]);for(const d in this.attributes)this.attributes.hasOwnProperty(d)&&o.setAttribute(d,this.attributes[d]);for(let d=0;d<this.children.length;d++)o.appendChild(this.children[d].toNode());return o},Te=/[\s"'>/=\x00-\x1f]/,Je=function(c){let o="<"+c;this.classes.length&&(o+=' class="'+w.escape(un(this.classes))+'"');let d="";for(const m in this.style)this.style.hasOwnProperty(m)&&(d+=w.hyphenate(m)+":"+this.style[m]+";");d&&(o+=' style="'+w.escape(d)+'"');for(const m in this.attributes)if(this.attributes.hasOwnProperty(m)){if(Te.test(m))throw new a("Invalid attribute name '"+m+"'");o+=" "+m+'="'+w.escape(this.attributes[m])+'"'}o+=">";for(let m=0;m<this.children.length;m++)o+=this.children[m].toMarkup();return o+="</"+c+">",o};class et{constructor(o,d,m,x){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,ur.call(this,o,m,x),this.children=d||[]}setAttribute(o,d){this.attributes[o]=d}hasClass(o){return w.contains(this.classes,o)}toNode(){return le.call(this,"span")}toMarkup(){return Je.call(this,"span")}}class gt{constructor(o,d,m,x){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,ur.call(this,d,x),this.children=m||[],this.setAttribute("href",o)}setAttribute(o,d){this.attributes[o]=d}hasClass(o){return w.contains(this.classes,o)}toNode(){return le.call(this,"a")}toMarkup(){return Je.call(this,"a")}}class Tt{constructor(o,d,m){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=d,this.src=o,this.classes=["mord"],this.style=m}hasClass(o){return w.contains(this.classes,o)}toNode(){const o=document.createElement("img");o.src=this.src,o.alt=this.alt,o.className="mord";for(const d in this.style)this.style.hasOwnProperty(d)&&(o.style[d]=this.style[d]);return o}toMarkup(){let o='<img src="'+w.escape(this.src)+'"'+(' alt="'+w.escape(this.alt)+'"'),d="";for(const m in this.style)this.style.hasOwnProperty(m)&&(d+=w.hyphenate(m)+":"+this.style[m]+";");return d&&(o+=' style="'+w.escape(d)+'"'),o+="'/>",o}}const ln={:"",:"",:"",:""};class Xt{constructor(o,d,m,x,S,T,R,P){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=o,this.height=d||0,this.depth=m||0,this.italic=x||0,this.skew=S||0,this.width=T||0,this.classes=R||[],this.style=P||{},this.maxFontSize=0;const X=q(this.text.charCodeAt(0));X&&this.classes.push(X+"_fallback"),/[]/.test(this.text)&&(this.text=ln[this.text])}hasClass(o){return w.contains(this.classes,o)}toNode(){const o=document.createTextNode(this.text);let d=null;this.italic>0&&(d=document.createElement("span"),d.style.marginRight=je(this.italic)),this.classes.length>0&&(d=d||document.createElement("span"),d.className=un(this.classes));for(const m in this.style)this.style.hasOwnProperty(m)&&(d=d||document.createElement("span"),d.style[m]=this.style[m]);return d?(d.appendChild(o),d):o}toMarkup(){let o=!1,d="<span";this.classes.length&&(o=!0,d+=' class="',d+=w.escape(un(this.classes)),d+='"');let m="";this.italic>0&&(m+="margin-right:"+this.italic+"em;");for(const S in this.style)this.style.hasOwnProperty(S)&&(m+=w.hyphenate(S)+":"+this.style[S]+";");m&&(o=!0,d+=' style="'+w.escape(m)+'"');const x=w.escape(this.text);return o?(d+=">",d+=x,d+="</span>",d):x}}class Ht{constructor(o,d){this.children=void 0,this.attributes=void 0,this.children=o||[],this.attributes=d||{}}toNode(){const d=document.createElementNS("http://www.w3.org/2000/svg","svg");for(const m in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,m)&&d.setAttribute(m,this.attributes[m]);for(let m=0;m<this.children.length;m++)d.appendChild(this.children[m].toNode());return d}toMarkup(){let o='<svg xmlns="http://www.w3.org/2000/svg"';for(const d in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,d)&&(o+=" "+d+'="'+w.escape(this.attributes[d])+'"');o+=">";for(let d=0;d<this.children.length;d++)o+=this.children[d].toMarkup();return o+="</svg>",o}}class Mt{constructor(o,d){this.pathName=void 0,this.alternate=void 0,this.pathName=o,this.alternate=d}toNode(){const d=document.createElementNS("http://www.w3.org/2000/svg","path");return this.alternate?d.setAttribute("d",this.alternate):d.setAttribute("d",Bt[this.pathName]),d}toMarkup(){return this.alternate?'<path d="'+w.escape(this.alternate)+'"/>':'<path d="'+w.escape(Bt[this.pathName])+'"/>'}}class dr{constructor(o){this.attributes=void 0,this.attributes=o||{}}toNode(){const d=document.createElementNS("http://www.w3.org/2000/svg","line");for(const m in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,m)&&d.setAttribute(m,this.attributes[m]);return d}toMarkup(){let o="<line";for(const d in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,d)&&(o+=" "+d+'="'+w.escape(this.attributes[d])+'"');return o+="/>",o}}function ps(c){if(c instanceof Xt)return c;throw new Error("Expected symbolNode but got "+String(c)+".")}function En(c){if(c instanceof et)return c;throw new Error("Expected span<HtmlDomNode> but got "+String(c)+".")}const Do={bin:1,close:1,inner:1,open:1,punct:1,rel:1},Ro={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},ji={math:{},text:{}};var mn=ji;function v(c,o,d,m,x,S){ji[c][x]={font:o,group:d,replace:m},S&&m&&(ji[c][m]=ji[c][x])}const k="math",_e="text",M="main",$="ams",dn="accent-token",Ze="bin",Qn="close",Ns="inner",ht="mathord",Nn="op-token",hr="open",Ci="punct",U="rel",Lr="spacing",te="textord";v(k,M,U,"","\\equiv",!0),v(k,M,U,"","\\prec",!0),v(k,M,U,"","\\succ",!0),v(k,M,U,"","\\sim",!0),v(k,M,U,"","\\perp"),v(k,M,U,"","\\preceq",!0),v(k,M,U,"","\\succeq",!0),v(k,M,U,"","\\simeq",!0),v(k,M,U,"","\\mid",!0),v(k,M,U,"","\\ll",!0),v(k,M,U,"","\\gg",!0),v(k,M,U,"","\\asymp",!0),v(k,M,U,"","\\parallel"),v(k,M,U,"","\\bowtie",!0),v(k,M,U,"","\\smile",!0),v(k,M,U,"","\\sqsubseteq",!0),v(k,M,U,"","\\sqsupseteq",!0),v(k,M,U,"","\\doteq",!0),v(k,M,U,"","\\frown",!0),v(k,M,U,"","\\ni",!0),v(k,M,U,"","\\propto",!0),v(k,M,U,"","\\vdash",!0),v(k,M,U,"","\\dashv",!0),v(k,M,U,"","\\owns"),v(k,M,Ci,".","\\ldotp"),v(k,M,Ci,"","\\cdotp"),v(k,M,te,"#","\\#"),v(_e,M,te,"#","\\#"),v(k,M,te,"&","\\&"),v(_e,M,te,"&","\\&"),v(k,M,te,"","\\aleph",!0),v(k,M,te,"","\\forall",!0),v(k,M,te,"","\\hbar",!0),v(k,M,te,"","\\exists",!0),v(k,M,te,"","\\nabla",!0),v(k,M,te,"","\\flat",!0),v(k,M,te,"","\\ell",!0),v(k,M,te,"","\\natural",!0),v(k,M,te,"","\\clubsuit",!0),v(k,M,te,"","\\wp",!0),v(k,M,te,"","\\sharp",!0),v(k,M,te,"","\\diamondsuit",!0),v(k,M,te,"","\\Re",!0),v(k,M,te,"","\\heartsuit",!0),v(k,M,te,"","\\Im",!0),v(k,M,te,"","\\spadesuit",!0),v(k,M,te,"","\\S",!0),v(_e,M,te,"","\\S"),v(k,M,te,"","\\P",!0),v(_e,M,te,"","\\P"),v(k,M,te,"","\\dag"),v(_e,M,te,"","\\dag"),v(_e,M,te,"","\\textdagger"),v(k,M,te,"","\\ddag"),v(_e,M,te,"","\\ddag"),v(_e,M,te,"","\\textdaggerdbl"),v(k,M,Qn,"","\\rmoustache",!0),v(k,M,hr,"","\\lmoustache",!0),v(k,M,Qn,"","\\rgroup",!0),v(k,M,hr,"","\\lgroup",!0),v(k,M,Ze,"","\\mp",!0),v(k,M,Ze,"","\\ominus",!0),v(k,M,Ze,"","\\uplus",!0),v(k,M,Ze,"","\\sqcap",!0),v(k,M,Ze,"","\\ast"),v(k,M,Ze,"","\\sqcup",!0),v(k,M,Ze,"","\\bigcirc",!0),v(k,M,Ze,"","\\bullet",!0),v(k,M,Ze,"","\\ddagger"),v(k,M,Ze,"","\\wr",!0),v(k,M,Ze,"","\\amalg"),v(k,M,Ze,"&","\\And"),v(k,M,U,"","\\longleftarrow",!0),v(k,M,U,"","\\Leftarrow",!0),v(k,M,U,"","\\Longleftarrow",!0),v(k,M,U,"","\\longrightarrow",!0),v(k,M,U,"","\\Rightarrow",!0),v(k,M,U,"","\\Longrightarrow",!0),v(k,M,U,"","\\leftrightarrow",!0),v(k,M,U,"","\\longleftrightarrow",!0),v(k,M,U,"","\\Leftrightarrow",!0),v(k,M,U,"","\\Longleftrightarrow",!0),v(k,M,U,"","\\mapsto",!0),v(k,M,U,"","\\longmapsto",!0),v(k,M,U,"","\\nearrow",!0),v(k,M,U,"","\\hookleftarrow",!0),v(k,M,U,"","\\hookrightarrow",!0),v(k,M,U,"","\\searrow",!0),v(k,M,U,"","\\leftharpoonup",!0),v(k,M,U,"","\\rightharpoonup",!0),v(k,M,U,"","\\swarrow",!0),v(k,M,U,"","\\leftharpoondown",!0),v(k,M,U,"","\\rightharpoondown",!0),v(k,M,U,"","\\nwarrow",!0),v(k,M,U,"","\\rightleftharpoons",!0),v(k,$,U,"","\\nless",!0),v(k,$,U,"","\\@nleqslant"),v(k,$,U,"","\\@nleqq"),v(k,$,U,"","\\lneq",!0),v(k,$,U,"","\\lneqq",!0),v(k,$,U,"","\\@lvertneqq"),v(k,$,U,"","\\lnsim",!0),v(k,$,U,"","\\lnapprox",!0),v(k,$,U,"","\\nprec",!0),v(k,$,U,"","\\npreceq",!0),v(k,$,U,"","\\precnsim",!0),v(k,$,U,"","\\precnapprox",!0),v(k,$,U,"","\\nsim",!0),v(k,$,U,"","\\@nshortmid"),v(k,$,U,"","\\nmid",!0),v(k,$,U,"","\\nvdash",!0),v(k,$,U,"","\\nvDash",!0),v(k,$,U,"","\\ntriangleleft"),v(k,$,U,"","\\ntrianglelefteq",!0),v(k,$,U,"","\\subsetneq",!0),v(k,$,U,"","\\@varsubsetneq"),v(k,$,U,"","\\subsetneqq",!0),v(k,$,U,"","\\@varsubsetneqq"),v(k,$,U,"","\\ngtr",!0),v(k,$,U,"","\\@ngeqslant"),v(k,$,U,"","\\@ngeqq"),v(k,$,U,"","\\gneq",!0),v(k,$,U,"","\\gneqq",!0),v(k,$,U,"","\\@gvertneqq"),v(k,$,U,"","\\gnsim",!0),v(k,$,U,"","\\gnapprox",!0),v(k,$,U,"","\\nsucc",!0),v(k,$,U,"","\\nsucceq",!0),v(k,$,U,"","\\succnsim",!0),v(k,$,U,"","\\succnapprox",!0),v(k,$,U,"","\\ncong",!0),v(k,$,U,"","\\@nshortparallel"),v(k,$,U,"","\\nparallel",!0),v(k,$,U,"","\\nVDash",!0),v(k,$,U,"","\\ntriangleright"),v(k,$,U,"","\\ntrianglerighteq",!0),v(k,$,U,"","\\@nsupseteqq"),v(k,$,U,"","\\supsetneq",!0),v(k,$,U,"","\\@varsupsetneq"),v(k,$,U,"","\\supsetneqq",!0),v(k,$,U,"","\\@varsupsetneqq"),v(k,$,U,"","\\nVdash",!0),v(k,$,U,"","\\precneqq",!0),v(k,$,U,"","\\succneqq",!0),v(k,$,U,"","\\@nsubseteqq"),v(k,$,Ze,"","\\unlhd"),v(k,$,Ze,"","\\unrhd"),v(k,$,U,"","\\nleftarrow",!0),v(k,$,U,"","\\nrightarrow",!0),v(k,$,U,"","\\nLeftarrow",!0),v(k,$,U,"","\\nRightarrow",!0),v(k,$,U,"","\\nleftrightarrow",!0),v(k,$,U,"","\\nLeftrightarrow",!0),v(k,$,U,"","\\vartriangle"),v(k,$,te,"","\\hslash"),v(k,$,te,"","\\triangledown"),v(k,$,te,"","\\lozenge"),v(k,$,te,"","\\circledS"),v(k,$,te,"","\\circledR"),v(_e,$,te,"","\\circledR"),v(k,$,te,"","\\measuredangle",!0),v(k,$,te,"","\\nexists"),v(k,$,te,"","\\mho"),v(k,$,te,"","\\Finv",!0),v(k,$,te,"","\\Game",!0),v(k,$,te,"","\\backprime"),v(k,$,te,"","\\blacktriangle"),v(k,$,te,"","\\blacktriangledown"),v(k,$,te,"","\\blacksquare"),v(k,$,te,"","\\blacklozenge"),v(k,$,te,"","\\bigstar"),v(k,$,te,"","\\sphericalangle",!0),v(k,$,te,"","\\complement",!0),v(k,$,te,"","\\eth",!0),v(_e,M,te,"",""),v(k,$,te,"","\\diagup"),v(k,$,te,"","\\diagdown"),v(k,$,te,"","\\square"),v(k,$,te,"","\\Box"),v(k,$,te,"","\\Diamond"),v(k,$,te,"","\\yen",!0),v(_e,$,te,"","\\yen",!0),v(k,$,te,"","\\checkmark",!0),v(_e,$,te,"","\\checkmark"),v(k,$,te,"","\\beth",!0),v(k,$,te,"","\\daleth",!0),v(k,$,te,"","\\gimel",!0),v(k,$,te,"","\\digamma",!0),v(k,$,te,"","\\varkappa"),v(k,$,hr,"","\\@ulcorner",!0),v(k,$,Qn,"","\\@urcorner",!0),v(k,$,hr,"","\\@llcorner",!0),v(k,$,Qn,"","\\@lrcorner",!0),v(k,$,U,"","\\leqq",!0),v(k,$,U,"","\\leqslant",!0),v(k,$,U,"","\\eqslantless",!0),v(k,$,U,"","\\lesssim",!0),v(k,$,U,"","\\lessapprox",!0),v(k,$,U,"","\\approxeq",!0),v(k,$,Ze,"","\\lessdot"),v(k,$,U,"","\\lll",!0),v(k,$,U,"","\\lessgtr",!0),v(k,$,U,"","\\lesseqgtr",!0),v(k,$,U,"","\\lesseqqgtr",!0),v(k,$,U,"","\\doteqdot"),v(k,$,U,"","\\risingdotseq",!0),v(k,$,U,"","\\fallingdotseq",!0),v(k,$,U,"","\\backsim",!0),v(k,$,U,"","\\backsimeq",!0),v(k,$,U,"","\\subseteqq",!0),v(k,$,U,"","\\Subset",!0),v(k,$,U,"","\\sqsubset",!0),v(k,$,U,"","\\preccurlyeq",!0),v(k,$,U,"","\\curlyeqprec",!0),v(k,$,U,"","\\precsim",!0),v(k,$,U,"","\\precapprox",!0),v(k,$,U,"","\\vartriangleleft"),v(k,$,U,"","\\trianglelefteq"),v(k,$,U,"","\\vDash",!0),v(k,$,U,"","\\Vvdash",!0),v(k,$,U,"","\\smallsmile"),v(k,$,U,"","\\smallfrown"),v(k,$,U,"","\\bumpeq",!0),v(k,$,U,"","\\Bumpeq",!0),v(k,$,U,"","\\geqq",!0),v(k,$,U,"","\\geqslant",!0),v(k,$,U,"","\\eqslantgtr",!0),v(k,$,U,"","\\gtrsim",!0),v(k,$,U,"","\\gtrapprox",!0),v(k,$,Ze,"","\\gtrdot"),v(k,$,U,"","\\ggg",!0),v(k,$,U,"","\\gtrless",!0),v(k,$,U,"","\\gtreqless",!0),v(k,$,U,"","\\gtreqqless",!0),v(k,$,U,"","\\eqcirc",!0),v(k,$,U,"","\\circeq",!0),v(k,$,U,"","\\triangleq",!0),v(k,$,U,"","\\thicksim"),v(k,$,U,"","\\thickapprox"),v(k,$,U,"","\\supseteqq",!0),v(k,$,U,"","\\Supset",!0),v(k,$,U,"","\\sqsupset",!0),v(k,$,U,"","\\succcurlyeq",!0),v(k,$,U,"","\\curlyeqsucc",!0),v(k,$,U,"","\\succsim",!0),v(k,$,U,"","\\succapprox",!0),v(k,$,U,"","\\vartriangleright"),v(k,$,U,"","\\trianglerighteq"),v(k,$,U,"","\\Vdash",!0),v(k,$,U,"","\\shortmid"),v(k,$,U,"","\\shortparallel"),v(k,$,U,"","\\between",!0),v(k,$,U,"","\\pitchfork",!0),v(k,$,U,"","\\varpropto"),v(k,$,U,"","\\blacktriangleleft"),v(k,$,U,"","\\therefore",!0),v(k,$,U,"","\\backepsilon"),v(k,$,U,"","\\blacktriangleright"),v(k,$,U,"","\\because",!0),v(k,$,U,"","\\llless"),v(k,$,U,"","\\gggtr"),v(k,$,Ze,"","\\lhd"),v(k,$,Ze,"","\\rhd"),v(k,$,U,"","\\eqsim",!0),v(k,M,U,"","\\Join"),v(k,$,U,"","\\Doteq",!0),v(k,$,Ze,"","\\dotplus",!0),v(k,$,Ze,"","\\smallsetminus"),v(k,$,Ze,"","\\Cap",!0),v(k,$,Ze,"","\\Cup",!0),v(k,$,Ze,"","\\doublebarwedge",!0),v(k,$,Ze,"","\\boxminus",!0),v(k,$,Ze,"","\\boxplus",!0),v(k,$,Ze,"","\\divideontimes",!0),v(k,$,Ze,"","\\ltimes",!0),v(k,$,Ze,"","\\rtimes",!0),v(k,$,Ze,"","\\leftthreetimes",!0),v(k,$,Ze,"","\\rightthreetimes",!0),v(k,$,Ze,"","\\curlywedge",!0),v(k,$,Ze,"","\\curlyvee",!0),v(k,$,Ze,"","\\circleddash",!0),v(k,$,Ze,"","\\circledast",!0),v(k,$,Ze,"","\\centerdot"),v(k,$,Ze,"","\\intercal",!0),v(k,$,Ze,"","\\doublecap"),v(k,$,Ze,"","\\doublecup"),v(k,$,Ze,"","\\boxtimes",!0),v(k,$,U,"","\\dashrightarrow",!0),v(k,$,U,"","\\dashleftarrow",!0),v(k,$,U,"","\\leftleftarrows",!0),v(k,$,U,"","\\leftrightarrows",!0),v(k,$,U,"","\\Lleftarrow",!0),v(k,$,U,"","\\twoheadleftarrow",!0),v(k,$,U,"","\\leftarrowtail",!0),v(k,$,U,"","\\looparrowleft",!0),v(k,$,U,"","\\leftrightharpoons",!0),v(k,$,U,"","\\curvearrowleft",!0),v(k,$,U,"","\\circlearrowleft",!0),v(k,$,U,"","\\Lsh",!0),v(k,$,U,"","\\upuparrows",!0),v(k,$,U,"","\\upharpoonleft",!0),v(k,$,U,"","\\downharpoonleft",!0),v(k,M,U,"","\\origof",!0),v(k,M,U,"","\\imageof",!0),v(k,$,U,"","\\multimap",!0),v(k,$,U,"","\\leftrightsquigarrow",!0),v(k,$,U,"","\\rightrightarrows",!0),v(k,$,U,"","\\rightleftarrows",!0),v(k,$,U,"","\\twoheadrightarrow",!0),v(k,$,U,"","\\rightarrowtail",!0),v(k,$,U,"","\\looparrowright",!0),v(k,$,U,"","\\curvearrowright",!0),v(k,$,U,"","\\circlearrowright",!0),v(k,$,U,"","\\Rsh",!0),v(k,$,U,"","\\downdownarrows",!0),v(k,$,U,"","\\upharpoonright",!0),v(k,$,U,"","\\downharpoonright",!0),v(k,$,U,"","\\rightsquigarrow",!0),v(k,$,U,"","\\leadsto"),v(k,$,U,"","\\Rrightarrow",!0),v(k,$,U,"","\\restriction"),v(k,M,te,"","`"),v(k,M,te,"$","\\$"),v(_e,M,te,"$","\\$"),v(_e,M,te,"$","\\textdollar"),v(k,M,te,"%","\\%"),v(_e,M,te,"%","\\%"),v(k,M,te,"_","\\_"),v(_e,M,te,"_","\\_"),v(_e,M,te,"_","\\textunderscore"),v(k,M,te,"","\\angle",!0),v(k,M,te,"","\\infty",!0),v(k,M,te,"","\\prime"),v(k,M,te,"","\\triangle"),v(k,M,te,"","\\Gamma",!0),v(k,M,te,"","\\Delta",!0),v(k,M,te,"","\\Theta",!0),v(k,M,te,"","\\Lambda",!0),v(k,M,te,"","\\Xi",!0),v(k,M,te,"","\\Pi",!0),v(k,M,te,"","\\Sigma",!0),v(k,M,te,"","\\Upsilon",!0),v(k,M,te,"","\\Phi",!0),v(k,M,te,"","\\Psi",!0),v(k,M,te,"","\\Omega",!0),v(k,M,te,"A",""),v(k,M,te,"B",""),v(k,M,te,"E",""),v(k,M,te,"Z",""),v(k,M,te,"H",""),v(k,M,te,"I",""),v(k,M,te,"K",""),v(k,M,te,"M",""),v(k,M,te,"N",""),v(k,M,te,"O",""),v(k,M,te,"P",""),v(k,M,te,"T",""),v(k,M,te,"X",""),v(k,M,te,"","\\neg",!0),v(k,M,te,"","\\lnot"),v(k,M,te,"","\\top"),v(k,M,te,"","\\bot"),v(k,M,te,"","\\emptyset"),v(k,$,te,"","\\varnothing"),v(k,M,ht,"","\\alpha",!0),v(k,M,ht,"","\\beta",!0),v(k,M,ht,"","\\gamma",!0),v(k,M,ht,"","\\delta",!0),v(k,M,ht,"","\\epsilon",!0),v(k,M,ht,"","\\zeta",!0),v(k,M,ht,"","\\eta",!0),v(k,M,ht,"","\\theta",!0),v(k,M,ht,"","\\iota",!0),v(k,M,ht,"","\\kappa",!0),v(k,M,ht,"","\\lambda",!0),v(k,M,ht,"","\\mu",!0),v(k,M,ht,"","\\nu",!0),v(k,M,ht,"","\\xi",!0),v(k,M,ht,"","\\omicron",!0),v(k,M,ht,"","\\pi",!0),v(k,M,ht,"","\\rho",!0),v(k,M,ht,"","\\sigma",!0),v(k,M,ht,"","\\tau",!0),v(k,M,ht,"","\\upsilon",!0),v(k,M,ht,"","\\phi",!0),v(k,M,ht,"","\\chi",!0),v(k,M,ht,"","\\psi",!0),v(k,M,ht,"","\\omega",!0),v(k,M,ht,"","\\varepsilon",!0),v(k,M,ht,"","\\vartheta",!0),v(k,M,ht,"","\\varpi",!0),v(k,M,ht,"","\\varrho",!0),v(k,M,ht,"","\\varsigma",!0),v(k,M,ht,"","\\varphi",!0),v(k,M,Ze,"","*",!0),v(k,M,Ze,"+","+"),v(k,M,Ze,"","-",!0),v(k,M,Ze,"","\\cdot",!0),v(k,M,Ze,"","\\circ",!0),v(k,M,Ze,"","\\div",!0),v(k,M,Ze,"","\\pm",!0),v(k,M,Ze,"","\\times",!0),v(k,M,Ze,"","\\cap",!0),v(k,M,Ze,"","\\cup",!0),v(k,M,Ze,"","\\setminus",!0),v(k,M,Ze,"","\\land"),v(k,M,Ze,"","\\lor"),v(k,M,Ze,"","\\wedge",!0),v(k,M,Ze,"","\\vee",!0),v(k,M,te,"","\\surd"),v(k,M,hr,"","\\langle",!0),v(k,M,hr,"","\\lvert"),v(k,M,hr,"","\\lVert"),v(k,M,Qn,"?","?"),v(k,M,Qn,"!","!"),v(k,M,Qn,"","\\rangle",!0),v(k,M,Qn,"","\\rvert"),v(k,M,Qn,"","\\rVert"),v(k,M,U,"=","="),v(k,M,U,":",":"),v(k,M,U,"","\\approx",!0),v(k,M,U,"","\\cong",!0),v(k,M,U,"","\\ge"),v(k,M,U,"","\\geq",!0),v(k,M,U,"","\\gets"),v(k,M,U,">","\\gt",!0),v(k,M,U,"","\\in",!0),v(k,M,U,"","\\@not"),v(k,M,U,"","\\subset",!0),v(k,M,U,"","\\supset",!0),v(k,M,U,"","\\subseteq",!0),v(k,M,U,"","\\supseteq",!0),v(k,$,U,"","\\nsubseteq",!0),v(k,$,U,"","\\nsupseteq",!0),v(k,M,U,"","\\models"),v(k,M,U,"","\\leftarrow",!0),v(k,M,U,"","\\le"),v(k,M,U,"","\\leq",!0),v(k,M,U,"<","\\lt",!0),v(k,M,U,"","\\rightarrow",!0),v(k,M,U,"","\\to"),v(k,$,U,"","\\ngeq",!0),v(k,$,U,"","\\nleq",!0),v(k,M,Lr,"","\\ "),v(k,M,Lr,"","\\space"),v(k,M,Lr,"","\\nobreakspace"),v(_e,M,Lr,"","\\ "),v(_e,M,Lr,""," "),v(_e,M,Lr,"","\\space"),v(_e,M,Lr,"","\\nobreakspace"),v(k,M,Lr,null,"\\nobreak"),v(k,M,Lr,null,"\\allowbreak"),v(k,M,Ci,",",","),v(k,M,Ci,";",";"),v(k,$,Ze,"","\\barwedge",!0),v(k,$,Ze,"","\\veebar",!0),v(k,M,Ze,"","\\odot",!0),v(k,M,Ze,"","\\oplus",!0),v(k,M,Ze,"","\\otimes",!0),v(k,M,te,"","\\partial",!0),v(k,M,Ze,"","\\oslash",!0),v(k,$,Ze,"","\\circledcirc",!0),v(k,$,Ze,"","\\boxdot",!0),v(k,M,Ze,"","\\bigtriangleup"),v(k,M,Ze,"","\\bigtriangledown"),v(k,M,Ze,"","\\dagger"),v(k,M,Ze,"","\\diamond"),v(k,M,Ze,"","\\star"),v(k,M,Ze,"","\\triangleleft"),v(k,M,Ze,"","\\triangleright"),v(k,M,hr,"{","\\{"),v(_e,M,te,"{","\\{"),v(_e,M,te,"{","\\textbraceleft"),v(k,M,Qn,"}","\\}"),v(_e,M,te,"}","\\}"),v(_e,M,te,"}","\\textbraceright"),v(k,M,hr,"{","\\lbrace"),v(k,M,Qn,"}","\\rbrace"),v(k,M,hr,"[","\\lbrack",!0),v(_e,M,te,"[","\\lbrack",!0),v(k,M,Qn,"]","\\rbrack",!0),v(_e,M,te,"]","\\rbrack",!0),v(k,M,hr,"(","\\lparen",!0),v(k,M,Qn,")","\\rparen",!0),v(_e,M,te,"<","\\textless",!0),v(_e,M,te,">","\\textgreater",!0),v(k,M,hr,"","\\lfloor",!0),v(k,M,Qn,"","\\rfloor",!0),v(k,M,hr,"","\\lceil",!0),v(k,M,Qn,"","\\rceil",!0),v(k,M,te,"\\","\\backslash"),v(k,M,te,"","|"),v(k,M,te,"","\\vert"),v(_e,M,te,"|","\\textbar",!0),v(k,M,te,"","\\|"),v(k,M,te,"","\\Vert"),v(_e,M,te,"","\\textbardbl"),v(_e,M,te,"~","\\textasciitilde"),v(_e,M,te,"\\","\\textbackslash"),v(_e,M,te,"^","\\textasciicircum"),v(k,M,U,"","\\uparrow",!0),v(k,M,U,"","\\Uparrow",!0),v(k,M,U,"","\\downarrow",!0),v(k,M,U,"","\\Downarrow",!0),v(k,M,U,"","\\updownarrow",!0),v(k,M,U,"","\\Updownarrow",!0),v(k,M,Nn,"","\\coprod"),v(k,M,Nn,"","\\bigvee"),v(k,M,Nn,"","\\bigwedge"),v(k,M,Nn,"","\\biguplus"),v(k,M,Nn,"","\\bigcap"),v(k,M,Nn,"","\\bigcup"),v(k,M,Nn,"","\\int"),v(k,M,Nn,"","\\intop"),v(k,M,Nn,"","\\iint"),v(k,M,Nn,"","\\iiint"),v(k,M,Nn,"","\\prod"),v(k,M,Nn,"","\\sum"),v(k,M,Nn,"","\\bigotimes"),v(k,M,Nn,"","\\bigoplus"),v(k,M,Nn,"","\\bigodot"),v(k,M,Nn,"","\\oint"),v(k,M,Nn,"","\\oiint"),v(k,M,Nn,"","\\oiiint"),v(k,M,Nn,"","\\bigsqcup"),v(k,M,Nn,"","\\smallint"),v(_e,M,Ns,"","\\textellipsis"),v(k,M,Ns,"","\\mathellipsis"),v(_e,M,Ns,"","\\ldots",!0),v(k,M,Ns,"","\\ldots",!0),v(k,M,Ns,"","\\@cdots",!0),v(k,M,Ns,"","\\ddots",!0),v(k,M,te,"","\\varvdots"),v(_e,M,te,"","\\varvdots"),v(k,M,dn,"","\\acute"),v(k,M,dn,"","\\grave"),v(k,M,dn,"","\\ddot"),v(k,M,dn,"~","\\tilde"),v(k,M,dn,"","\\bar"),v(k,M,dn,"","\\breve"),v(k,M,dn,"","\\check"),v(k,M,dn,"^","\\hat"),v(k,M,dn,"","\\vec"),v(k,M,dn,"","\\dot"),v(k,M,dn,"","\\mathring"),v(k,M,ht,"","\\@imath"),v(k,M,ht,"","\\@jmath"),v(k,M,te,"",""),v(k,M,te,"",""),v(_e,M,te,"","\\i",!0),v(_e,M,te,"","\\j",!0),v(_e,M,te,"","\\ss",!0),v(_e,M,te,"","\\ae",!0),v(_e,M,te,"","\\oe",!0),v(_e,M,te,"","\\o",!0),v(_e,M,te,"","\\AE",!0),v(_e,M,te,"","\\OE",!0),v(_e,M,te,"","\\O",!0),v(_e,M,dn,"","\\'"),v(_e,M,dn,"","\\`"),v(_e,M,dn,"","\\^"),v(_e,M,dn,"","\\~"),v(_e,M,dn,"","\\="),v(_e,M,dn,"","\\u"),v(_e,M,dn,"","\\."),v(_e,M,dn,"","\\c"),v(_e,M,dn,"","\\r"),v(_e,M,dn,"","\\v"),v(_e,M,dn,"",'\\"'),v(_e,M,dn,"","\\H"),v(_e,M,dn,"","\\textcircled");const K={"--":!0,"---":!0,"``":!0,"''":!0};v(_e,M,te,"","--",!0),v(_e,M,te,"","\\textendash"),v(_e,M,te,"","---",!0),v(_e,M,te,"","\\textemdash"),v(_e,M,te,"","`",!0),v(_e,M,te,"","\\textquoteleft"),v(_e,M,te,"","'",!0),v(_e,M,te,"","\\textquoteright"),v(_e,M,te,"","``",!0),v(_e,M,te,"","\\textquotedblleft"),v(_e,M,te,"","''",!0),v(_e,M,te,"","\\textquotedblright"),v(k,M,te,"","\\degree",!0),v(_e,M,te,"","\\degree"),v(_e,M,te,"","\\textdegree",!0),v(k,M,te,"","\\pounds"),v(k,M,te,"","\\mathsterling",!0),v(_e,M,te,"","\\pounds"),v(_e,M,te,"","\\textsterling",!0),v(k,$,te,"","\\maltese"),v(_e,$,te,"","\\maltese");const se='0123456789/@."';for(let c=0;c<se.length;c++){const o=se.charAt(c);v(k,M,te,o,o)}const Re='0123456789!@*()-=+";:?/.,';for(let c=0;c<Re.length;c++){const o=Re.charAt(c);v(_e,M,te,o,o)}const Fe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(let c=0;c<Fe.length;c++){const o=Fe.charAt(c);v(k,M,ht,o,o),v(_e,M,te,o,o)}v(k,$,te,"C",""),v(_e,$,te,"C",""),v(k,$,te,"H",""),v(_e,$,te,"H",""),v(k,$,te,"N",""),v(_e,$,te,"N",""),v(k,$,te,"P",""),v(_e,$,te,"P",""),v(k,$,te,"Q",""),v(_e,$,te,"Q",""),v(k,$,te,"R",""),v(_e,$,te,"R",""),v(k,$,te,"Z",""),v(_e,$,te,"Z",""),v(k,M,ht,"h",""),v(_e,M,ht,"h","");let De="";for(let c=0;c<Fe.length;c++){const o=Fe.charAt(c);De=String.fromCharCode(55349,56320+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56372+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56424+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56580+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56684+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56736+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56788+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56840+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56944+c),v(k,M,ht,o,De),v(_e,M,te,o,De),c<26&&(De=String.fromCharCode(55349,56632+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,56476+c),v(k,M,ht,o,De),v(_e,M,te,o,De))}De="",v(k,M,ht,"k",De),v(_e,M,te,"k",De);for(let c=0;c<10;c++){const o=c.toString();De=String.fromCharCode(55349,57294+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,57314+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,57324+c),v(k,M,ht,o,De),v(_e,M,te,o,De),De=String.fromCharCode(55349,57334+c),v(k,M,ht,o,De),v(_e,M,te,o,De)}const It="";for(let c=0;c<It.length;c++){const o=It.charAt(c);v(k,M,ht,o,o),v(_e,M,te,o,o)}const Ft=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],St=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],Un=function(c,o){const d=c.charCodeAt(0),m=c.charCodeAt(1),x=(d-55296)*1024+(m-56320)+65536,S=o==="math"?0:1;if(119808<=x&&x<120484){const T=Math.floor((x-119808)/26);return[Ft[T][2],Ft[T][S]]}else if(120782<=x&&x<=120831){const T=Math.floor((x-120782)/10);return[St[T][2],St[T][S]]}else{if(x===120485||x===120486)return[Ft[0][2],Ft[0][S]];if(120486<x&&x<120782)return["",""];throw new a("Unsupported character: "+c)}},jn=function(c,o,d){return mn[d][c]&&mn[d][c].replace&&(c=mn[d][c].replace),{value:c,metrics:Ve(c,o,d)}},At=function(c,o,d,m,x){const S=jn(c,o,d),T=S.metrics;c=S.value;let R;if(T){let P=T.italic;(d==="text"||m&&m.font==="mathit")&&(P=0),R=new Xt(c,T.height,T.depth,P,T.skew,T.width,x)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+c+"' in style '"+o+"' and mode '"+d+"'")),R=new Xt(c,0,0,0,0,0,x);if(m){R.maxFontSize=m.sizeMultiplier,m.style.isTight()&&R.classes.push("mtight");const P=m.getColor();P&&(R.style.color=P)}return R},Wn=function(c,o,d,m){return m===void 0&&(m=[]),d.font==="boldsymbol"&&jn(c,"Main-Bold",o).metrics?At(c,"Main-Bold",o,d,m.concat(["mathbf"])):c==="\\"||mn[o][c].font==="main"?At(c,"Main-Regular",o,d,m):At(c,"AMS-Regular",o,d,m.concat(["amsrm"]))},Ui=function(c,o,d,m,x){return x!=="textord"&&jn(c,"Math-BoldItalic",o).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},Wi=function(c,o,d){const m=c.mode,x=c.text,S=["mord"],T=m==="math"||m==="text"&&o.font,R=T?o.font:o.fontFamily;let P="",X="";if(x.charCodeAt(0)===55349&&([P,X]=Un(x,m)),P.length>0)return At(x,P,m,o,S.concat(X));if(R){let ie,oe;if(R==="boldsymbol"){const me=Ui(x,m,o,S,d);ie=me.fontName,oe=[me.fontClass]}else T?(ie=g0[R].fontName,oe=[R]):(ie=Vo(R,o.fontWeight,o.fontShape),oe=[R,o.fontWeight,o.fontShape]);if(jn(x,ie,m).metrics)return At(x,ie,m,o,S.concat(oe));if(K.hasOwnProperty(x)&&ie.slice(0,10)==="Typewriter"){const me=[];for(let Me=0;Me<x.length;Me++)me.push(At(x[Me],ie,m,o,S.concat(oe)));return Js(me)}}if(d==="mathord")return At(x,"Math-Italic",m,o,S.concat(["mathnormal"]));if(d==="textord"){const ie=mn[m][x]&&mn[m][x].font;if(ie==="ams"){const oe=Vo("amsrm",o.fontWeight,o.fontShape);return At(x,oe,m,o,S.concat("amsrm",o.fontWeight,o.fontShape))}else if(ie==="main"||!ie){const oe=Vo("textrm",o.fontWeight,o.fontShape);return At(x,oe,m,o,S.concat(o.fontWeight,o.fontShape))}else{const oe=Vo(ie,o.fontWeight,o.fontShape);return At(x,oe,m,o,S.concat(oe,o.fontWeight,o.fontShape))}}else throw new Error("unexpected type: "+d+" in makeOrd")},Ti=(c,o)=>{if(un(c.classes)!==un(o.classes)||c.skew!==o.skew||c.maxFontSize!==o.maxFontSize)return!1;if(c.classes.length===1){const d=c.classes[0];if(d==="mbin"||d==="mord")return!1}for(const d in c.style)if(c.style.hasOwnProperty(d)&&c.style[d]!==o.style[d])return!1;for(const d in o.style)if(o.style.hasOwnProperty(d)&&c.style[d]!==o.style[d])return!1;return!0},Va=c=>{for(let o=0;o<c.length-1;o++){const d=c[o],m=c[o+1];d instanceof Xt&&m instanceof Xt&&Ti(d,m)&&(d.text+=m.text,d.height=Math.max(d.height,m.height),d.depth=Math.max(d.depth,m.depth),d.italic=m.italic,c.splice(o+1,1),o--)}return c},Zi=function(c){let o=0,d=0,m=0;for(let x=0;x<c.children.length;x++){const S=c.children[x];S.height>o&&(o=S.height),S.depth>d&&(d=S.depth),S.maxFontSize>m&&(m=S.maxFontSize)}c.height=o,c.depth=d,c.maxFontSize=m},Rn=function(c,o,d,m){const x=new et(c,o,d,m);return Zi(x),x},za=(c,o,d,m)=>new et(c,o,d,m),Oo=function(c,o,d){const m=Rn([c],[],o);return m.height=Math.max(d||o.fontMetrics().defaultRuleThickness,o.minRuleThickness),m.style.borderBottomWidth=je(m.height),m.maxFontSize=1,m},Ms=function(c,o,d,m){const x=new gt(c,o,d,m);return Zi(x),x},Js=function(c){const o=new Fn(c);return Zi(o),o},Yi=function(c,o){return c instanceof Fn?Rn([],[c],o):c},xc=function(c){if(c.positionType==="individualShift"){const d=c.children,m=[d[0]],x=-d[0].shift-d[0].elem.depth;let S=x;for(let T=1;T<d.length;T++){const R=-d[T].shift-S-d[T].elem.depth,P=R-(d[T-1].elem.height+d[T-1].elem.depth);S=S+R,m.push({type:"kern",size:P}),m.push(d[T])}return{children:m,depth:x}}let o;if(c.positionType==="top"){let d=c.positionData;for(let m=0;m<c.children.length;m++){const x=c.children[m];d-=x.type==="kern"?x.size:x.elem.height+x.elem.depth}o=d}else if(c.positionType==="bottom")o=-c.positionData;else{const d=c.children[0];if(d.type!=="elem")throw new Error('First child must have type "elem".');if(c.positionType==="shift")o=-d.elem.depth-c.positionData;else if(c.positionType==="firstBaseline")o=-d.elem.depth;else throw new Error("Invalid positionType "+c.positionType+".")}return{children:c.children,depth:o}},Q1=function(c,o){const{children:d,depth:m}=xc(c);let x=0;for(let Me=0;Me<d.length;Me++){const Xe=d[Me];if(Xe.type==="elem"){const lt=Xe.elem;x=Math.max(x,lt.maxFontSize,lt.height)}}x+=2;const S=Rn(["pstrut"],[]);S.style.height=je(x);const T=[];let R=m,P=m,X=m;for(let Me=0;Me<d.length;Me++){const Xe=d[Me];if(Xe.type==="kern")X+=Xe.size;else{const lt=Xe.elem,Vt=Xe.wrapperClasses||[],Dt=Xe.wrapperStyle||{},Lt=Rn(Vt,[S,lt],void 0,Dt);Lt.style.top=je(-x-X-lt.depth),Xe.marginLeft&&(Lt.style.marginLeft=Xe.marginLeft),Xe.marginRight&&(Lt.style.marginRight=Xe.marginRight),T.push(Lt),X+=lt.height+lt.depth}R=Math.min(R,X),P=Math.max(P,X)}const ie=Rn(["vlist"],T);ie.style.height=je(P);let oe;if(R<0){const Me=Rn([],[]),Xe=Rn(["vlist"],[Me]);Xe.style.height=je(-R);const lt=Rn(["vlist-s"],[new Xt("")]);oe=[Rn(["vlist-r"],[ie,lt]),Rn(["vlist-r"],[Xe])]}else oe=[Rn(["vlist-r"],[ie])];const me=Rn(["vlist-t"],oe);return oe.length===2&&me.classes.push("vlist-t2"),me.height=P,me.depth=-R,me},ey=(c,o)=>{const d=Rn(["mspace"],[],o),m=Qe(c,o);return d.style.marginRight=je(m),d},Vo=function(c,o,d){let m="";switch(c){case"amsrm":m="AMS";break;case"textrm":m="Main";break;case"textsf":m="SansSerif";break;case"texttt":m="Typewriter";break;default:m=c}let x;return o==="textbf"&&d==="textit"?x="BoldItalic":o==="textbf"?x="Bold":o==="textit"?x="Italic":x="Regular",m+"-"+x},g0={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},y0={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]};var de={fontMap:g0,makeSymbol:At,mathsym:Wn,makeSpan:Rn,makeSvgSpan:za,makeLineSpan:Oo,makeAnchor:Ms,makeFragment:Js,wrapFragment:Yi,makeVList:Q1,makeOrd:Wi,makeGlue:ey,staticSvg:function(c,o){const[d,m,x]=y0[c],S=new Mt(d),T=new Ht([S],{width:je(m),height:je(x),style:"width:"+je(m),viewBox:"0 0 "+1e3*m+" "+1e3*x,preserveAspectRatio:"xMinYMin"}),R=za(["overlay"],[T],o);return R.height=x,R.style.height=je(x),R.style.width=je(m),R},svgData:y0,tryCombineChars:Va};const Mn={number:3,unit:"mu"},Ii={number:4,unit:"mu"},Ds={number:5,unit:"mu"},ty={mord:{mop:Mn,mbin:Ii,mrel:Ds,minner:Mn},mop:{mord:Mn,mop:Mn,mrel:Ds,minner:Mn},mbin:{mord:Ii,mop:Ii,mopen:Ii,minner:Ii},mrel:{mord:Ds,mop:Ds,mopen:Ds,minner:Ds},mopen:{},mclose:{mop:Mn,mbin:Ii,mrel:Ds,minner:Mn},mpunct:{mord:Mn,mop:Mn,mrel:Ds,mopen:Mn,mclose:Mn,mpunct:Mn,minner:Mn},minner:{mord:Mn,mop:Mn,mbin:Ii,mrel:Ds,mopen:Mn,mpunct:Mn,minner:Mn}},ny={mord:{mop:Mn},mop:{mord:Mn,mop:Mn},mbin:{},mrel:{},mopen:{},mclose:{mop:Mn},mpunct:{},minner:{mop:Mn}},x0={},zo={},Po={};function We(c){let{type:o,names:d,props:m,handler:x,htmlBuilder:S,mathmlBuilder:T}=c;const R={type:o,numArgs:m.numArgs,argTypes:m.argTypes,allowedInArgument:!!m.allowedInArgument,allowedInText:!!m.allowedInText,allowedInMath:m.allowedInMath===void 0?!0:m.allowedInMath,numOptionalArgs:m.numOptionalArgs||0,infix:!!m.infix,primitive:!!m.primitive,handler:x};for(let P=0;P<d.length;++P)x0[d[P]]=R;o&&(S&&(zo[o]=S),T&&(Po[o]=T))}function Ai(c){let{type:o,htmlBuilder:d,mathmlBuilder:m}=c;We({type:o,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:d,mathmlBuilder:m})}const Bo=function(c){return c.type==="ordgroup"&&c.body.length===1?c.body[0]:c},$n=function(c){return c.type==="ordgroup"?c.body:[c]},Rs=de.makeSpan,ry=["leftmost","mbin","mopen","mrel","mop","mpunct"],sy=["rightmost","mrel","mclose","mpunct"],iy={display:ue.DISPLAY,text:ue.TEXT,script:ue.SCRIPT,scriptscript:ue.SCRIPTSCRIPT},ay={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},Zn=function(c,o,d,m){m===void 0&&(m=[null,null]);const x=[];for(let X=0;X<c.length;X++){const ie=qt(c[X],o);if(ie instanceof Fn){const oe=ie.children;x.push(...oe)}else x.push(ie)}if(de.tryCombineChars(x),!d)return x;let S=o;if(c.length===1){const X=c[0];X.type==="sizing"?S=o.havingSize(X.size):X.type==="styling"&&(S=o.havingStyle(iy[X.style]))}const T=Rs([m[0]||"leftmost"],[],o),R=Rs([m[1]||"rightmost"],[],o),P=d==="root";return bc(x,(X,ie)=>{const oe=ie.classes[0],me=X.classes[0];oe==="mbin"&&w.contains(sy,me)?ie.classes[0]="mord":me==="mbin"&&w.contains(ry,oe)&&(X.classes[0]="mord")},{node:T},R,P),bc(x,(X,ie)=>{const oe=wc(ie),me=wc(X),Me=oe&&me?X.hasClass("mtight")?ny[oe][me]:ty[oe][me]:null;if(Me)return de.makeGlue(Me,S)},{node:T},R,P),x},bc=function(c,o,d,m,x){m&&c.push(m);let S=0;for(;S<c.length;S++){const T=c[S],R=b0(T);if(R){bc(R.children,o,d,null,x);continue}const P=!T.hasClass("mspace");if(P){const X=o(T,d.node);X&&(d.insertAfter?d.insertAfter(X):(c.unshift(X),S++))}P?d.node=T:x&&T.hasClass("newline")&&(d.node=Rs(["leftmost"])),d.insertAfter=(X=>ie=>{c.splice(X+1,0,ie),S++})(S)}m&&c.pop()},b0=function(c){return c instanceof Fn||c instanceof gt||c instanceof et&&c.hasClass("enclosing")?c:null},vc=function(c,o){const d=b0(c);if(d){const m=d.children;if(m.length){if(o==="right")return vc(m[m.length-1],"right");if(o==="left")return vc(m[0],"left")}}return c},wc=function(c,o){return c?(o&&(c=vc(c,o)),ay[c.classes[0]]||null):null},Pa=function(c,o){const d=["nulldelimiter"].concat(c.baseSizingClasses());return Rs(o.concat(d))},qt=function(c,o,d){if(!c)return Rs();if(zo[c.type]){let m=zo[c.type](c,o);if(d&&o.size!==d.size){m=Rs(o.sizingClasses(d),[m],o);const x=o.sizeMultiplier/d.sizeMultiplier;m.height*=x,m.depth*=x}return m}else throw new a("Got group of unknown type: '"+c.type+"'")};function Fo(c,o){const d=Rs(["base"],c,o),m=Rs(["strut"]);return m.style.height=je(d.height+d.depth),d.depth&&(m.style.verticalAlign=je(-d.depth)),d.children.unshift(m),d}function Sc(c,o){let d=null;c.length===1&&c[0].type==="tag"&&(d=c[0].tag,c=c[0].body);const m=Zn(c,o,"root");let x;m.length===2&&m[1].hasClass("tag")&&(x=m.pop());const S=[];let T=[];for(let X=0;X<m.length;X++)if(T.push(m[X]),m[X].hasClass("mbin")||m[X].hasClass("mrel")||m[X].hasClass("allowbreak")){let ie=!1;for(;X<m.length-1&&m[X+1].hasClass("mspace")&&!m[X+1].hasClass("newline");)X++,T.push(m[X]),m[X].hasClass("nobreak")&&(ie=!0);ie||(S.push(Fo(T,o)),T=[])}else m[X].hasClass("newline")&&(T.pop(),T.length>0&&(S.push(Fo(T,o)),T=[]),S.push(m[X]));T.length>0&&S.push(Fo(T,o));let R;d?(R=Fo(Zn(d,o,!0)),R.classes=["tag"],S.push(R)):x&&S.push(x);const P=Rs(["katex-html"],S);if(P.setAttribute("aria-hidden","true"),R){const X=R.children[0];X.style.height=je(P.height+P.depth),P.depth&&(X.style.verticalAlign=je(-P.depth))}return P}function v0(c){return new Fn(c)}class Rr{constructor(o,d,m){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=o,this.attributes={},this.children=d||[],this.classes=m||[]}setAttribute(o,d){this.attributes[o]=d}getAttribute(o){return this.attributes[o]}toNode(){const o=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(const d in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,d)&&o.setAttribute(d,this.attributes[d]);this.classes.length>0&&(o.className=un(this.classes));for(let d=0;d<this.children.length;d++)if(this.children[d]instanceof ms&&this.children[d+1]instanceof ms){let m=this.children[d].toText()+this.children[++d].toText();for(;this.children[d+1]instanceof ms;)m+=this.children[++d].toText();o.appendChild(new ms(m).toNode())}else o.appendChild(this.children[d].toNode());return o}toMarkup(){let o="<"+this.type;for(const d in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,d)&&(o+=" "+d+'="',o+=w.escape(this.attributes[d]),o+='"');this.classes.length>0&&(o+=' class ="'+w.escape(un(this.classes))+'"'),o+=">";for(let d=0;d<this.children.length;d++)o+=this.children[d].toMarkup();return o+="</"+this.type+">",o}toText(){return this.children.map(o=>o.toText()).join("")}}class ms{constructor(o){this.text=void 0,this.text=o}toNode(){return document.createTextNode(this.text)}toMarkup(){return w.escape(this.toText())}toText(){return this.text}}class oy{constructor(o){this.width=void 0,this.character=void 0,this.width=o,o>=.05555&&o<=.05556?this.character="":o>=.1666&&o<=.1667?this.character="":o>=.2222&&o<=.2223?this.character="":o>=.2777&&o<=.2778?this.character="":o>=-.05556&&o<=-.05555?this.character="":o>=-.1667&&o<=-.1666?this.character="":o>=-.2223&&o<=-.2222?this.character="":o>=-.2778&&o<=-.2777?this.character="":this.character=null}toNode(){if(this.character)return document.createTextNode(this.character);{const o=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return o.setAttribute("width",je(this.width)),o}}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+je(this.width)+'"/>'}toText(){return this.character?this.character:" "}}var ze={MathNode:Rr,TextNode:ms,SpaceNode:oy,newDocumentFragment:v0};const $r=function(c,o,d){return mn[o][c]&&mn[o][c].replace&&c.charCodeAt(0)!==55349&&!(K.hasOwnProperty(c)&&d&&(d.fontFamily&&d.fontFamily.slice(4,6)==="tt"||d.font&&d.font.slice(4,6)==="tt"))&&(c=mn[o][c].replace),new ze.TextNode(c)},kc=function(c){return c.length===1?c[0]:new ze.MathNode("mrow",c)},jc=function(c,o){if(o.fontFamily==="texttt")return"monospace";if(o.fontFamily==="textsf")return o.fontShape==="textit"&&o.fontWeight==="textbf"?"sans-serif-bold-italic":o.fontShape==="textit"?"sans-serif-italic":o.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(o.fontShape==="textit"&&o.fontWeight==="textbf")return"bold-italic";if(o.fontShape==="textit")return"italic";if(o.fontWeight==="textbf")return"bold";const d=o.font;if(!d||d==="mathnormal")return null;const m=c.mode;if(d==="mathit")return"italic";if(d==="boldsymbol")return c.type==="textord"?"bold":"bold-italic";if(d==="mathbf")return"bold";if(d==="mathbb")return"double-struck";if(d==="mathsfit")return"sans-serif-italic";if(d==="mathfrak")return"fraktur";if(d==="mathscr"||d==="mathcal")return"script";if(d==="mathsf")return"sans-serif";if(d==="mathtt")return"monospace";let x=c.text;if(w.contains(["\\imath","\\jmath"],x))return null;mn[m][x]&&mn[m][x].replace&&(x=mn[m][x].replace);const S=de.fontMap[d].fontName;return Ve(x,S,m)?de.fontMap[d].variant:null};function Cc(c){if(!c)return!1;if(c.type==="mi"&&c.children.length===1){const o=c.children[0];return o instanceof ms&&o.text==="."}else if(c.type==="mo"&&c.children.length===1&&c.getAttribute("separator")==="true"&&c.getAttribute("lspace")==="0em"&&c.getAttribute("rspace")==="0em"){const o=c.children[0];return o instanceof ms&&o.text===","}else return!1}const Ar=function(c,o,d){if(c.length===1){const S=hn(c[0],o);return d&&S instanceof Rr&&S.type==="mo"&&(S.setAttribute("lspace","0em"),S.setAttribute("rspace","0em")),[S]}const m=[];let x;for(let S=0;S<c.length;S++){const T=hn(c[S],o);if(T instanceof Rr&&x instanceof Rr){if(T.type==="mtext"&&x.type==="mtext"&&T.getAttribute("mathvariant")===x.getAttribute("mathvariant")){x.children.push(...T.children);continue}else if(T.type==="mn"&&x.type==="mn"){x.children.push(...T.children);continue}else if(Cc(T)&&x.type==="mn"){x.children.push(...T.children);continue}else if(T.type==="mn"&&Cc(x))T.children=[...x.children,...T.children],m.pop();else if((T.type==="msup"||T.type==="msub")&&T.children.length>=1&&(x.type==="mn"||Cc(x))){const R=T.children[0];R instanceof Rr&&R.type==="mn"&&(R.children=[...x.children,...R.children],m.pop())}else if(x.type==="mi"&&x.children.length===1){const R=x.children[0];if(R instanceof ms&&R.text===""&&(T.type==="mo"||T.type==="mi"||T.type==="mn")){const P=T.children[0];P instanceof ms&&P.text.length>0&&(P.text=P.text.slice(0,1)+""+P.text.slice(1),m.pop())}}}m.push(T),x=T}return m},Xs=function(c,o,d){return kc(Ar(c,o,d))},hn=function(c,o){if(!c)return new ze.MathNode("mrow");if(Po[c.type])return Po[c.type](c,o);throw new a("Got group of unknown type: '"+c.type+"'")};function w0(c,o,d,m,x){const S=Ar(c,d);let T;S.length===1&&S[0]instanceof Rr&&w.contains(["mrow","mtable"],S[0].type)?T=S[0]:T=new ze.MathNode("mrow",S);const R=new ze.MathNode("annotation",[new ze.TextNode(o)]);R.setAttribute("encoding","application/x-tex");const P=new ze.MathNode("semantics",[T,R]),X=new ze.MathNode("math",[P]);X.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),m&&X.setAttribute("display","block");const ie=x?"katex":"katex-mathml";return de.makeSpan([ie],[X])}const S0=function(c){return new be({style:c.displayMode?ue.DISPLAY:ue.TEXT,maxSize:c.maxSize,minRuleThickness:c.minRuleThickness})},k0=function(c,o){if(o.displayMode){const d=["katex-display"];o.leqno&&d.push("leqno"),o.fleqn&&d.push("fleqn"),c=de.makeSpan(d,[c])}return c},ly=function(c,o,d){const m=S0(d);let x;if(d.output==="mathml")return w0(c,o,m,d.displayMode,!0);if(d.output==="html"){const S=Sc(c,m);x=de.makeSpan(["katex"],[S])}else{const S=w0(c,o,m,d.displayMode,!1),T=Sc(c,m);x=de.makeSpan(["katex"],[S,T])}return k0(x,d)},cy=function(c,o,d){const m=S0(d),x=Sc(c,m),S=de.makeSpan(["katex"],[x]);return k0(S,d)},uy={widehat:"^",widecheck:"",widetilde:"~",utilde:"~",overleftarrow:"",underleftarrow:"",xleftarrow:"",overrightarrow:"",underrightarrow:"",xrightarrow:"",underbrace:"",overbrace:"",overgroup:"",undergroup:"",overleftrightarrow:"",underleftrightarrow:"",xleftrightarrow:"",Overrightarrow:"",xRightarrow:"",overleftharpoon:"",xleftharpoonup:"",overrightharpoon:"",xrightharpoonup:"",xLeftarrow:"",xLeftrightarrow:"",xhookleftarrow:"",xhookrightarrow:"",xmapsto:"",xrightharpoondown:"",xleftharpoondown:"",xrightleftharpoons:"",xleftrightharpoons:"",xtwoheadleftarrow:"",xtwoheadrightarrow:"",xlongequal:"=",xtofrom:"",xrightleftarrows:"",xrightequilibrium:"",xleftequilibrium:"","\\cdrightarrow":"","\\cdleftarrow":"","\\cdlongequal":"="},dy=function(c){const o=new ze.MathNode("mo",[new ze.TextNode(uy[c.replace(/^\\/,"")])]);return o.setAttribute("stretchy","true"),o},hy={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},fy=function(c){return c.type==="ordgroup"?c.body.length:1};var Os={encloseSpan:function(c,o,d,m,x){let S;const T=c.height+c.depth+d+m;if(/fbox|color|angl/.test(o)){if(S=de.makeSpan(["stretchy",o],[],x),o==="fbox"){const R=x.color&&x.getColor();R&&(S.style.borderColor=R)}}else{const R=[];/^[bx]cancel$/.test(o)&&R.push(new dr({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(o)&&R.push(new dr({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));const P=new Ht(R,{width:"100%",height:je(T)});S=de.makeSvgSpan([],[P],x)}return S.height=T,S.style.height=je(T),S},mathMLnode:dy,svgSpan:function(c,o){function d(){let T=4e5;const R=c.label.slice(1);if(w.contains(["widehat","widecheck","widetilde","utilde"],R)){const X=fy(c.base);let ie,oe,me;if(X>5)R==="widehat"||R==="widecheck"?(ie=420,T=2364,me=.42,oe=R+"4"):(ie=312,T=2340,me=.34,oe="tilde4");else{const lt=[1,1,2,2,3,3][X];R==="widehat"||R==="widecheck"?(T=[0,1062,2364,2364,2364][lt],ie=[0,239,300,360,420][lt],me=[0,.24,.3,.3,.36,.42][lt],oe=R+lt):(T=[0,600,1033,2339,2340][lt],ie=[0,260,286,306,312][lt],me=[0,.26,.286,.3,.306,.34][lt],oe="tilde"+lt)}const Me=new Mt(oe),Xe=new Ht([Me],{width:"100%",height:je(me),viewBox:"0 0 "+T+" "+ie,preserveAspectRatio:"none"});return{span:de.makeSvgSpan([],[Xe],o),minWidth:0,height:me}}else{const P=[],X=hy[R],[ie,oe,me]=X,Me=me/1e3,Xe=ie.length;let lt,Vt;if(Xe===1){const Dt=X[3];lt=["hide-tail"],Vt=[Dt]}else if(Xe===2)lt=["halfarrow-left","halfarrow-right"],Vt=["xMinYMin","xMaxYMin"];else if(Xe===3)lt=["brace-left","brace-center","brace-right"],Vt=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+Xe+" children.");for(let Dt=0;Dt<Xe;Dt++){const Lt=new Mt(ie[Dt]),Kt=new Ht([Lt],{width:"400em",height:je(Me),viewBox:"0 0 "+T+" "+me,preserveAspectRatio:Vt[Dt]+" slice"}),gn=de.makeSvgSpan([lt[Dt]],[Kt],o);if(Xe===1)return{span:gn,minWidth:oe,height:Me};gn.style.height=je(Me),P.push(gn)}return{span:de.makeSpan(["stretchy"],P,o),minWidth:oe,height:Me}}}const{span:m,minWidth:x,height:S}=d();return m.height=S,m.style.height=je(S),x>0&&(m.style.minWidth=je(x)),m}};function _t(c,o){if(!c||c.type!==o)throw new Error("Expected node of type "+o+", but got "+(c?"node of type "+c.type:String(c)));return c}function Tc(c){const o=Lo(c);if(!o)throw new Error("Expected node of symbol group type, but got "+(c?"node of type "+c.type:String(c)));return o}function Lo(c){return c&&(c.type==="atom"||Ro.hasOwnProperty(c.type))?c:null}const Ic=(c,o)=>{let d,m,x;c&&c.type==="supsub"?(m=_t(c.base,"accent"),d=m.base,c.base=d,x=En(qt(c,o)),c.base=m):(m=_t(c,"accent"),d=m.base);const S=qt(d,o.havingCrampedStyle()),T=m.isShifty&&w.isCharacterBox(d);let R=0;if(T){const me=w.getBaseElem(d),Me=qt(me,o.havingCrampedStyle());R=ps(Me).skew}const P=m.label==="\\c";let X=P?S.height+S.depth:Math.min(S.height,o.fontMetrics().xHeight),ie;if(m.isStretchy)ie=Os.svgSpan(m,o),ie=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:S},{type:"elem",elem:ie,wrapperClasses:["svg-align"],wrapperStyle:R>0?{width:"calc(100% - "+je(2*R)+")",marginLeft:je(2*R)}:void 0}]},o);else{let me,Me;m.label==="\\vec"?(me=de.staticSvg("vec",o),Me=de.svgData.vec[1]):(me=de.makeOrd({mode:m.mode,text:m.label},o,"textord"),me=ps(me),me.italic=0,Me=me.width,P&&(X+=me.depth)),ie=de.makeSpan(["accent-body"],[me]);const Xe=m.label==="\\textcircled";Xe&&(ie.classes.push("accent-full"),X=S.height);let lt=R;Xe||(lt-=Me/2),ie.style.left=je(lt),m.label==="\\textcircled"&&(ie.style.top=".2em"),ie=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:S},{type:"kern",size:-X},{type:"elem",elem:ie}]},o)}const oe=de.makeSpan(["mord","accent"],[ie],o);return x?(x.children[0]=oe,x.height=Math.max(oe.height,x.height),x.classes[0]="mord",x):oe},j0=(c,o)=>{const d=c.isStretchy?Os.mathMLnode(c.label):new ze.MathNode("mo",[$r(c.label,c.mode)]),m=new ze.MathNode("mover",[hn(c.base,o),d]);return m.setAttribute("accent","true"),m},py=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(c=>"\\"+c).join("|"));We({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(c,o)=>{const d=Bo(o[0]),m=!py.test(c.funcName),x=!m||c.funcName==="\\widehat"||c.funcName==="\\widetilde"||c.funcName==="\\widecheck";return{type:"accent",mode:c.parser.mode,label:c.funcName,isStretchy:m,isShifty:x,base:d}},htmlBuilder:Ic,mathmlBuilder:j0}),We({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(c,o)=>{const d=o[0];let m=c.parser.mode;return m==="math"&&(c.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+c.funcName+" works only in text mode"),m="text"),{type:"accent",mode:m,label:c.funcName,isStretchy:!1,isShifty:!0,base:d}},htmlBuilder:Ic,mathmlBuilder:j0}),We({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(c,o)=>{let{parser:d,funcName:m}=c;const x=o[0];return{type:"accentUnder",mode:d.mode,label:m,base:x}},htmlBuilder:(c,o)=>{const d=qt(c.base,o),m=Os.svgSpan(c,o),x=c.label==="\\utilde"?.12:0,S=de.makeVList({positionType:"top",positionData:d.height,children:[{type:"elem",elem:m,wrapperClasses:["svg-align"]},{type:"kern",size:x},{type:"elem",elem:d}]},o);return de.makeSpan(["mord","accentunder"],[S],o)},mathmlBuilder:(c,o)=>{const d=Os.mathMLnode(c.label),m=new ze.MathNode("munder",[hn(c.base,o),d]);return m.setAttribute("accentunder","true"),m}});const $o=c=>{const o=new ze.MathNode("mpadded",c?[c]:[]);return o.setAttribute("width","+0.6em"),o.setAttribute("lspace","0.3em"),o};We({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(c,o,d){let{parser:m,funcName:x}=c;return{type:"xArrow",mode:m.mode,label:x,body:o[0],below:d[0]}},htmlBuilder(c,o){const d=o.style;let m=o.havingStyle(d.sup());const x=de.wrapFragment(qt(c.body,m,o),o),S=c.label.slice(0,2)==="\\x"?"x":"cd";x.classes.push(S+"-arrow-pad");let T;c.below&&(m=o.havingStyle(d.sub()),T=de.wrapFragment(qt(c.below,m,o),o),T.classes.push(S+"-arrow-pad"));const R=Os.svgSpan(c,o),P=-o.fontMetrics().axisHeight+.5*R.height;let X=-o.fontMetrics().axisHeight-.5*R.height-.111;(x.depth>.25||c.label==="\\xleftequilibrium")&&(X-=x.depth);let ie;if(T){const oe=-o.fontMetrics().axisHeight+T.height+.5*R.height+.111;ie=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:x,shift:X},{type:"elem",elem:R,shift:P},{type:"elem",elem:T,shift:oe}]},o)}else ie=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:x,shift:X},{type:"elem",elem:R,shift:P}]},o);return ie.children[0].children[0].children[1].classes.push("svg-align"),de.makeSpan(["mrel","x-arrow"],[ie],o)},mathmlBuilder(c,o){const d=Os.mathMLnode(c.label);d.setAttribute("minsize",c.label.charAt(0)==="x"?"1.75em":"3.0em");let m;if(c.body){const x=$o(hn(c.body,o));if(c.below){const S=$o(hn(c.below,o));m=new ze.MathNode("munderover",[d,S,x])}else m=new ze.MathNode("mover",[d,x])}else if(c.below){const x=$o(hn(c.below,o));m=new ze.MathNode("munder",[d,x])}else m=$o(),m=new ze.MathNode("mover",[d,m]);return m}});const my=de.makeSpan;function C0(c,o){const d=Zn(c.body,o,!0);return my([c.mclass],d,o)}function T0(c,o){let d;const m=Ar(c.body,o);return c.mclass==="minner"?d=new ze.MathNode("mpadded",m):c.mclass==="mord"?c.isCharacterBox?(d=m[0],d.type="mi"):d=new ze.MathNode("mi",m):(c.isCharacterBox?(d=m[0],d.type="mo"):d=new ze.MathNode("mo",m),c.mclass==="mbin"?(d.attributes.lspace="0.22em",d.attributes.rspace="0.22em"):c.mclass==="mpunct"?(d.attributes.lspace="0em",d.attributes.rspace="0.17em"):c.mclass==="mopen"||c.mclass==="mclose"?(d.attributes.lspace="0em",d.attributes.rspace="0em"):c.mclass==="minner"&&(d.attributes.lspace="0.0556em",d.attributes.width="+0.1111em")),d}We({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(c,o){let{parser:d,funcName:m}=c;const x=o[0];return{type:"mclass",mode:d.mode,mclass:"m"+m.slice(5),body:$n(x),isCharacterBox:w.isCharacterBox(x)}},htmlBuilder:C0,mathmlBuilder:T0});const Go=c=>{const o=c.type==="ordgroup"&&c.body.length?c.body[0]:c;return o.type==="atom"&&(o.family==="bin"||o.family==="rel")?"m"+o.family:"mord"};We({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(c,o){let{parser:d}=c;return{type:"mclass",mode:d.mode,mclass:Go(o[0]),body:$n(o[1]),isCharacterBox:w.isCharacterBox(o[1])}}}),We({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(c,o){let{parser:d,funcName:m}=c;const x=o[1],S=o[0];let T;m!=="\\stackrel"?T=Go(x):T="mrel";const R={type:"op",mode:x.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:m!=="\\stackrel",body:$n(x)},P={type:"supsub",mode:S.mode,base:R,sup:m==="\\underset"?null:S,sub:m==="\\underset"?S:null};return{type:"mclass",mode:d.mode,mclass:T,body:[P],isCharacterBox:w.isCharacterBox(P)}},htmlBuilder:C0,mathmlBuilder:T0}),We({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(c,o){let{parser:d}=c;return{type:"pmb",mode:d.mode,mclass:Go(o[0]),body:$n(o[0])}},htmlBuilder(c,o){const d=Zn(c.body,o,!0),m=de.makeSpan([c.mclass],d,o);return m.style.textShadow="0.02em 0.01em 0.04px",m},mathmlBuilder(c,o){const d=Ar(c.body,o),m=new ze.MathNode("mstyle",d);return m.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),m}});const gy={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},I0=()=>({type:"styling",body:[],mode:"math",style:"display"}),A0=c=>c.type==="textord"&&c.text==="@",yy=(c,o)=>(c.type==="mathord"||c.type==="atom")&&c.text===o;function xy(c,o,d){const m=gy[c];switch(m){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return d.callFunction(m,[o[0]],[o[1]]);case"\\uparrow":case"\\downarrow":{const x=d.callFunction("\\\\cdleft",[o[0]],[]),S={type:"atom",text:m,mode:"math",family:"rel"},T=d.callFunction("\\Big",[S],[]),R=d.callFunction("\\\\cdright",[o[1]],[]),P={type:"ordgroup",mode:"math",body:[x,T,R]};return d.callFunction("\\\\cdparent",[P],[])}case"\\\\cdlongequal":return d.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{const x={type:"textord",text:"\\Vert",mode:"math"};return d.callFunction("\\Big",[x],[])}default:return{type:"textord",text:" ",mode:"math"}}}function by(c){const o=[];for(c.gullet.beginGroup(),c.gullet.macros.set("\\cr","\\\\\\relax"),c.gullet.beginGroup();;){o.push(c.parseExpression(!1,"\\\\")),c.gullet.endGroup(),c.gullet.beginGroup();const S=c.fetch().text;if(S==="&"||S==="\\\\")c.consume();else if(S==="\\end"){o[o.length-1].length===0&&o.pop();break}else throw new a("Expected \\\\ or \\cr or \\end",c.nextToken)}let d=[];const m=[d];for(let S=0;S<o.length;S++){const T=o[S];let R=I0();for(let P=0;P<T.length;P++)if(!A0(T[P]))R.body.push(T[P]);else{d.push(R),P+=1;const X=Tc(T[P]).text,ie=new Array(2);if(ie[0]={type:"ordgroup",mode:"math",body:[]},ie[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(X)>-1))if("<>AV".indexOf(X)>-1)for(let Me=0;Me<2;Me++){let Xe=!0;for(let lt=P+1;lt<T.length;lt++){if(yy(T[lt],X)){Xe=!1,P=lt;break}if(A0(T[lt]))throw new a("Missing a "+X+" character to complete a CD arrow.",T[lt]);ie[Me].body.push(T[lt])}if(Xe)throw new a("Missing a "+X+" character to complete a CD arrow.",T[P])}else throw new a('Expected one of "<>AV=|." after @',T[P]);const me={type:"styling",body:[xy(X,ie,c)],mode:"math",style:"display"};d.push(me),R=I0()}S%2===0?d.push(R):d.shift(),d=[],m.push(d)}c.gullet.endGroup(),c.gullet.endGroup();const x=new Array(m[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:m,arraystretch:1,addJot:!0,rowGaps:[null],cols:x,colSeparationType:"CD",hLinesBeforeRow:new Array(m.length+1).fill([])}}We({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(c,o){let{parser:d,funcName:m}=c;return{type:"cdlabel",mode:d.mode,side:m.slice(4),label:o[0]}},htmlBuilder(c,o){const d=o.havingStyle(o.style.sup()),m=de.wrapFragment(qt(c.label,d,o),o);return m.classes.push("cd-label-"+c.side),m.style.bottom=je(.8-m.depth),m.height=0,m.depth=0,m},mathmlBuilder(c,o){let d=new ze.MathNode("mrow",[hn(c.label,o)]);return d=new ze.MathNode("mpadded",[d]),d.setAttribute("width","0"),c.side==="left"&&d.setAttribute("lspace","-1width"),d.setAttribute("voffset","0.7em"),d=new ze.MathNode("mstyle",[d]),d.setAttribute("displaystyle","false"),d.setAttribute("scriptlevel","1"),d}}),We({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(c,o){let{parser:d}=c;return{type:"cdlabelparent",mode:d.mode,fragment:o[0]}},htmlBuilder(c,o){const d=de.wrapFragment(qt(c.fragment,o),o);return d.classes.push("cd-vert-arrow"),d},mathmlBuilder(c,o){return new ze.MathNode("mrow",[hn(c.fragment,o)])}}),We({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(c,o){let{parser:d}=c;const x=_t(o[0],"ordgroup").body;let S="";for(let P=0;P<x.length;P++){const X=_t(x[P],"textord");S+=X.text}let T=parseInt(S),R;if(isNaN(T))throw new a("\\@char has non-numeric argument "+S);if(T<0||T>=1114111)throw new a("\\@char with invalid code point "+S);return T<=65535?R=String.fromCharCode(T):(T-=65536,R=String.fromCharCode((T>>10)+55296,(T&1023)+56320)),{type:"textord",mode:d.mode,text:R}}});const _0=(c,o)=>{const d=Zn(c.body,o.withColor(c.color),!1);return de.makeFragment(d)},E0=(c,o)=>{const d=Ar(c.body,o.withColor(c.color)),m=new ze.MathNode("mstyle",d);return m.setAttribute("mathcolor",c.color),m};We({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(c,o){let{parser:d}=c;const m=_t(o[0],"color-token").color,x=o[1];return{type:"color",mode:d.mode,color:m,body:$n(x)}},htmlBuilder:_0,mathmlBuilder:E0}),We({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(c,o){let{parser:d,breakOnTokenText:m}=c;const x=_t(o[0],"color-token").color;d.gullet.macros.set("\\current@color",x);const S=d.parseExpression(!0,m);return{type:"color",mode:d.mode,color:x,body:S}},htmlBuilder:_0,mathmlBuilder:E0}),We({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(c,o,d){let{parser:m}=c;const x=m.gullet.future().text==="["?m.parseSizeGroup(!0):null,S=!m.settings.displayMode||!m.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:m.mode,newLine:S,size:x&&_t(x,"size").value}},htmlBuilder(c,o){const d=de.makeSpan(["mspace"],[],o);return c.newLine&&(d.classes.push("newline"),c.size&&(d.style.marginTop=je(Qe(c.size,o)))),d},mathmlBuilder(c,o){const d=new ze.MathNode("mspace");return c.newLine&&(d.setAttribute("linebreak","newline"),c.size&&d.setAttribute("height",je(Qe(c.size,o)))),d}});const Ac={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},N0=c=>{const o=c.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(o))throw new a("Expected a control sequence",c);return o},vy=c=>{let o=c.gullet.popToken();return o.text==="="&&(o=c.gullet.popToken(),o.text===" "&&(o=c.gullet.popToken())),o},M0=(c,o,d,m)=>{let x=c.gullet.macros.get(d.text);x==null&&(d.noexpand=!0,x={tokens:[d],numArgs:0,unexpandable:!c.gullet.isExpandable(d.text)}),c.gullet.macros.set(o,x,m)};We({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(c){let{parser:o,funcName:d}=c;o.consumeSpaces();const m=o.fetch();if(Ac[m.text])return(d==="\\global"||d==="\\\\globallong")&&(m.text=Ac[m.text]),_t(o.parseFunction(),"internal");throw new a("Invalid token after macro prefix",m)}}),We({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(c){let{parser:o,funcName:d}=c,m=o.gullet.popToken();const x=m.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(x))throw new a("Expected a control sequence",m);let S=0,T;const R=[[]];for(;o.gullet.future().text!=="{";)if(m=o.gullet.popToken(),m.text==="#"){if(o.gullet.future().text==="{"){T=o.gullet.future(),R[S].push("{");break}if(m=o.gullet.popToken(),!/^[1-9]$/.test(m.text))throw new a('Invalid argument number "'+m.text+'"');if(parseInt(m.text)!==S+1)throw new a('Argument number "'+m.text+'" out of order');S++,R.push([])}else{if(m.text==="EOF")throw new a("Expected a macro definition");R[S].push(m.text)}let{tokens:P}=o.gullet.consumeArg();return T&&P.unshift(T),(d==="\\edef"||d==="\\xdef")&&(P=o.gullet.expandTokens(P),P.reverse()),o.gullet.macros.set(x,{tokens:P,numArgs:S,delimiters:R},d===Ac[d]),{type:"internal",mode:o.mode}}}),We({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(c){let{parser:o,funcName:d}=c;const m=N0(o.gullet.popToken());o.gullet.consumeSpaces();const x=vy(o);return M0(o,m,x,d==="\\\\globallet"),{type:"internal",mode:o.mode}}}),We({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(c){let{parser:o,funcName:d}=c;const m=N0(o.gullet.popToken()),x=o.gullet.popToken(),S=o.gullet.popToken();return M0(o,m,S,d==="\\\\globalfuture"),o.gullet.pushToken(S),o.gullet.pushToken(x),{type:"internal",mode:o.mode}}});const Ba=function(c,o,d){const m=mn.math[c]&&mn.math[c].replace,x=Ve(m||c,o,d);if(!x)throw new Error("Unsupported symbol "+c+" and font size "+o+".");return x},_c=function(c,o,d,m){const x=d.havingBaseStyle(o),S=de.makeSpan(m.concat(x.sizingClasses(d)),[c],d),T=x.sizeMultiplier/d.sizeMultiplier;return S.height*=T,S.depth*=T,S.maxFontSize=x.sizeMultiplier,S},D0=function(c,o,d){const m=o.havingBaseStyle(d),x=(1-o.sizeMultiplier/m.sizeMultiplier)*o.fontMetrics().axisHeight;c.classes.push("delimcenter"),c.style.top=je(x),c.height-=x,c.depth+=x},wy=function(c,o,d,m,x,S){const T=de.makeSymbol(c,"Main-Regular",x,m),R=_c(T,o,m,S);return d&&D0(R,m,o),R},Sy=function(c,o,d,m){return de.makeSymbol(c,"Size"+o+"-Regular",d,m)},R0=function(c,o,d,m,x,S){const T=Sy(c,o,x,m),R=_c(de.makeSpan(["delimsizing","size"+o],[T],m),ue.TEXT,m,S);return d&&D0(R,m,ue.TEXT),R},Ec=function(c,o,d){let m;return o==="Size1-Regular"?m="delim-size1":m="delim-size4",{type:"elem",elem:de.makeSpan(["delimsizinginner",m],[de.makeSpan([],[de.makeSymbol(c,o,d)])])}},Nc=function(c,o,d){const m=Ct["Size4-Regular"][c.charCodeAt(0)]?Ct["Size4-Regular"][c.charCodeAt(0)][4]:Ct["Size1-Regular"][c.charCodeAt(0)][4],x=new Mt("inner",jt(c,Math.round(1e3*o))),S=new Ht([x],{width:je(m),height:je(o),style:"width:"+je(m),viewBox:"0 0 "+1e3*m+" "+Math.round(1e3*o),preserveAspectRatio:"xMinYMin"}),T=de.makeSvgSpan([],[S],d);return T.height=o,T.style.height=je(o),T.style.width=je(m),{type:"elem",elem:T}},Mc=.008,Ho={type:"kern",size:-1*Mc},ky=["|","\\lvert","\\rvert","\\vert"],jy=["\\|","\\lVert","\\rVert","\\Vert"],O0=function(c,o,d,m,x,S){let T,R,P,X,ie="",oe=0;T=P=X=c,R=null;let me="Size1-Regular";c==="\\uparrow"?P=X="":c==="\\Uparrow"?P=X="":c==="\\downarrow"?T=P="":c==="\\Downarrow"?T=P="":c==="\\updownarrow"?(T="\\uparrow",P="",X="\\downarrow"):c==="\\Updownarrow"?(T="\\Uparrow",P="",X="\\Downarrow"):w.contains(ky,c)?(P="",ie="vert",oe=333):w.contains(jy,c)?(P="",ie="doublevert",oe=556):c==="["||c==="\\lbrack"?(T="",P="",X="",me="Size4-Regular",ie="lbrack",oe=667):c==="]"||c==="\\rbrack"?(T="",P="",X="",me="Size4-Regular",ie="rbrack",oe=667):c==="\\lfloor"||c===""?(P=T="",X="",me="Size4-Regular",ie="lfloor",oe=667):c==="\\lceil"||c===""?(T="",P=X="",me="Size4-Regular",ie="lceil",oe=667):c==="\\rfloor"||c===""?(P=T="",X="",me="Size4-Regular",ie="rfloor",oe=667):c==="\\rceil"||c===""?(T="",P=X="",me="Size4-Regular",ie="rceil",oe=667):c==="("||c==="\\lparen"?(T="",P="",X="",me="Size4-Regular",ie="lparen",oe=875):c===")"||c==="\\rparen"?(T="",P="",X="",me="Size4-Regular",ie="rparen",oe=875):c==="\\{"||c==="\\lbrace"?(T="",R="",X="",P="",me="Size4-Regular"):c==="\\}"||c==="\\rbrace"?(T="",R="",X="",P="",me="Size4-Regular"):c==="\\lgroup"||c===""?(T="",X="",P="",me="Size4-Regular"):c==="\\rgroup"||c===""?(T="",X="",P="",me="Size4-Regular"):c==="\\lmoustache"||c===""?(T="",X="",P="",me="Size4-Regular"):(c==="\\rmoustache"||c==="")&&(T="",X="",P="",me="Size4-Regular");const Me=Ba(T,me,x),Xe=Me.height+Me.depth,lt=Ba(P,me,x),Vt=lt.height+lt.depth,Dt=Ba(X,me,x),Lt=Dt.height+Dt.depth;let Kt=0,gn=1;if(R!==null){const On=Ba(R,me,x);Kt=On.height+On.depth,gn=2}const gr=Xe+Lt+Kt,Yn=Math.max(0,Math.ceil((o-gr)/(gn*Vt))),Hr=gr+Yn*gn*Vt;let Xi=m.fontMetrics().axisHeight;d&&(Xi*=m.sizeMultiplier);const Ut=Hr/2-Xi,rn=[];if(ie.length>0){const On=Hr-Xe-Lt,Dn=Math.round(Hr*1e3),qr=qn(ie,Math.round(On*1e3)),Jy=new Mt(ie,qr),Ch=(oe/1e3).toFixed(3)+"em",Th=(Dn/1e3).toFixed(3)+"em",Xy=new Ht([Jy],{width:Ch,height:Th,viewBox:"0 0 "+oe+" "+Dn}),Yo=de.makeSvgSpan([],[Xy],m);Yo.height=Dn/1e3,Yo.style.width=Ch,Yo.style.height=Th,rn.push({type:"elem",elem:Yo})}else{if(rn.push(Ec(X,me,x)),rn.push(Ho),R===null){const On=Hr-Xe-Lt+2*Mc;rn.push(Nc(P,On,m))}else{const On=(Hr-Xe-Lt-Kt)/2+2*Mc;rn.push(Nc(P,On,m)),rn.push(Ho),rn.push(Ec(R,me,x)),rn.push(Ho),rn.push(Nc(P,On,m))}rn.push(Ho),rn.push(Ec(T,me,x))}const Cn=m.havingBaseStyle(ue.TEXT),In=de.makeVList({positionType:"bottom",positionData:Ut,children:rn},Cn);return _c(de.makeSpan(["delimsizing","mult"],[In],Cn),ue.TEXT,m,S)},Dc=80,Rc=.08,Oc=function(c,o,d,m,x){const S=Ir(c,m,d),T=new Mt(c,S),R=new Ht([T],{width:"400em",height:je(o),viewBox:"0 0 400000 "+d,preserveAspectRatio:"xMinYMin slice"});return de.makeSvgSpan(["hide-tail"],[R],x)},Cy=function(c,o){const d=o.havingBaseSizing(),m=B0("\\surd",c*d.sizeMultiplier,P0,d);let x=d.sizeMultiplier;const S=Math.max(0,o.minRuleThickness-o.fontMetrics().sqrtRuleThickness);let T,R=0,P=0,X=0,ie;return m.type==="small"?(X=1e3+1e3*S+Dc,c<1?x=1:c<1.4&&(x=.7),R=(1+S+Rc)/x,P=(1+S)/x,T=Oc("sqrtMain",R,X,S,o),T.style.minWidth="0.853em",ie=.833/x):m.type==="large"?(X=(1e3+Dc)*Fa[m.size],P=(Fa[m.size]+S)/x,R=(Fa[m.size]+S+Rc)/x,T=Oc("sqrtSize"+m.size,R,X,S,o),T.style.minWidth="1.02em",ie=1/x):(R=c+S+Rc,P=c+S,X=Math.floor(1e3*c+S)+Dc,T=Oc("sqrtTall",R,X,S,o),T.style.minWidth="0.742em",ie=1.056),T.height=P,T.style.height=je(R),{span:T,advanceWidth:ie,ruleWidth:(o.fontMetrics().sqrtRuleThickness+S)*x}},V0=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","\\surd"],Ty=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","",""],z0=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],Fa=[0,1.2,1.8,2.4,3],Iy=function(c,o,d,m,x){if(c==="<"||c==="\\lt"||c===""?c="\\langle":(c===">"||c==="\\gt"||c==="")&&(c="\\rangle"),w.contains(V0,c)||w.contains(z0,c))return R0(c,o,!1,d,m,x);if(w.contains(Ty,c))return O0(c,Fa[o],!1,d,m,x);throw new a("Illegal delimiter: '"+c+"'")},Ay=[{type:"small",style:ue.SCRIPTSCRIPT},{type:"small",style:ue.SCRIPT},{type:"small",style:ue.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],_y=[{type:"small",style:ue.SCRIPTSCRIPT},{type:"small",style:ue.SCRIPT},{type:"small",style:ue.TEXT},{type:"stack"}],P0=[{type:"small",style:ue.SCRIPTSCRIPT},{type:"small",style:ue.SCRIPT},{type:"small",style:ue.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],Ey=function(c){if(c.type==="small")return"Main-Regular";if(c.type==="large")return"Size"+c.size+"-Regular";if(c.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+c.type+"' here.")},B0=function(c,o,d,m){const x=Math.min(2,3-m.style.size);for(let S=x;S<d.length&&d[S].type!=="stack";S++){const T=Ba(c,Ey(d[S]),"math");let R=T.height+T.depth;if(d[S].type==="small"){const P=m.havingBaseStyle(d[S].style);R*=P.sizeMultiplier}if(R>o)return d[S]}return d[d.length-1]},F0=function(c,o,d,m,x,S){c==="<"||c==="\\lt"||c===""?c="\\langle":(c===">"||c==="\\gt"||c==="")&&(c="\\rangle");let T;w.contains(z0,c)?T=Ay:w.contains(V0,c)?T=P0:T=_y;const R=B0(c,o,T,m);return R.type==="small"?wy(c,R.style,d,m,x,S):R.type==="large"?R0(c,R.size,d,m,x,S):O0(c,o,d,m,x,S)};var Vs={sqrtImage:Cy,sizedDelim:Iy,sizeToMaxHeight:Fa,customSizedDelim:F0,leftRightDelim:function(c,o,d,m,x,S){const T=m.fontMetrics().axisHeight*m.sizeMultiplier,R=901,P=5/m.fontMetrics().ptPerEm,X=Math.max(o-T,d+T),ie=Math.max(X/500*R,2*X-P);return F0(c,ie,!0,m,x,S)}};const L0={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},Ny=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","<",">","\\langle","","\\rangle","","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","","","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function qo(c,o){const d=Lo(c);if(d&&w.contains(Ny,d.text))return d;throw d?new a("Invalid delimiter '"+d.text+"' after '"+o.funcName+"'",c):new a("Invalid delimiter type '"+c.type+"'",c)}We({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(c,o)=>{const d=qo(o[0],c);return{type:"delimsizing",mode:c.parser.mode,size:L0[c.funcName].size,mclass:L0[c.funcName].mclass,delim:d.text}},htmlBuilder:(c,o)=>c.delim==="."?de.makeSpan([c.mclass]):Vs.sizedDelim(c.delim,c.size,o,c.mode,[c.mclass]),mathmlBuilder:c=>{const o=[];c.delim!=="."&&o.push($r(c.delim,c.mode));const d=new ze.MathNode("mo",o);c.mclass==="mopen"||c.mclass==="mclose"?d.setAttribute("fence","true"):d.setAttribute("fence","false"),d.setAttribute("stretchy","true");const m=je(Vs.sizeToMaxHeight[c.size]);return d.setAttribute("minsize",m),d.setAttribute("maxsize",m),d}});function $0(c){if(!c.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}We({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(c,o)=>{const d=c.parser.gullet.macros.get("\\current@color");if(d&&typeof d!="string")throw new a("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:c.parser.mode,delim:qo(o[0],c).text,color:d}}}),We({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(c,o)=>{const d=qo(o[0],c),m=c.parser;++m.leftrightDepth;const x=m.parseExpression(!1);--m.leftrightDepth,m.expect("\\right",!1);const S=_t(m.parseFunction(),"leftright-right");return{type:"leftright",mode:m.mode,body:x,left:d.text,right:S.delim,rightColor:S.color}},htmlBuilder:(c,o)=>{$0(c);const d=Zn(c.body,o,!0,["mopen","mclose"]);let m=0,x=0,S=!1;for(let P=0;P<d.length;P++)d[P].isMiddle?S=!0:(m=Math.max(d[P].height,m),x=Math.max(d[P].depth,x));m*=o.sizeMultiplier,x*=o.sizeMultiplier;let T;if(c.left==="."?T=Pa(o,["mopen"]):T=Vs.leftRightDelim(c.left,m,x,o,c.mode,["mopen"]),d.unshift(T),S)for(let P=1;P<d.length;P++){const ie=d[P].isMiddle;ie&&(d[P]=Vs.leftRightDelim(ie.delim,m,x,ie.options,c.mode,[]))}let R;if(c.right===".")R=Pa(o,["mclose"]);else{const P=c.rightColor?o.withColor(c.rightColor):o;R=Vs.leftRightDelim(c.right,m,x,P,c.mode,["mclose"])}return d.push(R),de.makeSpan(["minner"],d,o)},mathmlBuilder:(c,o)=>{$0(c);const d=Ar(c.body,o);if(c.left!=="."){const m=new ze.MathNode("mo",[$r(c.left,c.mode)]);m.setAttribute("fence","true"),d.unshift(m)}if(c.right!=="."){const m=new ze.MathNode("mo",[$r(c.right,c.mode)]);m.setAttribute("fence","true"),c.rightColor&&m.setAttribute("mathcolor",c.rightColor),d.push(m)}return kc(d)}}),We({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(c,o)=>{const d=qo(o[0],c);if(!c.parser.leftrightDepth)throw new a("\\middle without preceding \\left",d);return{type:"middle",mode:c.parser.mode,delim:d.text}},htmlBuilder:(c,o)=>{let d;if(c.delim===".")d=Pa(o,[]);else{d=Vs.sizedDelim(c.delim,1,o,c.mode,[]);const m={delim:c.delim,options:o};d.isMiddle=m}return d},mathmlBuilder:(c,o)=>{const d=c.delim==="\\vert"||c.delim==="|"?$r("|","text"):$r(c.delim,c.mode),m=new ze.MathNode("mo",[d]);return m.setAttribute("fence","true"),m.setAttribute("lspace","0.05em"),m.setAttribute("rspace","0.05em"),m}});const Vc=(c,o)=>{const d=de.wrapFragment(qt(c.body,o),o),m=c.label.slice(1);let x=o.sizeMultiplier,S,T=0;const R=w.isCharacterBox(c.body);if(m==="sout")S=de.makeSpan(["stretchy","sout"]),S.height=o.fontMetrics().defaultRuleThickness/x,T=-.5*o.fontMetrics().xHeight;else if(m==="phase"){const X=Qe({number:.6,unit:"pt"},o),ie=Qe({number:.35,unit:"ex"},o),oe=o.havingBaseSizing();x=x/oe.sizeMultiplier;const me=d.height+d.depth+X+ie;d.style.paddingLeft=je(me/2+X);const Me=Math.floor(1e3*me*x),Xe=Rt(Me),lt=new Ht([new Mt("phase",Xe)],{width:"400em",height:je(Me/1e3),viewBox:"0 0 400000 "+Me,preserveAspectRatio:"xMinYMin slice"});S=de.makeSvgSpan(["hide-tail"],[lt],o),S.style.height=je(me),T=d.depth+X+ie}else{/cancel/.test(m)?R||d.classes.push("cancel-pad"):m==="angl"?d.classes.push("anglpad"):d.classes.push("boxpad");let X=0,ie=0,oe=0;/box/.test(m)?(oe=Math.max(o.fontMetrics().fboxrule,o.minRuleThickness),X=o.fontMetrics().fboxsep+(m==="colorbox"?0:oe),ie=X):m==="angl"?(oe=Math.max(o.fontMetrics().defaultRuleThickness,o.minRuleThickness),X=4*oe,ie=Math.max(0,.25-d.depth)):(X=R?.2:0,ie=X),S=Os.encloseSpan(d,m,X,ie,o),/fbox|boxed|fcolorbox/.test(m)?(S.style.borderStyle="solid",S.style.borderWidth=je(oe)):m==="angl"&&oe!==.049&&(S.style.borderTopWidth=je(oe),S.style.borderRightWidth=je(oe)),T=d.depth+ie,c.backgroundColor&&(S.style.backgroundColor=c.backgroundColor,c.borderColor&&(S.style.borderColor=c.borderColor))}let P;if(c.backgroundColor)P=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:S,shift:T},{type:"elem",elem:d,shift:0}]},o);else{const X=/cancel|phase/.test(m)?["svg-align"]:[];P=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:d,shift:0},{type:"elem",elem:S,shift:T,wrapperClasses:X}]},o)}return/cancel/.test(m)&&(P.height=d.height,P.depth=d.depth),/cancel/.test(m)&&!R?de.makeSpan(["mord","cancel-lap"],[P],o):de.makeSpan(["mord"],[P],o)},zc=(c,o)=>{let d=0;const m=new ze.MathNode(c.label.indexOf("colorbox")>-1?"mpadded":"menclose",[hn(c.body,o)]);switch(c.label){case"\\cancel":m.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":m.setAttribute("notation","downdiagonalstrike");break;case"\\phase":m.setAttribute("notation","phasorangle");break;case"\\sout":m.setAttribute("notation","horizontalstrike");break;case"\\fbox":m.setAttribute("notation","box");break;case"\\angl":m.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(d=o.fontMetrics().fboxsep*o.fontMetrics().ptPerEm,m.setAttribute("width","+"+2*d+"pt"),m.setAttribute("height","+"+2*d+"pt"),m.setAttribute("lspace",d+"pt"),m.setAttribute("voffset",d+"pt"),c.label==="\\fcolorbox"){const x=Math.max(o.fontMetrics().fboxrule,o.minRuleThickness);m.setAttribute("style","border: "+x+"em solid "+String(c.borderColor))}break;case"\\xcancel":m.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return c.backgroundColor&&m.setAttribute("mathbackground",c.backgroundColor),m};We({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(c,o,d){let{parser:m,funcName:x}=c;const S=_t(o[0],"color-token").color,T=o[1];return{type:"enclose",mode:m.mode,label:x,backgroundColor:S,body:T}},htmlBuilder:Vc,mathmlBuilder:zc}),We({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(c,o,d){let{parser:m,funcName:x}=c;const S=_t(o[0],"color-token").color,T=_t(o[1],"color-token").color,R=o[2];return{type:"enclose",mode:m.mode,label:x,backgroundColor:T,borderColor:S,body:R}},htmlBuilder:Vc,mathmlBuilder:zc}),We({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(c,o){let{parser:d}=c;return{type:"enclose",mode:d.mode,label:"\\fbox",body:o[0]}}}),We({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(c,o){let{parser:d,funcName:m}=c;const x=o[0];return{type:"enclose",mode:d.mode,label:m,body:x}},htmlBuilder:Vc,mathmlBuilder:zc}),We({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(c,o){let{parser:d}=c;return{type:"enclose",mode:d.mode,label:"\\angl",body:o[0]}}});const G0={};function gs(c){let{type:o,names:d,props:m,handler:x,htmlBuilder:S,mathmlBuilder:T}=c;const R={type:o,numArgs:m.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:x};for(let P=0;P<d.length;++P)G0[d[P]]=R;S&&(zo[o]=S),T&&(Po[o]=T)}const H0={};function V(c,o){H0[c]=o}class Or{constructor(o,d,m){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=o,this.start=d,this.end=m}static range(o,d){return d?!o||!o.loc||!d.loc||o.loc.lexer!==d.loc.lexer?null:new Or(o.loc.lexer,o.loc.start,d.loc.end):o&&o.loc}}class Gr{constructor(o,d){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=o,this.loc=d}range(o,d){return new Gr(d,Or.range(this,o))}}function q0(c){const o=[];c.consumeSpaces();let d=c.fetch().text;for(d==="\\relax"&&(c.consume(),c.consumeSpaces(),d=c.fetch().text);d==="\\hline"||d==="\\hdashline";)c.consume(),o.push(d==="\\hdashline"),c.consumeSpaces(),d=c.fetch().text;return o}const Uo=c=>{if(!c.parser.settings.displayMode)throw new a("{"+c.envName+"} can be used only in display mode.")};function Pc(c){if(c.indexOf("ed")===-1)return c.indexOf("*")===-1}function Ks(c,o,d){let{hskipBeforeAndAfter:m,addJot:x,cols:S,arraystretch:T,colSeparationType:R,autoTag:P,singleRow:X,emptySingleRow:ie,maxNumCols:oe,leqno:me}=o;if(c.gullet.beginGroup(),X||c.gullet.macros.set("\\cr","\\\\\\relax"),!T){const gn=c.gullet.expandMacroAsText("\\arraystretch");if(gn==null)T=1;else if(T=parseFloat(gn),!T||T<0)throw new a("Invalid \\arraystretch: "+gn)}c.gullet.beginGroup();let Me=[];const Xe=[Me],lt=[],Vt=[],Dt=P!=null?[]:void 0;function Lt(){P&&c.gullet.macros.set("\\@eqnsw","1",!0)}function Kt(){Dt&&(c.gullet.macros.get("\\df@tag")?(Dt.push(c.subparse([new Gr("\\df@tag")])),c.gullet.macros.set("\\df@tag",void 0,!0)):Dt.push(!!P&&c.gullet.macros.get("\\@eqnsw")==="1"))}for(Lt(),Vt.push(q0(c));;){let gn=c.parseExpression(!1,X?"\\end":"\\\\");c.gullet.endGroup(),c.gullet.beginGroup(),gn={type:"ordgroup",mode:c.mode,body:gn},d&&(gn={type:"styling",mode:c.mode,style:d,body:[gn]}),Me.push(gn);const gr=c.fetch().text;if(gr==="&"){if(oe&&Me.length===oe){if(X||R)throw new a("Too many tab characters: &",c.nextToken);c.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}c.consume()}else if(gr==="\\end"){Kt(),Me.length===1&&gn.type==="styling"&&gn.body[0].body.length===0&&(Xe.length>1||!ie)&&Xe.pop(),Vt.length<Xe.length+1&&Vt.push([]);break}else if(gr==="\\\\"){c.consume();let Yn;c.gullet.future().text!==" "&&(Yn=c.parseSizeGroup(!0)),lt.push(Yn?Yn.value:null),Kt(),Vt.push(q0(c)),Me=[],Xe.push(Me),Lt()}else throw new a("Expected & or \\\\ or \\cr or \\end",c.nextToken)}return c.gullet.endGroup(),c.gullet.endGroup(),{type:"array",mode:c.mode,addJot:x,arraystretch:T,body:Xe,cols:S,rowGaps:lt,hskipBeforeAndAfter:m,hLinesBeforeRow:Vt,colSeparationType:R,tags:Dt,leqno:me}}function Bc(c){return c.slice(0,1)==="d"?"display":"text"}const ys=function(c,o){let d,m;const x=c.body.length,S=c.hLinesBeforeRow;let T=0,R=new Array(x);const P=[],X=Math.max(o.fontMetrics().arrayRuleWidth,o.minRuleThickness),ie=1/o.fontMetrics().ptPerEm;let oe=5*ie;c.colSeparationType&&c.colSeparationType==="small"&&(oe=.2778*(o.havingStyle(ue.SCRIPT).sizeMultiplier/o.sizeMultiplier));const me=c.colSeparationType==="CD"?Qe({number:3,unit:"ex"},o):12*ie,Me=3*ie,Xe=c.arraystretch*me,lt=.7*Xe,Vt=.3*Xe;let Dt=0;function Lt(Ut){for(let rn=0;rn<Ut.length;++rn)rn>0&&(Dt+=.25),P.push({pos:Dt,isDashed:Ut[rn]})}for(Lt(S[0]),d=0;d<c.body.length;++d){const Ut=c.body[d];let rn=lt,Cn=Vt;T<Ut.length&&(T=Ut.length);const In=new Array(Ut.length);for(m=0;m<Ut.length;++m){const qr=qt(Ut[m],o);Cn<qr.depth&&(Cn=qr.depth),rn<qr.height&&(rn=qr.height),In[m]=qr}const On=c.rowGaps[d];let Dn=0;On&&(Dn=Qe(On,o),Dn>0&&(Dn+=Vt,Cn<Dn&&(Cn=Dn),Dn=0)),c.addJot&&(Cn+=Me),In.height=rn,In.depth=Cn,Dt+=rn,In.pos=Dt,Dt+=Cn+Dn,R[d]=In,Lt(S[d+1])}const Kt=Dt/2+o.fontMetrics().axisHeight,gn=c.cols||[],gr=[];let Yn,Hr;const Xi=[];if(c.tags&&c.tags.some(Ut=>Ut))for(d=0;d<x;++d){const Ut=R[d],rn=Ut.pos-Kt,Cn=c.tags[d];let In;Cn===!0?In=de.makeSpan(["eqn-num"],[],o):Cn===!1?In=de.makeSpan([],[],o):In=de.makeSpan([],Zn(Cn,o,!0),o),In.depth=Ut.depth,In.height=Ut.height,Xi.push({type:"elem",elem:In,shift:rn})}for(m=0,Hr=0;m<T||Hr<gn.length;++m,++Hr){let Ut=gn[Hr]||{},rn=!0;for(;Ut.type==="separator";){if(rn||(Yn=de.makeSpan(["arraycolsep"],[]),Yn.style.width=je(o.fontMetrics().doubleRuleSep),gr.push(Yn)),Ut.separator==="|"||Ut.separator===":"){const On=Ut.separator==="|"?"solid":"dashed",Dn=de.makeSpan(["vertical-separator"],[],o);Dn.style.height=je(Dt),Dn.style.borderRightWidth=je(X),Dn.style.borderRightStyle=On,Dn.style.margin="0 "+je(-X/2);const qr=Dt-Kt;qr&&(Dn.style.verticalAlign=je(-qr)),gr.push(Dn)}else throw new a("Invalid separator type: "+Ut.separator);Hr++,Ut=gn[Hr]||{},rn=!1}if(m>=T)continue;let Cn;(m>0||c.hskipBeforeAndAfter)&&(Cn=w.deflt(Ut.pregap,oe),Cn!==0&&(Yn=de.makeSpan(["arraycolsep"],[]),Yn.style.width=je(Cn),gr.push(Yn)));let In=[];for(d=0;d<x;++d){const On=R[d],Dn=On[m];if(!Dn)continue;const qr=On.pos-Kt;Dn.depth=On.depth,Dn.height=On.height,In.push({type:"elem",elem:Dn,shift:qr})}In=de.makeVList({positionType:"individualShift",children:In},o),In=de.makeSpan(["col-align-"+(Ut.align||"c")],[In]),gr.push(In),(m<T-1||c.hskipBeforeAndAfter)&&(Cn=w.deflt(Ut.postgap,oe),Cn!==0&&(Yn=de.makeSpan(["arraycolsep"],[]),Yn.style.width=je(Cn),gr.push(Yn)))}if(R=de.makeSpan(["mtable"],gr),P.length>0){const Ut=de.makeLineSpan("hline",o,X),rn=de.makeLineSpan("hdashline",o,X),Cn=[{type:"elem",elem:R,shift:0}];for(;P.length>0;){const In=P.pop(),On=In.pos-Kt;In.isDashed?Cn.push({type:"elem",elem:rn,shift:On}):Cn.push({type:"elem",elem:Ut,shift:On})}R=de.makeVList({positionType:"individualShift",children:Cn},o)}if(Xi.length===0)return de.makeSpan(["mord"],[R],o);{let Ut=de.makeVList({positionType:"individualShift",children:Xi},o);return Ut=de.makeSpan(["tag"],[Ut],o),de.makeFragment([R,Ut])}},My={c:"center ",l:"left ",r:"right "},xs=function(c,o){const d=[],m=new ze.MathNode("mtd",[],["mtr-glue"]),x=new ze.MathNode("mtd",[],["mml-eqn-num"]);for(let oe=0;oe<c.body.length;oe++){const me=c.body[oe],Me=[];for(let Xe=0;Xe<me.length;Xe++)Me.push(new ze.MathNode("mtd",[hn(me[Xe],o)]));c.tags&&c.tags[oe]&&(Me.unshift(m),Me.push(m),c.leqno?Me.unshift(x):Me.push(x)),d.push(new ze.MathNode("mtr",Me))}let S=new ze.MathNode("mtable",d);const T=c.arraystretch===.5?.1:.16+c.arraystretch-1+(c.addJot?.09:0);S.setAttribute("rowspacing",je(T));let R="",P="";if(c.cols&&c.cols.length>0){const oe=c.cols;let me="",Me=!1,Xe=0,lt=oe.length;oe[0].type==="separator"&&(R+="top ",Xe=1),oe[oe.length-1].type==="separator"&&(R+="bottom ",lt-=1);for(let Vt=Xe;Vt<lt;Vt++)oe[Vt].type==="align"?(P+=My[oe[Vt].align],Me&&(me+="none "),Me=!0):oe[Vt].type==="separator"&&Me&&(me+=oe[Vt].separator==="|"?"solid ":"dashed ",Me=!1);S.setAttribute("columnalign",P.trim()),/[sd]/.test(me)&&S.setAttribute("columnlines",me.trim())}if(c.colSeparationType==="align"){const oe=c.cols||[];let me="";for(let Me=1;Me<oe.length;Me++)me+=Me%2?"0em ":"1em ";S.setAttribute("columnspacing",me.trim())}else c.colSeparationType==="alignat"||c.colSeparationType==="gather"?S.setAttribute("columnspacing","0em"):c.colSeparationType==="small"?S.setAttribute("columnspacing","0.2778em"):c.colSeparationType==="CD"?S.setAttribute("columnspacing","0.5em"):S.setAttribute("columnspacing","1em");let X="";const ie=c.hLinesBeforeRow;R+=ie[0].length>0?"left ":"",R+=ie[ie.length-1].length>0?"right ":"";for(let oe=1;oe<ie.length-1;oe++)X+=ie[oe].length===0?"none ":ie[oe][0]?"dashed ":"solid ";return/[sd]/.test(X)&&S.setAttribute("rowlines",X.trim()),R!==""&&(S=new ze.MathNode("menclose",[S]),S.setAttribute("notation",R.trim())),c.arraystretch&&c.arraystretch<1&&(S=new ze.MathNode("mstyle",[S]),S.setAttribute("scriptlevel","1")),S},U0=function(c,o){c.envName.indexOf("ed")===-1&&Uo(c);const d=[],m=c.envName.indexOf("at")>-1?"alignat":"align",x=c.envName==="split",S=Ks(c.parser,{cols:d,addJot:!0,autoTag:x?void 0:Pc(c.envName),emptySingleRow:!0,colSeparationType:m,maxNumCols:x?2:void 0,leqno:c.parser.settings.leqno},"display");let T,R=0;const P={type:"ordgroup",mode:c.mode,body:[]};if(o[0]&&o[0].type==="ordgroup"){let ie="";for(let oe=0;oe<o[0].body.length;oe++){const me=_t(o[0].body[oe],"textord");ie+=me.text}T=Number(ie),R=T*2}const X=!R;S.body.forEach(function(ie){for(let oe=1;oe<ie.length;oe+=2){const me=_t(ie[oe],"styling");_t(me.body[0],"ordgroup").body.unshift(P)}if(X)R<ie.length&&(R=ie.length);else{const oe=ie.length/2;if(T<oe)throw new a("Too many math in a row: "+("expected "+T+", but got "+oe),ie[0])}});for(let ie=0;ie<R;++ie){let oe="r",me=0;ie%2===1?oe="l":ie>0&&X&&(me=1),d[ie]={type:"align",align:oe,pregap:me,postgap:0}}return S.colSeparationType=X?"align":"alignat",S};gs({type:"array",names:["array","darray"],props:{numArgs:1},handler(c,o){const x=(Lo(o[0])?[o[0]]:_t(o[0],"ordgroup").body).map(function(T){const P=Tc(T).text;if("lcr".indexOf(P)!==-1)return{type:"align",align:P};if(P==="|")return{type:"separator",separator:"|"};if(P===":")return{type:"separator",separator:":"};throw new a("Unknown column alignment: "+P,T)}),S={cols:x,hskipBeforeAndAfter:!0,maxNumCols:x.length};return Ks(c.parser,S,Bc(c.envName))},htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(c){const o={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[c.envName.replace("*","")];let d="c";const m={hskipBeforeAndAfter:!1,cols:[{type:"align",align:d}]};if(c.envName.charAt(c.envName.length-1)==="*"){const T=c.parser;if(T.consumeSpaces(),T.fetch().text==="["){if(T.consume(),T.consumeSpaces(),d=T.fetch().text,"lcr".indexOf(d)===-1)throw new a("Expected l or c or r",T.nextToken);T.consume(),T.consumeSpaces(),T.expect("]"),T.consume(),m.cols=[{type:"align",align:d}]}}const x=Ks(c.parser,m,Bc(c.envName)),S=Math.max(0,...x.body.map(T=>T.length));return x.cols=new Array(S).fill({type:"align",align:d}),o?{type:"leftright",mode:c.mode,body:[x],left:o[0],right:o[1],rightColor:void 0}:x},htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(c){const o={arraystretch:.5},d=Ks(c.parser,o,"script");return d.colSeparationType="small",d},htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["subarray"],props:{numArgs:1},handler(c,o){const x=(Lo(o[0])?[o[0]]:_t(o[0],"ordgroup").body).map(function(T){const P=Tc(T).text;if("lc".indexOf(P)!==-1)return{type:"align",align:P};throw new a("Unknown column alignment: "+P,T)});if(x.length>1)throw new a("{subarray} can contain only one column");let S={cols:x,hskipBeforeAndAfter:!1,arraystretch:.5};if(S=Ks(c.parser,S,"script"),S.body.length>0&&S.body[0].length>1)throw new a("{subarray} can contain only one column");return S},htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(c){const o={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},d=Ks(c.parser,o,Bc(c.envName));return{type:"leftright",mode:c.mode,body:[d],left:c.envName.indexOf("r")>-1?".":"\\{",right:c.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:U0,htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(c){w.contains(["gather","gather*"],c.envName)&&Uo(c);const o={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:Pc(c.envName),emptySingleRow:!0,leqno:c.parser.settings.leqno};return Ks(c.parser,o,"display")},htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:U0,htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(c){Uo(c);const o={autoTag:Pc(c.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:c.parser.settings.leqno};return Ks(c.parser,o,"display")},htmlBuilder:ys,mathmlBuilder:xs}),gs({type:"array",names:["CD"],props:{numArgs:0},handler(c){return Uo(c),by(c.parser)},htmlBuilder:ys,mathmlBuilder:xs}),V("\\nonumber","\\gdef\\@eqnsw{0}"),V("\\notag","\\nonumber"),We({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(c,o){throw new a(c.funcName+" valid only within array environment")}});var W0=G0;We({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(c,o){let{parser:d,funcName:m}=c;const x=o[0];if(x.type!=="ordgroup")throw new a("Invalid environment name",x);let S="";for(let T=0;T<x.body.length;++T)S+=_t(x.body[T],"textord").text;if(m==="\\begin"){if(!W0.hasOwnProperty(S))throw new a("No such environment: "+S,x);const T=W0[S],{args:R,optArgs:P}=d.parseArguments("\\begin{"+S+"}",T),X={mode:d.mode,envName:S,parser:d},ie=T.handler(X,R,P);d.expect("\\end",!1);const oe=d.nextToken,me=_t(d.parseFunction(),"environment");if(me.name!==S)throw new a("Mismatch: \\begin{"+S+"} matched by \\end{"+me.name+"}",oe);return ie}return{type:"environment",mode:d.mode,name:S,nameGroup:x}}});const Z0=(c,o)=>{const d=c.font,m=o.withFont(d);return qt(c.body,m)},Y0=(c,o)=>{const d=c.font,m=o.withFont(d);return hn(c.body,m)},J0={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};We({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathsfit","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(c,o)=>{let{parser:d,funcName:m}=c;const x=Bo(o[0]);let S=m;return S in J0&&(S=J0[S]),{type:"font",mode:d.mode,font:S.slice(1),body:x}},htmlBuilder:Z0,mathmlBuilder:Y0}),We({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(c,o)=>{let{parser:d}=c;const m=o[0],x=w.isCharacterBox(m);return{type:"mclass",mode:d.mode,mclass:Go(m),body:[{type:"font",mode:d.mode,font:"boldsymbol",body:m}],isCharacterBox:x}}}),We({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(c,o)=>{let{parser:d,funcName:m,breakOnTokenText:x}=c;const{mode:S}=d,T=d.parseExpression(!0,x),R="math"+m.slice(1);return{type:"font",mode:S,font:R,body:{type:"ordgroup",mode:d.mode,body:T}}},htmlBuilder:Z0,mathmlBuilder:Y0});const X0=(c,o)=>{let d=o;return c==="display"?d=d.id>=ue.SCRIPT.id?d.text():ue.DISPLAY:c==="text"&&d.size===ue.DISPLAY.size?d=ue.TEXT:c==="script"?d=ue.SCRIPT:c==="scriptscript"&&(d=ue.SCRIPTSCRIPT),d},Fc=(c,o)=>{const d=X0(c.size,o.style),m=d.fracNum(),x=d.fracDen();let S;S=o.havingStyle(m);const T=qt(c.numer,S,o);if(c.continued){const Lt=8.5/o.fontMetrics().ptPerEm,Kt=3.5/o.fontMetrics().ptPerEm;T.height=T.height<Lt?Lt:T.height,T.depth=T.depth<Kt?Kt:T.depth}S=o.havingStyle(x);const R=qt(c.denom,S,o);let P,X,ie;c.hasBarLine?(c.barSize?(X=Qe(c.barSize,o),P=de.makeLineSpan("frac-line",o,X)):P=de.makeLineSpan("frac-line",o),X=P.height,ie=P.height):(P=null,X=0,ie=o.fontMetrics().defaultRuleThickness);let oe,me,Me;d.size===ue.DISPLAY.size||c.size==="display"?(oe=o.fontMetrics().num1,X>0?me=3*ie:me=7*ie,Me=o.fontMetrics().denom1):(X>0?(oe=o.fontMetrics().num2,me=ie):(oe=o.fontMetrics().num3,me=3*ie),Me=o.fontMetrics().denom2);let Xe;if(P){const Lt=o.fontMetrics().axisHeight;oe-T.depth-(Lt+.5*X)<me&&(oe+=me-(oe-T.depth-(Lt+.5*X))),Lt-.5*X-(R.height-Me)<me&&(Me+=me-(Lt-.5*X-(R.height-Me)));const Kt=-(Lt-.5*X);Xe=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:R,shift:Me},{type:"elem",elem:P,shift:Kt},{type:"elem",elem:T,shift:-oe}]},o)}else{const Lt=oe-T.depth-(R.height-Me);Lt<me&&(oe+=.5*(me-Lt),Me+=.5*(me-Lt)),Xe=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:R,shift:Me},{type:"elem",elem:T,shift:-oe}]},o)}S=o.havingStyle(d),Xe.height*=S.sizeMultiplier/o.sizeMultiplier,Xe.depth*=S.sizeMultiplier/o.sizeMultiplier;let lt;d.size===ue.DISPLAY.size?lt=o.fontMetrics().delim1:d.size===ue.SCRIPTSCRIPT.size?lt=o.havingStyle(ue.SCRIPT).fontMetrics().delim2:lt=o.fontMetrics().delim2;let Vt,Dt;return c.leftDelim==null?Vt=Pa(o,["mopen"]):Vt=Vs.customSizedDelim(c.leftDelim,lt,!0,o.havingStyle(d),c.mode,["mopen"]),c.continued?Dt=de.makeSpan([]):c.rightDelim==null?Dt=Pa(o,["mclose"]):Dt=Vs.customSizedDelim(c.rightDelim,lt,!0,o.havingStyle(d),c.mode,["mclose"]),de.makeSpan(["mord"].concat(S.sizingClasses(o)),[Vt,de.makeSpan(["mfrac"],[Xe]),Dt],o)},Lc=(c,o)=>{let d=new ze.MathNode("mfrac",[hn(c.numer,o),hn(c.denom,o)]);if(!c.hasBarLine)d.setAttribute("linethickness","0px");else if(c.barSize){const x=Qe(c.barSize,o);d.setAttribute("linethickness",je(x))}const m=X0(c.size,o.style);if(m.size!==o.style.size){d=new ze.MathNode("mstyle",[d]);const x=m.size===ue.DISPLAY.size?"true":"false";d.setAttribute("displaystyle",x),d.setAttribute("scriptlevel","0")}if(c.leftDelim!=null||c.rightDelim!=null){const x=[];if(c.leftDelim!=null){const S=new ze.MathNode("mo",[new ze.TextNode(c.leftDelim.replace("\\",""))]);S.setAttribute("fence","true"),x.push(S)}if(x.push(d),c.rightDelim!=null){const S=new ze.MathNode("mo",[new ze.TextNode(c.rightDelim.replace("\\",""))]);S.setAttribute("fence","true"),x.push(S)}return kc(x)}return d};We({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(c,o)=>{let{parser:d,funcName:m}=c;const x=o[0],S=o[1];let T,R=null,P=null,X="auto";switch(m){case"\\dfrac":case"\\frac":case"\\tfrac":T=!0;break;case"\\\\atopfrac":T=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":T=!1,R="(",P=")";break;case"\\\\bracefrac":T=!1,R="\\{",P="\\}";break;case"\\\\brackfrac":T=!1,R="[",P="]";break;default:throw new Error("Unrecognized genfrac command")}switch(m){case"\\dfrac":case"\\dbinom":X="display";break;case"\\tfrac":case"\\tbinom":X="text";break}return{type:"genfrac",mode:d.mode,continued:!1,numer:x,denom:S,hasBarLine:T,leftDelim:R,rightDelim:P,size:X,barSize:null}},htmlBuilder:Fc,mathmlBuilder:Lc}),We({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(c,o)=>{let{parser:d,funcName:m}=c;const x=o[0],S=o[1];return{type:"genfrac",mode:d.mode,continued:!0,numer:x,denom:S,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}}),We({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(c){let{parser:o,funcName:d,token:m}=c,x;switch(d){case"\\over":x="\\frac";break;case"\\choose":x="\\binom";break;case"\\atop":x="\\\\atopfrac";break;case"\\brace":x="\\\\bracefrac";break;case"\\brack":x="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:o.mode,replaceWith:x,token:m}}});const K0=["display","text","script","scriptscript"],Q0=function(c){let o=null;return c.length>0&&(o=c,o=o==="."?null:o),o};We({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(c,o){let{parser:d}=c;const m=o[4],x=o[5],S=Bo(o[0]),T=S.type==="atom"&&S.family==="open"?Q0(S.text):null,R=Bo(o[1]),P=R.type==="atom"&&R.family==="close"?Q0(R.text):null,X=_t(o[2],"size");let ie,oe=null;X.isBlank?ie=!0:(oe=X.value,ie=oe.number>0);let me="auto",Me=o[3];if(Me.type==="ordgroup"){if(Me.body.length>0){const Xe=_t(Me.body[0],"textord");me=K0[Number(Xe.text)]}}else Me=_t(Me,"textord"),me=K0[Number(Me.text)];return{type:"genfrac",mode:d.mode,numer:m,denom:x,continued:!1,hasBarLine:ie,barSize:oe,leftDelim:T,rightDelim:P,size:me}},htmlBuilder:Fc,mathmlBuilder:Lc}),We({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(c,o){let{parser:d,funcName:m,token:x}=c;return{type:"infix",mode:d.mode,replaceWith:"\\\\abovefrac",size:_t(o[0],"size").value,token:x}}}),We({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(c,o)=>{let{parser:d,funcName:m}=c;const x=o[0],S=D(_t(o[1],"infix").size),T=o[2],R=S.number>0;return{type:"genfrac",mode:d.mode,numer:x,denom:T,continued:!1,hasBarLine:R,barSize:S,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:Fc,mathmlBuilder:Lc});const eh=(c,o)=>{const d=o.style;let m,x;c.type==="supsub"?(m=c.sup?qt(c.sup,o.havingStyle(d.sup()),o):qt(c.sub,o.havingStyle(d.sub()),o),x=_t(c.base,"horizBrace")):x=_t(c,"horizBrace");const S=qt(x.base,o.havingBaseStyle(ue.DISPLAY)),T=Os.svgSpan(x,o);let R;if(x.isOver?(R=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:S},{type:"kern",size:.1},{type:"elem",elem:T}]},o),R.children[0].children[0].children[1].classes.push("svg-align")):(R=de.makeVList({positionType:"bottom",positionData:S.depth+.1+T.height,children:[{type:"elem",elem:T},{type:"kern",size:.1},{type:"elem",elem:S}]},o),R.children[0].children[0].children[0].classes.push("svg-align")),m){const P=de.makeSpan(["mord",x.isOver?"mover":"munder"],[R],o);x.isOver?R=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:P},{type:"kern",size:.2},{type:"elem",elem:m}]},o):R=de.makeVList({positionType:"bottom",positionData:P.depth+.2+m.height+m.depth,children:[{type:"elem",elem:m},{type:"kern",size:.2},{type:"elem",elem:P}]},o)}return de.makeSpan(["mord",x.isOver?"mover":"munder"],[R],o)};We({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(c,o){let{parser:d,funcName:m}=c;return{type:"horizBrace",mode:d.mode,label:m,isOver:/^\\over/.test(m),base:o[0]}},htmlBuilder:eh,mathmlBuilder:(c,o)=>{const d=Os.mathMLnode(c.label);return new ze.MathNode(c.isOver?"mover":"munder",[hn(c.base,o),d])}}),We({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(c,o)=>{let{parser:d}=c;const m=o[1],x=_t(o[0],"url").url;return d.settings.isTrusted({command:"\\href",url:x})?{type:"href",mode:d.mode,href:x,body:$n(m)}:d.formatUnsupportedCmd("\\href")},htmlBuilder:(c,o)=>{const d=Zn(c.body,o,!1);return de.makeAnchor(c.href,[],d,o)},mathmlBuilder:(c,o)=>{let d=Xs(c.body,o);return d instanceof Rr||(d=new Rr("mrow",[d])),d.setAttribute("href",c.href),d}}),We({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(c,o)=>{let{parser:d}=c;const m=_t(o[0],"url").url;if(!d.settings.isTrusted({command:"\\url",url:m}))return d.formatUnsupportedCmd("\\url");const x=[];for(let T=0;T<m.length;T++){let R=m[T];R==="~"&&(R="\\textasciitilde"),x.push({type:"textord",mode:"text",text:R})}const S={type:"text",mode:d.mode,font:"\\texttt",body:x};return{type:"href",mode:d.mode,href:m,body:$n(S)}}}),We({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(c,o){let{parser:d}=c;return{type:"hbox",mode:d.mode,body:$n(o[0])}},htmlBuilder(c,o){const d=Zn(c.body,o,!1);return de.makeFragment(d)},mathmlBuilder(c,o){return new ze.MathNode("mrow",Ar(c.body,o))}}),We({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(c,o)=>{let{parser:d,funcName:m,token:x}=c;const S=_t(o[0],"raw").string,T=o[1];d.settings.strict&&d.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");let R;const P={};switch(m){case"\\htmlClass":P.class=S,R={command:"\\htmlClass",class:S};break;case"\\htmlId":P.id=S,R={command:"\\htmlId",id:S};break;case"\\htmlStyle":P.style=S,R={command:"\\htmlStyle",style:S};break;case"\\htmlData":{const X=S.split(",");for(let ie=0;ie<X.length;ie++){const oe=X[ie].split("=");if(oe.length!==2)throw new a("Error parsing key-value for \\htmlData");P["data-"+oe[0].trim()]=oe[1].trim()}R={command:"\\htmlData",attributes:P};break}default:throw new Error("Unrecognized html command")}return d.settings.isTrusted(R)?{type:"html",mode:d.mode,attributes:P,body:$n(T)}:d.formatUnsupportedCmd(m)},htmlBuilder:(c,o)=>{const d=Zn(c.body,o,!1),m=["enclosing"];c.attributes.class&&m.push(...c.attributes.class.trim().split(/\s+/));const x=de.makeSpan(m,d,o);for(const S in c.attributes)S!=="class"&&c.attributes.hasOwnProperty(S)&&x.setAttribute(S,c.attributes[S]);return x},mathmlBuilder:(c,o)=>Xs(c.body,o)}),We({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(c,o)=>{let{parser:d}=c;return{type:"htmlmathml",mode:d.mode,html:$n(o[0]),mathml:$n(o[1])}},htmlBuilder:(c,o)=>{const d=Zn(c.html,o,!1);return de.makeFragment(d)},mathmlBuilder:(c,o)=>Xs(c.mathml,o)});const $c=function(c){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(c))return{number:+c,unit:"bp"};{const o=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(c);if(!o)throw new a("Invalid size: '"+c+"' in \\includegraphics");const d={number:+(o[1]+o[2]),unit:o[3]};if(!qe(d))throw new a("Invalid unit: '"+d.unit+"' in \\includegraphics.");return d}};We({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(c,o,d)=>{let{parser:m}=c,x={number:0,unit:"em"},S={number:.9,unit:"em"},T={number:0,unit:"em"},R="";if(d[0]){const ie=_t(d[0],"raw").string.split(",");for(let oe=0;oe<ie.length;oe++){const me=ie[oe].split("=");if(me.length===2){const Me=me[1].trim();switch(me[0].trim()){case"alt":R=Me;break;case"width":x=$c(Me);break;case"height":S=$c(Me);break;case"totalheight":T=$c(Me);break;default:throw new a("Invalid key: '"+me[0]+"' in \\includegraphics.")}}}}const P=_t(o[0],"url").url;return R===""&&(R=P,R=R.replace(/^.*[\\/]/,""),R=R.substring(0,R.lastIndexOf("."))),m.settings.isTrusted({command:"\\includegraphics",url:P})?{type:"includegraphics",mode:m.mode,alt:R,width:x,height:S,totalheight:T,src:P}:m.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(c,o)=>{const d=Qe(c.height,o);let m=0;c.totalheight.number>0&&(m=Qe(c.totalheight,o)-d);let x=0;c.width.number>0&&(x=Qe(c.width,o));const S={height:je(d+m)};x>0&&(S.width=je(x)),m>0&&(S.verticalAlign=je(-m));const T=new Tt(c.src,c.alt,S);return T.height=d,T.depth=m,T},mathmlBuilder:(c,o)=>{const d=new ze.MathNode("mglyph",[]);d.setAttribute("alt",c.alt);const m=Qe(c.height,o);let x=0;if(c.totalheight.number>0&&(x=Qe(c.totalheight,o)-m,d.setAttribute("valign",je(-x))),d.setAttribute("height",je(m+x)),c.width.number>0){const S=Qe(c.width,o);d.setAttribute("width",je(S))}return d.setAttribute("src",c.src),d}}),We({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(c,o){let{parser:d,funcName:m}=c;const x=_t(o[0],"size");if(d.settings.strict){const S=m[1]==="m",T=x.value.unit==="mu";S?(T||d.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+m+" supports only mu units, "+("not "+x.value.unit+" units")),d.mode!=="math"&&d.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+m+" works only in math mode")):T&&d.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+m+" doesn't support mu units")}return{type:"kern",mode:d.mode,dimension:x.value}},htmlBuilder(c,o){return de.makeGlue(c.dimension,o)},mathmlBuilder(c,o){const d=Qe(c.dimension,o);return new ze.SpaceNode(d)}}),We({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(c,o)=>{let{parser:d,funcName:m}=c;const x=o[0];return{type:"lap",mode:d.mode,alignment:m.slice(5),body:x}},htmlBuilder:(c,o)=>{let d;c.alignment==="clap"?(d=de.makeSpan([],[qt(c.body,o)]),d=de.makeSpan(["inner"],[d],o)):d=de.makeSpan(["inner"],[qt(c.body,o)]);const m=de.makeSpan(["fix"],[]);let x=de.makeSpan([c.alignment],[d,m],o);const S=de.makeSpan(["strut"]);return S.style.height=je(x.height+x.depth),x.depth&&(S.style.verticalAlign=je(-x.depth)),x.children.unshift(S),x=de.makeSpan(["thinbox"],[x],o),de.makeSpan(["mord","vbox"],[x],o)},mathmlBuilder:(c,o)=>{const d=new ze.MathNode("mpadded",[hn(c.body,o)]);if(c.alignment!=="rlap"){const m=c.alignment==="llap"?"-1":"-0.5";d.setAttribute("lspace",m+"width")}return d.setAttribute("width","0px"),d}}),We({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(c,o){let{funcName:d,parser:m}=c;const x=m.mode;m.switchMode("math");const S=d==="\\("?"\\)":"$",T=m.parseExpression(!1,S);return m.expect(S),m.switchMode(x),{type:"styling",mode:m.mode,style:"text",body:T}}}),We({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(c,o){throw new a("Mismatched "+c.funcName)}});const th=(c,o)=>{switch(o.style.size){case ue.DISPLAY.size:return c.display;case ue.TEXT.size:return c.text;case ue.SCRIPT.size:return c.script;case ue.SCRIPTSCRIPT.size:return c.scriptscript;default:return c.text}};We({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(c,o)=>{let{parser:d}=c;return{type:"mathchoice",mode:d.mode,display:$n(o[0]),text:$n(o[1]),script:$n(o[2]),scriptscript:$n(o[3])}},htmlBuilder:(c,o)=>{const d=th(c,o),m=Zn(d,o,!1);return de.makeFragment(m)},mathmlBuilder:(c,o)=>{const d=th(c,o);return Xs(d,o)}});const nh=(c,o,d,m,x,S,T)=>{c=de.makeSpan([],[c]);const R=d&&w.isCharacterBox(d);let P,X;if(o){const me=qt(o,m.havingStyle(x.sup()),m);X={elem:me,kern:Math.max(m.fontMetrics().bigOpSpacing1,m.fontMetrics().bigOpSpacing3-me.depth)}}if(d){const me=qt(d,m.havingStyle(x.sub()),m);P={elem:me,kern:Math.max(m.fontMetrics().bigOpSpacing2,m.fontMetrics().bigOpSpacing4-me.height)}}let ie;if(X&&P){const me=m.fontMetrics().bigOpSpacing5+P.elem.height+P.elem.depth+P.kern+c.depth+T;ie=de.makeVList({positionType:"bottom",positionData:me,children:[{type:"kern",size:m.fontMetrics().bigOpSpacing5},{type:"elem",elem:P.elem,marginLeft:je(-S)},{type:"kern",size:P.kern},{type:"elem",elem:c},{type:"kern",size:X.kern},{type:"elem",elem:X.elem,marginLeft:je(S)},{type:"kern",size:m.fontMetrics().bigOpSpacing5}]},m)}else if(P){const me=c.height-T;ie=de.makeVList({positionType:"top",positionData:me,children:[{type:"kern",size:m.fontMetrics().bigOpSpacing5},{type:"elem",elem:P.elem,marginLeft:je(-S)},{type:"kern",size:P.kern},{type:"elem",elem:c}]},m)}else if(X){const me=c.depth+T;ie=de.makeVList({positionType:"bottom",positionData:me,children:[{type:"elem",elem:c},{type:"kern",size:X.kern},{type:"elem",elem:X.elem,marginLeft:je(S)},{type:"kern",size:m.fontMetrics().bigOpSpacing5}]},m)}else return c;const oe=[ie];if(P&&S!==0&&!R){const me=de.makeSpan(["mspace"],[],m);me.style.marginRight=je(S),oe.unshift(me)}return de.makeSpan(["mop","op-limits"],oe,m)},rh=["\\smallint"],Ji=(c,o)=>{let d,m,x=!1,S;c.type==="supsub"?(d=c.sup,m=c.sub,S=_t(c.base,"op"),x=!0):S=_t(c,"op");const T=o.style;let R=!1;T.size===ue.DISPLAY.size&&S.symbol&&!w.contains(rh,S.name)&&(R=!0);let P;if(S.symbol){const oe=R?"Size2-Regular":"Size1-Regular";let me="";if((S.name==="\\oiint"||S.name==="\\oiiint")&&(me=S.name.slice(1),S.name=me==="oiint"?"\\iint":"\\iiint"),P=de.makeSymbol(S.name,oe,"math",o,["mop","op-symbol",R?"large-op":"small-op"]),me.length>0){const Me=P.italic,Xe=de.staticSvg(me+"Size"+(R?"2":"1"),o);P=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:P,shift:0},{type:"elem",elem:Xe,shift:R?.08:0}]},o),S.name="\\"+me,P.classes.unshift("mop"),P.italic=Me}}else if(S.body){const oe=Zn(S.body,o,!0);oe.length===1&&oe[0]instanceof Xt?(P=oe[0],P.classes[0]="mop"):P=de.makeSpan(["mop"],oe,o)}else{const oe=[];for(let me=1;me<S.name.length;me++)oe.push(de.mathsym(S.name[me],S.mode,o));P=de.makeSpan(["mop"],oe,o)}let X=0,ie=0;return(P instanceof Xt||S.name==="\\oiint"||S.name==="\\oiiint")&&!S.suppressBaseShift&&(X=(P.height-P.depth)/2-o.fontMetrics().axisHeight,ie=P.italic),x?nh(P,d,m,o,T,ie,X):(X&&(P.style.position="relative",P.style.top=je(X)),P)},La=(c,o)=>{let d;if(c.symbol)d=new Rr("mo",[$r(c.name,c.mode)]),w.contains(rh,c.name)&&d.setAttribute("largeop","false");else if(c.body)d=new Rr("mo",Ar(c.body,o));else{d=new Rr("mi",[new ms(c.name.slice(1))]);const m=new Rr("mo",[$r("","text")]);c.parentIsSupSub?d=new Rr("mrow",[d,m]):d=v0([d,m])}return d},Dy={"":"\\prod","":"\\coprod","":"\\sum","":"\\bigwedge","":"\\bigvee","":"\\bigcap","":"\\bigcup","":"\\bigodot","":"\\bigoplus","":"\\bigotimes","":"\\biguplus","":"\\bigsqcup"};We({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","","","","","","","","","","","",""],props:{numArgs:0},handler:(c,o)=>{let{parser:d,funcName:m}=c,x=m;return x.length===1&&(x=Dy[x]),{type:"op",mode:d.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:x}},htmlBuilder:Ji,mathmlBuilder:La}),We({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(c,o)=>{let{parser:d}=c;const m=o[0];return{type:"op",mode:d.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:$n(m)}},htmlBuilder:Ji,mathmlBuilder:La});const Ry={"":"\\int","":"\\iint","":"\\iiint","":"\\oint","":"\\oiint","":"\\oiiint"};We({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(c){let{parser:o,funcName:d}=c;return{type:"op",mode:o.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:d}},htmlBuilder:Ji,mathmlBuilder:La}),We({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(c){let{parser:o,funcName:d}=c;return{type:"op",mode:o.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:d}},htmlBuilder:Ji,mathmlBuilder:La}),We({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","","","","","",""],props:{numArgs:0},handler(c){let{parser:o,funcName:d}=c,m=d;return m.length===1&&(m=Ry[m]),{type:"op",mode:o.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:m}},htmlBuilder:Ji,mathmlBuilder:La});const sh=(c,o)=>{let d,m,x=!1,S;c.type==="supsub"?(d=c.sup,m=c.sub,S=_t(c.base,"operatorname"),x=!0):S=_t(c,"operatorname");let T;if(S.body.length>0){const R=S.body.map(X=>{const ie=X.text;return typeof ie=="string"?{type:"textord",mode:X.mode,text:ie}:X}),P=Zn(R,o.withFont("mathrm"),!0);for(let X=0;X<P.length;X++){const ie=P[X];ie instanceof Xt&&(ie.text=ie.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}T=de.makeSpan(["mop"],P,o)}else T=de.makeSpan(["mop"],[],o);return x?nh(T,d,m,o,o.style,0,0):T};We({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(c,o)=>{let{parser:d,funcName:m}=c;const x=o[0];return{type:"operatorname",mode:d.mode,body:$n(x),alwaysHandleSupSub:m==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:sh,mathmlBuilder:(c,o)=>{let d=Ar(c.body,o.withFont("mathrm")),m=!0;for(let T=0;T<d.length;T++){const R=d[T];if(!(R instanceof ze.SpaceNode))if(R instanceof ze.MathNode)switch(R.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{const P=R.children[0];R.children.length===1&&P instanceof ze.TextNode?P.text=P.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):m=!1;break}default:m=!1}else m=!1}if(m){const T=d.map(R=>R.toText()).join("");d=[new ze.TextNode(T)]}const x=new ze.MathNode("mi",d);x.setAttribute("mathvariant","normal");const S=new ze.MathNode("mo",[$r("","text")]);return c.parentIsSupSub?new ze.MathNode("mrow",[x,S]):ze.newDocumentFragment([x,S])}}),V("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@"),Ai({type:"ordgroup",htmlBuilder(c,o){return c.semisimple?de.makeFragment(Zn(c.body,o,!1)):de.makeSpan(["mord"],Zn(c.body,o,!0),o)},mathmlBuilder(c,o){return Xs(c.body,o,!0)}}),We({type:"overline",names:["\\overline"],props:{numArgs:1},handler(c,o){let{parser:d}=c;const m=o[0];return{type:"overline",mode:d.mode,body:m}},htmlBuilder(c,o){const d=qt(c.body,o.havingCrampedStyle()),m=de.makeLineSpan("overline-line",o),x=o.fontMetrics().defaultRuleThickness,S=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:d},{type:"kern",size:3*x},{type:"elem",elem:m},{type:"kern",size:x}]},o);return de.makeSpan(["mord","overline"],[S],o)},mathmlBuilder(c,o){const d=new ze.MathNode("mo",[new ze.TextNode("")]);d.setAttribute("stretchy","true");const m=new ze.MathNode("mover",[hn(c.body,o),d]);return m.setAttribute("accent","true"),m}}),We({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(c,o)=>{let{parser:d}=c;const m=o[0];return{type:"phantom",mode:d.mode,body:$n(m)}},htmlBuilder:(c,o)=>{const d=Zn(c.body,o.withPhantom(),!1);return de.makeFragment(d)},mathmlBuilder:(c,o)=>{const d=Ar(c.body,o);return new ze.MathNode("mphantom",d)}}),We({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(c,o)=>{let{parser:d}=c;const m=o[0];return{type:"hphantom",mode:d.mode,body:m}},htmlBuilder:(c,o)=>{let d=de.makeSpan([],[qt(c.body,o.withPhantom())]);if(d.height=0,d.depth=0,d.children)for(let m=0;m<d.children.length;m++)d.children[m].height=0,d.children[m].depth=0;return d=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:d}]},o),de.makeSpan(["mord"],[d],o)},mathmlBuilder:(c,o)=>{const d=Ar($n(c.body),o),m=new ze.MathNode("mphantom",d),x=new ze.MathNode("mpadded",[m]);return x.setAttribute("height","0px"),x.setAttribute("depth","0px"),x}}),We({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(c,o)=>{let{parser:d}=c;const m=o[0];return{type:"vphantom",mode:d.mode,body:m}},htmlBuilder:(c,o)=>{const d=de.makeSpan(["inner"],[qt(c.body,o.withPhantom())]),m=de.makeSpan(["fix"],[]);return de.makeSpan(["mord","rlap"],[d,m],o)},mathmlBuilder:(c,o)=>{const d=Ar($n(c.body),o),m=new ze.MathNode("mphantom",d),x=new ze.MathNode("mpadded",[m]);return x.setAttribute("width","0px"),x}}),We({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(c,o){let{parser:d}=c;const m=_t(o[0],"size").value,x=o[1];return{type:"raisebox",mode:d.mode,dy:m,body:x}},htmlBuilder(c,o){const d=qt(c.body,o),m=Qe(c.dy,o);return de.makeVList({positionType:"shift",positionData:-m,children:[{type:"elem",elem:d}]},o)},mathmlBuilder(c,o){const d=new ze.MathNode("mpadded",[hn(c.body,o)]),m=c.dy.number+c.dy.unit;return d.setAttribute("voffset",m),d}}),We({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0,allowedInArgument:!0},handler(c){let{parser:o}=c;return{type:"internal",mode:o.mode}}}),We({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(c,o,d){let{parser:m}=c;const x=d[0],S=_t(o[0],"size"),T=_t(o[1],"size");return{type:"rule",mode:m.mode,shift:x&&_t(x,"size").value,width:S.value,height:T.value}},htmlBuilder(c,o){const d=de.makeSpan(["mord","rule"],[],o),m=Qe(c.width,o),x=Qe(c.height,o),S=c.shift?Qe(c.shift,o):0;return d.style.borderRightWidth=je(m),d.style.borderTopWidth=je(x),d.style.bottom=je(S),d.width=m,d.height=x+S,d.depth=-S,d.maxFontSize=x*1.125*o.sizeMultiplier,d},mathmlBuilder(c,o){const d=Qe(c.width,o),m=Qe(c.height,o),x=c.shift?Qe(c.shift,o):0,S=o.color&&o.getColor()||"black",T=new ze.MathNode("mspace");T.setAttribute("mathbackground",S),T.setAttribute("width",je(d)),T.setAttribute("height",je(m));const R=new ze.MathNode("mpadded",[T]);return x>=0?R.setAttribute("height",je(x)):(R.setAttribute("height",je(x)),R.setAttribute("depth",je(-x))),R.setAttribute("voffset",je(x)),R}});function ih(c,o,d){const m=Zn(c,o,!1),x=o.sizeMultiplier/d.sizeMultiplier;for(let S=0;S<m.length;S++){const T=m[S].classes.indexOf("sizing");T<0?Array.prototype.push.apply(m[S].classes,o.sizingClasses(d)):m[S].classes[T+1]==="reset-size"+o.size&&(m[S].classes[T+1]="reset-size"+d.size),m[S].height*=x,m[S].depth*=x}return de.makeFragment(m)}const ah=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"];We({type:"sizing",names:ah,props:{numArgs:0,allowedInText:!0},handler:(c,o)=>{let{breakOnTokenText:d,funcName:m,parser:x}=c;const S=x.parseExpression(!1,d);return{type:"sizing",mode:x.mode,size:ah.indexOf(m)+1,body:S}},htmlBuilder:(c,o)=>{const d=o.havingSize(c.size);return ih(c.body,d,o)},mathmlBuilder:(c,o)=>{const d=o.havingSize(c.size),m=Ar(c.body,d),x=new ze.MathNode("mstyle",m);return x.setAttribute("mathsize",je(d.sizeMultiplier)),x}}),We({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(c,o,d)=>{let{parser:m}=c,x=!1,S=!1;const T=d[0]&&_t(d[0],"ordgroup");if(T){let P="";for(let X=0;X<T.body.length;++X)if(P=T.body[X].text,P==="t")x=!0;else if(P==="b")S=!0;else{x=!1,S=!1;break}}else x=!0,S=!0;const R=o[0];return{type:"smash",mode:m.mode,body:R,smashHeight:x,smashDepth:S}},htmlBuilder:(c,o)=>{const d=de.makeSpan([],[qt(c.body,o)]);if(!c.smashHeight&&!c.smashDepth)return d;if(c.smashHeight&&(d.height=0,d.children))for(let x=0;x<d.children.length;x++)d.children[x].height=0;if(c.smashDepth&&(d.depth=0,d.children))for(let x=0;x<d.children.length;x++)d.children[x].depth=0;const m=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:d}]},o);return de.makeSpan(["mord"],[m],o)},mathmlBuilder:(c,o)=>{const d=new ze.MathNode("mpadded",[hn(c.body,o)]);return c.smashHeight&&d.setAttribute("height","0px"),c.smashDepth&&d.setAttribute("depth","0px"),d}}),We({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(c,o,d){let{parser:m}=c;const x=d[0],S=o[0];return{type:"sqrt",mode:m.mode,body:S,index:x}},htmlBuilder(c,o){let d=qt(c.body,o.havingCrampedStyle());d.height===0&&(d.height=o.fontMetrics().xHeight),d=de.wrapFragment(d,o);const x=o.fontMetrics().defaultRuleThickness;let S=x;o.style.id<ue.TEXT.id&&(S=o.fontMetrics().xHeight);let T=x+S/4;const R=d.height+d.depth+T+x,{span:P,ruleWidth:X,advanceWidth:ie}=Vs.sqrtImage(R,o),oe=P.height-X;oe>d.height+d.depth+T&&(T=(T+oe-d.height-d.depth)/2);const me=P.height-d.height-T-X;d.style.paddingLeft=je(ie);const Me=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:d,wrapperClasses:["svg-align"]},{type:"kern",size:-(d.height+me)},{type:"elem",elem:P},{type:"kern",size:X}]},o);if(c.index){const Xe=o.havingStyle(ue.SCRIPTSCRIPT),lt=qt(c.index,Xe,o),Vt=.6*(Me.height-Me.depth),Dt=de.makeVList({positionType:"shift",positionData:-Vt,children:[{type:"elem",elem:lt}]},o),Lt=de.makeSpan(["root"],[Dt]);return de.makeSpan(["mord","sqrt"],[Lt,Me],o)}else return de.makeSpan(["mord","sqrt"],[Me],o)},mathmlBuilder(c,o){const{body:d,index:m}=c;return m?new ze.MathNode("mroot",[hn(d,o),hn(m,o)]):new ze.MathNode("msqrt",[hn(d,o)])}});const oh={display:ue.DISPLAY,text:ue.TEXT,script:ue.SCRIPT,scriptscript:ue.SCRIPTSCRIPT};We({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(c,o){let{breakOnTokenText:d,funcName:m,parser:x}=c;const S=x.parseExpression(!0,d),T=m.slice(1,m.length-5);return{type:"styling",mode:x.mode,style:T,body:S}},htmlBuilder(c,o){const d=oh[c.style],m=o.havingStyle(d).withFont("");return ih(c.body,m,o)},mathmlBuilder(c,o){const d=oh[c.style],m=o.havingStyle(d),x=Ar(c.body,m),S=new ze.MathNode("mstyle",x),R={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]}[c.style];return S.setAttribute("scriptlevel",R[0]),S.setAttribute("displaystyle",R[1]),S}});const Oy=function(c,o){const d=c.base;return d?d.type==="op"?d.limits&&(o.style.size===ue.DISPLAY.size||d.alwaysHandleSupSub)?Ji:null:d.type==="operatorname"?d.alwaysHandleSupSub&&(o.style.size===ue.DISPLAY.size||d.limits)?sh:null:d.type==="accent"?w.isCharacterBox(d.base)?Ic:null:d.type==="horizBrace"&&!c.sub===d.isOver?eh:null:null};Ai({type:"supsub",htmlBuilder(c,o){const d=Oy(c,o);if(d)return d(c,o);const{base:m,sup:x,sub:S}=c,T=qt(m,o);let R,P;const X=o.fontMetrics();let ie=0,oe=0;const me=m&&w.isCharacterBox(m);if(x){const Kt=o.havingStyle(o.style.sup());R=qt(x,Kt,o),me||(ie=T.height-Kt.fontMetrics().supDrop*Kt.sizeMultiplier/o.sizeMultiplier)}if(S){const Kt=o.havingStyle(o.style.sub());P=qt(S,Kt,o),me||(oe=T.depth+Kt.fontMetrics().subDrop*Kt.sizeMultiplier/o.sizeMultiplier)}let Me;o.style===ue.DISPLAY?Me=X.sup1:o.style.cramped?Me=X.sup3:Me=X.sup2;const Xe=o.sizeMultiplier,lt=je(.5/X.ptPerEm/Xe);let Vt=null;if(P){const Kt=c.base&&c.base.type==="op"&&c.base.name&&(c.base.name==="\\oiint"||c.base.name==="\\oiiint");(T instanceof Xt||Kt)&&(Vt=je(-T.italic))}let Dt;if(R&&P){ie=Math.max(ie,Me,R.depth+.25*X.xHeight),oe=Math.max(oe,X.sub2);const gn=4*X.defaultRuleThickness;if(ie-R.depth-(P.height-oe)<gn){oe=gn-(ie-R.depth)+P.height;const Yn=.8*X.xHeight-(ie-R.depth);Yn>0&&(ie+=Yn,oe-=Yn)}const gr=[{type:"elem",elem:P,shift:oe,marginRight:lt,marginLeft:Vt},{type:"elem",elem:R,shift:-ie,marginRight:lt}];Dt=de.makeVList({positionType:"individualShift",children:gr},o)}else if(P){oe=Math.max(oe,X.sub1,P.height-.8*X.xHeight);const Kt=[{type:"elem",elem:P,marginLeft:Vt,marginRight:lt}];Dt=de.makeVList({positionType:"shift",positionData:oe,children:Kt},o)}else if(R)ie=Math.max(ie,Me,R.depth+.25*X.xHeight),Dt=de.makeVList({positionType:"shift",positionData:-ie,children:[{type:"elem",elem:R,marginRight:lt}]},o);else throw new Error("supsub must have either sup or sub.");const Lt=wc(T,"right")||"mord";return de.makeSpan([Lt],[T,de.makeSpan(["msupsub"],[Dt])],o)},mathmlBuilder(c,o){let d=!1,m,x;c.base&&c.base.type==="horizBrace"&&(x=!!c.sup,x===c.base.isOver&&(d=!0,m=c.base.isOver)),c.base&&(c.base.type==="op"||c.base.type==="operatorname")&&(c.base.parentIsSupSub=!0);const S=[hn(c.base,o)];c.sub&&S.push(hn(c.sub,o)),c.sup&&S.push(hn(c.sup,o));let T;if(d)T=m?"mover":"munder";else if(c.sub)if(c.sup){const R=c.base;R&&R.type==="op"&&R.limits&&o.style===ue.DISPLAY||R&&R.type==="operatorname"&&R.alwaysHandleSupSub&&(o.style===ue.DISPLAY||R.limits)?T="munderover":T="msubsup"}else{const R=c.base;R&&R.type==="op"&&R.limits&&(o.style===ue.DISPLAY||R.alwaysHandleSupSub)||R&&R.type==="operatorname"&&R.alwaysHandleSupSub&&(R.limits||o.style===ue.DISPLAY)?T="munder":T="msub"}else{const R=c.base;R&&R.type==="op"&&R.limits&&(o.style===ue.DISPLAY||R.alwaysHandleSupSub)||R&&R.type==="operatorname"&&R.alwaysHandleSupSub&&(R.limits||o.style===ue.DISPLAY)?T="mover":T="msup"}return new ze.MathNode(T,S)}}),Ai({type:"atom",htmlBuilder(c,o){return de.mathsym(c.text,c.mode,o,["m"+c.family])},mathmlBuilder(c,o){const d=new ze.MathNode("mo",[$r(c.text,c.mode)]);if(c.family==="bin"){const m=jc(c,o);m==="bold-italic"&&d.setAttribute("mathvariant",m)}else c.family==="punct"?d.setAttribute("separator","true"):(c.family==="open"||c.family==="close")&&d.setAttribute("stretchy","false");return d}});const lh={mi:"italic",mn:"normal",mtext:"normal"};Ai({type:"mathord",htmlBuilder(c,o){return de.makeOrd(c,o,"mathord")},mathmlBuilder(c,o){const d=new ze.MathNode("mi",[$r(c.text,c.mode,o)]),m=jc(c,o)||"italic";return m!==lh[d.type]&&d.setAttribute("mathvariant",m),d}}),Ai({type:"textord",htmlBuilder(c,o){return de.makeOrd(c,o,"textord")},mathmlBuilder(c,o){const d=$r(c.text,c.mode,o),m=jc(c,o)||"normal";let x;return c.mode==="text"?x=new ze.MathNode("mtext",[d]):/[0-9]/.test(c.text)?x=new ze.MathNode("mn",[d]):c.text==="\\prime"?x=new ze.MathNode("mo",[d]):x=new ze.MathNode("mi",[d]),m!==lh[x.type]&&x.setAttribute("mathvariant",m),x}});const Gc={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},Hc={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};Ai({type:"spacing",htmlBuilder(c,o){if(Hc.hasOwnProperty(c.text)){const d=Hc[c.text].className||"";if(c.mode==="text"){const m=de.makeOrd(c,o,"textord");return m.classes.push(d),m}else return de.makeSpan(["mspace",d],[de.mathsym(c.text,c.mode,o)],o)}else{if(Gc.hasOwnProperty(c.text))return de.makeSpan(["mspace",Gc[c.text]],[],o);throw new a('Unknown type of space "'+c.text+'"')}},mathmlBuilder(c,o){let d;if(Hc.hasOwnProperty(c.text))d=new ze.MathNode("mtext",[new ze.TextNode("")]);else{if(Gc.hasOwnProperty(c.text))return new ze.MathNode("mspace");throw new a('Unknown type of space "'+c.text+'"')}return d}});const ch=()=>{const c=new ze.MathNode("mtd",[]);return c.setAttribute("width","50%"),c};Ai({type:"tag",mathmlBuilder(c,o){const d=new ze.MathNode("mtable",[new ze.MathNode("mtr",[ch(),new ze.MathNode("mtd",[Xs(c.body,o)]),ch(),new ze.MathNode("mtd",[Xs(c.tag,o)])])]);return d.setAttribute("width","100%"),d}});const uh={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},dh={"\\textbf":"textbf","\\textmd":"textmd"},Vy={"\\textit":"textit","\\textup":"textup"},hh=(c,o)=>{const d=c.font;if(d){if(uh[d])return o.withTextFontFamily(uh[d]);if(dh[d])return o.withTextFontWeight(dh[d]);if(d==="\\emph")return o.fontShape==="textit"?o.withTextFontShape("textup"):o.withTextFontShape("textit")}else return o;return o.withTextFontShape(Vy[d])};We({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(c,o){let{parser:d,funcName:m}=c;const x=o[0];return{type:"text",mode:d.mode,body:$n(x),font:m}},htmlBuilder(c,o){const d=hh(c,o),m=Zn(c.body,d,!0);return de.makeSpan(["mord","text"],m,d)},mathmlBuilder(c,o){const d=hh(c,o);return Xs(c.body,d)}}),We({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(c,o){let{parser:d}=c;return{type:"underline",mode:d.mode,body:o[0]}},htmlBuilder(c,o){const d=qt(c.body,o),m=de.makeLineSpan("underline-line",o),x=o.fontMetrics().defaultRuleThickness,S=de.makeVList({positionType:"top",positionData:d.height,children:[{type:"kern",size:x},{type:"elem",elem:m},{type:"kern",size:3*x},{type:"elem",elem:d}]},o);return de.makeSpan(["mord","underline"],[S],o)},mathmlBuilder(c,o){const d=new ze.MathNode("mo",[new ze.TextNode("")]);d.setAttribute("stretchy","true");const m=new ze.MathNode("munder",[hn(c.body,o),d]);return m.setAttribute("accentunder","true"),m}}),We({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(c,o){let{parser:d}=c;return{type:"vcenter",mode:d.mode,body:o[0]}},htmlBuilder(c,o){const d=qt(c.body,o),m=o.fontMetrics().axisHeight,x=.5*(d.height-m-(d.depth+m));return de.makeVList({positionType:"shift",positionData:x,children:[{type:"elem",elem:d}]},o)},mathmlBuilder(c,o){return new ze.MathNode("mpadded",[hn(c.body,o)],["vcenter"])}}),We({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(c,o,d){throw new a("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(c,o){const d=fh(c),m=[],x=o.havingStyle(o.style.text());for(let S=0;S<d.length;S++){let T=d[S];T==="~"&&(T="\\textasciitilde"),m.push(de.makeSymbol(T,"Typewriter-Regular",c.mode,x,["mord","texttt"]))}return de.makeSpan(["mord","text"].concat(x.sizingClasses(o)),de.tryCombineChars(m),x)},mathmlBuilder(c,o){const d=new ze.TextNode(fh(c)),m=new ze.MathNode("mtext",[d]);return m.setAttribute("mathvariant","monospace"),m}});const fh=c=>c.body.replace(/ /g,c.star?"":"");var Qs=x0;const ph=`[ \r
	]`,zy="\\\\[a-zA-Z@]+",Py="\\\\[^\uD800-\uDFFF]",By="("+zy+")"+ph+"*",Fy=`\\\\(
|[ \r	]+
?)[ \r	]*`,qc="[-]",Ly=new RegExp(qc+"+$"),$y="("+ph+"+)|"+(Fy+"|")+"([!-\\[\\]---]"+(qc+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(qc+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+By)+("|"+Py+")");class mh{constructor(o,d){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=o,this.settings=d,this.tokenRegex=new RegExp($y,"g"),this.catcodes={"%":14,"~":13}}setCatcode(o,d){this.catcodes[o]=d}lex(){const o=this.input,d=this.tokenRegex.lastIndex;if(d===o.length)return new Gr("EOF",new Or(this,d,d));const m=this.tokenRegex.exec(o);if(m===null||m.index!==d)throw new a("Unexpected character: '"+o[d]+"'",new Gr(o[d],new Or(this,d,d+1)));const x=m[6]||m[3]||(m[2]?"\\ ":" ");if(this.catcodes[x]===14){const S=o.indexOf(`
`,this.tokenRegex.lastIndex);return S===-1?(this.tokenRegex.lastIndex=o.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=S+1,this.lex()}return new Gr(x,new Or(this,d,this.tokenRegex.lastIndex))}}class Gy{constructor(o,d){o===void 0&&(o={}),d===void 0&&(d={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=d,this.builtins=o,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new a("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");const o=this.undefStack.pop();for(const d in o)o.hasOwnProperty(d)&&(o[d]==null?delete this.current[d]:this.current[d]=o[d])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(o){return this.current.hasOwnProperty(o)||this.builtins.hasOwnProperty(o)}get(o){return this.current.hasOwnProperty(o)?this.current[o]:this.builtins[o]}set(o,d,m){if(m===void 0&&(m=!1),m){for(let x=0;x<this.undefStack.length;x++)delete this.undefStack[x][o];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][o]=d)}else{const x=this.undefStack[this.undefStack.length-1];x&&!x.hasOwnProperty(o)&&(x[o]=this.current[o])}d==null?delete this.current[o]:this.current[o]=d}}var Hy=H0;V("\\noexpand",function(c){const o=c.popToken();return c.isExpandable(o.text)&&(o.noexpand=!0,o.treatAsRelax=!0),{tokens:[o],numArgs:0}}),V("\\expandafter",function(c){const o=c.popToken();return c.expandOnce(!0),{tokens:[o],numArgs:0}}),V("\\@firstoftwo",function(c){return{tokens:c.consumeArgs(2)[0],numArgs:0}}),V("\\@secondoftwo",function(c){return{tokens:c.consumeArgs(2)[1],numArgs:0}}),V("\\@ifnextchar",function(c){const o=c.consumeArgs(3);c.consumeSpaces();const d=c.future();return o[0].length===1&&o[0][0].text===d.text?{tokens:o[1],numArgs:0}:{tokens:o[2],numArgs:0}}),V("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}"),V("\\TextOrMath",function(c){const o=c.consumeArgs(2);return c.mode==="text"?{tokens:o[0],numArgs:0}:{tokens:o[1],numArgs:0}});const gh={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};V("\\char",function(c){let o=c.popToken(),d,m="";if(o.text==="'")d=8,o=c.popToken();else if(o.text==='"')d=16,o=c.popToken();else if(o.text==="`")if(o=c.popToken(),o.text[0]==="\\")m=o.text.charCodeAt(1);else{if(o.text==="EOF")throw new a("\\char` missing argument");m=o.text.charCodeAt(0)}else d=10;if(d){if(m=gh[o.text],m==null||m>=d)throw new a("Invalid base-"+d+" digit "+o.text);let x;for(;(x=gh[c.future().text])!=null&&x<d;)m*=d,m+=x,c.popToken()}return"\\@char{"+m+"}"});const Uc=(c,o,d,m)=>{let x=c.consumeArg().tokens;if(x.length!==1)throw new a("\\newcommand's first argument must be a macro name");const S=x[0].text,T=c.isDefined(S);if(T&&!o)throw new a("\\newcommand{"+S+"} attempting to redefine "+(S+"; use \\renewcommand"));if(!T&&!d)throw new a("\\renewcommand{"+S+"} when command "+S+" does not yet exist; use \\newcommand");let R=0;if(x=c.consumeArg().tokens,x.length===1&&x[0].text==="["){let P="",X=c.expandNextToken();for(;X.text!=="]"&&X.text!=="EOF";)P+=X.text,X=c.expandNextToken();if(!P.match(/^\s*[0-9]+\s*$/))throw new a("Invalid number of arguments: "+P);R=parseInt(P),x=c.consumeArg().tokens}return T&&m||c.macros.set(S,{tokens:x,numArgs:R}),""};V("\\newcommand",c=>Uc(c,!1,!0,!1)),V("\\renewcommand",c=>Uc(c,!0,!1,!1)),V("\\providecommand",c=>Uc(c,!0,!0,!0)),V("\\message",c=>{const o=c.consumeArgs(1)[0];return console.log(o.reverse().map(d=>d.text).join("")),""}),V("\\errmessage",c=>{const o=c.consumeArgs(1)[0];return console.error(o.reverse().map(d=>d.text).join("")),""}),V("\\show",c=>{const o=c.popToken(),d=o.text;return console.log(o,c.macros.get(d),Qs[d],mn.math[d],mn.text[d]),""}),V("\\bgroup","{"),V("\\egroup","}"),V("~","\\nobreakspace"),V("\\lq","`"),V("\\rq","'"),V("\\aa","\\r a"),V("\\AA","\\r A"),V("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`}"),V("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}"),V("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`}"),V("","\\mathscr{B}"),V("","\\mathscr{E}"),V("","\\mathscr{F}"),V("","\\mathscr{H}"),V("","\\mathscr{I}"),V("","\\mathscr{L}"),V("","\\mathscr{M}"),V("","\\mathscr{R}"),V("","\\mathfrak{C}"),V("","\\mathfrak{H}"),V("","\\mathfrak{Z}"),V("\\Bbbk","\\Bbb{k}"),V("","\\cdotp"),V("\\llap","\\mathllap{\\textrm{#1}}"),V("\\rlap","\\mathrlap{\\textrm{#1}}"),V("\\clap","\\mathclap{\\textrm{#1}}"),V("\\mathstrut","\\vphantom{(}"),V("\\underbar","\\underline{\\text{#1}}"),V("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}'),V("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`}}"),V("\\ne","\\neq"),V("","\\neq"),V("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`}}"),V("","\\notin"),V("","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`}}"),V("","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`}}"),V("","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`}}"),V("","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`}}"),V("","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`}}"),V("","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`}}"),V("","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`}}"),V("","\\perp"),V("","\\mathclose{!\\mkern-0.8mu!}"),V("","\\notni"),V("","\\ulcorner"),V("","\\urcorner"),V("","\\llcorner"),V("","\\lrcorner"),V("","\\copyright"),V("","\\textregistered"),V("","\\textregistered"),V("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}'),V("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}'),V("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}'),V("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}'),V("\\vdots","{\\varvdots\\rule{0pt}{15pt}}"),V("","\\vdots"),V("\\varGamma","\\mathit{\\Gamma}"),V("\\varDelta","\\mathit{\\Delta}"),V("\\varTheta","\\mathit{\\Theta}"),V("\\varLambda","\\mathit{\\Lambda}"),V("\\varXi","\\mathit{\\Xi}"),V("\\varPi","\\mathit{\\Pi}"),V("\\varSigma","\\mathit{\\Sigma}"),V("\\varUpsilon","\\mathit{\\Upsilon}"),V("\\varPhi","\\mathit{\\Phi}"),V("\\varPsi","\\mathit{\\Psi}"),V("\\varOmega","\\mathit{\\Omega}"),V("\\substack","\\begin{subarray}{c}#1\\end{subarray}"),V("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax"),V("\\boxed","\\fbox{$\\displaystyle{#1}$}"),V("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;"),V("\\implies","\\DOTSB\\;\\Longrightarrow\\;"),V("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;"),V("\\dddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ...}}{#1}}"),V("\\ddddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ....}}{#1}}");const yh={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};V("\\dots",function(c){let o="\\dotso";const d=c.expandAfterFuture().text;return d in yh?o=yh[d]:(d.slice(0,4)==="\\not"||d in mn.math&&w.contains(["bin","rel"],mn.math[d].group))&&(o="\\dotsb"),o});const Wc={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};V("\\dotso",function(c){return c.future().text in Wc?"\\ldots\\,":"\\ldots"}),V("\\dotsc",function(c){const o=c.future().text;return o in Wc&&o!==","?"\\ldots\\,":"\\ldots"}),V("\\cdots",function(c){return c.future().text in Wc?"\\@cdots\\,":"\\@cdots"}),V("\\dotsb","\\cdots"),V("\\dotsm","\\cdots"),V("\\dotsi","\\!\\cdots"),V("\\dotsx","\\ldots\\,"),V("\\DOTSI","\\relax"),V("\\DOTSB","\\relax"),V("\\DOTSX","\\relax"),V("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax"),V("\\,","\\tmspace+{3mu}{.1667em}"),V("\\thinspace","\\,"),V("\\>","\\mskip{4mu}"),V("\\:","\\tmspace+{4mu}{.2222em}"),V("\\medspace","\\:"),V("\\;","\\tmspace+{5mu}{.2777em}"),V("\\thickspace","\\;"),V("\\!","\\tmspace-{3mu}{.1667em}"),V("\\negthinspace","\\!"),V("\\negmedspace","\\tmspace-{4mu}{.2222em}"),V("\\negthickspace","\\tmspace-{5mu}{.277em}"),V("\\enspace","\\kern.5em "),V("\\enskip","\\hskip.5em\\relax"),V("\\quad","\\hskip1em\\relax"),V("\\qquad","\\hskip2em\\relax"),V("\\tag","\\@ifstar\\tag@literal\\tag@paren"),V("\\tag@paren","\\tag@literal{({#1})}"),V("\\tag@literal",c=>{if(c.macros.get("\\df@tag"))throw new a("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"}),V("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}"),V("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)"),V("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}"),V("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1"),V("\\newline","\\\\\\relax"),V("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");const xh=je(Ct["Main-Regular"][84][1]-.7*Ct["Main-Regular"][65][1]);V("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+xh+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}"),V("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+xh+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}"),V("\\hspace","\\@ifstar\\@hspacer\\@hspace"),V("\\@hspace","\\hskip #1\\relax"),V("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax"),V("\\ordinarycolon",":"),V("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}"),V("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}'),V("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}'),V("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}'),V("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}'),V("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}'),V("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}'),V("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}'),V("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}'),V("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}'),V("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}'),V("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}'),V("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}'),V("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}'),V("","\\dblcolon"),V("","\\eqcolon"),V("","\\coloneqq"),V("","\\eqqcolon"),V("","\\Coloneqq"),V("\\ratio","\\vcentcolon"),V("\\coloncolon","\\dblcolon"),V("\\colonequals","\\coloneqq"),V("\\coloncolonequals","\\Coloneqq"),V("\\equalscolon","\\eqqcolon"),V("\\equalscoloncolon","\\Eqqcolon"),V("\\colonminus","\\coloneq"),V("\\coloncolonminus","\\Coloneq"),V("\\minuscolon","\\eqcolon"),V("\\minuscoloncolon","\\Eqcolon"),V("\\coloncolonapprox","\\Colonapprox"),V("\\coloncolonsim","\\Colonsim"),V("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),V("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}"),V("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),V("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}"),V("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`}}"),V("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}"),V("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}"),V("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}"),V("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}"),V("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}"),V("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}"),V("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}"),V("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}"),V("\\gvertneqq","\\html@mathml{\\@gvertneqq}{}"),V("\\lvertneqq","\\html@mathml{\\@lvertneqq}{}"),V("\\ngeqq","\\html@mathml{\\@ngeqq}{}"),V("\\ngeqslant","\\html@mathml{\\@ngeqslant}{}"),V("\\nleqq","\\html@mathml{\\@nleqq}{}"),V("\\nleqslant","\\html@mathml{\\@nleqslant}{}"),V("\\nshortmid","\\html@mathml{\\@nshortmid}{}"),V("\\nshortparallel","\\html@mathml{\\@nshortparallel}{}"),V("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{}"),V("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{}"),V("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{}"),V("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{}"),V("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{}"),V("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{}"),V("\\imath","\\html@mathml{\\@imath}{}"),V("\\jmath","\\html@mathml{\\@jmath}{}"),V("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`}}"),V("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`}}"),V("","\\llbracket"),V("","\\rrbracket"),V("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`}}"),V("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`}}"),V("","\\lBrace"),V("","\\rBrace"),V("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`}}"),V("","\\minuso"),V("\\darr","\\downarrow"),V("\\dArr","\\Downarrow"),V("\\Darr","\\Downarrow"),V("\\lang","\\langle"),V("\\rang","\\rangle"),V("\\uarr","\\uparrow"),V("\\uArr","\\Uparrow"),V("\\Uarr","\\Uparrow"),V("\\N","\\mathbb{N}"),V("\\R","\\mathbb{R}"),V("\\Z","\\mathbb{Z}"),V("\\alef","\\aleph"),V("\\alefsym","\\aleph"),V("\\Alpha","\\mathrm{A}"),V("\\Beta","\\mathrm{B}"),V("\\bull","\\bullet"),V("\\Chi","\\mathrm{X}"),V("\\clubs","\\clubsuit"),V("\\cnums","\\mathbb{C}"),V("\\Complex","\\mathbb{C}"),V("\\Dagger","\\ddagger"),V("\\diamonds","\\diamondsuit"),V("\\empty","\\emptyset"),V("\\Epsilon","\\mathrm{E}"),V("\\Eta","\\mathrm{H}"),V("\\exist","\\exists"),V("\\harr","\\leftrightarrow"),V("\\hArr","\\Leftrightarrow"),V("\\Harr","\\Leftrightarrow"),V("\\hearts","\\heartsuit"),V("\\image","\\Im"),V("\\infin","\\infty"),V("\\Iota","\\mathrm{I}"),V("\\isin","\\in"),V("\\Kappa","\\mathrm{K}"),V("\\larr","\\leftarrow"),V("\\lArr","\\Leftarrow"),V("\\Larr","\\Leftarrow"),V("\\lrarr","\\leftrightarrow"),V("\\lrArr","\\Leftrightarrow"),V("\\Lrarr","\\Leftrightarrow"),V("\\Mu","\\mathrm{M}"),V("\\natnums","\\mathbb{N}"),V("\\Nu","\\mathrm{N}"),V("\\Omicron","\\mathrm{O}"),V("\\plusmn","\\pm"),V("\\rarr","\\rightarrow"),V("\\rArr","\\Rightarrow"),V("\\Rarr","\\Rightarrow"),V("\\real","\\Re"),V("\\reals","\\mathbb{R}"),V("\\Reals","\\mathbb{R}"),V("\\Rho","\\mathrm{P}"),V("\\sdot","\\cdot"),V("\\sect","\\S"),V("\\spades","\\spadesuit"),V("\\sub","\\subset"),V("\\sube","\\subseteq"),V("\\supe","\\supseteq"),V("\\Tau","\\mathrm{T}"),V("\\thetasym","\\vartheta"),V("\\weierp","\\wp"),V("\\Zeta","\\mathrm{Z}"),V("\\argmin","\\DOTSB\\operatorname*{arg\\,min}"),V("\\argmax","\\DOTSB\\operatorname*{arg\\,max}"),V("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits"),V("\\bra","\\mathinner{\\langle{#1}|}"),V("\\ket","\\mathinner{|{#1}\\rangle}"),V("\\braket","\\mathinner{\\langle{#1}\\rangle}"),V("\\Bra","\\left\\langle#1\\right|"),V("\\Ket","\\left|#1\\right\\rangle");const bh=c=>o=>{const d=o.consumeArg().tokens,m=o.consumeArg().tokens,x=o.consumeArg().tokens,S=o.consumeArg().tokens,T=o.macros.get("|"),R=o.macros.get("\\|");o.macros.beginGroup();const P=oe=>me=>{c&&(me.macros.set("|",T),x.length&&me.macros.set("\\|",R));let Me=oe;return!oe&&x.length&&me.future().text==="|"&&(me.popToken(),Me=!0),{tokens:Me?x:m,numArgs:0}};o.macros.set("|",P(!1)),x.length&&o.macros.set("\\|",P(!0));const X=o.consumeArg().tokens,ie=o.expandTokens([...S,...X,...d]);return o.macros.endGroup(),{tokens:ie.reverse(),numArgs:0}};V("\\bra@ket",bh(!1)),V("\\bra@set",bh(!0)),V("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}"),V("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}"),V("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}"),V("\\angln","{\\angl n}"),V("\\blue","\\textcolor{##6495ed}{#1}"),V("\\orange","\\textcolor{##ffa500}{#1}"),V("\\pink","\\textcolor{##ff00af}{#1}"),V("\\red","\\textcolor{##df0030}{#1}"),V("\\green","\\textcolor{##28ae7b}{#1}"),V("\\gray","\\textcolor{gray}{#1}"),V("\\purple","\\textcolor{##9d38bd}{#1}"),V("\\blueA","\\textcolor{##ccfaff}{#1}"),V("\\blueB","\\textcolor{##80f6ff}{#1}"),V("\\blueC","\\textcolor{##63d9ea}{#1}"),V("\\blueD","\\textcolor{##11accd}{#1}"),V("\\blueE","\\textcolor{##0c7f99}{#1}"),V("\\tealA","\\textcolor{##94fff5}{#1}"),V("\\tealB","\\textcolor{##26edd5}{#1}"),V("\\tealC","\\textcolor{##01d1c1}{#1}"),V("\\tealD","\\textcolor{##01a995}{#1}"),V("\\tealE","\\textcolor{##208170}{#1}"),V("\\greenA","\\textcolor{##b6ffb0}{#1}"),V("\\greenB","\\textcolor{##8af281}{#1}"),V("\\greenC","\\textcolor{##74cf70}{#1}"),V("\\greenD","\\textcolor{##1fab54}{#1}"),V("\\greenE","\\textcolor{##0d923f}{#1}"),V("\\goldA","\\textcolor{##ffd0a9}{#1}"),V("\\goldB","\\textcolor{##ffbb71}{#1}"),V("\\goldC","\\textcolor{##ff9c39}{#1}"),V("\\goldD","\\textcolor{##e07d10}{#1}"),V("\\goldE","\\textcolor{##a75a05}{#1}"),V("\\redA","\\textcolor{##fca9a9}{#1}"),V("\\redB","\\textcolor{##ff8482}{#1}"),V("\\redC","\\textcolor{##f9685d}{#1}"),V("\\redD","\\textcolor{##e84d39}{#1}"),V("\\redE","\\textcolor{##bc2612}{#1}"),V("\\maroonA","\\textcolor{##ffbde0}{#1}"),V("\\maroonB","\\textcolor{##ff92c6}{#1}"),V("\\maroonC","\\textcolor{##ed5fa6}{#1}"),V("\\maroonD","\\textcolor{##ca337c}{#1}"),V("\\maroonE","\\textcolor{##9e034e}{#1}"),V("\\purpleA","\\textcolor{##ddd7ff}{#1}"),V("\\purpleB","\\textcolor{##c6b9fc}{#1}"),V("\\purpleC","\\textcolor{##aa87ff}{#1}"),V("\\purpleD","\\textcolor{##7854ab}{#1}"),V("\\purpleE","\\textcolor{##543b78}{#1}"),V("\\mintA","\\textcolor{##f5f9e8}{#1}"),V("\\mintB","\\textcolor{##edf2df}{#1}"),V("\\mintC","\\textcolor{##e0e5cc}{#1}"),V("\\grayA","\\textcolor{##f6f7f7}{#1}"),V("\\grayB","\\textcolor{##f0f1f2}{#1}"),V("\\grayC","\\textcolor{##e3e5e6}{#1}"),V("\\grayD","\\textcolor{##d6d8da}{#1}"),V("\\grayE","\\textcolor{##babec2}{#1}"),V("\\grayF","\\textcolor{##888d93}{#1}"),V("\\grayG","\\textcolor{##626569}{#1}"),V("\\grayH","\\textcolor{##3b3e40}{#1}"),V("\\grayI","\\textcolor{##21242c}{#1}"),V("\\kaBlue","\\textcolor{##314453}{#1}"),V("\\kaGreen","\\textcolor{##71B307}{#1}");const vh={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class qy{constructor(o,d,m){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=d,this.expansionCount=0,this.feed(o),this.macros=new Gy(Hy,d.macros),this.mode=m,this.stack=[]}feed(o){this.lexer=new mh(o,this.settings)}switchMode(o){this.mode=o}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(o){this.stack.push(o)}pushTokens(o){this.stack.push(...o)}scanArgument(o){let d,m,x;if(o){if(this.consumeSpaces(),this.future().text!=="[")return null;d=this.popToken(),{tokens:x,end:m}=this.consumeArg(["]"])}else({tokens:x,start:d,end:m}=this.consumeArg());return this.pushToken(new Gr("EOF",m.loc)),this.pushTokens(x),d.range(m,"")}consumeSpaces(){for(;this.future().text===" ";)this.stack.pop()}consumeArg(o){const d=[],m=o&&o.length>0;m||this.consumeSpaces();const x=this.future();let S,T=0,R=0;do{if(S=this.popToken(),d.push(S),S.text==="{")++T;else if(S.text==="}"){if(--T,T===-1)throw new a("Extra }",S)}else if(S.text==="EOF")throw new a("Unexpected end of input in a macro argument, expected '"+(o&&m?o[R]:"}")+"'",S);if(o&&m)if((T===0||T===1&&o[R]==="{")&&S.text===o[R]){if(++R,R===o.length){d.splice(-R,R);break}}else R=0}while(T!==0||m);return x.text==="{"&&d[d.length-1].text==="}"&&(d.pop(),d.shift()),d.reverse(),{tokens:d,start:x,end:S}}consumeArgs(o,d){if(d){if(d.length!==o+1)throw new a("The length of delimiters doesn't match the number of args!");const x=d[0];for(let S=0;S<x.length;S++){const T=this.popToken();if(x[S]!==T.text)throw new a("Use of the macro doesn't match its definition",T)}}const m=[];for(let x=0;x<o;x++)m.push(this.consumeArg(d&&d[x+1]).tokens);return m}countExpansion(o){if(this.expansionCount+=o,this.expansionCount>this.settings.maxExpand)throw new a("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(o){const d=this.popToken(),m=d.text,x=d.noexpand?null:this._getExpansion(m);if(x==null||o&&x.unexpandable){if(o&&x==null&&m[0]==="\\"&&!this.isDefined(m))throw new a("Undefined control sequence: "+m);return this.pushToken(d),!1}this.countExpansion(1);let S=x.tokens;const T=this.consumeArgs(x.numArgs,x.delimiters);if(x.numArgs){S=S.slice();for(let R=S.length-1;R>=0;--R){let P=S[R];if(P.text==="#"){if(R===0)throw new a("Incomplete placeholder at end of macro body",P);if(P=S[--R],P.text==="#")S.splice(R+1,1);else if(/^[1-9]$/.test(P.text))S.splice(R,2,...T[+P.text-1]);else throw new a("Not a valid argument number",P)}}}return this.pushTokens(S),S.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){const o=this.stack.pop();return o.treatAsRelax&&(o.text="\\relax"),o}throw new Error}expandMacro(o){return this.macros.has(o)?this.expandTokens([new Gr(o)]):void 0}expandTokens(o){const d=[],m=this.stack.length;for(this.pushTokens(o);this.stack.length>m;)if(this.expandOnce(!0)===!1){const x=this.stack.pop();x.treatAsRelax&&(x.noexpand=!1,x.treatAsRelax=!1),d.push(x)}return this.countExpansion(d.length),d}expandMacroAsText(o){const d=this.expandMacro(o);return d&&d.map(m=>m.text).join("")}_getExpansion(o){const d=this.macros.get(o);if(d==null)return d;if(o.length===1){const x=this.lexer.catcodes[o];if(x!=null&&x!==13)return}const m=typeof d=="function"?d(this):d;if(typeof m=="string"){let x=0;if(m.indexOf("#")!==-1){const X=m.replace(/##/g,"");for(;X.indexOf("#"+(x+1))!==-1;)++x}const S=new mh(m,this.settings),T=[];let R=S.lex();for(;R.text!=="EOF";)T.push(R),R=S.lex();return T.reverse(),{tokens:T,numArgs:x}}return m}isDefined(o){return this.macros.has(o)||Qs.hasOwnProperty(o)||mn.math.hasOwnProperty(o)||mn.text.hasOwnProperty(o)||vh.hasOwnProperty(o)}isExpandable(o){const d=this.macros.get(o);return d!=null?typeof d=="string"||typeof d=="function"||!d.unexpandable:Qs.hasOwnProperty(o)&&!Qs[o].primitive}}const wh=/^[]/,Wo=Object.freeze({"":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"a","":"e","":"h","":"i","":"j","":"k","":"l","":"m","":"n","":"o","":"p","":"r","":"s","":"t","":"u","":"v","":"x","":"","":"","":"","":"","":"","":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"A","":"B","":"D","":"E","":"G","":"H","":"I","":"J","":"K","":"L","":"M","":"N","":"O","":"P","":"R","":"T","":"U","":"V","":"W","":"a","":"b","":"c","":"d","":"e","":"f","":"g",:"h","":"i",:"j","":"k",:"l","":"m",:"n","":"o","":"p",:"r",:"s","":"t","":"u","":"v",:"w",:"x",:"y","":"z","":"","":"","":"","":"","":"","":""}),Zc={"":{text:"\\'",math:"\\acute"},"":{text:"\\`",math:"\\grave"},"":{text:'\\"',math:"\\ddot"},"":{text:"\\~",math:"\\tilde"},"":{text:"\\=",math:"\\bar"},"":{text:"\\u",math:"\\breve"},"":{text:"\\v",math:"\\check"},"":{text:"\\^",math:"\\hat"},"":{text:"\\.",math:"\\dot"},"":{text:"\\r",math:"\\mathring"},"":{text:"\\H"},"":{text:"\\c"}},Sh={:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"b",:"c",:"c",:"c",:"c",:"c",:"c",:"d",:"d",:"d",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"f",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"h",:"h",:"h",:"h",:"h",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"j",:"j",:"k",:"k",:"k",:"l",:"l",:"l",:"m",:"m",:"n",:"n",:"n",:"n",:"n",:"n",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"p",:"p",:"r",:"r",:"r",:"r",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"t",:"t",:"t",:"t",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"v",:"w",:"w",:"w",:"w",:"w",:"w",:"x",:"x",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"z",:"z",:"z",:"z",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"B",:"C",:"C",:"C",:"C",:"C",:"C",:"D",:"D",:"D",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"F",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"H",:"H",:"H",:"H",:"H",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"J",:"K",:"K",:"K",:"L",:"L",:"L",:"M",:"M",:"N",:"N",:"N",:"N",:"N",:"N",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"P",:"P",:"R",:"R",:"R",:"R",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"T",:"T",:"T",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"V",:"W",:"W",:"W",:"W",:"W",:"X",:"X",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Z",:"Z",:"Z",:"Z",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};class Zo{constructor(o,d){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new qy(o,d,this.mode),this.settings=d,this.leftrightDepth=0}expect(o,d){if(d===void 0&&(d=!0),this.fetch().text!==o)throw new a("Expected '"+o+"', got '"+this.fetch().text+"'",this.fetch());d&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(o){this.mode=o,this.gullet.switchMode(o)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{const o=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),o}finally{this.gullet.endGroups()}}subparse(o){const d=this.nextToken;this.consume(),this.gullet.pushToken(new Gr("}")),this.gullet.pushTokens(o);const m=this.parseExpression(!1);return this.expect("}"),this.nextToken=d,m}parseExpression(o,d){const m=[];for(;;){this.mode==="math"&&this.consumeSpaces();const x=this.fetch();if(Zo.endOfExpression.indexOf(x.text)!==-1||d&&x.text===d||o&&Qs[x.text]&&Qs[x.text].infix)break;const S=this.parseAtom(d);if(S){if(S.type==="internal")continue}else break;m.push(S)}return this.mode==="text"&&this.formLigatures(m),this.handleInfixNodes(m)}handleInfixNodes(o){let d=-1,m;for(let x=0;x<o.length;x++)if(o[x].type==="infix"){if(d!==-1)throw new a("only one infix operator per group",o[x].token);d=x,m=o[x].replaceWith}if(d!==-1&&m){let x,S;const T=o.slice(0,d),R=o.slice(d+1);T.length===1&&T[0].type==="ordgroup"?x=T[0]:x={type:"ordgroup",mode:this.mode,body:T},R.length===1&&R[0].type==="ordgroup"?S=R[0]:S={type:"ordgroup",mode:this.mode,body:R};let P;return m==="\\\\abovefrac"?P=this.callFunction(m,[x,o[d],S],[]):P=this.callFunction(m,[x,S],[]),[P]}else return o}handleSupSubscript(o){const d=this.fetch(),m=d.text;this.consume(),this.consumeSpaces();let x;do{var S;x=this.parseGroup(o)}while(((S=x)==null?void 0:S.type)==="internal");if(!x)throw new a("Expected group after '"+m+"'",d);return x}formatUnsupportedCmd(o){const d=[];for(let S=0;S<o.length;S++)d.push({type:"textord",mode:"text",text:o[S]});const m={type:"text",mode:this.mode,body:d};return{type:"color",mode:this.mode,color:this.settings.errorColor,body:[m]}}parseAtom(o){const d=this.parseGroup("atom",o);if((d==null?void 0:d.type)==="internal"||this.mode==="text")return d;let m,x;for(;;){this.consumeSpaces();const S=this.fetch();if(S.text==="\\limits"||S.text==="\\nolimits"){if(d&&d.type==="op"){const T=S.text==="\\limits";d.limits=T,d.alwaysHandleSupSub=!0}else if(d&&d.type==="operatorname")d.alwaysHandleSupSub&&(d.limits=S.text==="\\limits");else throw new a("Limit controls must follow a math operator",S);this.consume()}else if(S.text==="^"){if(m)throw new a("Double superscript",S);m=this.handleSupSubscript("superscript")}else if(S.text==="_"){if(x)throw new a("Double subscript",S);x=this.handleSupSubscript("subscript")}else if(S.text==="'"){if(m)throw new a("Double superscript",S);const T={type:"textord",mode:this.mode,text:"\\prime"},R=[T];for(this.consume();this.fetch().text==="'";)R.push(T),this.consume();this.fetch().text==="^"&&R.push(this.handleSupSubscript("superscript")),m={type:"ordgroup",mode:this.mode,body:R}}else if(Wo[S.text]){const T=wh.test(S.text),R=[];for(R.push(new Gr(Wo[S.text])),this.consume();;){const X=this.fetch().text;if(!Wo[X]||wh.test(X)!==T)break;R.unshift(new Gr(Wo[X])),this.consume()}const P=this.subparse(R);T?x={type:"ordgroup",mode:"math",body:P}:m={type:"ordgroup",mode:"math",body:P}}else break}return m||x?{type:"supsub",mode:this.mode,base:d,sup:m,sub:x}:d}parseFunction(o,d){const m=this.fetch(),x=m.text,S=Qs[x];if(!S)return null;if(this.consume(),d&&d!=="atom"&&!S.allowedInArgument)throw new a("Got function '"+x+"' with no arguments"+(d?" as "+d:""),m);if(this.mode==="text"&&!S.allowedInText)throw new a("Can't use function '"+x+"' in text mode",m);if(this.mode==="math"&&S.allowedInMath===!1)throw new a("Can't use function '"+x+"' in math mode",m);const{args:T,optArgs:R}=this.parseArguments(x,S);return this.callFunction(x,T,R,m,o)}callFunction(o,d,m,x,S){const T={funcName:o,parser:this,token:x,breakOnTokenText:S},R=Qs[o];if(R&&R.handler)return R.handler(T,d,m);throw new a("No function handler for "+o)}parseArguments(o,d){const m=d.numArgs+d.numOptionalArgs;if(m===0)return{args:[],optArgs:[]};const x=[],S=[];for(let T=0;T<m;T++){let R=d.argTypes&&d.argTypes[T];const P=T<d.numOptionalArgs;(d.primitive&&R==null||d.type==="sqrt"&&T===1&&S[0]==null)&&(R="primitive");const X=this.parseGroupOfType("argument to '"+o+"'",R,P);if(P)S.push(X);else if(X!=null)x.push(X);else throw new a("Null argument, please report this as a bug")}return{args:x,optArgs:S}}parseGroupOfType(o,d,m){switch(d){case"color":return this.parseColorGroup(m);case"size":return this.parseSizeGroup(m);case"url":return this.parseUrlGroup(m);case"math":case"text":return this.parseArgumentGroup(m,d);case"hbox":{const x=this.parseArgumentGroup(m,"text");return x!=null?{type:"styling",mode:x.mode,body:[x],style:"text"}:null}case"raw":{const x=this.parseStringGroup("raw",m);return x!=null?{type:"raw",mode:"text",string:x.text}:null}case"primitive":{if(m)throw new a("A primitive argument cannot be optional");const x=this.parseGroup(o);if(x==null)throw new a("Expected group as "+o,this.fetch());return x}case"original":case null:case void 0:return this.parseArgumentGroup(m);default:throw new a("Unknown group type as "+o,this.fetch())}}consumeSpaces(){for(;this.fetch().text===" ";)this.consume()}parseStringGroup(o,d){const m=this.gullet.scanArgument(d);if(m==null)return null;let x="",S;for(;(S=this.fetch()).text!=="EOF";)x+=S.text,this.consume();return this.consume(),m.text=x,m}parseRegexGroup(o,d){const m=this.fetch();let x=m,S="",T;for(;(T=this.fetch()).text!=="EOF"&&o.test(S+T.text);)x=T,S+=x.text,this.consume();if(S==="")throw new a("Invalid "+d+": '"+m.text+"'",m);return m.range(x,S)}parseColorGroup(o){const d=this.parseStringGroup("color",o);if(d==null)return null;const m=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(d.text);if(!m)throw new a("Invalid color: '"+d.text+"'",d);let x=m[0];return/^[0-9a-f]{6}$/i.test(x)&&(x="#"+x),{type:"color-token",mode:this.mode,color:x}}parseSizeGroup(o){let d,m=!1;if(this.gullet.consumeSpaces(),!o&&this.gullet.future().text!=="{"?d=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):d=this.parseStringGroup("size",o),!d)return null;!o&&d.text.length===0&&(d.text="0pt",m=!0);const x=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(d.text);if(!x)throw new a("Invalid size: '"+d.text+"'",d);const S={number:+(x[1]+x[2]),unit:x[3]};if(!qe(S))throw new a("Invalid unit: '"+S.unit+"'",d);return{type:"size",mode:this.mode,value:S,isBlank:m}}parseUrlGroup(o){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);const d=this.parseStringGroup("url",o);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),d==null)return null;const m=d.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:m}}parseArgumentGroup(o,d){const m=this.gullet.scanArgument(o);if(m==null)return null;const x=this.mode;d&&this.switchMode(d),this.gullet.beginGroup();const S=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();const T={type:"ordgroup",mode:this.mode,loc:m.loc,body:S};return d&&this.switchMode(x),T}parseGroup(o,d){const m=this.fetch(),x=m.text;let S;if(x==="{"||x==="\\begingroup"){this.consume();const T=x==="{"?"}":"\\endgroup";this.gullet.beginGroup();const R=this.parseExpression(!1,T),P=this.fetch();this.expect(T),this.gullet.endGroup(),S={type:"ordgroup",mode:this.mode,loc:Or.range(m,P),body:R,semisimple:x==="\\begingroup"||void 0}}else if(S=this.parseFunction(d,o)||this.parseSymbol(),S==null&&x[0]==="\\"&&!vh.hasOwnProperty(x)){if(this.settings.throwOnError)throw new a("Undefined control sequence: "+x,m);S=this.formatUnsupportedCmd(x),this.consume()}return S}formLigatures(o){let d=o.length-1;for(let m=0;m<d;++m){const x=o[m],S=x.text;S==="-"&&o[m+1].text==="-"&&(m+1<d&&o[m+2].text==="-"?(o.splice(m,3,{type:"textord",mode:"text",loc:Or.range(x,o[m+2]),text:"---"}),d-=2):(o.splice(m,2,{type:"textord",mode:"text",loc:Or.range(x,o[m+1]),text:"--"}),d-=1)),(S==="'"||S==="`")&&o[m+1].text===S&&(o.splice(m,2,{type:"textord",mode:"text",loc:Or.range(x,o[m+1]),text:S+S}),d-=1)}}parseSymbol(){const o=this.fetch();let d=o.text;if(/^\\verb[^a-zA-Z]/.test(d)){this.consume();let S=d.slice(5);const T=S.charAt(0)==="*";if(T&&(S=S.slice(1)),S.length<2||S.charAt(0)!==S.slice(-1))throw new a(`\\verb assertion failed --
                    please report what input caused this bug`);return S=S.slice(1,-1),{type:"verb",mode:"text",body:S,star:T}}Sh.hasOwnProperty(d[0])&&!mn[this.mode][d[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+d[0]+'" used in math mode',o),d=Sh[d[0]]+d.slice(1));const m=Ly.exec(d);m&&(d=d.substring(0,m.index),d==="i"?d="":d==="j"&&(d=""));let x;if(mn[this.mode][d]){this.settings.strict&&this.mode==="math"&&It.indexOf(d)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+d[0]+'" used in math mode',o);const S=mn[this.mode][d].group,T=Or.range(o);let R;if(Do.hasOwnProperty(S)){const P=S;R={type:"atom",mode:this.mode,family:P,loc:T,text:d}}else R={type:S,mode:this.mode,loc:T,text:d};x=R}else if(d.charCodeAt(0)>=128)this.settings.strict&&(Se(d.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+d[0]+'" used in math mode',o):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+d[0]+'"'+(" ("+d.charCodeAt(0)+")"),o)),x={type:"textord",mode:"text",loc:Or.range(o),text:d};else return null;if(this.consume(),m)for(let S=0;S<m[0].length;S++){const T=m[0][S];if(!Zc[T])throw new a("Unknown accent ' "+T+"'",o);const R=Zc[T][this.mode]||Zc[T].text;if(!R)throw new a("Accent "+T+" unsupported in "+this.mode+" mode",o);x={type:"accent",mode:this.mode,loc:Or.range(o),label:R,isStretchy:!1,isShifty:!0,base:x}}return x}}Zo.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var Yc=function(c,o){if(!(typeof c=="string"||c instanceof String))throw new TypeError("KaTeX can only parse string typed expression");const d=new Zo(c,o);delete d.gullet.macros.current["\\df@tag"];let m=d.parse();if(delete d.gullet.macros.current["\\current@color"],delete d.gullet.macros.current["\\color"],d.gullet.macros.get("\\df@tag")){if(!o.displayMode)throw new a("\\tag works only in display equations");m=[{type:"tag",mode:"text",body:m,tag:d.subparse([new Gr("\\df@tag")])}]}return m};let kh=function(c,o,d){o.textContent="";const m=Jc(c,d).toNode();o.appendChild(m)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),kh=function(){throw new a("KaTeX doesn't work in quirks mode.")});const Uy=function(c,o){return Jc(c,o).toMarkup()},Wy=function(c,o){const d=new N(o);return Yc(c,d)},jh=function(c,o,d){if(d.throwOnError||!(c instanceof a))throw c;const m=de.makeSpan(["katex-error"],[new Xt(o)]);return m.setAttribute("title",c.toString()),m.setAttribute("style","color:"+d.errorColor),m},Jc=function(c,o){const d=new N(o);try{const m=Yc(c,d);return ly(m,c,d)}catch(m){return jh(m,c,d)}};var Zy={version:"0.16.22",render:kh,renderToString:Uy,ParseError:a,SETTINGS_SCHEMA:C,__parse:Wy,__renderToDomTree:Jc,__renderToHTMLTree:function(c,o){const d=new N(o);try{const m=Yc(c,d);return cy(m,c,d)}catch(m){return jh(m,c,d)}},__setFontMetrics:ee,__defineSymbol:v,__defineFunction:We,__defineMacro:V,__domTree:{Span:et,Anchor:gt,SymbolNode:Xt,SvgNode:Ht,PathNode:Mt,LineNode:dr}},Yy=Zy;return r=r.default,r}()})}(yu)),yu.exports}(function(e,t){(function(n,r){r(t,z,hx(),K8())})(Bp,function(n,r,i,a){Object.defineProperty(n,"__esModule",{value:!0});function l(j,w){for(var C in w)Object.defineProperty(j,C,{enumerable:!0,get:w[C]})}l(n,{BlockMath:()=>A,InlineMath:()=>D}),r=f(r),i=u(i),a=u(a);function u(j){return j&&j.__esModule?j:{default:j}}function h(j){if(typeof WeakMap!="function")return null;var w=new WeakMap,C=new WeakMap;return(h=function(_){return _?C:w})(j)}function f(j,w){if(j&&j.__esModule)return j;if(j===null||typeof j!="object"&&typeof j!="function")return{default:j};var C=h(w);if(C&&C.has(j))return C.get(j);var _={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in j)if(E!=="default"&&Object.prototype.hasOwnProperty.call(j,E)){var I=N?Object.getOwnPropertyDescriptor(j,E):null;I&&(I.get||I.set)?Object.defineProperty(_,E,I):_[E]=j[E]}return _.default=j,C&&C.set(j,_),_}const p=(j,{displayMode:w})=>{const C=({children:_,errorColor:N,math:E,renderError:I})=>{const H=E??_,{html:Z,error:ae}=(0,r.useMemo)(()=>{try{return{html:a.default.renderToString(H,{displayMode:w,errorColor:N,throwOnError:!!I}),error:void 0}}catch(ne){if(ne instanceof a.default.ParseError||ne instanceof TypeError)return{error:ne};throw ne}},[H,N,I]);return ae?I?I(ae):r.default.createElement(j,{html:`${ae.message}`}):r.default.createElement(j,{html:Z})};return C.propTypes={children:i.default.string,errorColor:i.default.string,math:i.default.string,renderError:i.default.func},C},g={html:i.default.string.isRequired},y=({html:j})=>r.default.createElement("div",{"data-testid":"react-katex",dangerouslySetInnerHTML:{__html:j}});y.propTypes=g;const b=({html:j})=>r.default.createElement("span",{"data-testid":"react-katex",dangerouslySetInnerHTML:{__html:j}});b.propTypes=g;const A=p(y,{displayMode:!0}),D=p(b,{displayMode:!1})})})(ad,ad.exports);var Q8=ad.exports;class Ni{static getValidIdentifiers(t){const n={};return Object.keys(t).forEach(r=>{/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(r)&&(n[r]=t[r])}),n}static executeAlgorithm(t,n,r={},i){console.log(" AlgorithmExecutionService.executeAlgorithm: Starting algorithm execution",{algorithmId:t.id,algorithmName:t.name,iterationValue:n,context:r,modeContext:i,variablesCount:t.variables.length,stepsCount:t.steps.length});const a={variables:{},results:{},iterationValue:n,finalResult:null};try{return console.log(" AlgorithmExecutionService.executeAlgorithm: Initializing variables"),t.variables.forEach(l=>{console.log(` AlgorithmExecutionService.executeAlgorithm: Processing variable "${l.name}" (${l.id})`,{variableId:l.id,variableName:l.name,variableType:l.type,modeBased:l.modeBased,dimensionId:l.dimensionId,defaultValue:l.defaultValue,valuesByMode:l.valuesByMode});let u;if(l.modeBased&&l.dimensionId&&l.valuesByMode&&i){console.log(` AlgorithmExecutionService.executeAlgorithm: Processing mode-based variable "${l.name}"`,{variableId:l.id,dimensionId:l.dimensionId,modeContext:i,availableModeValues:Object.keys(l.valuesByMode)});const h=i[l.dimensionId];if(console.log(` AlgorithmExecutionService.executeAlgorithm: Current mode for dimension "${l.dimensionId}"`,{currentModeId:h,hasModeValue:h?!!l.valuesByMode[h]:!1}),h&&l.valuesByMode[h]){const f=l.valuesByMode[h];u=this.parseVariableValue(f,l.type),console.log(` AlgorithmExecutionService.executeAlgorithm: Using mode-specific value for "${l.name}"`,{modeId:h,modeValue:f,parsedValue:u,parsedValueType:typeof u})}else u=this.parseVariableValue(l.defaultValue||"",l.type),console.log(` AlgorithmExecutionService.executeAlgorithm: Mode-specific value not found for "${l.name}", using default`,{currentModeId:h,availableModeValues:Object.keys(l.valuesByMode),defaultValue:l.defaultValue,parsedValue:u,parsedValueType:typeof u})}else u=this.parseVariableValue(l.defaultValue||"",l.type),console.log(` AlgorithmExecutionService.executeAlgorithm: Using default value for "${l.name}"`,{defaultValue:l.defaultValue,parsedValue:u,parsedValueType:typeof u});a.variables[l.id]=u,console.log(` AlgorithmExecutionService.executeAlgorithm: Stored variable "${l.name}" in execution context`,{variableId:l.id,storedValue:u})}),a.variables.n=n,console.log(' AlgorithmExecutionService.executeAlgorithm: Added system variable "n"',{n}),Object.assign(a.variables,r),console.log(" AlgorithmExecutionService.executeAlgorithm: Added additional context",{context:r}),a.variables.Math={pow:Math.pow,max:Math.max,min:Math.min,abs:Math.abs,floor:Math.floor,ceil:Math.ceil,round:Math.round,sqrt:Math.sqrt,sin:Math.sin,cos:Math.cos,tan:Math.tan,log:Math.log,exp:Math.exp},a.variables.Array={isArray:Array.isArray},console.log(" AlgorithmExecutionService.executeAlgorithm: Added Math and Array utilities"),console.log(" AlgorithmExecutionService.executeAlgorithm: Final execution context variables",{variableCount:Object.keys(a.variables).length,variables:a.variables}),console.log(" AlgorithmExecutionService.executeAlgorithm: Starting step execution"),t.steps.forEach((l,u)=>{if(console.log(` AlgorithmExecutionService.executeAlgorithm: Executing step ${u+1}/${t.steps.length}`,{stepType:l.type,stepId:l.id,stepName:l.name}),l.type==="formula"){const h=t.formulas.find(f=>f.id===l.id);if(h){console.log(` AlgorithmExecutionService.executeAlgorithm: Evaluating formula "${h.name}"`,{formulaId:h.id,formulaName:h.name,expression:h.expressions.javascript.value});const f=this.evaluateFormula(h,a.variables);console.log(` AlgorithmExecutionService.executeAlgorithm: Formula "${h.name}" evaluated successfully`,{result:f,resultType:typeof f}),a.results[h.name]=f,a.finalResult=f}else console.error(" AlgorithmExecutionService.executeAlgorithm: Formula not found for step",{stepId:l.id,stepName:l.name})}else if(l.type==="condition"){const h=t.conditions.find(f=>f.id===l.id);if(h){console.log(` AlgorithmExecutionService.executeAlgorithm: Evaluating condition "${h.name}"`,{conditionId:h.id,conditionName:h.name,expression:h.expression});const f=this.evaluateCondition(h,a.variables);console.log(` AlgorithmExecutionService.executeAlgorithm: Condition "${h.name}" evaluated successfully`,{result:f,resultType:typeof f}),a.results[h.name]=f}else console.error(" AlgorithmExecutionService.executeAlgorithm: Condition not found for step",{stepId:l.id,stepName:l.name})}}),console.log(" AlgorithmExecutionService.executeAlgorithm: Algorithm execution completed successfully",{finalResult:a.finalResult,finalResultType:typeof a.finalResult,resultsCount:Object.keys(a.results).length,results:a.results}),a}catch(l){throw console.error(" AlgorithmExecutionService.executeAlgorithm: Algorithm execution failed",{error:l,stack:l instanceof Error?l.stack:void 0,algorithmId:t.id,iterationValue:n,modeContext:i}),new Error(`Algorithm execution failed: ${l}`)}}static evaluateFormula(t,n){try{if(t.expressions.ast){const r=Nr.validateAST(t.expressions.ast),i=r.filter(p=>p.startsWith("Warning:")),a=r.filter(p=>!p.startsWith("Warning:"));if(i.length>0&&console.warn(`AST validation warnings for formula "${t.name}":`,i),a.length>0)throw new Error(`AST validation failed: ${a.join(", ")}`);const l=Nr.generateJavaScript(t.expressions.ast),u={...n,Math:n.Math||Math,Array:n.Array||Array,console};if(l.includes("=")){const p=l.split("=").map(g=>g.trim());if(p.length===2){const g=p[0],y=p[1],A=new Function(...Object.keys(this.getValidIdentifiers(u)),`return ${y}`)(...Object.values(this.getValidIdentifiers(u)));return n[g]=A,u[g]=A,A}}return new Function(...Object.keys(this.getValidIdentifiers(u)),`return ${l}`)(...Object.values(this.getValidIdentifiers(u)))}else{const r=t.expressions.javascript.value,i={...n,Math:n.Math||Math,Array:n.Array||Array,console};if(r.includes("=")){const u=r.split("=").map(h=>h.trim());if(u.length===2){const h=u[0],f=u[1],g=new Function(...Object.keys(this.getValidIdentifiers(i)),`return ${f}`)(...Object.values(this.getValidIdentifiers(i)));n[h]=g,i[h]=g;for(const y of Object.keys(n))y!==h&&n[y]===g&&(n[y]=g,i[y]=g);return g}}return new Function(...Object.keys(this.getValidIdentifiers(i)),`return ${r}`)(...Object.values(this.getValidIdentifiers(i)))}}catch(r){throw console.error("Formula evaluation error:",r),console.error("Expression:",t.expressions.javascript.value),console.error("Variables:",n),new Error(`Formula evaluation failed for ${t.name}: ${r}`)}}static evaluateCondition(t,n){try{const r=t.expression,i={...n,Math:n.Math||Math,Array:n.Array||Array,console};return!!new Function(...Object.keys(this.getValidIdentifiers(i)),`return ${r}`)(...Object.values(this.getValidIdentifiers(i)))}catch(r){throw console.error("Condition evaluation error:",r),console.error("  Expression:",t.expression),console.error("  Variables:",n),new Error(`Condition evaluation failed for ${t.name}: ${r}`)}}static generateTokensForAlgorithm(t){var a;const n=[];if(!((a=t.tokenGeneration)!=null&&a.enabled))return n;const{iterationRange:r}=t.tokenGeneration,i=[];for(let l=r.start;l<=r.end;l+=r.step)i.push(l);return i.forEach(l=>{try{const u=this.executeAlgorithm(t,l),h=this.generateTokenDisplayName(t,l),f={value:this.formatValueForTokenType(u.finalResult,t.resolvedValueTypeId)},p=`${t.id}-${l}`;n.push({tokenId:p,displayName:h,value:f,iterationValue:l,formulaName:this.getLastExecutedFormulaName(t)})}catch(u){console.error(`Error generating token for iteration ${l}:`,u),n.push({tokenId:`${t.id}-${l}`,displayName:`Error-${l}`,value:{value:""},iterationValue:l,formulaName:"Error",error:String(u)})}}),n}static generateTokenDisplayName(t,n){const r=t.name.replace(/\s+/g,"-").toLowerCase();return n<0?`${r}-minus-${Math.abs(n)}`:`${r}-${n}`}static formatValueForTokenType(t,n){if(t==null)return"";switch(n){case"dimension":case"gap":case"font-size":{const r=Number(t);return isNaN(r)?String(t):r.toString()}case"color":{if(typeof t=="string"&&(t.startsWith("#")||t.startsWith("rgb")))return t;const r=Number(t);return isNaN(r)?String(t):`#${r.toString(16).padStart(6,"0")}`}default:return String(t)}}static getLastExecutedFormulaName(t){for(let n=t.steps.length-1;n>=0;n--){const r=t.steps[n];if(r.type==="formula")return r.name}return"Unknown"}static parseVariableValue(t,n){switch(n){case"number":return Number(t)||0;case"string":{if(t.trim().startsWith("[")&&t.trim().endsWith("]"))try{return JSON.parse(t)}catch{return String(t)}return String(t)}case"boolean":return t==="true"||t==="1";case"color":return String(t);default:return t}}static validateAlgorithm(t){const n=[];return t.id||n.push("Algorithm ID is required"),t.name||n.push("Algorithm name is required"),t.resolvedValueTypeId||n.push("Resolved value type ID is required"),t.variables.forEach((r,i)=>{r.id||n.push(`Variable ${i}: ID is required`),r.name||n.push(`Variable ${i}: Name is required`),r.type||n.push(`Variable ${i}: Type is required`)}),t.formulas.forEach((r,i)=>{var a,l;r.id||n.push(`Formula ${i}: ID is required`),r.name||n.push(`Formula ${i}: Name is required`),(l=(a=r.expressions)==null?void 0:a.javascript)!=null&&l.value||n.push(`Formula ${i}: JavaScript expression is required`)}),t.steps.forEach((r,i)=>{r.type||n.push(`Step ${i}: Type is required`),r.id||n.push(`Step ${i}: ID is required`),r.name||n.push(`Step ${i}: Name is required`),r.type==="formula"?t.formulas.find(l=>l.id===r.id)||n.push(`Step ${i}: Referenced formula '${r.id}' not found`):r.type==="condition"&&(t.conditions.find(l=>l.id===r.id)||n.push(`Step ${i}: Referenced condition '${r.id}' not found`))}),n}}class ua{static generateCodeSyntax(t,n,r){var D;const i=(r.platforms||[]).find(j=>j.id===n),a=(i==null?void 0:i.syntaxPatterns)||{},l=((D=r.namingRules)==null?void 0:D.taxonomyOrder)||[],u=r.taxonomies||[],h=[],f=new Set;if(Array.isArray(t.taxonomies)&&t.taxonomies.length>0&&(l.forEach(j=>{const w=t.taxonomies.find(C=>C.taxonomyId===j);if(w){const C=u.find(N=>N.id===w.taxonomyId),_=C==null?void 0:C.terms.find(N=>N.id===w.termId);_&&(h.push(_.name),f.add(j))}}),t.taxonomies.forEach(j=>{if(!f.has(j.taxonomyId)){const w=u.find(_=>_.id===j.taxonomyId),C=w==null?void 0:w.terms.find(_=>_.id===j.termId);C&&h.push(C.name)}})),h.length===0)return"";let p=h;switch(a.capitalization){case"uppercase":p=h.map(j=>j.toUpperCase());break;case"lowercase":p=h.map(j=>j.toLowerCase());break;case"capitalize":p=h.map(j=>j.charAt(0).toUpperCase()+j.slice(1).toLowerCase());break}const g=p.join(a.delimiter??"");let y=a.prefix??"",b=a.suffix??"";switch(y&&a.delimiter&&(y=y.split(/\s+/).join(a.delimiter)),b&&a.delimiter&&(b=b.split(/\s+/).join(a.delimiter)),a.capitalization){case"uppercase":y=y.toUpperCase(),b=b.toUpperCase();break;case"lowercase":y=y.toLowerCase(),b=b.toLowerCase();break;case"capitalize":y=y.replace(/\b\w/g,j=>j.toUpperCase()),b=b.replace(/\b\w/g,j=>j.toUpperCase());break}let A="";if(a.formatString)A=a.formatString.replace("{prefix}",y).replace("{name}",g).replace("{suffix}",b);else{const j=a.delimiter??"";y&&g&&b?A=`${y}${j}${g}${j}${b}`:y&&g?A=`${y}${j}${g}`:g&&b?A=`${g}${j}${b}`:y&&b?A=`${y}${j}${b}`:y?A=y:g?A=g:b?A=b:A=""}return A}static generateAllCodeSyntaxes(t,n){return(n.platforms||[]).map(r=>({platformId:r.id,formattedName:this.generateCodeSyntax(t,r.id,n)||""}))}static updateCodeSyntax(t,n,r){return{...t,codeSyntax:{...t.codeSyntax,[n]:r}}}}function e9(e){return Object.entries(e).map(([t,n])=>({platformId:t,formattedName:n}))}function Uf(e){return Array.isArray(e)?e:typeof e=="object"&&e!==null?e9(e):[]}class Wf{static generateTokens(t,n,r,i,a=!1,l){var f,p,g,y;if(console.log(" TokenGenerationService.generateTokens: Starting token generation",{algorithmId:t.id,algorithmName:t.name,hasTokenGeneration:!!((f=t.tokenGeneration)!=null&&f.enabled),existingTokensCount:n.length,selectedModes:l,modifyTaxonomiesInPlace:a}),!((p=t.tokenGeneration)!=null&&p.enabled))return console.log(" TokenGenerationService.generateTokens: Token generation not enabled"),{tokens:[],errors:[]};const u=[],h=[];try{if(t.formulas.length===0){const I="Algorithm must have at least one formula for token generation";return console.error(" TokenGenerationService.generateTokens:",I),u.push(I),{tokens:[],errors:u}}const{logicalMapping:b}=t.tokenGeneration;if(!b.taxonomyId&&!b.newTaxonomyName){const I="Must select an existing taxonomy or provide a name for a new taxonomy";return console.error(" TokenGenerationService.generateTokens:",I),u.push(I),{tokens:[],errors:u}}console.log(" TokenGenerationService.generateTokens: Basic validation passed");const A=this.generateIterationValues(t.tokenGeneration.iterationRange);console.log(" TokenGenerationService.generateTokens: Generated iteration values",{iterationValues:A,range:t.tokenGeneration.iterationRange});const D=this.generateTermsFromLogicalMapping(A,b);console.log(" TokenGenerationService.generateTokens: Generated terms",{generatedTerms:D,logicalMapping:b});const{taxonomy:j,newTaxonomies:w}=this.handleTaxonomyCreation(b,D,i,t.tokenGeneration.bulkAssignments.resolvedValueTypeId);console.log(" TokenGenerationService.generateTokens: Taxonomy handling complete",{taxonomyId:j.id,taxonomyName:j.name,termCount:j.terms.length,newTaxonomiesCount:w.length});const C=a?{id:j.id,termCount:j.terms.length,termNames:j.terms.map(I=>I.name)}:null,_=this.matchOrCreateTerms(j,D,A,a);console.log(" TokenGenerationService.generateTokens: Term mappings created",{termMappingsCount:_.length,termMappings:_.slice(0,3)});const N=this.generateModeCombinations(t,l);console.log(" TokenGenerationService.generateTokens: Mode combinations generated",{modeCombinationsCount:N.length,modeCombinations:N,algorithmVariables:t.variables.map(I=>({id:I.id,name:I.name,modeBased:I.modeBased,dimensionId:I.dimensionId,hasModeValues:!!I.valuesByMode}))}),console.log(" TokenGenerationService.generateTokens: Starting token generation loop",{iterationValuesCount:A.length,modeCombinationsCount:N.length,totalExpectedTokens:A.length*N.length});for(let I=0;I<A.length;I++){const H=A[I];console.log(` TokenGenerationService.generateTokens: Processing iteration ${I+1}/${A.length}, n=${H}`);for(let Z=0;Z<N.length;Z++){const ae=N[Z];console.log(` TokenGenerationService.generateTokens: Processing mode combination ${Z+1}/${N.length}`,{modeContext:ae,iterationValue:H,modeContextKeys:Object.keys(ae),modeContextValues:Object.values(ae)});try{console.log(" TokenGenerationService.generateTokens: Executing algorithm steps",{algorithmId:t.id,stepsCount:t.steps.length,modeContext:ae,variables:t.variables.map(G=>{var ge,W;return{id:G.id,name:G.name,modeBased:G.modeBased,dimensionId:G.dimensionId,defaultValue:(W=(ge=G.valuesByMode)==null?void 0:ge[0])==null?void 0:W.value}})});const ne=this.executeAlgorithmSteps(t,H,ae);console.log(" TokenGenerationService.generateTokens: Algorithm execution successful",{calculatedValue:ne,calculatedValueType:typeof ne,isNumber:typeof ne=="number",isNaN:typeof ne=="number"?isNaN(ne):"N/A"});const F=this.generateTokenId();if(console.log(" TokenGenerationService.generateTokens: Generated token ID",{tokenId:F}),n.some(G=>G.id===F)){const G=`Token ID "${F}" already exists`;console.error(" TokenGenerationService.generateTokens:",G),u.push(G);continue}const J=_.find(G=>G.iterationValue===H);if(!J){const G=`No term mapping found for iteration ${H}`;console.error(" TokenGenerationService.generateTokens:",G,{termMappings:_,iterationValue:H}),u.push(G);continue}console.log(" TokenGenerationService.generateTokens: Found term mapping",{termMapping:J,iterationValue:H});const pe=this.createTokenWithLogicalMappingAndModes(F,t,ne,H,j,J.termId,i,ae);console.log(" TokenGenerationService.generateTokens: Token created successfully",{tokenId:pe.id,displayName:pe.displayName,value:(g=pe.valuesByMode[0])==null?void 0:g.value,modeIds:(y=pe.valuesByMode[0])==null?void 0:y.modeIds,taxonomiesCount:pe.taxonomies.length}),h.push(pe),console.log(" TokenGenerationService.generateTokens: Token added to generated tokens array",{currentGeneratedTokensCount:h.length})}catch(ne){const F=Object.keys(ae).length>0?` (modes: ${Object.entries(ae).map(([pe,G])=>`${pe}:${G}`).join(", ")})`:"",J=`Error generating token for iteration ${H}${F}: ${ne}`;console.error(" TokenGenerationService.generateTokens:",J,{error:ne,stack:ne instanceof Error?ne.stack:void 0}),u.push(J)}}}console.log(" TokenGenerationService.generateTokens: Token generation loop complete",{generatedTokensCount:h.length,errorsCount:u.length});let E;return b.taxonomyId&&a&&C&&(console.log(" TokenGenerationService.generateTokens: Checking for taxonomy updates:",{taxonomyId:j.id,taxonomyName:j.name,originalTermCount:C.termCount,currentTermCount:j.terms.length,originalTerms:C.termNames,currentTerms:j.terms.map(I=>I.name),modifyTaxonomiesInPlace:a}),j.terms.length>C.termCount?(E=[j],console.log(" TokenGenerationService.generateTokens: Returning updated taxonomy with new terms:",{taxonomyId:j.id,taxonomyName:j.name,originalTermCount:C.termCount,newTermCount:j.terms.length,newTerms:j.terms.slice(C.termCount).map(I=>I.name)})):console.log(" TokenGenerationService.generateTokens: No new terms added to taxonomy:",{taxonomyId:j.id,taxonomyName:j.name,termCount:j.terms.length})),console.log(" TokenGenerationService.generateTokens: Final results",{tokensCount:h.length,errorsCount:u.length,newTaxonomiesCount:(w==null?void 0:w.length)||0,updatedTaxonomiesCount:(E==null?void 0:E.length)||0}),{tokens:h,errors:u,newTaxonomies:w.length>0?w:void 0,updatedTaxonomies:E}}catch(b){const A=`Token generation failed: ${b}`;console.error(" TokenGenerationService.generateTokens: Critical error",A,{error:b,stack:b instanceof Error?b.stack:void 0}),u.push(A)}return{tokens:h,errors:u}}static generateModeCombinations(t,n){console.log(" TokenGenerationService.generateModeCombinations: Starting mode combination generation",{algorithmId:t.id,algorithmName:t.name,selectedModes:n,totalVariables:t.variables.length});const r=t.variables.filter(u=>u.modeBased&&u.dimensionId);if(console.log(" TokenGenerationService.generateModeCombinations: Found mode-based variables",{modeBasedVariablesCount:r.length,modeBasedVariables:r.map(u=>({id:u.id,name:u.name,dimensionId:u.dimensionId,modeValues:u.valuesByMode}))}),r.length===0)return console.log(" TokenGenerationService.generateModeCombinations: No mode-based variables found, returning empty context"),[{}];const i=he.getDimensions();console.log(" TokenGenerationService.generateModeCombinations: Retrieved dimensions from storage",{totalDimensions:i.length,dimensions:i.map(u=>({id:u.id,displayName:u.displayName,modesCount:u.modes.length}))});const a=i.filter(u=>r.some(h=>h.dimensionId===u.id));console.log(" TokenGenerationService.generateModeCombinations: Filtered to used dimensions",{usedDimensionsCount:a.length,usedDimensions:a.map(u=>({id:u.id,displayName:u.displayName,modesCount:u.modes.length,modes:u.modes.map(h=>({id:h.id,name:h.name}))}))});const l=[{}];console.log(" TokenGenerationService.generateModeCombinations: Starting combination generation",{initialCombinationsCount:l.length});for(const u of a){console.log(` TokenGenerationService.generateModeCombinations: Processing dimension "${u.displayName}" (${u.id})`,{dimensionId:u.id,dimensionName:u.displayName,totalModes:u.modes.length});const h=[...l];l.length=0;let f=u.modes;n&&n[u.id]?(f=u.modes.filter(p=>n[u.id].includes(p.id)),console.log(` TokenGenerationService.generateModeCombinations: Filtered modes for dimension "${u.displayName}"`,{totalModes:u.modes.length,selectedModes:n[u.id],filteredModesCount:f.length,filteredModes:f.map(p=>({id:p.id,name:p.name}))})):console.log(` TokenGenerationService.generateModeCombinations: Using all modes for dimension "${u.displayName}"`,{modesCount:f.length,modes:f.map(p=>({id:p.id,name:p.name}))});for(const p of f){console.log(` TokenGenerationService.generateModeCombinations: Processing mode "${p.name}" (${p.id})`,{modeId:p.id,modeName:p.name,currentCombinationsCount:h.length});for(const g of h){const y={...g,[u.id]:p.id};l.push(y)}}console.log(` TokenGenerationService.generateModeCombinations: Completed dimension "${u.displayName}"`,{dimensionId:u.id,dimensionName:u.displayName,newCombinationsCount:l.length,sampleCombinations:l.slice(0,3)})}return console.log(" TokenGenerationService.generateModeCombinations: Mode combination generation complete",{finalCombinationsCount:l.length,combinations:l}),l}static generateIterationValues(t){console.log(" TokenGenerationService.generateIterationValues: Generating iteration values",{range:t,start:t.start,end:t.end,step:t.step});const n=[],{start:r,end:i,step:a}=t;for(let l=r;l<=i;l+=a)n.push(l);return console.log(" TokenGenerationService.generateIterationValues: Generated values",{values:n,count:n.length}),n}static generateTokenId(){return Vr("token")}static createToken(t,n,r,i,a,l){var g;const u=(g=n.tokenGeneration)==null?void 0:g.bulkAssignments;if(!u)throw new Error("Bulk assignments not configured");const h=this.createTaxonomiesArray(u.taxonomies||[],i,n.tokenGeneration.logicalMapping,l),f=this.generateDisplayNameFromTaxonomies(h,l,i,n.tokenGeneration.logicalMapping);return{id:t,displayName:f,resolvedValueTypeId:u.resolvedValueTypeId,tokenCollectionId:u.collectionId||void 0,description:`Generated by algorithm "${n.name}" with n=${i}`,private:u.private,status:u.status||"stable",themeable:u.themeable,tokenTier:u.tokenTier||"PRIMITIVE",generatedByAlgorithm:!0,algorithmId:n.id,taxonomies:h,propertyTypes:[],codeSyntax:[],valuesByMode:[{modeIds:[],value:{value:r.toString()}}]}}static generateDisplayNameFromTaxonomies(t,n,r,i){const a=[];for(const l of t){const u=n.find(h=>h.id===l.taxonomyId);if(u){const h=u.terms.find(f=>f.id===l.termId);h&&a.push(h.name)}}return a.length===0?this.generateFallbackDisplayName(r,i):a.join(" ")}static generateFallbackDisplayName(t,n){const{scaleType:r}=n;return r==="tshirt"?this.generateTshirtSizeName(t,n.defaultValue,n.extraPrefix||"X"):this.generateNumericSizeName(t,n.defaultValue,n.increasingStep||100,n.decreasingStep||25)}static generateTshirtSizeName(t,n,r){if(t===0)return n;if(t>0){if(t===1)return"Large";const i=t-1;return`${r.repeat(i)}-Large`}else{if(t===-1)return"Small";const i=Math.abs(t)-1;return`${r.repeat(i)}-Small`}}static generateNumericSizeName(t,n,r,i){const a=parseFloat(n)||100;return t===0?n:t>0?(a+t*r).toString():(a+t*i).toString()}static createTaxonomiesArray(t,n,r,i){return t.filter(a=>{const l=i.find(u=>u.id===a.taxonomyId);return l?l.terms.some(u=>u.id===a.termId):!1})}static findLogicalTerm(t,n,r){const{scaleType:i}=r;if(i==="tshirt"){const a=this.generateTshirtSizeName(n,r.defaultValue,r.extraPrefix||"X");return t.terms.find(l=>l.name.toLowerCase()===a.toLowerCase())||null}else{const a=this.generateNumericSizeName(n,r.defaultValue,r.increasingStep||100,r.decreasingStep||25);return t.terms.find(l=>l.name===a||l.name===n.toString())||null}}static generateTermsFromLogicalMapping(t,n){console.log(" TokenGenerationService.generateTermsFromLogicalMapping: Generating terms",{iterationValues:t,logicalMapping:n,scaleType:n.scaleType});const r=[];for(const i of t){let a;n.scaleType==="tshirt"?a=this.generateTshirtSizeName(i,n.defaultValue,n.extraPrefix||"X"):a=this.generateNumericSizeName(i,n.defaultValue,n.increasingStep||100,n.decreasingStep||25),r.push(a),console.log(` TokenGenerationService.generateTermsFromLogicalMapping: Generated term for n=${i}: "${a}"`)}return console.log(" TokenGenerationService.generateTermsFromLogicalMapping: All terms generated",{terms:r,count:r.length}),r}static handleTaxonomyCreation(t,n,r,i){const a=[];if(t.taxonomyId){const l=r.find(u=>u.id===t.taxonomyId);if(!l)throw new Error(`Selected taxonomy with ID "${t.taxonomyId}" not found`);return{taxonomy:l,newTaxonomies:a}}if(t.newTaxonomyName){const l={id:Vr("taxonomy"),name:t.newTaxonomyName,description:"Generated by algorithm for scale terms",terms:n.map(u=>({id:Vr("term"),name:u,description:`Generated term for scale: ${u}`})),resolvedValueTypeIds:[i]};return a.push(l),{taxonomy:l,newTaxonomies:a}}throw new Error("No taxonomy selected or new taxonomy name provided")}static matchOrCreateTerms(t,n,r,i=!1){console.log(" TokenGenerationService.matchOrCreateTerms: Starting term matching/creation",{taxonomyId:t.id,taxonomyName:t.name,existingTermsCount:t.terms.length,generatedTerms:n,iterationValues:r,modifyTaxonomiesInPlace:i});const a=[],l=i?t:{...t,terms:[...t.terms]};for(let u=0;u<r.length;u++){const h=r[u],f=n[u];console.log(` TokenGenerationService.matchOrCreateTerms: Processing iteration ${u+1}/${r.length}`,{iterationValue:h,termName:f,existingTerms:l.terms.map(g=>g.name)});let p=l.terms.find(g=>g.name===f);if(p)console.log(" TokenGenerationService.matchOrCreateTerms: Found existing term",{termId:p.id,termName:p.name});else{const g={id:Vr("term"),name:f,description:`Generated term for scale: ${f}`};l.terms.push(g),p=g,console.log(" TokenGenerationService.matchOrCreateTerms: Created new term",{termId:g.id,termName:g.name})}a.push({iterationValue:h,termId:p.id,termName:p.name})}return console.log(" TokenGenerationService.matchOrCreateTerms: Term mappings complete",{termMappingsCount:a.length,termMappings:a,finalTaxonomyTermsCount:l.terms.length}),a}static createTokenWithLogicalMappingAndModes(t,n,r,i,a,l,u,h){var I,H;console.log(" TokenGenerationService.createTokenWithLogicalMappingAndModes: Creating token with mode context",{tokenId:t,algorithmId:n.id,algorithmName:n.name,value:r,iterationValue:i,taxonomyId:a.id,taxonomyName:a.name,termId:l,modeContext:h,modeContextKeys:Object.keys(h),modeContextValues:Object.values(h)});const{tokenGeneration:f}=n,{bulkAssignments:p,logicalMapping:g}=f,y=[...p.taxonomies];console.log(" TokenGenerationService.createTokenWithLogicalMappingAndModes: Initial taxonomies array",{taxonomiesArray:y,bulkAssignmentsTaxonomies:p.taxonomies});const b={taxonomyId:a.id,termId:l};y.some(Z=>Z.taxonomyId===a.id)?console.log(" TokenGenerationService.createTokenWithLogicalMappingAndModes: Logical mapping taxonomy already included",{logicalMappingTaxonomy:b,existingTaxonomiesArray:y}):(y.push(b),console.log(" TokenGenerationService.createTokenWithLogicalMappingAndModes: Added logical mapping taxonomy",{logicalMappingTaxonomy:b,updatedTaxonomiesArray:y}));const D=this.generateDisplayNameFromTaxonomies(y,u,i,g);console.log(" TokenGenerationService.createTokenWithLogicalMappingAndModes: Generated display name",{displayName:D,taxonomiesArray:y,iterationValue:i});const j=Object.values(h).map(Z=>Z);console.log(" TokenGenerationService.createTokenWithLogicalMappingAndModes: Extracted mode IDs from context",{modeContext:h,modeIds:j,modeIdsCount:j.length});const w={id:t,displayName:D,resolvedValueTypeId:p.resolvedValueTypeId,tokenCollectionId:p.collectionId||void 0,description:`Generated by algorithm "${n.name}" with n=${i}`,private:p.private,status:p.status||"stable",themeable:p.themeable,tokenTier:p.tokenTier||"PRIMITIVE",generatedByAlgorithm:!0,algorithmId:n.id,taxonomies:y,propertyTypes:[],codeSyntax:[],valuesByMode:[{modeIds:j,value:{value:r.toString()}}]},C=he.getPlatforms(),_=he.getNamingRules(),N={platforms:C,taxonomies:u,namingRules:_},E=ua.generateAllCodeSyntaxes(w,N);return w.codeSyntax=E,console.log(" TokenGenerationService.createTokenWithLogicalMappingAndModes: Token created successfully",{tokenId:w.id,displayName:w.displayName,resolvedValueTypeId:w.resolvedValueTypeId,modeIds:(I=w.valuesByMode[0])==null?void 0:I.modeIds,value:(H=w.valuesByMode[0])==null?void 0:H.value,taxonomiesCount:w.taxonomies.length,generatedByAlgorithm:w.generatedByAlgorithm,algorithmId:w.algorithmId,codeSyntaxCount:w.codeSyntax.length}),w}static executeAlgorithmSteps(t,n,r){console.log(" TokenGenerationService.executeAlgorithmSteps: Starting algorithm execution",{algorithmId:t.id,algorithmName:t.name,iterationValue:n,modeContext:r,stepsCount:t.steps.length,variablesCount:t.variables.length});try{console.log(" TokenGenerationService.executeAlgorithmSteps: Calling AlgorithmExecutionService.executeAlgorithm");const i=Ni.executeAlgorithm(t,n,{},r);console.log(" TokenGenerationService.executeAlgorithmSteps: Algorithm execution completed",{finalResult:i.finalResult,finalResultType:typeof i.finalResult,variables:i.variables,results:i.results});const a=i.finalResult;if(typeof a=="number"&&!isNaN(a))return console.log(" TokenGenerationService.executeAlgorithmSteps: Valid numeric result",{result:a}),a;if(typeof a=="string"){const u=parseFloat(a);if(!isNaN(u))return console.log(" TokenGenerationService.executeAlgorithmSteps: Parsed string result to number",{originalResult:a,parsedResult:u}),u}const l=`Algorithm execution did not produce a valid number. Got: ${typeof a} ${a}`;throw console.error(" TokenGenerationService.executeAlgorithmSteps:",l,{result:a,resultType:typeof a,executionContext:i}),new Error(l)}catch(i){const a=`Algorithm execution failed: ${i}`;throw console.error(" TokenGenerationService.executeAlgorithmSteps:",a,{error:i,stack:i instanceof Error?i.stack:void 0,algorithmId:t.id,iterationValue:n,modeContext:r}),new Error(a)}}static evaluateFormulaWithContext(t,n){try{const r=Ni.evaluateFormula(t,n);if(typeof r=="number"&&!isNaN(r))return r;if(typeof r=="string"){const i=parseFloat(r);if(!isNaN(i))return i}throw new Error(`Formula "${t.name}" must evaluate to a valid number`)}catch(r){throw new Error(`Formula "${t.name}" evaluation failed: ${r}`)}}static evaluateConditionWithContext(t,n){try{return Ni.evaluateCondition(t,n)}catch(r){throw new Error(`Condition "${t.name}" evaluation failed: ${r}`)}}}class Wa{static findTokensByAlgorithm(t,n){return n.filter(r=>r.generatedByAlgorithm===!0&&r.algorithmId===t)}static evaluateFormula(t,n,r,i={}){try{const a={n:r,...i,...n.reduce((l,u)=>(l[u.name]=this.parseVariableValue(u.defaultValue||"",u.type),l),{})};return Ni.evaluateFormula(t,a)}catch(a){throw console.error("Formula evaluation error:",a),new Error(`Formula evaluation failed: ${a}`)}}static parseVariableValue(t,n){switch(n){case"number":return Number(t)||0;case"string":return String(t);case"boolean":return t==="true"||t==="1";default:return t}}static calculateTokenValues(t,n){var l;const r=new Map;if(!((l=t.tokenGeneration)!=null&&l.enabled))return r;const i=this.findTokensByAlgorithm(t.id,n),a=Ni.generateTokensForAlgorithm(t);return i.forEach(u=>{var h,f,p;try{const g=a.find(y=>y.tokenId===u.id);if(g){const y=((h=u.valuesByMode[0])==null?void 0:h.value)||{value:""},b=this.valuesAreDifferent(y,g.value),A={tokenId:u.id,originalValue:y,calculatedValue:g.value,hasChanges:b,iterationValue:g.iterationValue,affectedFormulas:[g.formulaName]};r.set(u.id,A)}else r.set(u.id,{tokenId:u.id,originalValue:((f=u.valuesByMode[0])==null?void 0:f.value)||{value:""},calculatedValue:{value:""},hasChanges:!1,iterationValue:0,error:"Token not found in algorithm execution results"})}catch(g){console.error(`Error processing token ${u.id}:`,g),r.set(u.id,{tokenId:u.id,originalValue:((p=u.valuesByMode[0])==null?void 0:p.value)||{value:""},calculatedValue:{value:""},hasChanges:!1,iterationValue:0,error:`Calculation failed: ${g}`})}}),r}static executeAlgorithmSteps(t,n){return Ni.executeAlgorithm(t,n).finalResult}static valuesAreDifferent(t,n){return"tokenId"in t&&"tokenId"in n?t.tokenId!==n.tokenId:"value"in t&&"value"in n?t.value!==n.value:!0}static calculateValueDifference(t,n){if("value"in t&&"value"in n){const r=Number(t.value)||0,i=Number(n.value)||0;return Math.abs(r-i)}return 1/0}static analyzeFormulaDependencies(t,n){const r=[],i=this.findTokensByAlgorithm(t.id,n);return t.formulas.forEach(a=>{const l=this.extractVariableDependencies(a.expressions.javascript.value),u=i.map(h=>h.id);r.push({formulaId:a.id,formulaName:a.name,affectedTokens:u,dependencies:l})}),r}static extractVariableDependencies(t){const n=[],r=/\b[a-zA-Z_$][a-zA-Z0-9_$]*\b/g,i=t.match(r)||[],a=["Math","sin","cos","tan","sqrt","pow","abs","round","floor","ceil","max","min"],l=["n"];return i.forEach(u=>{!a.includes(u)&&!l.includes(u)&&n.push(u)}),[...new Set(n)]}static getTokensForFormulaRecalculation(t,n,r){const a=this.analyzeFormulaDependencies(n,r).find(l=>l.formulaId===t);return(a==null?void 0:a.affectedTokens)||[]}static calculateTokenValuesSelective(t,n,r){var h;const i=new Map;if(!((h=t.tokenGeneration)!=null&&h.enabled))return i;const a=this.findTokensByAlgorithm(t.id,n),l=r?a.filter(f=>r.flatMap(g=>this.getTokensForFormulaRecalculation(g,t,n)).includes(f.id)):a,u=Ni.generateTokensForAlgorithm(t);return l.forEach(f=>{var p,g,y;try{const b=u.find(A=>A.tokenId===f.id);if(b){const A=((p=f.valuesByMode[0])==null?void 0:p.value)||{value:""},D=this.valuesAreDifferent(A,b.value),j={tokenId:f.id,originalValue:A,calculatedValue:b.value,hasChanges:D,iterationValue:b.iterationValue,affectedFormulas:r||[b.formulaName]};i.set(f.id,j)}else i.set(f.id,{tokenId:f.id,originalValue:((g=f.valuesByMode[0])==null?void 0:g.value)||{value:""},calculatedValue:{value:""},hasChanges:!1,iterationValue:0,error:"Token not found in algorithm execution results",affectedFormulas:r||[]})}catch(b){console.error(`Error processing token ${f.id}:`,b),i.set(f.id,{tokenId:f.id,originalValue:((y=f.valuesByMode[0])==null?void 0:y.value)||{value:""},calculatedValue:{value:""},hasChanges:!1,iterationValue:0,error:`Calculation failed: ${b}`,affectedFormulas:r||[]})}}),i}}class Qr{static saveToHistory(t,n,r){try{const i=this.getHistory(),a={id:this.generateId(),timestamp:Date.now(),algorithm:JSON.parse(JSON.stringify(t)),description:n,type:r};i.unshift(a),i.length>this.MAX_HISTORY_SIZE&&i.splice(this.MAX_HISTORY_SIZE),this.saveHistory(i)}catch(i){console.error("Failed to save algorithm to history:",i)}}static getHistory(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):[]}catch(t){return console.error("Failed to load algorithm history:",t),[]}}static getHistoryForAlgorithm(t){return this.getHistory().filter(n=>n.algorithm.id===t)}static getLatestEntry(t){const n=this.getHistoryForAlgorithm(t);return n.length>0?n[0]:null}static getPreviousEntry(t){const n=this.getHistoryForAlgorithm(t);return n.length>1?n[1]:null}static canUndo(t){return this.getHistoryForAlgorithm(t).length>1}static canRedo(t){return this.getRedoStack(t).length>0}static undo(t){try{const n=this.getHistoryForAlgorithm(t);if(n.length<=1)return null;const r=n[0],i=n[1];this.addToRedoStack(t,r);const l=this.getHistory().filter(u=>!(u.algorithm.id===t&&u.timestamp===r.timestamp));return this.saveHistory(l),i.algorithm}catch(n){return console.error("Failed to undo algorithm change:",n),null}}static redo(t){try{const n=this.getRedoStack(t);if(n.length===0)return null;const r=n.pop(),i=this.getHistory();return i.unshift(r),this.saveHistory(i),this.saveRedoStack(t,n),r.algorithm}catch(n){return console.error("Failed to redo algorithm change:",n),null}}static clearHistory(t){try{const r=this.getHistory().filter(i=>i.algorithm.id!==t);this.saveHistory(r),this.clearRedoStack(t)}catch(n){console.error("Failed to clear algorithm history:",n)}}static clearAllHistory(){try{localStorage.removeItem(this.STORAGE_KEY),Object.keys(localStorage).forEach(n=>{n.startsWith("algorithm_redo_")&&localStorage.removeItem(n)})}catch(t){console.error("Failed to clear all history:",t)}}static getRedoStack(t){try{const n=localStorage.getItem(`algorithm_redo_${t}`);return n?JSON.parse(n):[]}catch(n){return console.error("Failed to load redo stack:",n),[]}}static addToRedoStack(t,n){try{const r=this.getRedoStack(t);r.push(n),this.saveRedoStack(t,r)}catch(r){console.error("Failed to add to redo stack:",r)}}static saveRedoStack(t,n){try{localStorage.setItem(`algorithm_redo_${t}`,JSON.stringify(n))}catch(r){console.error("Failed to save redo stack:",r)}}static clearRedoStack(t){try{localStorage.removeItem(`algorithm_redo_${t}`)}catch(n){console.error("Failed to clear redo stack:",n)}}static saveHistory(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(n){console.error("Failed to save algorithm history:",n)}}static generateId(){return`history_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}bs(Qr,"MAX_HISTORY_SIZE",50),bs(Qr,"STORAGE_KEY","algorithm_history");function o1({taxonomies:e,value:t,onChange:n,disabled:r=!1,onViewClassifications:i}){var D,j;const[a,l]=z.useState(!1),[u,h]=z.useState(""),[f,p]=z.useState(""),g=e.filter(w=>!t.some(C=>C.taxonomyId===w.id)),y=(w,C)=>{const _=e.find(E=>E.id===w);return!_||!_.terms.some(E=>E.id===C)?!1:e.some(E=>E.id===w)},b=()=>{if(u&&f){try{n([...t,{taxonomyId:u,termId:f}])}catch(w){console.error("[TaxonomyPicker] Error calling onChange:",w)}l(!1),h(""),p("")}},A=w=>{try{n(t.filter((C,_)=>_!==w))}catch(C){console.error("[TaxonomyPicker] Error calling onChange:",C)}};return e.length===0?s.jsx(Y,{p:2,color:"gray.500",fontStyle:"italic",children:"Must have at least one taxonomy term"}):s.jsxs(Y,{children:[!a&&s.jsx(Ee,{variant:"outline",size:"sm",onClick:()=>l(!0),isDisabled:g.length===0||r,children:"Add Taxonomy"}),a?s.jsxs(ve,{spacing:2,align:"center",mb:2,children:[s.jsx(Ge,{isDisabled:r,minW:"140px",children:s.jsx(Zt,{value:u,placeholder:"Select taxonomy",onChange:w=>{h(w.target.value),p("")},isDisabled:r,size:"sm",children:g.map(w=>s.jsx("option",{value:w.id,children:w.name},w.id))})}),s.jsx(Ge,{isDisabled:!u||r,minW:"140px",children:s.jsx(Zt,{value:f,placeholder:"Select term",onChange:w=>p(w.target.value),isDisabled:!u||r,size:"sm",children:((j=(D=e.find(w=>w.id===u))==null?void 0:D.terms)==null?void 0:j.map(w=>s.jsx("option",{value:w.id,children:w.name},w.id)))||[]})}),s.jsx(Ee,{colorScheme:"blue",size:"sm",onClick:b,isDisabled:!u||!f||r,children:"Add"}),s.jsx(Ee,{variant:"ghost",size:"sm",onClick:()=>{l(!1),h(""),p("")},children:"Cancel"})]}):null,s.jsx(ve,{wrap:"wrap",spacing:2,mb:2,children:t.map((w,C)=>{const _=e.find(H=>H.id===w.taxonomyId),N=_==null?void 0:_.terms.find(H=>H.id===w.termId),E=`${w.taxonomyId}-${w.termId}`,I=y(w.taxonomyId,w.termId);return s.jsxs(pa,{placement:"top",closeOnBlur:!0,children:[s.jsx(ma,{children:s.jsxs(us,{size:"md",variant:"solid",colorScheme:I?"blue":"red",m:1,tabIndex:0,children:[s.jsxs(Bi,{children:[_&&N?`${_.name}: ${N.name}`:"Unknown",!I&&s.jsx(er,{label:"This term is no longer valid for the current value type",children:s.jsx(vr,{as:l4,ml:1,boxSize:3})})]}),!r&&s.jsx(bd,{onClick:()=>A(C)})]})}),s.jsx(so,{width:"300px",children:s.jsx(io,{p:4,children:s.jsxs(ye,{align:"stretch",spacing:3,children:[_&&s.jsxs(s.Fragment,{children:[s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",fontSize:"sm",children:_.name}),_.description&&s.jsx(B,{fontSize:"sm",color:"gray.400",children:_.description})]}),N&&s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",fontSize:"sm",children:N.name}),N.description&&s.jsx(B,{fontSize:"sm",color:"gray.400",children:N.description}),!I&&s.jsx(B,{fontSize:"sm",color:"red.400",mt:1,children:"This term is no longer valid for the current value type"})]})]}),s.jsx(Y,{pt:2,children:s.jsx(Ee,{variant:"link",color:"blue.500",fontWeight:"semibold",tabIndex:0,_hover:{textDecoration:"underline"},onMouseDown:()=>{console.log("[TaxonomyPicker] View all classifications link mousedown"),i&&i()},children:"View all classifications"})})]})})})]},E)})})]})}const t9=({isOpen:e,onClose:t,onSave:n,algorithm:r,tokenCalculationStates:i,existingTokens:a,resolvedValueTypes:l})=>{const{colorMode:u}=tn(),[h,f]=z.useState([]);kt.useEffect(()=>{if(e){const C=Array.from(i.values()).filter(_=>_.hasChanges).map(_=>_.tokenId);f(C)}},[e,i]);const p=Array.from(i.values()).filter(C=>C.hasChanges),g=Array.from(i.values()).filter(C=>!C.hasChanges),y=()=>{f(p.map(C=>C.tokenId))},b=()=>{f([])},A=C=>{f(_=>_.includes(C)?_.filter(N=>N!==C):[..._,C])},D=()=>{n(h),t()},j=C=>{const _=a.find(E=>E.id===C);if(!_)return"Unknown";const N=l.find(E=>E.id===_.resolvedValueTypeId);return(N==null?void 0:N.displayName)||"Unknown"},w=C=>typeof C=="number"?C.toString():typeof C=="string"?C:typeof C=="boolean"?C?"true":"false":String(C);return s.jsxs(zn,{isOpen:e,onClose:t,size:"xl",scrollBehavior:"inside",children:[s.jsx(vn,{}),s.jsxs(Pn,{maxH:"90vh",children:[s.jsx(wn,{children:s.jsxs(ve,{spacing:3,children:[s.jsx(B,{children:"Save Algorithm Changes"}),s.jsxs(pt,{colorScheme:"blue",variant:"subtle",children:[p.length," tokens affected"]})]})}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Y,{p:4,borderWidth:1,borderRadius:"md",bg:u==="light"?"blue.50":"blue.900",children:[s.jsxs(B,{fontWeight:"bold",mb:2,children:["Algorithm: ",r.name]}),s.jsxs(B,{fontSize:"sm",color:"gray.600",children:["This will update ",p.length," tokens with new calculated values based on your formula changes."]})]}),p.length>0&&s.jsxs(Y,{p:3,borderWidth:1,borderRadius:"md",bg:u==="light"?"gray.50":"gray.700",children:[s.jsxs(ve,{justify:"space-between",mb:3,children:[s.jsx(B,{fontWeight:"medium",children:"Select tokens to update:"}),s.jsxs(ve,{spacing:2,children:[s.jsx(Ee,{size:"sm",variant:"outline",onClick:y,children:"Select All"}),s.jsx(Ee,{size:"sm",variant:"outline",onClick:b,children:"Deselect All"})]})]}),s.jsxs(B,{fontSize:"sm",color:"gray.500",children:[h.length," of ",p.length," tokens selected"]})]}),p.length>0&&s.jsxs(Y,{children:[s.jsxs(B,{fontWeight:"bold",mb:3,color:"orange.600",children:["Tokens with Changes (",p.length,")"]}),s.jsx(Y,{children:s.jsx(ye,{spacing:2,align:"stretch",children:p.map(C=>{const _=a.find(H=>H.id===C.tokenId);if(!_)return null;const N=h.includes(C.tokenId),E=C.originalValue&&"value"in C.originalValue?w(C.originalValue.value):"N/A",I=C.calculatedValue&&"value"in C.calculatedValue?w(C.calculatedValue.value):"N/A";return s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",borderColor:N?"blue.300":"gray.200",bg:N?u==="light"?"blue.50":"blue.900":u==="light"?"white":"gray.700",children:s.jsxs(ve,{justify:"space-between",align:"start",children:[s.jsxs(ye,{align:"start",flex:1,spacing:1,children:[s.jsxs(ve,{children:[s.jsx(Tn,{isChecked:N,onChange:()=>A(C.tokenId)}),s.jsx(B,{fontWeight:"medium",children:_.displayName}),s.jsx(pt,{size:"sm",colorScheme:"gray",children:j(C.tokenId)})]}),s.jsxs(ve,{spacing:4,fontSize:"sm",children:[s.jsxs(ye,{align:"start",spacing:0,children:[s.jsx(B,{color:"gray.500",children:"Current:"}),s.jsx(B,{fontFamily:"mono",color:"red.500",children:E})]}),s.jsx(B,{color:"gray.400",children:""}),s.jsxs(ye,{align:"start",spacing:0,children:[s.jsx(B,{color:"gray.500",children:"New:"}),s.jsx(B,{fontFamily:"mono",color:"green.500",children:I})]})]}),s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["Iteration: ",C.iterationValue]})]}),s.jsx(pt,{colorScheme:"orange",variant:"subtle",children:"Changed"})]})},C.tokenId)})})})]}),g.length>0&&s.jsxs(Y,{children:[s.jsxs(B,{fontWeight:"bold",mb:3,color:"green.600",children:["Tokens Unchanged (",g.length,")"]}),s.jsx(Y,{children:s.jsxs(ye,{spacing:2,align:"stretch",children:[g.slice(0,5).map(C=>{const _=a.find(E=>E.id===C.tokenId);if(!_)return null;const N=C.originalValue&&"value"in C.originalValue?w(C.originalValue.value):"N/A";return s.jsx(Y,{p:2,borderWidth:1,borderRadius:"md",bg:u==="light"?"gray.50":"gray.700",opacity:.7,children:s.jsxs(ve,{justify:"space-between",children:[s.jsxs(ye,{align:"start",spacing:0,children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",children:_.displayName}),s.jsxs(B,{fontSize:"xs",color:"gray.500",children:[j(C.tokenId),"  ",N]})]}),s.jsx(pt,{colorScheme:"green",variant:"subtle",size:"sm",children:"Unchanged"})]})},C.tokenId)}),g.length>5&&s.jsxs(B,{fontSize:"sm",color:"gray.500",textAlign:"center",children:["... and ",g.length-5," more unchanged tokens"]})]})})]}),p.length===0&&s.jsxs(xn,{status:"info",children:[s.jsx(bn,{}),s.jsx(B,{children:"No token values have changed. The algorithm will be saved without updating any tokens."})]})]})}),s.jsx(Xn,{children:s.jsxs(ve,{spacing:3,children:[s.jsx(Ee,{variant:"ghost",onClick:t,leftIcon:s.jsx(fm,{size:16}),children:"Cancel"}),s.jsxs(Ee,{colorScheme:"blue",onClick:D,leftIcon:s.jsx(Cd,{size:16}),isDisabled:p.length===0,children:["Save Algorithm",h.length>0&&` & Update ${h.length} Tokens`]})]})})]})]})},n9=({isOpen:e,onClose:t,onReset:n,algorithm:r,hasUnsavedChanges:i})=>{const{colorMode:a}=tn(),[l,u]=z.useState("last-save"),[h,f]=z.useState(""),p=Qr.getHistoryForAlgorithm(r.id),g=Qr.canUndo(r.id),y=Qr.canRedo(r.id),b=()=>{let j;l==="specific-history"&&h&&(j=p.find(w=>w.id===h)),n(l,j),t()},A=j=>new Date(j).toLocaleString(),D=j=>{switch(j){case"last-save":return"Revert to the last saved version of the algorithm";case"specific-history":return"Revert to a specific point in the algorithm history";case"original":return"Reset to the original algorithm state (this will clear all history)";default:return""}};return s.jsxs(zn,{isOpen:e,onClose:t,size:"lg",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:s.jsxs(ve,{spacing:3,children:[s.jsx(_l,{size:20}),s.jsx(B,{children:"Reset Algorithm"})]})}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[i&&s.jsxs(xn,{status:"warning",children:[s.jsx(bn,{}),s.jsx(B,{children:"You have unsaved changes. Resetting will discard these changes."})]}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",mb:3,children:"Choose Reset Option:"}),s.jsx(Ih,{value:l,onChange:j=>u(j),children:s.jsxs(ye,{spacing:3,align:"start",children:[s.jsx(Xo,{value:"last-save",isDisabled:!g,children:s.jsxs(ye,{align:"start",spacing:1,children:[s.jsx(B,{fontWeight:"medium",children:"Last Saved Version"}),s.jsx(B,{fontSize:"sm",color:"gray.500",children:D("last-save")}),!g&&s.jsx(B,{fontSize:"xs",color:"orange.500",children:"No saved history available"})]})}),s.jsx(Xo,{value:"specific-history",isDisabled:p.length===0,children:s.jsxs(ye,{align:"start",spacing:1,children:[s.jsx(B,{fontWeight:"medium",children:"Specific History Point"}),s.jsx(B,{fontSize:"sm",color:"gray.500",children:D("specific-history")}),p.length===0&&s.jsx(B,{fontSize:"xs",color:"orange.500",children:"No history available"})]})}),s.jsx(Xo,{value:"original",children:s.jsxs(ye,{align:"start",spacing:1,children:[s.jsx(B,{fontWeight:"medium",children:"Original State"}),s.jsx(B,{fontSize:"sm",color:"gray.500",children:D("original")})]})})]})})]}),l==="specific-history"&&p.length>0&&s.jsxs(Y,{children:[s.jsx(Ss,{my:3}),s.jsx(B,{fontWeight:"bold",mb:3,children:"Select History Point:"}),s.jsx(Y,{maxH:"200px",overflowY:"auto",borderWidth:1,borderRadius:"md",p:2,children:s.jsx(Ih,{value:h,onChange:f,children:s.jsx(ye,{spacing:2,align:"start",children:p.map(j=>s.jsx(Xo,{value:j.id,children:s.jsxs(ye,{align:"start",spacing:0,children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",children:j.description}),s.jsxs(B,{fontSize:"xs",color:"gray.500",children:[A(j.timestamp),"  ",j.type]})]})},j.id))})})})]}),s.jsxs(Y,{p:3,bg:a==="light"?"gray.50":"gray.700",borderRadius:"md",children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Current Status:"}),s.jsxs(ye,{spacing:1,align:"start",children:[s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["Undo available: ",g?"Yes":"No"]}),s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["Redo available: ",y?"Yes":"No"]}),s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["History entries: ",p.length]})]})]})]})}),s.jsx(Xn,{children:s.jsxs(ve,{spacing:3,children:[s.jsx(Ee,{variant:"ghost",onClick:t,children:"Cancel"}),s.jsx(Ee,{colorScheme:"red",onClick:b,leftIcon:s.jsx(_l,{size:16}),isDisabled:l==="last-save"&&!g||l==="specific-history"&&(!h||p.length===0),children:"Reset Algorithm"})]})})]})]})};class hl{static analyzeFormulaDependencies(t){const n=[],r=[],i={},a=ar.getSystemVariables(),l=new Set(["n",...a.map(h=>h.name)]);t.variables.forEach(h=>{i[h.name]={formulas:[],conditions:[],isSystemVariable:!1}}),l.forEach(h=>{i[h]={formulas:[],conditions:[],isSystemVariable:!0}}),t.formulas.forEach(h=>{const f=this.extractVariableDependencies(h.expressions.javascript.value,h.expressions.ast);f.forEach(y=>{i[y]&&i[y].formulas.push(h.id)});const p={id:h.id,name:h.name,type:"formula",inputs:f,outputs:[],dependencies:[],stepIndex:t.steps.findIndex(y=>y.id===h.id)},g=this.extractOutputVariables(h.expressions.javascript.value);p.outputs=g,n.push(p)}),t.conditions.forEach(h=>{const f=this.extractVariableDependencies(h.expression);f.forEach(g=>{i[g]&&i[g].conditions.push(h.id)});const p={id:h.id,name:h.name,type:"condition",inputs:f,outputs:[],dependencies:[],stepIndex:t.steps.findIndex(g=>g.id===h.id)};n.push(p)}),n.forEach(h=>{h.inputs.forEach(f=>{n.filter(g=>g.type==="formula"&&g.outputs.includes(f)).forEach(g=>{g.stepIndex!==void 0&&h.stepIndex!==void 0&&g.stepIndex<h.stepIndex&&(r.push({source:g.id,target:h.id,type:"formula",variableName:f}),h.dependencies.push(g.id))})})});const u=t.steps.map(h=>h.id);return{nodes:n,edges:r,executionOrder:u,variableUsage:i}}static getVariableUsage(t){return this.extractVariableDependencies(t.expressions.javascript.value,t.expressions.ast)}static validateFormulaDependencies(t){const n=[],r=this.analyzeFormulaDependencies(t),i=ar.getSystemVariables(),a=new Set(["n",...i.map(u=>u.name)]);return r.nodes.forEach(u=>{u.inputs.forEach(h=>{const f=t.variables.some(g=>g.name===h),p=a.has(h);!f&&!p&&n.push({type:"error",message:`Undefined variable '${h}' used in ${u.type} '${u.name}'`,formulaId:u.type==="formula"?u.id:void 0,conditionId:u.type==="condition"?u.id:void 0,variableName:h})})}),this.detectCircularDependencies(r).forEach(u=>{n.push({type:"error",message:`Circular dependency detected: ${u.join(" -> ")}`,formulaId:u[0]})}),t.variables.forEach(u=>{const h=r.variableUsage[u.name];(!h||h.formulas.length===0&&h.conditions.length===0)&&n.push({type:"warning",message:`Variable '${u.name}' is defined but never used`,variableName:u.name})}),n}static generateExecutionTrace(t,n={}){const r=Date.now(),i=[],a=[];let l=null;try{const u=ar.getSystemVariables(),h={...n,n:n.n||0};u.forEach(f=>{f.name in h||(h[f.name]=this.parseVariableValue(f.defaultValue||"",f.type))}),t.variables.forEach(f=>{f.name in h||(h[f.name]=this.parseVariableValue(f.defaultValue||"",f.type))}),t.steps.forEach((f,p)=>{var A,D,j;const g=Date.now();let y=null,b;try{if(f.type==="formula"){const _=t.formulas.find(N=>N.id===f.id);_&&(y=this.evaluateFormula(_,h),l=y)}else if(f.type==="condition"){const _=t.conditions.find(N=>N.id===f.id);_&&(y=this.evaluateCondition(_,h))}const w=Date.now(),C=f.type==="formula"?this.extractVariableDependencies(((A=t.formulas.find(_=>_.id===f.id))==null?void 0:A.expressions.javascript.value)||"",(D=t.formulas.find(_=>_.id===f.id))==null?void 0:D.expressions.ast):this.extractVariableDependencies(((j=t.conditions.find(_=>_.id===f.id))==null?void 0:j.expression)||"");i.push({stepId:f.id,stepName:f.name,stepType:f.type,inputValues:{...h},outputValue:y,error:b,executionTime:w-g,dependencies:C})}catch(w){b=w instanceof Error?w.message:String(w),a.push(`Step ${p+1} (${f.name}): ${b}`),i.push({stepId:f.id,stepName:f.name,stepType:f.type,inputValues:{...h},outputValue:null,error:b,executionTime:Date.now()-g,dependencies:[]})}})}catch(u){a.push(`Execution failed: ${u instanceof Error?u.message:String(u)}`)}return{steps:i,finalResult:l,errors:a,executionTime:Date.now()-r}}static extractVariableDependencies(t,n){if(n)return Nr.extractVariables(n);const r=/\b[a-zA-Z_][a-zA-Z0-9_]*\b/g,i=t.match(r)||[],a=["Math","Array","console","function","return","if","else","for","while","var","let","const"],l=i.filter(u=>!a.includes(u));return[...new Set(l)]}static extractOutputVariables(t){const n=[],r=/^([a-zA-Z_$][a-zA-Z0-9_$]*)\s*=/,i=t.match(r);return i&&n.push(i[1]),n}static detectCircularDependencies(t){const n=[],r=new Set,i=new Set,a=(l,u)=>{if(i.has(l)){const f=u.indexOf(l);n.push(u.slice(f));return}if(r.has(l))return;r.add(l),i.add(l);const h=t.nodes.find(f=>f.id===l);h&&h.dependencies.forEach(f=>{a(f,[...u,l])}),i.delete(l)};return t.nodes.forEach(l=>{r.has(l.id)||a(l.id,[])}),n}static parseVariableValue(t,n){switch(n){case"number":return Number(t)||0;case"string":return t;case"boolean":return t.toLowerCase()==="true";case"color":return t;default:return t}}static evaluateFormula(t,n){try{const r=t.expressions.javascript.value,i=Object.keys(n),a=Object.values(n);return new Function(...i,`return ${r}`)(...a)}catch(r){throw new Error(`Formula evaluation failed for ${t.name}: ${r}`)}}static evaluateCondition(t,n){try{const r=t.expression,i=Object.keys(n),a=Object.values(n);return!!new Function(...i,`return ${r}`)(...a)}catch(r){throw new Error(`Condition evaluation failed for ${t.name}: ${r}`)}}}const r9=({algorithm:e,showValidation:t=!0,showExecutionTrace:n=!1,executionContext:r={}})=>{const i=z.useMemo(()=>hl.analyzeFormulaDependencies(e),[e]),a=z.useMemo(()=>t?hl.validateFormulaDependencies(e):[],[e,t]),l=z.useMemo(()=>n?hl.generateExecutionTrace(e,r):null,[e,n,r]),u=p=>p==="formula"?"purple":"green",h=p=>{switch(p){case"error":return Hu;case"warning":return Hu;case"info":return Xh;default:return Xh}},f=p=>{switch(p){case"error":return"red";case"warning":return"orange";case"info":return"blue";default:return"gray"}};return s.jsxs(ye,{spacing:6,align:"stretch",children:[s.jsxs(sa,{children:[s.jsx(ia,{children:s.jsxs(ve,{children:[s.jsx(vr,{as:k4}),s.jsx(yt,{size:"md",children:"Dependency Graph"})]})}),s.jsx(aa,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Qa,{columns:2,spacing:4,children:[s.jsxs(Y,{children:[s.jsxs(B,{fontWeight:"bold",mb:2,children:["Formulas (",i.nodes.filter(p=>p.type==="formula").length,")"]}),s.jsx(ye,{align:"start",spacing:1,children:i.nodes.filter(p=>p.type==="formula").map(p=>s.jsxs(ve,{spacing:2,children:[s.jsx(pt,{colorScheme:u(p.type),size:"sm",children:p.type}),s.jsx(B,{fontSize:"sm",children:p.name}),p.inputs.length>0&&s.jsx(er,{label:`Uses: ${p.inputs.join(", ")}`,children:s.jsxs(pt,{size:"sm",colorScheme:"blue",variant:"outline",children:[p.inputs.length," inputs"]})})]},p.id))})]}),s.jsxs(Y,{children:[s.jsxs(B,{fontWeight:"bold",mb:2,children:["Conditions (",i.nodes.filter(p=>p.type==="condition").length,")"]}),s.jsx(ye,{align:"start",spacing:1,children:i.nodes.filter(p=>p.type==="condition").map(p=>s.jsxs(ve,{spacing:2,children:[s.jsx(pt,{colorScheme:u(p.type),size:"sm",children:p.type}),s.jsx(B,{fontSize:"sm",children:p.name}),p.inputs.length>0&&s.jsx(er,{label:`Uses: ${p.inputs.join(", ")}`,children:s.jsxs(pt,{size:"sm",colorScheme:"blue",variant:"outline",children:[p.inputs.length," inputs"]})})]},p.id))})]})]}),s.jsx(Ss,{}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",mb:2,children:"Execution Order"}),s.jsx(ve,{spacing:2,flexWrap:"wrap",children:i.executionOrder.map((p,g)=>{const y=i.nodes.find(b=>b.id===p);return y?s.jsxs(ve,{spacing:1,children:[s.jsx(pt,{colorScheme:"gray",size:"sm",children:g+1}),s.jsx(pt,{colorScheme:u(y.type),size:"sm",children:y.type}),s.jsx(B,{fontSize:"sm",children:y.name}),g<i.executionOrder.length-1&&s.jsx(vr,{as:Zh,size:16})]},p):null})})]}),i.edges.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(Ss,{}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",mb:2,children:"Dependencies"}),s.jsx(ye,{align:"start",spacing:1,children:i.edges.map((p,g)=>{const y=i.nodes.find(A=>A.id===p.source),b=i.nodes.find(A=>A.id===p.target);return!y||!b?null:s.jsxs(ve,{spacing:2,children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",children:y.name}),s.jsx(vr,{as:Zh,size:14}),s.jsx(B,{fontSize:"sm",fontWeight:"medium",children:b.name}),p.variableName&&s.jsx(er,{label:`Via variable: ${p.variableName}`,children:s.jsx(pt,{size:"sm",colorScheme:"teal",variant:"outline",children:p.variableName})})]},g)})})]})]})]})})]}),s.jsxs(sa,{children:[s.jsx(ia,{children:s.jsxs(ve,{children:[s.jsx(vr,{as:Nl}),s.jsx(yt,{size:"md",children:"Variable Usage"})]})}),s.jsx(aa,{children:s.jsx(Qa,{columns:2,spacing:4,children:Object.entries(i.variableUsage).map(([p,g])=>s.jsxs(Y,{p:3,borderWidth:1,borderRadius:"md",children:[s.jsxs(ve,{justify:"space-between",mb:2,children:[s.jsx(B,{fontWeight:"bold",children:p}),g.isSystemVariable&&s.jsx(pt,{size:"sm",colorScheme:"green",children:"System"})]}),g.formulas.length>0&&s.jsxs(B,{fontSize:"sm",color:"gray.500",children:["Used by ",g.formulas.length," formula",g.formulas.length!==1?"s":""]}),g.conditions.length>0&&s.jsxs(B,{fontSize:"sm",color:"gray.500",children:["Used by ",g.conditions.length," condition",g.conditions.length!==1?"s":""]})]},p))})})]}),t&&a.length>0&&s.jsxs(sa,{children:[s.jsx(ia,{children:s.jsxs(ve,{children:[s.jsx(vr,{as:Xp}),s.jsx(yt,{size:"md",children:"Validation Results"})]})}),s.jsx(aa,{children:s.jsx(ye,{spacing:3,align:"stretch",children:a.map((p,g)=>s.jsxs(xn,{status:p.type==="error"?"error":p.type==="warning"?"warning":"info",children:[s.jsx(bn,{as:h(p.type)}),s.jsxs(or,{children:[p.message,p.formulaId&&s.jsx(pt,{ml:2,colorScheme:f(p.type),size:"sm",children:"Formula"}),p.conditionId&&s.jsx(pt,{ml:2,colorScheme:f(p.type),size:"sm",children:"Condition"})]})]},g))})})]}),n&&l&&s.jsxs(sa,{children:[s.jsx(ia,{children:s.jsxs(ve,{children:[s.jsx(vr,{as:tm}),s.jsx(yt,{size:"md",children:"Execution Trace"})]})}),s.jsx(aa,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[l.errors.length>0&&s.jsxs(xn,{status:"error",children:[s.jsx(bn,{}),s.jsxs(or,{children:[l.errors.length," error",l.errors.length!==1?"s":""," occurred during execution"]})]}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",mb:2,children:"Execution Steps"}),s.jsx(ye,{spacing:2,align:"stretch",children:l.steps.map((p,g)=>s.jsxs(Y,{p:3,borderWidth:1,borderRadius:"md",children:[s.jsxs(ve,{justify:"space-between",mb:2,children:[s.jsxs(ve,{children:[s.jsx(pt,{colorScheme:"gray",size:"sm",children:g+1}),s.jsx(pt,{colorScheme:u(p.stepType),size:"sm",children:p.stepType}),s.jsx(B,{fontWeight:"medium",children:p.stepName})]}),s.jsxs(B,{fontSize:"sm",color:"gray.500",children:[p.executionTime,"ms"]})]}),p.error?s.jsxs(xn,{status:"error",size:"sm",children:[s.jsx(bn,{}),s.jsx(or,{children:p.error})]}):s.jsxs(ye,{align:"start",spacing:1,children:[s.jsxs(B,{fontSize:"sm",children:[s.jsx("strong",{children:"Output:"})," ",String(p.outputValue)]}),p.dependencies.length>0&&s.jsxs(B,{fontSize:"sm",children:[s.jsx("strong",{children:"Dependencies:"})," ",p.dependencies.join(", ")]})]})]},p.stepId))})]}),s.jsx(Ss,{}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",children:"Final Result"}),s.jsx(B,{children:String(l.finalResult)}),s.jsxs(B,{fontSize:"sm",color:"gray.500",mt:1,children:["Total execution time: ",l.executionTime,"ms"]})]})]})})]})]})},s9=({algorithm:e,onExecutionComplete:t})=>{const{colorMode:n}=tn(),[r,i]=z.useState({}),[a,l]=z.useState(null),[u,h]=z.useState(!1),[f,p]=z.useState(-1),[g,y]=z.useState([]);z.useEffect(()=>{(()=>{const H=ar.getSystemVariables(),Z=[{id:"system_n",name:"n",type:"number",defaultValue:"0"},...H];y(Z)})()},[]);const b=e.steps.length,A=b>0,D=()=>{h(!0);try{const I=hl.generateExecutionTrace(e,r);l(I),p(I.steps.length-1),t==null||t(I)}catch(I){console.error("Execution failed:",I)}finally{h(!1)}},j=()=>{f<b-1&&p(I=>I+1)},w=()=>{p(-1),l(null)},C=(I,H)=>{i(Z=>({...Z,[I]:H}))},_=I=>{var H;return!a||I>f?"pending":(H=a.steps[I])!=null&&H.error?"error":"completed"},N=I=>{switch(I){case"completed":return"green";case"error":return"red";case"pending":return"gray";default:return"gray"}},E=I=>I==null?"undefined":typeof I=="object"?JSON.stringify(I):String(I);return s.jsxs(ye,{spacing:6,align:"stretch",children:[s.jsxs(sa,{children:[s.jsx(ia,{children:s.jsxs(ve,{children:[s.jsx(vr,{as:Kh}),s.jsx(yt,{size:"md",children:"Execution Preview"})]})}),s.jsx(aa,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",mb:3,children:"Execution Context"}),s.jsxs(ye,{spacing:3,align:"stretch",children:[g.map(I=>s.jsxs(Ge,{children:[s.jsxs(Ue,{children:[I.name," (",I.type,")",I.id==="system_n"&&s.jsx(pt,{ml:2,size:"sm",colorScheme:"green",children:"Built-in"}),I.id!=="system_n"&&I.id.startsWith("system-")&&s.jsx(pt,{ml:2,size:"sm",colorScheme:"blue",children:"System"})]}),I.type==="number"?s.jsxs(Au,{value:r[I.name]||Number(I.defaultValue)||0,onChange:(H,Z)=>C(I.name,Z),min:-10,max:100,children:[s.jsx(_u,{}),s.jsxs(Eu,{children:[s.jsx(Nu,{}),s.jsx(Mu,{})]})]}):s.jsx(ut,{value:r[I.name]||I.defaultValue||"",onChange:H=>C(I.name,H.target.value),placeholder:`Enter ${I.name}`})]},I.id)),e.variables.map(I=>s.jsxs(Ge,{children:[s.jsxs(Ue,{children:[I.name," (",I.type,")"]}),I.type==="number"?s.jsxs(Au,{value:r[I.name]||Number(I.defaultValue)||0,onChange:(H,Z)=>C(I.name,Z),children:[s.jsx(_u,{}),s.jsxs(Eu,{children:[s.jsx(Nu,{}),s.jsx(Mu,{})]})]}):s.jsx(ut,{value:r[I.name]||I.defaultValue||"",onChange:H=>C(I.name,H.target.value),placeholder:`Enter ${I.name}`})]},I.id))]})]}),s.jsxs(ve,{spacing:3,children:[s.jsx(Ee,{leftIcon:s.jsx(Kh,{size:16}),colorScheme:"green",onClick:D,isLoading:u,isDisabled:!A,children:"Run Execution"}),s.jsx(Ee,{leftIcon:s.jsx(ub,{size:16}),onClick:j,isDisabled:f>=b||!a,children:"Step Forward"}),s.jsx(Ee,{leftIcon:s.jsx(_l,{size:16}),onClick:w,variant:"outline",children:"Reset"})]}),A&&s.jsxs(Y,{children:[s.jsxs(B,{fontSize:"sm",color:"gray.500",mb:2,children:["Progress: ",f," / ",b," steps"]}),s.jsx(Y,{w:"100%",h:2,bg:n==="light"?"gray.200":"gray.700",borderRadius:"full",overflow:"hidden",children:s.jsx(Y,{h:"100%",bg:"blue.500",w:`${f/b*100}%`,transition:"width 0.3s ease"})})]})]})})]}),a&&s.jsxs(sa,{children:[s.jsx(ia,{children:s.jsxs(ve,{children:[s.jsx(vr,{as:tm}),s.jsx(yt,{size:"md",children:"Execution Steps"}),a.errors.length>0&&s.jsxs(pt,{colorScheme:"red",size:"sm",children:[a.errors.length," Error",a.errors.length!==1?"s":""]})]})}),s.jsx(aa,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Y,{p:3,bg:n==="light"?"gray.50":"gray.700",borderRadius:"md",children:[s.jsxs(ve,{justify:"space-between",children:[s.jsx(B,{fontWeight:"bold",children:"Execution Summary"}),s.jsxs(ve,{children:[s.jsx(vr,{as:Yh,size:14}),s.jsxs(B,{fontSize:"sm",children:[a.executionTime,"ms"]})]})]}),s.jsxs(B,{fontSize:"sm",color:"gray.500",mt:1,children:["Final Result: ",E(a.finalResult)]})]}),s.jsx(ye,{spacing:3,align:"stretch",children:a.steps.map((I,H)=>{const Z=_(H),ae=H<=f;return s.jsxs(Y,{p:4,borderWidth:1,borderRadius:"md",opacity:ae?1:.5,transition:"opacity 0.3s ease",children:[s.jsxs(ve,{justify:"space-between",mb:3,children:[s.jsxs(ve,{children:[s.jsx(pt,{colorScheme:"gray",size:"sm",children:H+1}),s.jsx(pt,{colorScheme:N(Z),size:"sm",children:I.stepType}),s.jsx(B,{fontWeight:"medium",children:I.stepName})]}),s.jsxs(ve,{children:[s.jsx(vr,{as:Yh,size:14}),s.jsxs(B,{fontSize:"sm",children:[I.executionTime,"ms"]})]})]}),ae&&s.jsxs(ye,{spacing:3,align:"stretch",children:[s.jsxs(Y,{children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Input Values"}),s.jsx(ve,{spacing:2,flexWrap:"wrap",children:Object.entries(I.inputValues).map(([ne,F])=>s.jsx(pt,{size:"sm",colorScheme:"blue",variant:"outline",children:s.jsxs(ve,{spacing:1,children:[s.jsx(vr,{as:Nl,size:10}),s.jsxs(B,{children:[ne,": ",E(F)]})]})},ne))})]}),s.jsxs(Y,{children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Output"}),I.error?s.jsxs(xn,{status:"error",size:"sm",children:[s.jsx(bn,{as:Hu}),s.jsx(or,{children:I.error})]}):s.jsx(B,{fontSize:"sm",p:2,bg:n==="light"?"green.50":"green.900",borderRadius:"md",children:E(I.outputValue)})]}),I.dependencies.length>0&&s.jsxs(Y,{children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Dependencies"}),s.jsx(ve,{spacing:2,flexWrap:"wrap",children:I.dependencies.map(ne=>s.jsx(pt,{size:"sm",colorScheme:"purple",variant:"outline",children:s.jsxs(ve,{spacing:1,children:[s.jsx(vr,{as:Nl,size:10}),s.jsx(B,{children:ne})]})},ne))})]})]})]},I.stepId)})}),a.errors.length>0&&s.jsxs(xn,{status:"error",children:[s.jsx(bn,{}),s.jsxs(or,{children:[a.errors.length," error",a.errors.length!==1?"s":""," occurred during execution"]})]})]})})]})]})},i9=({isOpen:e,onClose:t,onConfirm:n,algorithm:r})=>{const{colorMode:i}=tn(),[a,l]=z.useState([]),[u,h]=z.useState({});z.useEffect(()=>{if(!e)return;const j=he.getDimensions(),w=r.variables||[],C=ar.getSystemVariables(),N=[...w,...C].filter(Z=>Z.modeBased&&Z.dimensionId);if(N.length===0){n({});return}const E=j.filter(Z=>N.some(ae=>ae.dimensionId===Z.id)),I=[];E.forEach(Z=>{Z.modes.forEach(ae=>{I.push({dimensionId:Z.id,dimensionName:Z.displayName,modeId:ae.id,modeName:ae.name,isSelected:!0})})}),l(I);const H={};E.forEach(Z=>{H[Z.id]=Z.modes.map(ae=>ae.id)}),h(H)},[e,r,n]);const f=(j,w,C)=>{h(_=>{const N=_[j]||[];return C?{..._,[j]:[...N,w]}:{..._,[j]:N.filter(E=>E!==w)}}),l(_=>_.map(N=>N.dimensionId===j&&N.modeId===w?{...N,isSelected:C}:N))},p=j=>{const C=a.filter(_=>_.dimensionId===j).map(_=>_.modeId);h(_=>({..._,[j]:C})),l(_=>_.map(N=>N.dimensionId===j?{...N,isSelected:!0}:N))},g=j=>{h(w=>({...w,[j]:[]})),l(w=>w.map(C=>C.dimensionId===j?{...C,isSelected:!1}:C))},y=()=>{const j={};Object.entries(u).forEach(([w,C])=>{C.length>0&&(j[w]=C)}),n(j),t()},b=()=>{t()},A=a.reduce((j,w)=>(j[w.dimensionId]||(j[w.dimensionId]={dimensionName:w.dimensionName,options:[]}),j[w.dimensionId].options.push(w),j),{}),D=Object.values(u).reduce((j,w)=>j*Math.max(w.length,1),1);return s.jsxs(zn,{isOpen:e,onClose:t,size:"lg",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:"Select Modes for Token Generation"}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(xn,{status:"info",borderRadius:"md",children:[s.jsx(bn,{}),s.jsxs(or,{children:["Your algorithm contains mode-based variables. Select which modes to generate tokens for.",D>1&&s.jsxs(B,{mt:2,fontWeight:"bold",children:["This will generate ",D," tokens per iteration."]})]})]}),Object.entries(A).map(([j,w])=>{var N;const C=((N=u[j])==null?void 0:N.length)||0,_=w.options.length;return s.jsxs(Y,{p:4,borderWidth:1,borderRadius:"md",bg:i==="dark"?"gray.800":"gray.50",children:[s.jsxs(ve,{justify:"space-between",mb:3,children:[s.jsx(B,{fontWeight:"bold",children:w.dimensionName}),s.jsxs(ve,{spacing:2,children:[s.jsxs(pt,{colorScheme:"blue",children:[C,"/",_," selected"]}),s.jsx(Ee,{size:"xs",onClick:()=>p(j),children:"Select All"}),s.jsx(Ee,{size:"xs",onClick:()=>g(j),children:"Deselect All"})]})]}),s.jsx(ye,{spacing:2,align:"stretch",children:w.options.map(E=>s.jsx(Tn,{isChecked:E.isSelected,onChange:I=>f(j,E.modeId,I.target.checked),children:s.jsxs(ve,{children:[s.jsx(B,{children:E.modeName}),s.jsx(pt,{size:"sm",colorScheme:"gray",variant:"outline",children:E.modeId})]})},E.modeId))})]},j)})]})}),s.jsx(Xn,{children:s.jsxs(ve,{spacing:3,children:[s.jsx(Ee,{onClick:b,children:"Cancel"}),s.jsxs(Ee,{colorScheme:"blue",onClick:y,children:["Generate Tokens (",D," per iteration)"]})]})})]})]})},tl={id:fi("algorithm"),name:"New Algorithm",resolvedValueTypeId:"color",variables:[],formulas:[],conditions:[],steps:[],tokenGeneration:{enabled:!1,iterationRange:{start:-2,end:8,step:1},bulkAssignments:{resolvedValueTypeId:"color",taxonomies:[],tokenTier:"PRIMITIVE",private:!1,status:"stable",themeable:!1},logicalMapping:{scaleType:"numeric",defaultValue:"100",increasingStep:100,decreasingStep:25,extraPrefix:"X",incrementDirection:"ascending",taxonomyId:void 0,newTaxonomyName:void 0}}},a9=({algorithm:e=tl,onSave:t=()=>{},onUpdateTokens:n=()=>{}})=>{var Tt,ln,Xt,Ht,Mt,dr,ps,En,Do,Ro,ji,mn,v,k,_e,M,$,dn,Ze,Qn,Ns,ht,Nn,hr,Ci,U,Lr,te;const{colorMode:r}=tn(),i=Hn(),[a,l]=z.useState(()=>e?{...e}:tl);z.useEffect(()=>{l(e?{...e}:tl)},[e]);const[u,h]=kt.useState({name:"",type:"number",defaultValue:""}),[f,p]=kt.useState({type:"formula",id:"",name:""}),[g,y]=z.useState(null),[b,A]=z.useState({}),[D,j]=z.useState([]),[w,C]=z.useState([]),[_,N]=z.useState([]),[E,I]=z.useState(!1),[H,Z]=z.useState(new Map),[ae,ne]=z.useState([]),[F,J]=z.useState([]),[pe,G]=z.useState(!1),[ge,W]=z.useState(!1),[L,Q]=z.useState(!1),[fe,xe]=z.useState(null),[ue,ke]=z.useState(!1),[q,re]=z.useState({}),[Se,we]=z.useState(!1),[Ce,Le]=z.useState([]),[ft,vt]=z.useState([]),[on,Rt]=z.useState([]),[nn,Ir]=z.useState(!1);z.useEffect(()=>{if(fe){const K=JSON.stringify(a)!==JSON.stringify(fe);Q(K)}},[a,fe]),z.useEffect(()=>{e&&xe({...e})},[e]),z.useEffect(()=>{const K=()=>{var Fe,De;const se=he.getTaxonomies(),Re=(De=(Fe=a.tokenGeneration)==null?void 0:Fe.bulkAssignments)==null?void 0:De.resolvedValueTypeId;if(Re){const It=se.filter(Ft=>Array.isArray(Ft.resolvedValueTypeIds)&&Ft.resolvedValueTypeIds.includes(Re));Le(It)}else Le([])};return K(),window.addEventListener("focus",K),()=>{window.removeEventListener("focus",K)}},[(ln=(Tt=a.tokenGeneration)==null?void 0:Tt.bulkAssignments)==null?void 0:ln.resolvedValueTypeId]),z.useEffect(()=>{var se,Re;const K=((Re=(se=a.tokenGeneration)==null?void 0:se.bulkAssignments)==null?void 0:Re.taxonomies)||[];vt(K)},[(Ht=(Xt=a.tokenGeneration)==null?void 0:Xt.bulkAssignments)==null?void 0:Ht.taxonomies]),z.useEffect(()=>{const K=he.getValueTypes();Rt(K),K.length>0&&l(se=>K.some(Fe=>Fe.id===se.resolvedValueTypeId)?se:{...se,resolvedValueTypeId:K[0].id})},[]),z.useEffect(()=>{var Ft;const K=a.variables||[],se=new Set;(Ft=a.formulas)==null||Ft.forEach(St=>{St.expressions.javascript.value&&(St.expressions.javascript.value.match(/\b[a-zA-Z_][a-zA-Z0-9_]*\b/g)||[]).forEach(jn=>{K.some(At=>At.name===jn)||se.add(jn)})});const Fe=ar.getSystemVariables().filter(St=>se.has(St.name)),It=[...K,...Fe].filter(St=>St.modeBased&&St.dimensionId);we(It.length>0)},[a.variables,a.formulas]),z.useEffect(()=>{(()=>{var Fe;const se=he.getTokens(),Re=Wa.findTokensByAlgorithm(a.id,se);N(Re),I(Re.length>0),Re.length>0&&!((Fe=a.tokenGeneration)!=null&&Fe.enabled)&&(l(De=>({...De,tokenGeneration:{enabled:!0,iterationRange:{start:-2,end:8,step:1},bulkAssignments:{resolvedValueTypeId:De.resolvedValueTypeId,taxonomies:[],tokenTier:"PRIMITIVE",private:!1,status:"stable",themeable:!1},logicalMapping:{scaleType:"numeric",defaultValue:"100",increasingStep:100,decreasingStep:25,extraPrefix:"X",incrementDirection:"ascending",taxonomyId:void 0,newTaxonomyName:void 0}}})),i({title:"Token Generation Auto-Enabled",description:`Found ${Re.length} existing tokens generated by this algorithm. Token generation has been enabled.`,status:"info",duration:5e3,isClosable:!0}))})()},[a.id,(Mt=a.tokenGeneration)==null?void 0:Mt.enabled,i]),z.useEffect(()=>{var K;if(E&&((K=a.tokenGeneration)!=null&&K.enabled)){const se=he.getTokens(),Re=Wa.calculateTokenValues(a,se);Z(Re)}},[a,E]),z.useEffect(()=>{var K;if(E&&((K=a.tokenGeneration)!=null&&K.enabled)){const se=setTimeout(()=>{const Re=he.getTokens(),Fe=Wa.analyzeFormulaDependencies(a,Re);J(Fe);const De=ae.length>0?Wa.calculateTokenValuesSelective(a,Re,ae):Wa.calculateTokenValues(a,Re);Z(De);const It=Array.from(De.values()).filter(Ft=>Ft.hasChanges);It.length>0&&i({title:"Formula Changes Detected",description:`${It.length} tokens have updated values based on formula changes.`,status:"info",duration:3e3,isClosable:!0}),ne([])},500);return()=>clearTimeout(se)}},[a.formulas,a.variables,a.steps,(dr=a.tokenGeneration)==null?void 0:dr.iterationRange,E,ae]);const jt=K=>{vt(K),l(se=>({...se,tokenGeneration:{...se.tokenGeneration,bulkAssignments:{...se.tokenGeneration.bulkAssignments,taxonomies:K}}}))},Bt=K=>{ne(se=>[...new Set([...se,K])])},qn=K=>{if(!K.destination)return;const se=Array.from(a.steps),[Re]=se.splice(K.source.index,1);se.splice(K.destination.index,0,Re),l(Fe=>({...Fe,steps:se}))},Fn=()=>{var Re;if(!((Re=u.name)!=null&&Re.trim())){i({title:"Error",description:"Please enter a variable name",status:"error",duration:3e3,isClosable:!0});return}const K={id:fi("variable"),name:u.name,type:u.type||"number",defaultValue:u.defaultValue||"",modeBased:u.modeBased,dimensionId:u.dimensionId,valuesByMode:u.valuesByMode||[]},se={...a,variables:[...a.variables,K]};l(se),h({name:"",type:"number",defaultValue:"",modeBased:!1,dimensionId:void 0,valuesByMode:[]}),Pe(`Added variable: ${K.name}`,"variable")},Ct=()=>{const K={id:fi("cond"),name:"",expression:"",variableIds:[]},se={...a,conditions:[...a.conditions||[],K]};l(se)},kn=()=>{if(!f.id||!f.name||!f.type){i({title:"Error",description:"Please select a formula or condition",status:"error",duration:3e3,isClosable:!0});return}const K={type:f.type,id:f.id,name:f.name};l(se=>({...se,steps:[...se.steps,K]})),p({type:"formula",id:"",name:""})},Ln=K=>{const se=a.variables.find(Fe=>Fe.id===K),Re={...a,variables:a.variables.filter(Fe=>Fe.id!==K)};l(Re),se&&Pe(`Deleted variable: ${se.name}`,"variable")},ee=K=>{l(se=>({...se,steps:se.steps.filter((Re,Fe)=>Fe!==K)}))},Ve=()=>{var K,se,Re,Fe,De,It,Ft;if(!((K=a.name)!=null&&K.trim())){i({title:"Error",description:"Please enter an algorithm name",status:"error",duration:3e3,isClosable:!0});return}for(const St of a.variables){if(!((se=St.name)!=null&&se.trim())){i({title:"Error",description:`Variable with ID "${St.id}" is missing a name`,status:"error",duration:3e3,isClosable:!0});return}if(!St.type){i({title:"Error",description:`Variable "${St.name}" is missing a type`,status:"error",duration:3e3,isClosable:!0});return}}for(const St of a.formulas||[])if(!((Re=St.name)!=null&&Re.trim())){i({title:"Error",description:`Formula with ID "${St.id}" is missing a name`,status:"error",duration:3e3,isClosable:!0});return}for(const St of a.conditions||[])if(!((Fe=St.name)!=null&&Fe.trim())){i({title:"Error",description:`Condition with ID "${St.id}" is missing a name`,status:"error",duration:3e3,isClosable:!0});return}if((De=a.tokenGeneration)!=null&&De.enabled&&!E){const{logicalMapping:St}=a.tokenGeneration;if(!(St.taxonomyId||((It=St.newTaxonomyName)==null?void 0:It.trim()))){i({title:"Token Generation Configuration Required",description:"Please configure the taxonomy settings in the Token Generation tab before saving.",status:"error",duration:5e3,isClosable:!0});return}const jn=a.variables&&a.variables.length>0,At=a.formulas&&a.formulas.length>0;if(!jn||!At){const Wn=[];jn||Wn.push("variables"),At||Wn.push("formulas"),i({title:"Algorithm Configuration Required",description:`Please add ${Wn.join(" and ")} before saving.`,status:"error",duration:5e3,isClosable:!0});return}}if(E&&Array.from(H.values()).some(St=>St.hasChanges)){G(!0);return}if((Ft=a.tokenGeneration)!=null&&Ft.enabled&&Se&&!E){ke(!0);return}Ie([])},Ie=(K,se)=>{var Fe;t(a);const Re={schemaVersion:"5.0.0",profile:"basic",metadata:{name:"Algorithm Collection",description:"Collection of algorithms for design token generation",version:"1.0.0"},config:{},algorithms:[a],execution:{order:[],parallel:!1,onError:"stop"},integration:{targetSchema:"https://designsystem.org/schemas/tokens/v1.0.0",outputFormat:"design-tokens",mergeStrategy:"merge",validation:!0},examples:[]};if(console.log("AlgorithmEditor: Saving algorithm in schema format:",{algorithmId:a.id,algorithmName:a.name,schemaData:Re,rawAlgorithm:a}),xe({...a}),Q(!1),Pe("Saved algorithm","general"),K.length>0)try{const It=he.getTokens().map(Ft=>{var St;if(K.includes(Ft.id)){const Un=H.get(Ft.id);if(Un&&Un.hasChanges)return{...Ft,valuesByMode:[{modeIds:((St=Ft.valuesByMode[0])==null?void 0:St.modeIds)||[],value:Un.calculatedValue}]}}return Ft});n(It),i({title:"Success",description:`Algorithm saved and ${K.length} tokens updated successfully!`,status:"success",duration:3e3,isClosable:!0})}catch(De){i({title:"Token Update Failed",description:`Algorithm saved but token updates failed: ${De}`,status:"error",duration:5e3,isClosable:!0})}else if((Fe=a.tokenGeneration)!=null&&Fe.enabled&&!E)try{const De=he.getTokens(),It=he.getCollections(),Ft=he.getTaxonomies(),{tokens:St,errors:Un,newTaxonomies:jn,updatedTaxonomies:At}=Wf.generateTokens(a,De,It,Ft,!0,se);if(console.log("AlgorithmEditor: Received from TokenGenerationService:",{tokensCount:St.length,errorsCount:Un.length,newTaxonomiesCount:(jn==null?void 0:jn.length)||0,updatedTaxonomiesCount:(At==null?void 0:At.length)||0,newTaxonomies:jn,updatedTaxonomies:At}),jn&&jn.length>0){const Wn=[...Ft,...jn];he.setTaxonomies(Wn),console.log("AlgorithmEditor: Saved new taxonomies:",jn)}if(At&&At.length>0){const Wn=Ft.map(Ui=>At.find(Ti=>Ti.id===Ui.id)||Ui);he.setTaxonomies(Wn),console.log("AlgorithmEditor: Saved updated taxonomies:",At)}if(Un.length>0&&i({title:"Token Generation Errors",description:`Generated ${St.length} tokens with ${Un.length} errors. Check the preview for details.`,status:"warning",duration:5e3,isClosable:!0}),St.length>0){const Wn=[...De,...St];n(Wn),console.log("new tokens",St),i({title:"Success",description:`Algorithm saved and ${St.length} tokens generated successfully!`,status:"success",duration:3e3,isClosable:!0})}}catch(De){i({title:"Token Generation Failed",description:`Algorithm saved but token generation failed: ${De}`,status:"error",duration:5e3,isClosable:!0})}else i({title:"Success",description:"Algorithm saved successfully!",status:"success",duration:3e3,isClosable:!0})},Ne=K=>{h(se=>({...se,type:K}))},ot=K=>{h(se=>({...se,defaultValue:K}))},Ke=K=>{y(K.id),A(K)},Et=()=>{var se;if(!((se=b.name)!=null&&se.trim())){i({title:"Error",description:"Please enter a variable name",status:"error",duration:3e3,isClosable:!0});return}if(!Je.test(b.name)){i({title:"Error",description:"Variable name must start with a letter or underscore and contain only letters, numbers, and underscores.",status:"error",duration:3e3,isClosable:!0});return}const K={...a,variables:a.variables.map(Re=>Re.id===g?{...Re,...b}:Re)};l(K),y(null),A({}),Pe(`Updated variable: ${b.name}`,"variable")},Ae=()=>{y(null),A({})},be=()=>{var Re;if(!((Re=a.tokenGeneration)!=null&&Re.enabled)){j([]),C([]);return}if(!nn){j([]),C([]);return}const K=a.variables&&a.variables.length>0,se=a.formulas&&a.formulas.length>0;if(!E&&(!K||!se)){j([]),C(["Please add variables and formulas before generating tokens."]);return}if(se){const Fe=new Set(a.variables.map(At=>At.name)),De=ar.getSystemVariables(),It=new Set(De.map(At=>At.name)),Ft=new Set([...Fe,...It]),St=[],Un=[];if(a.formulas.forEach(At=>{if(At.expressions.javascript.value){const Wn=At.expressions.javascript.value;Wn.includes("Math.pow(")&&Wn.includes("=")&&Un.push(`Formula "${At.name}" has invalid Math.pow syntax. Assignment cannot be done inside Math.pow().`),Wn.includes("(")&&!Wn.includes(")")&&Un.push(`Formula "${At.name}" has unmatched parentheses.`);const Wi=ri.convertFormulaToNames(Wn,a.variables).match(/\b[a-zA-Z_][a-zA-Z0-9_]*\b/g)||[],Ti=[...new Set(Wi)],Va=["Math","Array","Object","String","Number","Boolean","Date","RegExp","Function","undefined","null","true","false","NaN","Infinity"];Ti.filter(Rn=>!Va.includes(Rn)).forEach(Rn=>{Ft.has(Rn)||St.push(Rn)})}}),Un.length>0){j([]),C(Un);return}if(St.length>0){const At=[...new Set(St)];j([]),C([`The following variables are referenced in formulas but not defined: ${At.join(", ")}. Please add them in the Variables tab or ensure system variables are properly configured.`]);return}const jn=[];if(a.formulas.forEach(At=>{if(At.expressions.javascript.value){const Wn=At.expressions.javascript.value,Wi=ri.convertFormulaToNames(Wn,a.variables).match(/\b[a-zA-Z_][a-zA-Z0-9_]*\b/g)||[],Ti=[...new Set(Wi)],Va=["Math","Array","Object","String","Number","Boolean","Date","RegExp","Function","undefined","null","true","false","NaN","Infinity"],Zi=Ti.filter(Ms=>!Va.includes(Ms)),Rn=ri.getAllVariableMappings(a.variables),za=new Set;Zi.forEach(Ms=>{const Js=Rn.find(Yi=>Yi.name===Ms);Js&&za.add(Js.id)});const Oo=Array.from(za).filter(Ms=>!At.variableIds.includes(Ms));if(Oo.length>0){const Ms=Oo.map(Js=>{const Yi=Rn.find(xc=>xc.id===Js);return Yi?Yi.name:Js});jn.push(`Formula "${At.name}" references variables not listed in variableIds: ${Ms.join(", ")}`)}}}),jn.length>0){j([]),C(jn);return}}try{const Fe=he.getTokens(),De=he.getCollections(),It=he.getTaxonomies(),{tokens:Ft,errors:St}=Wf.generateTokens(a,Fe,De,It,!1,q);j(Ft),C(St)}catch(Fe){console.error("Preview generation error:",Fe),C([`Preview generation failed: ${Fe}`]),j([])}};z.useEffect(()=>{be()},[a,q,nn]),z.useEffect(()=>{var It,Ft;if(!((It=a.tokenGeneration)!=null&&It.enabled)){Ir(!1);return}const{logicalMapping:K}=a.tokenGeneration,se=K.taxonomyId||((Ft=K.newTaxonomyName)==null?void 0:Ft.trim()),Re=a.variables&&a.variables.length>0,Fe=a.formulas&&a.formulas.length>0;Ir(!!se&&(E?!0:Re&&Fe))},[(En=(ps=a.tokenGeneration)==null?void 0:ps.logicalMapping)==null?void 0:En.taxonomyId,(Ro=(Do=a.tokenGeneration)==null?void 0:Do.logicalMapping)==null?void 0:Ro.newTaxonomyName,(ji=a.tokenGeneration)==null?void 0:ji.enabled,a.variables,a.formulas,E]);const Oe=()=>{const K={id:fi("formula"),name:"",description:"",expressions:{latex:{value:""},javascript:{value:"",metadata:{allowedOperations:["math"]}},ast:{type:"literal",value:"",metadata:{astVersion:"1.0.0",validationErrors:[],complexity:"low"}}},variableIds:[]},se={...a,formulas:[...a.formulas||[],K]};l(se),Qr.saveToHistory(se,"Added new formula","formula")},Pe=(K,se)=>{Qr.saveToHistory(a,K,se)},qe=()=>{const K=Qr.undo(a.id);K?(l(K),i({title:"Undo Successful",description:"Algorithm reverted to previous state",status:"success",duration:3e3,isClosable:!0})):i({title:"Nothing to Undo",description:"No previous states available",status:"info",duration:3e3,isClosable:!0})},Qe=()=>{const K=Qr.redo(a.id);K?(l(K),i({title:"Redo Successful",description:"Algorithm restored to next state",status:"success",duration:3e3,isClosable:!0})):i({title:"Nothing to Redo",description:"No future states available",status:"info",duration:3e3,isClosable:!0})},je=(K,se)=>{let Re;switch(K){case"last-save":if(fe)Re={...fe};else{i({title:"Reset Failed",description:"No saved state available",status:"error",duration:3e3,isClosable:!0});return}break;case"specific-history":if(se)Re={...se.algorithm};else{i({title:"Reset Failed",description:"No history entry selected",status:"error",duration:3e3,isClosable:!0});return}break;case"original":Re=e?{...e}:tl,Qr.clearHistory(a.id);break;default:return}l(Re),xe(Re),Q(!1),i({title:"Reset Successful",description:`Algorithm reset to ${K.replace("-"," ")}`,status:"success",duration:3e3,isClosable:!0})},un=K=>{re(K),ke(!1),Ie([],K)},ur=Qr.canUndo(a.id),le=Qr.canRedo(a.id),Te=(K,se)=>{if(!se)return K;const Fe=he.getDimensions().find(It=>It.id===se);if(!Fe)return K;const De=Fe.modes.find(It=>It.id===K);return De?De.name:K},Je=/^[a-zA-Z_][a-zA-Z0-9_]*$/,et=u.name?Je.test(u.name):!1,gt=b.name?Je.test(b.name):!0;return s.jsx(Y,{children:s.jsxs(ye,{spacing:6,align:"stretch",children:[s.jsxs(ve,{justify:"space-between",align:"center",children:[s.jsx(B,{fontSize:"xl",fontWeight:"bold",children:"Algorithm Editor"}),s.jsxs(ve,{spacing:2,children:[s.jsx(mt,{"aria-label":"Undo",icon:s.jsx(hm,{size:16}),size:"sm",variant:"ghost",isDisabled:!ur,onClick:qe,title:ur?"Undo last change":"Nothing to undo"}),s.jsx(mt,{"aria-label":"Redo",icon:s.jsx(Y4,{size:16}),size:"sm",variant:"ghost",isDisabled:!le,onClick:Qe,title:le?"Redo last undone change":"Nothing to redo"}),s.jsx(mt,{"aria-label":"Reset Algorithm",icon:s.jsx(_l,{size:16}),size:"sm",variant:"ghost",colorScheme:"orange",onClick:()=>W(!0),title:"Reset algorithm to previous state"})]})]}),L&&s.jsx(Y,{p:2,bg:"orange.100",borderRadius:"md",borderWidth:1,borderColor:"orange.200",children:s.jsx(B,{fontSize:"sm",color:"orange.700",children:" You have unsaved changes"})}),s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsx(B,{fontSize:"lg",fontWeight:"bold",children:"Basic Information"}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Algorithm Name"}),s.jsx(ut,{placeholder:"Algorithm Name",value:a.name,onChange:K=>{l(se=>({...se,name:K.target.value})),Pe("Updated algorithm name","general")}})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(Np,{placeholder:"Description (optional)",value:a.description,onChange:K=>{l(se=>({...se,description:K.target.value})),Pe("Updated algorithm description","general")}})]})]}),s.jsx(Ss,{}),s.jsxs(Fi,{children:[s.jsxs(Li,{children:[s.jsx(Jn,{children:"Variables"}),s.jsx(Jn,{children:"Formulas"}),s.jsx(Jn,{children:"Conditions"}),s.jsx(Jn,{children:"Token Generation"}),s.jsx(Jn,{children:"Algorithm Steps"}),s.jsx(Jn,{children:"Preview"}),s.jsx(Jn,{children:"Dependency Visualization"})]}),s.jsxs(Ia,{children:[s.jsx(fr,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(ve,{spacing:4,justify:"start",children:[s.jsxs(Ge,{isRequired:!0,isInvalid:!!u.name&&!et,children:[s.jsx(Ue,{children:"Variable Name"}),s.jsx(ut,{placeholder:"Variable Name",value:u.name,onChange:K=>h(se=>({...se,name:K.target.value}))}),!et&&u.name&&s.jsx(B,{fontSize:"xs",color:"red.500",children:"Variable names must start with a letter or underscore and contain only letters, numbers, and underscores."})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Type"}),s.jsxs(Zt,{value:u.type,onChange:K=>Ne(K.target.value),children:[s.jsx("option",{value:"number",children:"Number"}),s.jsx("option",{value:"string",children:"String"}),s.jsx("option",{value:"boolean",children:"Boolean"})]})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Default Value"}),s.jsx(ut,{placeholder:"Default Value (optional)",value:((mn=u.defaultValue)==null?void 0:mn.toString())||"",onChange:K=>ot(K.target.value)})]}),s.jsx(Ee,{leftIcon:s.jsx(ts,{size:16}),flexShrink:0,onClick:Fn,isDisabled:!et,children:"Add Variable"})]}),u.name&&s.jsx(Wu,{variable:u,onVariableChange:K=>h(K),dimensions:he.getDimensions()}),s.jsx(ye,{spacing:2,align:"stretch",children:a.variables.map(K=>{var se;return s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",children:s.jsx(ve,{justify:"space-between",mb:2,children:g===K.id?s.jsxs(ye,{spacing:4,flex:1,align:"stretch",children:[s.jsxs(ve,{spacing:4,children:[s.jsxs(Ge,{isRequired:!0,isInvalid:!!b.name&&!gt,children:[s.jsx(Ue,{children:"Variable Name"}),s.jsx(ut,{placeholder:"Variable Name",value:b.name,onChange:Re=>A(Fe=>({...Fe,name:Re.target.value}))}),!gt&&b.name&&s.jsx(B,{fontSize:"xs",color:"red.500",children:"Variable names must start with a letter or underscore and contain only letters, numbers, and underscores."})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Type"}),s.jsxs(Zt,{value:b.type,onChange:Re=>A(Fe=>({...Fe,type:Re.target.value})),children:[s.jsx("option",{value:"number",children:"Number"}),s.jsx("option",{value:"string",children:"String"}),s.jsx("option",{value:"boolean",children:"Boolean"})]})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Default Value"}),s.jsx(ut,{placeholder:"Default Value (optional)",value:((se=b.defaultValue)==null?void 0:se.toString())||"",onChange:Re=>A(Fe=>({...Fe,defaultValue:Re.target.value}))})]})]}),s.jsx(Wu,{variable:b,onVariableChange:Re=>A(Re),dimensions:he.getDimensions()}),s.jsxs(ve,{spacing:2,children:[s.jsx(Ee,{size:"sm",colorScheme:"blue",onClick:Et,isDisabled:!gt,children:"Save"}),s.jsx(Ee,{size:"sm",onClick:Ae,children:"Cancel"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs(ye,{align:"start",flex:1,spacing:1,children:[s.jsxs(ve,{children:[s.jsx(pt,{colorScheme:"blue",children:K.name}),s.jsxs(B,{fontSize:"sm",color:"gray.500",children:["(",K.type,")"]}),K.defaultValue&&!K.modeBased&&s.jsxs(B,{fontSize:"sm",color:"gray.500",children:["= ",K.defaultValue]}),K.modeBased&&s.jsx(pt,{colorScheme:"green",size:"sm",children:"Mode-Based"})]}),K.modeBased&&K.valuesByMode&&K.valuesByMode.length>0&&s.jsxs(Y,{children:[s.jsx(B,{fontSize:"xs",color:"gray.500",mb:1,children:"Mode Values:"}),s.jsx(ve,{spacing:2,wrap:"wrap",children:K.valuesByMode.map(({modeIds:Re,value:Fe})=>s.jsxs(pt,{size:"sm",colorScheme:"purple",variant:"outline",children:[Te(Re[0],K.dimensionId),": ",Fe]},Re.join(", ")))})]})]}),s.jsxs(ve,{children:[s.jsx(mt,{"aria-label":"Edit variable",icon:s.jsx(Td,{size:16}),size:"sm",onClick:()=>Ke(K)}),s.jsx(mt,{"aria-label":"Delete variable",icon:s.jsx(ws,{size:16}),size:"sm",colorScheme:"red",onClick:()=>Ln(K.id)})]})]})})},K.id)})})]})}),s.jsx(fr,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsx(ve,{justify:"space-between",children:s.jsx(Ee,{size:"sm",leftIcon:s.jsx(ts,{size:16}),onClick:Oe,children:"Add Formula"})}),s.jsx(ye,{spacing:4,align:"stretch",children:(a.formulas||[]).map((K,se)=>s.jsx(Y,{p:4,borderWidth:1,borderRadius:"md",position:"relative",children:s.jsxs(ve,{spacing:4,align:"start",children:[s.jsxs(Y,{flex:1,children:[s.jsxs(ve,{spacing:4,align:"start",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Formula Name"}),s.jsx(ut,{placeholder:"Formula Name",value:K.name,onChange:Re=>{const Fe=[...a.formulas||[]];Fe[se]={...K,name:Re.target.value};const De={...a,formulas:Fe};l(De),Bt(K.id),Pe(`Updated formula name: ${Re.target.value}`,"formula")},mb:2})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{placeholder:"Description",value:K.description,onChange:Re=>{const Fe=[...a.formulas||[]];Fe[se]={...K,description:Re.target.value};const De={...a,formulas:Fe};l(De),Bt(K.id),Pe(`Updated formula description: ${Re.target.value}`,"formula")},mb:2})]})]}),K.expressions.latex.value&&s.jsxs(Y,{p:2,bg:r==="light"?"gray.50":"gray.700",borderRadius:"md",mb:2,fontSize:"sm",children:[s.jsx(B,{mb:-2,fontSize:"sm",color:"gray.500",children:"LaTeX preview:"}),s.jsx(Q8.BlockMath,{math:K.expressions.latex.value})]}),s.jsx(Hf,{variables:a.variables||[],value:K.expressions.javascript.value,mode:"formula",onChange:(Re,Fe,De)=>{const It=ri.convertFormulaToIds(Re,a.variables),Ft=ri.convertLatexToIds(Fe,a.variables),St=ri.convertASTToIds(De,a.variables),Un=[...a.formulas||[]];Un[se]={...K,expressions:{latex:{value:Ft},javascript:{value:It,metadata:{allowedOperations:["math"]}},ast:St}};const jn={...a,formulas:Un};l(jn),Bt(K.id),Pe(`Updated formula expression: ${K.name}`,"formula")}})]}),s.jsx(mt,{"aria-label":"Delete formula",icon:s.jsx(ws,{size:16}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>{const Re=(a.formulas||[]).filter(De=>De.id!==K.id),Fe={...a,formulas:Re};l(Fe),Pe(`Deleted formula: ${K.name}`,"formula")}})]})},K.id))})]})}),s.jsx(fr,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsx(ve,{justify:"space-between",children:s.jsx(Ee,{size:"sm",leftIcon:s.jsx(ts,{size:16}),onClick:Ct,children:"Add Condition"})}),s.jsx(ye,{spacing:4,align:"stretch",children:(a.conditions||[]).map((K,se)=>s.jsx(Y,{p:4,borderWidth:1,borderRadius:"md",position:"relative",children:s.jsxs(ve,{spacing:4,align:"start",children:[s.jsxs(Y,{flex:1,children:[s.jsx(ve,{spacing:4,align:"start",children:s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Condition Name"}),s.jsx(ut,{placeholder:"Condition Name",value:K.name,onChange:Re=>{const Fe=[...a.conditions||[]];Fe[se]={...K,name:Re.target.value};const De={...a,conditions:Fe};l(De)},mb:2})]})}),s.jsx(Hf,{variables:a.variables||[],value:K.expression,mode:"condition",onChange:Re=>{const Fe=[...a.conditions||[]];Fe[se]={...K,expression:Re};const De={...a,conditions:Fe};l(De)}})]}),s.jsx(mt,{"aria-label":"Delete condition",icon:s.jsx(ws,{size:16}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>{const Re=(a.conditions||[]).filter(De=>De.id!==K.id),Fe={...a,conditions:Re};l(Fe)}})]})},K.id))})]})}),s.jsx(fr,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(ve,{justify:"space-between",children:[s.jsx(B,{fontSize:"lg",fontWeight:"bold",children:"Token Generation Settings"}),s.jsx(Ee,{size:"sm",colorScheme:(v=a.tokenGeneration)!=null&&v.enabled?"green":"gray",onClick:()=>{var se;const K=!((se=a.tokenGeneration)!=null&&se.enabled);l(Re=>({...Re,tokenGeneration:K?{enabled:!0,iterationRange:{start:-2,end:8,step:1},bulkAssignments:{resolvedValueTypeId:on.length>0?on[0].id:"color",taxonomies:[],tokenTier:"PRIMITIVE",private:!1,status:"stable",themeable:!1},logicalMapping:{scaleType:"numeric",defaultValue:"100",increasingStep:100,decreasingStep:25,extraPrefix:"X",incrementDirection:"ascending",taxonomyId:void 0,newTaxonomyName:void 0}}:void 0}))},children:(k=a.tokenGeneration)!=null&&k.enabled?"Enabled":"Enable Token Generation"})]}),Se&&((_e=a.tokenGeneration)==null?void 0:_e.enabled)&&s.jsxs(Y,{p:4,borderWidth:1,borderRadius:"md",bg:r==="light"?"blue.50":"blue.900",children:[s.jsxs(ve,{justify:"space-between",mb:3,children:[s.jsx(B,{fontWeight:"bold",color:"blue.600",children:"Mode-Based Variables Detected"}),s.jsx(pt,{colorScheme:"blue",children:"Mode Selection Required"})]}),s.jsx(B,{fontSize:"sm",color:"gray.600",mb:3,children:"Your algorithm contains variables with mode-specific values. When you save, you'll be prompted to select which modes to generate tokens for."}),Object.keys(q).length>0&&s.jsxs(Y,{children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Selected Modes:"}),s.jsx(ye,{spacing:1,align:"stretch",children:Object.entries(q).map(([K,se])=>{const Re=he.getDimensions().find(Fe=>Fe.id===K);return s.jsxs(ve,{spacing:2,children:[s.jsx(pt,{size:"sm",colorScheme:"green",children:(Re==null?void 0:Re.displayName)||K}),s.jsxs(B,{fontSize:"xs",color:"gray.500",children:[se.length," mode",se.length!==1?"s":""," selected"]})]},K)})})]})]}),E&&s.jsxs(Y,{p:4,borderWidth:1,borderRadius:"md",bg:r==="light"?"blue.50":"blue.900",children:[s.jsxs(ve,{justify:"space-between",mb:3,children:[s.jsxs(B,{fontWeight:"bold",color:"blue.600",children:["Existing Tokens (",_.length,")"]}),s.jsx(pt,{colorScheme:"blue",children:"Algorithm-Generated"})]}),s.jsxs(B,{fontSize:"sm",color:"gray.600",mb:3,children:["This algorithm has generated ",_.length," tokens. Token generation settings are simplified to focus on formula-driven updates."]}),s.jsx(ye,{spacing:2,align:"stretch",maxH:"300px",overflowY:"auto",children:_.map(K=>{var De;const se=H.get(K.id),Re=on.find(It=>It.id===K.resolvedValueTypeId),Fe=F.filter(It=>It.affectedTokens.includes(K.id)).map(It=>It.formulaName);return s.jsxs(ve,{p:2,borderWidth:1,borderRadius:"md",bg:r==="light"?"white":"gray.700",children:[s.jsxs(ye,{align:"start",flex:1,spacing:1,children:[s.jsx(B,{fontWeight:"medium",fontSize:"sm",children:K.displayName}),s.jsxs(ve,{spacing:2,children:[s.jsx(pt,{size:"sm",colorScheme:"gray",children:(Re==null?void 0:Re.displayName)||"Unknown Type"}),se&&s.jsx(pt,{size:"sm",colorScheme:se.hasChanges?"orange":"green",children:se.hasChanges?"Has Changes":"Up to Date"}),se&&s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["Iteration: ",se.iterationValue]})]}),Fe.length>0&&s.jsxs(B,{fontSize:"xs",color:"blue.500",children:["Affected by: ",Fe.join(", ")]})]}),s.jsxs(ye,{align:"end",spacing:1,children:[s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["Current: ",(De=K.valuesByMode[0])!=null&&De.value&&"value"in K.valuesByMode[0].value?K.valuesByMode[0].value.value:"N/A"]}),se&&se.hasChanges&&s.jsxs(B,{fontSize:"xs",color:"orange.500",children:["New: ",se.calculatedValue&&"value"in se.calculatedValue?se.calculatedValue.value:"N/A"]})]})]},K.id)})})]}),((M=a.tokenGeneration)==null?void 0:M.enabled)&&s.jsxs(ye,{spacing:6,align:"stretch",children:[s.jsxs(Y,{p:4,borderWidth:1,borderRadius:"md",children:[s.jsx(B,{fontWeight:"bold",mb:3,children:"Iteration Range"}),s.jsxs(ve,{spacing:4,children:[s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Start"}),s.jsx(ut,{type:"number",value:a.tokenGeneration.iterationRange.start,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,iterationRange:{...se.tokenGeneration.iterationRange,start:parseInt(K.target.value)||0}}}))}})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"End"}),s.jsx(ut,{type:"number",value:a.tokenGeneration.iterationRange.end,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,iterationRange:{...se.tokenGeneration.iterationRange,end:parseInt(K.target.value)||0}}}))}})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Step"}),s.jsx(ut,{type:"number",value:a.tokenGeneration.iterationRange.step,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,iterationRange:{...se.tokenGeneration.iterationRange,step:parseInt(K.target.value)||1}}}))}})]})]})]}),!E&&s.jsxs(s.Fragment,{children:[s.jsxs(Y,{p:4,borderWidth:1,borderRadius:"md",children:[s.jsx(B,{fontWeight:"bold",mb:3,children:"Bulk Assignments"}),s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Resolved Value Type"}),s.jsx(Zt,{value:a.tokenGeneration.bulkAssignments.resolvedValueTypeId,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,bulkAssignments:{...se.tokenGeneration.bulkAssignments,resolvedValueTypeId:K.target.value}}}))},children:on.map(K=>s.jsx("option",{value:K.id,children:K.displayName},K.id))})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Token Tier"}),s.jsxs(Zt,{value:a.tokenGeneration.bulkAssignments.tokenTier,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,bulkAssignments:{...se.tokenGeneration.bulkAssignments,tokenTier:K.target.value}}}))},children:[s.jsx("option",{value:"PRIMITIVE",children:"Primitive"}),s.jsx("option",{value:"SEMANTIC",children:"Semantic"}),s.jsx("option",{value:"COMPONENT",children:"Component"})]})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Status"}),s.jsxs(Zt,{value:a.tokenGeneration.bulkAssignments.status,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,bulkAssignments:{...se.tokenGeneration.bulkAssignments,status:K.target.value}}}))},children:[s.jsx("option",{value:"",children:"None"}),s.jsx("option",{value:"experimental",children:"Experimental"}),s.jsx("option",{value:"stable",children:"Stable"}),s.jsx("option",{value:"deprecated",children:"Deprecated"})]})]}),s.jsxs(ye,{spacing:3,align:"stretch",children:[s.jsx(Tn,{isChecked:a.tokenGeneration.bulkAssignments.private,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,bulkAssignments:{...se.tokenGeneration.bulkAssignments,private:K.target.checked}}}))},children:"Private"}),s.jsx(Tn,{isChecked:a.tokenGeneration.bulkAssignments.themeable,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,bulkAssignments:{...se.tokenGeneration.bulkAssignments,themeable:K.target.checked}}}))},children:"Themeable"})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Taxonomies"}),s.jsxs(ye,{spacing:2,align:"stretch",children:[s.jsx(B,{fontSize:"sm",color:"gray.600",children:"Select taxonomies for logical term assignment. Terms will be automatically mapped based on the logical mapping settings."}),s.jsx(o1,{taxonomies:Ce,value:ft,onChange:jt,disabled:Ce.length===0}),Ce.length===0&&s.jsx(Y,{p:3,bg:r==="light"?"gray.50":"gray.700",borderRadius:"md",children:s.jsx(B,{fontSize:"sm",color:"gray.500",children:(()=>{var Re,Fe;const K=he.getTaxonomies(),se=(Fe=(Re=a.tokenGeneration)==null?void 0:Re.bulkAssignments)==null?void 0:Fe.resolvedValueTypeId;return K.length===0?"No taxonomies have been created yet. Please create taxonomies in the Classification setup first.":se&&K.filter(It=>Array.isArray(It.resolvedValueTypeIds)&&It.resolvedValueTypeIds.includes(se)).length===0?`No taxonomies support the "${se}" value type. Please select a different value type (like "color" or "spacing") or create a taxonomy that supports "${se}".`:"No taxonomies available for this value type. Please select a different value type or add taxonomies for this type."})()})})]})]})]})]}),s.jsxs(Y,{p:4,borderWidth:1,borderRadius:"md",children:[s.jsx(B,{fontWeight:"bold",mb:3,children:"Logical Mapping"}),s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Scale Type"}),s.jsxs(Zt,{value:a.tokenGeneration.logicalMapping.scaleType,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,logicalMapping:{...se.tokenGeneration.logicalMapping,scaleType:K.target.value}}}))},children:[s.jsx("option",{value:"numeric",children:"Numeric"}),s.jsx("option",{value:"tshirt",children:"T-Shirt Sizing"})]})]}),s.jsxs(Ge,{isRequired:!nn,children:[s.jsxs(Ue,{children:["Taxonomy for Scale Terms",!nn&&s.jsx(B,{as:"span",color:"red.500",children:" *"})]}),s.jsxs(ye,{spacing:3,align:"stretch",children:[s.jsx(B,{fontSize:"sm",color:"gray.600",children:"Choose an existing taxonomy or create a new one for the scale terms. This is required for token generation."}),s.jsxs(Zt,{value:a.tokenGeneration.logicalMapping.taxonomyId||"",onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,logicalMapping:{...se.tokenGeneration.logicalMapping,taxonomyId:K.target.value||void 0,newTaxonomyName:K.target.value?void 0:se.tokenGeneration.logicalMapping.newTaxonomyName}}}))},children:[s.jsx("option",{value:"",children:"Create new taxonomy"}),Ce.map(K=>s.jsx("option",{value:K.id,children:K.name},K.id))]}),!a.tokenGeneration.logicalMapping.taxonomyId&&s.jsxs(Ge,{isRequired:!nn,children:[s.jsxs(Ue,{children:["New Taxonomy Name",!nn&&s.jsx(B,{as:"span",color:"red.500",children:" *"})]}),s.jsx(ut,{placeholder:"Enter taxonomy name (e.g., 'Scale Terms', 'Size Categories')",value:a.tokenGeneration.logicalMapping.newTaxonomyName||"",onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,logicalMapping:{...se.tokenGeneration.logicalMapping,newTaxonomyName:K.target.value}}}))}}),s.jsx(B,{fontSize:"xs",color:"gray.500",mt:1,children:"Provide a descriptive name for the new taxonomy that will contain the scale terms."})]}),!nn&&s.jsxs(Y,{p:3,bg:"orange.50",borderRadius:"md",borderWidth:1,borderColor:"orange.200",children:[s.jsx(B,{fontSize:"sm",color:"orange.700",mb:2,children:" Please complete the following to enable token generation preview:"}),s.jsxs(ye,{spacing:1,align:"start",children:[!((dn=($=a.tokenGeneration)==null?void 0:$.logicalMapping)!=null&&dn.taxonomyId)&&!((Ns=(Qn=(Ze=a.tokenGeneration)==null?void 0:Ze.logicalMapping)==null?void 0:Qn.newTaxonomyName)!=null&&Ns.trim())&&s.jsx(B,{fontSize:"xs",color:"orange.600",children:" Configure taxonomy settings above"}),!E&&a.variables.length===0&&s.jsx(B,{fontSize:"xs",color:"orange.600",children:" Add variables in the Variables tab"}),!E&&a.formulas.length===0&&s.jsx(B,{fontSize:"xs",color:"orange.600",children:" Add formulas in the Formulas tab"})]})]})]})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Default Value"}),s.jsx(ut,{value:a.tokenGeneration.logicalMapping.defaultValue,onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,logicalMapping:{...se.tokenGeneration.logicalMapping,defaultValue:K.target.value}}}))}})]}),a.tokenGeneration.logicalMapping.scaleType==="numeric"&&s.jsxs(s.Fragment,{children:[s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Steps (Increasing)"}),s.jsx(ut,{type:"number",placeholder:"100",value:a.tokenGeneration.logicalMapping.increasingStep||"",onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,logicalMapping:{...se.tokenGeneration.logicalMapping,increasingStep:parseInt(K.target.value)||void 0}}}))}})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Steps (Decreasing)"}),s.jsx(ut,{type:"number",placeholder:"25",value:a.tokenGeneration.logicalMapping.decreasingStep||"",onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,logicalMapping:{...se.tokenGeneration.logicalMapping,decreasingStep:parseInt(K.target.value)||void 0}}}))}})]})]}),a.tokenGeneration.logicalMapping.scaleType==="tshirt"&&s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Prefix for Extra Sizes"}),s.jsxs(Zt,{value:a.tokenGeneration.logicalMapping.extraPrefix||"X",onChange:K=>{l(se=>({...se,tokenGeneration:{...se.tokenGeneration,logicalMapping:{...se.tokenGeneration.logicalMapping,extraPrefix:K.target.value}}}))},children:[s.jsx("option",{value:"X",children:"X (X-Small, X-Large)"}),s.jsx("option",{value:"extra",children:"extra (extra-small, extra-large)"})]})]})]})]})]})]})]})}),s.jsx(fr,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(ve,{spacing:4,children:[s.jsxs(Zt,{value:f.type,onChange:K=>p(se=>({...se,type:K.target.value})),children:[s.jsx("option",{value:"formula",children:"Formula"}),s.jsx("option",{value:"condition",children:"Condition"})]}),s.jsxs(Zt,{value:f.id,onChange:K=>{const Re=(f.type==="formula"?a.formulas:a.conditions).find(Fe=>Fe.id===K.target.value);p(Fe=>({...Fe,id:K.target.value,name:(Re==null?void 0:Re.name)||""}))},children:[s.jsxs("option",{value:"",children:["Select ",f.type==="formula"?"Formula":"Condition"]}),(f.type==="formula"?a.formulas:a.conditions).map(K=>s.jsx("option",{value:K.id,children:K.name},K.id))]}),s.jsx(Ee,{leftIcon:s.jsx(ts,{size:16}),onClick:kn,children:"Add Step"})]}),s.jsx(Y,{p:4,bg:r==="dark"?"gray.800":"gray.50",borderRadius:"md",children:s.jsx(ac,{onDragEnd:qn,children:s.jsx(oc,{droppableId:"algorithm-steps",children:K=>s.jsxs(ye,{...K.droppableProps,ref:K.innerRef,spacing:2,align:"stretch",children:[a.steps.map((se,Re)=>{const Fe=se.type==="formula"?a.formulas.find(De=>De.id===se.id):a.conditions.find(De=>De.id===se.id);return s.jsx(go,{draggableId:`${se.type}_${se.id}_${Re}`,index:Re,children:(De,It)=>s.jsxs(ve,{ref:De.innerRef,...De.draggableProps,...De.dragHandleProps,p:2,bg:r==="dark"?"gray.700":"white",borderRadius:"md",boxShadow:It.isDragging?"md":"sm",borderWidth:1,borderColor:r==="dark"?"gray.600":"gray.200",justify:"space-between",children:[s.jsxs(ve,{children:[s.jsx(Y,{cursor:"grab",children:s.jsx($u,{size:16})}),s.jsx(pt,{colorScheme:se.type==="formula"?"purple":"green",children:se.type==="formula"?"Formula":"Condition"}),s.jsx(B,{children:Fe==null?void 0:Fe.name})]}),s.jsx(mt,{"aria-label":"Delete step",icon:s.jsx(ws,{size:16}),size:"sm",colorScheme:"red",onClick:()=>ee(Re)})]})},`${se.type}_${se.id}_${Re}`)}),K.placeholder]})})})})]})}),s.jsx(fr,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Y,{p:4,bg:r==="light"?"gray.50":"gray.800",borderRadius:"md",fontSize:"sm",fontFamily:"mono",overflowX:"auto",children:[s.jsx(B,{fontWeight:"bold",mb:2,children:"Algorithm JSON Preview"}),s.jsx("pre",{style:{margin:0},children:JSON.stringify(a,null,2)})]}),((ht=a.tokenGeneration)==null?void 0:ht.enabled)&&s.jsxs(Y,{p:4,bg:r==="light"?"gray.50":"gray.800",borderRadius:"md",fontSize:"sm",fontFamily:"mono",overflowX:"auto",children:[s.jsx(B,{fontWeight:"bold",mb:2,children:"Generated Tokens Preview"}),!nn&&s.jsxs(Y,{mb:3,p:3,bg:"orange.100",borderRadius:"md",children:[s.jsx(B,{fontWeight:"bold",color:"orange.600",children:"Configuration Required"}),s.jsxs(ye,{spacing:1,align:"start",mt:2,children:[!((hr=(Nn=a.tokenGeneration)==null?void 0:Nn.logicalMapping)!=null&&hr.taxonomyId)&&!((Lr=(U=(Ci=a.tokenGeneration)==null?void 0:Ci.logicalMapping)==null?void 0:U.newTaxonomyName)!=null&&Lr.trim())&&s.jsx(B,{color:"orange.600",fontSize:"xs",children:" Configure taxonomy settings in the Token Generation tab"}),!E&&a.variables.length===0&&s.jsx(B,{color:"orange.600",fontSize:"xs",children:" Add variables in the Variables tab"}),!E&&a.formulas.length===0&&s.jsx(B,{color:"orange.600",fontSize:"xs",children:" Add formulas in the Formulas tab"})]})]}),w.length>0&&s.jsxs(Y,{mb:3,p:3,bg:"red.100",borderRadius:"md",children:[s.jsx(B,{fontWeight:"bold",color:"red.600",children:"Generation Errors:"}),w.map((K,se)=>s.jsxs(B,{color:"red.600",fontSize:"xs",children:[" ",K]},se))]}),D.length>0&&s.jsxs(Y,{children:[s.jsxs(B,{mb:2,fontSize:"sm",color:"gray.500",children:[D.length," tokens will be generated:"]}),s.jsxs(ye,{spacing:2,align:"stretch",children:[D.slice(0,10).map((K,se)=>{var Re,Fe;return s.jsxs(Y,{p:2,bg:"white",borderRadius:"sm",borderWidth:1,children:[s.jsx(B,{fontSize:"xs",fontWeight:"bold",children:K.id}),s.jsx(B,{fontSize:"xs",color:"gray.600",children:K.displayName}),s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["Value: ",(Re=K.valuesByMode[0])!=null&&Re.value&&"value"in K.valuesByMode[0].value?K.valuesByMode[0].value.value:"N/A"]}),((Fe=K.valuesByMode[0])==null?void 0:Fe.modeIds)&&K.valuesByMode[0].modeIds.length>0&&s.jsxs(B,{fontSize:"xs",color:"blue.500",children:["Modes: ",K.valuesByMode[0].modeIds.join(", ")]})]},se)}),D.length>10&&s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["... and ",D.length-10," more tokens"]})]})]}),D.length===0&&w.length===0&&nn&&s.jsx(B,{fontSize:"sm",color:"gray.500",children:"No tokens will be generated. Check your algorithm configuration and iteration range settings."})]})]})}),s.jsx(fr,{children:s.jsxs(ye,{spacing:6,align:"stretch",children:[s.jsx(r9,{algorithm:a,showValidation:!0,showExecutionTrace:!1}),s.jsx(s9,{algorithm:a,onExecutionComplete:K=>{console.log("Execution completed:",K)}})]})})]})]}),s.jsx(Ee,{leftIcon:s.jsx(Cd,{size:16}),colorScheme:"blue",onClick:Ve,size:"lg",children:(te=a.tokenGeneration)!=null&&te.enabled?"Save and Run":"Save Algorithm"}),s.jsx(t9,{isOpen:pe,onClose:()=>G(!1),onSave:Ie,algorithm:a,tokenCalculationStates:H,existingTokens:_,resolvedValueTypes:on}),s.jsx(n9,{isOpen:ge,onClose:()=>W(!1),onReset:je,algorithm:a,hasUnsavedChanges:L}),s.jsx(i9,{isOpen:ue,onClose:()=>ke(!1),onConfirm:un,algorithm:a})]})})},o9=({algorithms:e,onUpdate:t,onUpdateTokens:n})=>{const{colorMode:r}=tn(),i=Hn(),[a,l]=z.useState(!1),[u,h]=z.useState();console.log("[AlgorithmsView] Received",e.length,"algorithms");const f=y=>{const b=u?e.map(A=>A.id===y.id?y:A):[...e,y];t(b),l(!1),h(void 0),i({title:"Success",description:`Algorithm ${u?"updated":"created"} successfully`,status:"success",duration:3e3,isClosable:!0})},p=y=>{const b=e.filter(A=>A.id!==y);t(b),i({title:"Success",description:"Algorithm deleted successfully",status:"success",duration:3e3,isClosable:!0})},g=y=>{h(y),l(!0)};return s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"Algorithms"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:r==="dark"?"gray.900":"white",children:[s.jsx(Ee,{leftIcon:s.jsx(ds,{}),colorScheme:"blue",size:"sm",mb:4,onClick:()=>{h(void 0),l(!0)},children:"New Algorithm"}),s.jsx(ye,{align:"stretch",spacing:2,children:e.map(y=>s.jsx(Y,{p:4,bg:r==="dark"?"gray.800":"gray.50",borderRadius:"md",borderWidth:1,borderColor:r==="dark"?"gray.600":"gray.200",children:s.jsxs(ye,{align:"stretch",spacing:2,children:[s.jsxs(ve,{justify:"space-between",children:[s.jsx(Aa,{title:y.name,cardType:"algorithm"}),s.jsxs(ve,{children:[s.jsx(mt,{"aria-label":"Edit algorithm",icon:s.jsx(Is,{}),size:"sm",onClick:()=>g(y)}),s.jsx(mt,{"aria-label":"Delete algorithm",icon:s.jsx(hs,{}),size:"sm",colorScheme:"red",onClick:()=>p(y.id)})]})]}),y.description&&s.jsx(B,{color:"gray.500",children:y.description}),s.jsxs(B,{fontSize:"sm",children:[y.variables.length," variables  ",y.formulas.length," formulas  ",y.conditions.length," conditions  ",y.steps.length," steps"]})]})},y.id))}),s.jsxs(zn,{isOpen:a,onClose:()=>l(!1),size:"6xl",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:u?"Edit Algorithm":"New Algorithm"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsx(a9,{algorithm:u,onSave:f,onUpdateTokens:n})})]})]})]})]})};function l9({platform:e,open:t,onClose:n,onSave:r,isNew:i=!1}){var g,y,b,A,D,j,w;const[a,l]=z.useState(()=>{var C,_,N,E,I;return{...e,syntaxPatterns:{prefix:((C=e.syntaxPatterns)==null?void 0:C.prefix)??"",suffix:((_=e.syntaxPatterns)==null?void 0:_.suffix)??"",delimiter:((N=e.syntaxPatterns)==null?void 0:N.delimiter)??"_",capitalization:((E=e.syntaxPatterns)==null?void 0:E.capitalization)??"none",formatString:((I=e.syntaxPatterns)==null?void 0:I.formatString)??""}}}),{colorMode:u}=tn(),h=z.useMemo(()=>{const C={taxonomies:[{taxonomyId:"mock1",termId:"mock1"},{taxonomyId:"mock2",termId:"mock2"},{taxonomyId:"mock3",termId:"mock3"}]},_={namingRules:{taxonomyOrder:["mock1","mock2","mock3"]},taxonomies:[{id:"mock1",terms:[{id:"mock1",name:"primary"}]},{id:"mock2",terms:[{id:"mock2",name:"color"}]},{id:"mock3",terms:[{id:"mock3",name:"background"}]}],platforms:[{id:"preview",syntaxPatterns:a.syntaxPatterns}]};return ua.generateCodeSyntax(C,"preview",_)},[a.syntaxPatterns]),f=!a.displayName||((g=a.syntaxPatterns)==null?void 0:g.delimiter)===void 0||!((y=a.syntaxPatterns)!=null&&y.capitalization),p=C=>{C.preventDefault(),r(a),n()};return s.jsxs(zn,{isOpen:t,onClose:n,size:"xl",children:[s.jsx(vn,{}),s.jsxs(Pn,{maxW:"900px",children:[s.jsxs(wn,{children:[i?"Create Platform":`Edit Platform: ${a.displayName}`,s.jsx(B,{fontSize:"xs",color:"gray.500",mt:1,fontFamily:"mono",wordBreak:"break-all",children:a.id})]}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsx(B,{fontSize:"lg",fontWeight:"bold",mb:2,children:"Basic Information"}),s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:u==="dark"?"gray.800":"gray.50",borderColor:u==="dark"?"gray.600":"gray.200",children:s.jsxs(ye,{spacing:3,align:"stretch",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Display Name"}),s.jsx(ut,{value:a.displayName,onChange:C=>l(_=>({..._,displayName:C.target.value}))})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{value:a.description||"",onChange:C=>l(_=>({..._,description:C.target.value}))})]})]})}),s.jsx(B,{fontSize:"lg",fontWeight:"bold",mb:2,children:"Syntax Patterns"}),s.jsxs(Y,{p:3,borderWidth:1,borderRadius:"md",bg:u==="dark"?"gray.800":"gray.50",borderColor:u==="dark"?"gray.600":"gray.200",children:[s.jsxs(ve,{spacing:4,align:"flex-end",children:[s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Prefix"}),s.jsx(ut,{value:((b=a.syntaxPatterns)==null?void 0:b.prefix)??"",onChange:C=>l(_=>({..._,syntaxPatterns:{..._.syntaxPatterns,prefix:C.target.value}})),placeholder:"e.g., TKN_"})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Suffix"}),s.jsx(ut,{value:((A=a.syntaxPatterns)==null?void 0:A.suffix)??"",onChange:C=>l(_=>({..._,syntaxPatterns:{..._.syntaxPatterns,suffix:C.target.value}})),placeholder:"e.g., _SUF"})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Delimiter"}),s.jsxs(Zt,{value:((D=a.syntaxPatterns)==null?void 0:D.delimiter)??"_",onChange:C=>l(_=>({..._,syntaxPatterns:{..._.syntaxPatterns,delimiter:C.target.value}})),children:[s.jsx("option",{value:"",children:"None (no delimiter)"}),s.jsx("option",{value:"_",children:"Underscore (_)"}),s.jsx("option",{value:"-",children:"Hyphen (-)"}),s.jsx("option",{value:".",children:"Dot (.)"}),s.jsx("option",{value:"/",children:"Forward slash (/)"})]})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Capitalization"}),s.jsxs(Zt,{value:((j=a.syntaxPatterns)==null?void 0:j.capitalization)??"none",onChange:C=>l(_=>({..._,syntaxPatterns:{..._.syntaxPatterns,capitalization:C.target.value}})),children:[s.jsx("option",{value:"none",children:"None"}),s.jsx("option",{value:"uppercase",children:"UPPERCASE"}),s.jsx("option",{value:"lowercase",children:"lowercase"}),s.jsx("option",{value:"capitalize",children:"Capitalize"})]})]})]}),s.jsxs(ye,{spacing:3,align:"stretch",mt:4,children:[s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Format String"}),s.jsx(ut,{value:((w=a.syntaxPatterns)==null?void 0:w.formatString)??"",onChange:C=>l(_=>({..._,syntaxPatterns:{..._.syntaxPatterns,formatString:C.target.value}})),placeholder:"e.g., {prefix}{name}{suffix}",width:"100%"})]}),s.jsxs(Y,{mt:2,p:3,borderWidth:1,borderRadius:"md",bg:u==="dark"?"gray.700":"gray.100",children:[s.jsx(B,{fontSize:"sm",color:"gray.500",mb:1,fontWeight:"bold",children:"Preview"}),s.jsx(B,{fontFamily:"mono",fontSize:"md",wordBreak:"break-all",children:h})]})]})]})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:n,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:p,disabled:f,children:i?"Create Platform":"Save"})]})]})]})}const c9=({platforms:e,setPlatforms:t,tokens:n,setTokens:r,taxonomies:i})=>{const{colorMode:a}=tn(),[l,u]=z.useState(null),[h,f]=z.useState(!1),[p,g]=z.useState(!1),y=Ah("gray.50","gray.800"),b=Ah("gray.200","gray.600"),A=Hn(),D=N=>{var L;const E=he.getCollections(),I=he.getDimensions(),H=he.getTokens(),Z=he.getTaxonomies(),ae=he.getValueTypes(),ne=JSON.parse(localStorage.getItem("token-model:root")||"{}"),{systemName:F="Design System",systemId:J="design-system",version:pe="1.0.0",versionHistory:G=[]}=ne,ge={systemName:F,systemId:J,tokenCollections:E,dimensions:I,tokens:H,platforms:N,taxonomies:Z,resolvedValueTypes:ae,version:pe,versionHistory:G},W=mr.validateData(ge);return W.isValid?(t(N),!0):(A({title:"Schema Validation Failed",description:((L=W.errors)==null?void 0:L.map(Q=>Q.message).join(`
`))||"Your change would make the data invalid. See the Validation tab for details.",status:"error",duration:5e3,isClosable:!0}),!1)},j=N=>{const E=e.find(H=>H.id===N),I=e.filter(H=>H.id!==N);D(I)&&A({title:"Platform Deleted",description:`Successfully deleted platform "${E==null?void 0:E.displayName}"`,status:"info",duration:3e3,isClosable:!0})},w=N=>{u(N),f(!0),g(!1)},C=()=>{u({id:Vr("platform"),displayName:"",description:"",syntaxPatterns:{prefix:"",suffix:"",delimiter:"_",capitalization:"none",formatString:""}}),f(!0),g(!0)},_=N=>{let E;if(p){const Z=N.displayName.trim().replace(/\s+/g,"_").toLowerCase()||`platform_${Date.now()}`;E=[...e,{...N,id:Z}]}else E=e.map(Z=>Z.id===N.id?N:Z);if(!D(E))return;const I={platforms:E,taxonomies:i},H=n.map(Z=>{const ae=E.map(ne=>({platformId:ne.id,formattedName:ua.generateCodeSyntax(Z,ne.id,I)}));return{...Z,codeSyntax:ae}});r(H),f(!1),u(null),g(!1)};return s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"Platforms"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:a==="dark"?"gray.900":"white",children:[s.jsx(Ee,{size:"sm",leftIcon:s.jsx(ds,{}),onClick:C,colorScheme:"blue",mb:4,children:"Add Platform"}),s.jsx(ye,{align:"stretch",spacing:3,children:e.map(N=>{const E=N.syntaxPatterns||{};return s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:y,borderColor:b,children:s.jsxs(ve,{justify:"space-between",align:"flex-start",children:[s.jsxs(Y,{flex:1,minW:0,children:[s.jsx(B,{fontSize:"lg",fontWeight:"medium",children:N.displayName}),N.description&&s.jsx(B,{fontSize:"sm",color:"gray.500",children:N.description}),s.jsxs(Y,{mt:2,children:[s.jsx(B,{fontWeight:"bold",fontSize:"sm",mb:1,children:"Syntax Patterns"}),s.jsxs(ve,{spacing:4,wrap:"wrap",children:[s.jsxs(B,{fontSize:"sm",children:[s.jsx("b",{children:"Prefix:"})," ",E.prefix||s.jsx("span",{style:{color:"#888"},children:"none"})]}),s.jsxs(B,{fontSize:"sm",children:[s.jsx("b",{children:"Suffix:"})," ",E.suffix||s.jsx("span",{style:{color:"#888"},children:"none"})]}),s.jsxs(B,{fontSize:"sm",children:[s.jsx("b",{children:"Delimiter:"})," ",E.delimiter||s.jsx("span",{style:{color:"#888"},children:"none"})]}),s.jsxs(B,{fontSize:"sm",children:[s.jsx("b",{children:"Capitalization:"})," ",E.capitalization||s.jsx("span",{style:{color:"#888"},children:"none"})]}),s.jsxs(B,{fontSize:"sm",children:[s.jsx("b",{children:"Format String:"})," ",E.formatString||s.jsx("span",{style:{color:"#888"},children:"none"})]})]})]})]}),s.jsxs(ve,{spacing:2,align:"flex-start",children:[s.jsx(er,{label:"Edit Platform",children:s.jsx(mt,{"aria-label":"Edit platform",icon:s.jsx(Is,{}),size:"sm",onClick:()=>w(N)})}),s.jsx(er,{label:"Delete Platform",children:s.jsx(mt,{"aria-label":"Delete platform",colorScheme:"red",size:"sm",icon:s.jsx(hs,{}),onClick:()=>j(N.id)})})]})]})},N.id)})})]}),l&&s.jsx(l9,{platform:l,open:h,onClose:()=>{f(!1),u(null),g(!1)},onSave:_,isNew:p})]})};function Zf(){const e=he.getCollections(),t=he.getTokens(),n=he.getDimensions(),r=he.getPlatforms(),i=he.getThemes(),a=he.getTaxonomies(),l=he.getValueTypes(),u=he.getNamingRules(),h=JSON.parse(localStorage.getItem("token-model:dimension-order")||"[]"),f=he.getRootData(),{systemName:p="Design System",systemId:g="design-system",description:y="A comprehensive design system with tokens, dimensions, and themes",version:b="1.0.0",versionHistory:A=[]}=f,D=Array.isArray(A)&&A.length>0?A:[{version:b,dimensions:Array.isArray(n)?n.map(I=>I.id):[],date:new Date().toISOString().slice(0,10),migrationStrategy:{emptyModeIds:"mapToDefaults",preserveOriginalValues:!0}}];let j=[];if(Array.isArray(l)&&l.length>0)j=l.map(I=>typeof I=="string"?{id:I,displayName:I}:I);else throw console.error("[createSchemaJsonFromLocalStorage] No resolvedValueTypes found in localStorage. Please ensure your system data includes all value types required by your schema."),new Error("[createSchemaJsonFromLocalStorage] No resolvedValueTypes found in localStorage. Please ensure your system data includes all value types required by your schema.");const w=new Set;n.forEach(I=>{(I.resolvedValueTypeIds||[]).forEach(H=>w.add(H))}),e.forEach(I=>{(I.resolvedValueTypeIds||[]).forEach(H=>w.add(H))}),t.forEach(I=>{I.resolvedValueTypeId&&w.add(I.resolvedValueTypeId)});const C=Array.from(w).filter(I=>!j.some(H=>H.id===I));if(C.length>0)throw console.error(`[createSchemaJsonFromLocalStorage] The following resolvedValueTypeIds are referenced in dimensions, collections, or tokens but missing from resolvedValueTypes: ${C.join(", ")}`),new Error(`[createSchemaJsonFromLocalStorage] The following resolvedValueTypeIds are referenced in dimensions, collections, or tokens but missing from resolvedValueTypes: ${C.join(", ")}`);const _=(r||[]).map(I=>{var H,Z,ae,ne,F;return{...I,syntaxPatterns:{prefix:((H=I.syntaxPatterns)==null?void 0:H.prefix)??"",suffix:((Z=I.syntaxPatterns)==null?void 0:Z.suffix)??"",delimiter:((ae=I.syntaxPatterns)==null?void 0:ae.delimiter)??"_",capitalization:((ne=I.syntaxPatterns)==null?void 0:ne.capitalization)??"none",formatString:((F=I.syntaxPatterns)==null?void 0:F.formatString)??""}}}),N=Array.isArray(i)&&i.length>0?i:[{id:"default",displayName:"Default Theme",description:"The default theme for the design system",isDefault:!0}];return{systemName:p,systemId:g,description:y,version:b,versionHistory:D,tokenCollections:e,dimensions:n,dimensionOrder:h,tokens:t,platforms:_,themes:N,taxonomies:a,resolvedValueTypes:j,namingRules:u||{taxonomyOrder:[]}}}function u9(){var u;const e=he.getAlgorithms(),t=JSON.parse(localStorage.getItem("token-model:root")||"{}"),{systemName:n="Design System",version:r="1.0.0"}=t,i=he.getAlgorithmFile();if(i)return{...i,algorithms:e.map(f=>({id:f.id,name:f.name,description:f.description||"",resolvedValueTypeId:f.resolvedValueTypeId,variables:f.variables.map(p=>({id:p.id,name:p.name,type:p.type,defaultValue:p.defaultValue||"",description:p.description||""})),formulas:f.formulas.map(p=>({id:p.id,name:p.name,description:p.description||"",expressions:{latex:{value:p.expressions.latex.value},javascript:{value:p.expressions.javascript.value,metadata:p.expressions.javascript.metadata||{allowedOperations:["math"]}},ast:p.expressions.ast||{type:"literal",value:p.expressions.javascript.value,metadata:{astVersion:"1.0.0",validationErrors:[],complexity:"low"}}},variableIds:p.variableIds||[]})),conditions:f.conditions.map(p=>({id:p.id,name:p.name,expression:p.expression,variableIds:p.variableIds||[]})),steps:f.steps.map(p=>({type:p.type,id:p.id,name:p.name}))}))};let a=[];if(e&&e.length>0){const h=e[0];(u=h.config)!=null&&u.systemVariables&&(a=h.config.systemVariables)}return{schemaVersion:"5.0.0",profile:"basic",metadata:{name:`${n} Algorithm Collection`,description:`Algorithm collection for ${n}`,version:r,author:"Design System Manager"},config:{systemVariables:a,defaultBaseValue:16,defaultRatio:1.25,defaultSpacing:4},algorithms:e.map(h=>({id:h.id,name:h.name,description:h.description||"",resolvedValueTypeId:h.resolvedValueTypeId,variables:h.variables.map(f=>({id:f.id,name:f.name,type:f.type,defaultValue:f.defaultValue||"",description:f.description||""})),formulas:h.formulas.map(f=>({id:f.id,name:f.name,description:f.description||"",expressions:{latex:{value:f.expressions.latex.value},javascript:{value:f.expressions.javascript.value,metadata:f.expressions.javascript.metadata||{allowedOperations:["math"]}},ast:f.expressions.ast||{type:"literal",value:f.expressions.javascript.value,metadata:{astVersion:"1.0.0",validationErrors:[],complexity:"low"}}},variableIds:f.variableIds||[]})),conditions:h.conditions.map(f=>({id:f.id,name:f.name,expression:f.expression,variableIds:f.variableIds||[]})),steps:h.steps.map(f=>({type:f.type,id:f.id,name:f.name}))})),execution:{order:[],parallel:!1,onError:"stop"},integration:{targetSchema:"https://designsystem.org/schemas/tokens/v1.0.0",outputFormat:"design-tokens",mergeStrategy:"merge",validation:!0},examples:[]}}function d9({tokens:e=[],collections:t=[],dimensions:n=[],platforms:r=[],taxonomies:i=[],version:a="1.0.0",versionHistory:l=[],onValidate:u}){var pe,G,ge;const{colorMode:h}=tn(),[f,p]=z.useState(null),[g,y]=z.useState(!1),[b,A]=z.useState(null),[D,j]=z.useState(!1),[w,C]=z.useState(null),[_,N]=z.useState(!1),[E,I]=z.useState(""),H=kt.useRef(null),Z=Hn();z.useEffect(()=>{if(_){const W=Zf();I(JSON.stringify(W,null,2))}},[_,t,n,e,r,i,a,l]);const ae=()=>{try{const W=Zf(),L=mr.validateData(W);L.isValid?Z({title:"Validation Successful",description:"Your data is valid according to the schema.",status:"success",duration:3e3,isClosable:!0}):(C(L),j(!0))}catch{Z({title:"Validation Error",description:"An error occurred during validation.",status:"error",duration:3e3,isClosable:!0})}},ne=()=>{N(!0)},F=W=>{const L=e.find(Q=>Q.id===W);p(L||null),A(null)},J=()=>{if(f)try{u(f),Z({title:"Token Validation Successful",description:"The selected token is valid.",status:"success",duration:3e3,isClosable:!0})}catch(W){A({isValid:!1,errors:[W]}),y(!0)}};return s.jsxs(Y,{children:[s.jsx(Y,{p:4,bg:h==="dark"?"gray.900":"white",children:s.jsxs(ye,{align:"stretch",spacing:6,children:[s.jsxs(Y,{children:[s.jsx(yt,{as:"h2",size:"md",mb:4,children:"Global Data Validation"}),s.jsx(Ee,{colorScheme:"blue",onClick:ae,mb:4,children:"Validate All Data"}),s.jsx(Ee,{variant:"outline",colorScheme:"gray",onClick:ne,mb:4,ml:2,children:"Preview JSON"})]}),s.jsxs(Y,{pt:6,children:[s.jsx(yt,{as:"h2",size:"md",mb:4,children:"Token Validation Tester"}),s.jsxs(ye,{align:"stretch",spacing:4,children:[s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Select Token"}),s.jsx(Zt,{value:(f==null?void 0:f.id)||"",onChange:W=>F(W.target.value),placeholder:"Select token",children:e==null?void 0:e.map(W=>s.jsx("option",{value:W.id,children:W.displayName},W.id))})]}),f&&s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"semibold",mb:2,children:"Selected Token Details"}),s.jsxs(B,{fontSize:"sm",children:["Name: ",f.displayName]}),s.jsxs(B,{fontSize:"sm",children:["Collection: ",f.tokenCollectionId?(pe=t==null?void 0:t.find(W=>W.id===f.tokenCollectionId))==null?void 0:pe.name:"None"]}),s.jsxs(B,{fontSize:"sm",children:["Value Type: ",f.resolvedValueTypeId]}),s.jsx(Ee,{colorScheme:"blue",onClick:J,mt:3,children:"Validate Token"})]})]})]})]})}),s.jsx(bl,{isOpen:D,leastDestructiveRef:H,onClose:()=>j(!1),children:s.jsx(vn,{children:s.jsxs(vl,{children:[s.jsx(wn,{fontSize:"lg",fontWeight:"bold",children:"Validation Failed"}),s.jsxs(Sn,{children:[s.jsx(B,{mb:4,children:"The following validation errors were found:"}),(G=w==null?void 0:w.errors)==null?void 0:G.map((W,L)=>s.jsx(it,{display:"block",mb:2,p:2,whiteSpace:"pre-wrap",children:JSON.stringify(W,null,2)},L))]}),s.jsx(Xn,{children:s.jsx(Ee,{ref:H,onClick:()=>j(!1),children:"Close"})})]})})}),s.jsx(bl,{isOpen:g,leastDestructiveRef:H,onClose:()=>y(!1),children:s.jsx(vn,{children:s.jsxs(vl,{children:[s.jsx(wn,{fontSize:"lg",fontWeight:"bold",children:"Token Validation Failed"}),s.jsxs(Sn,{children:[s.jsx(B,{mb:4,children:"The following validation errors were found:"}),(ge=b==null?void 0:b.errors)==null?void 0:ge.map((W,L)=>s.jsx(it,{display:"block",mb:2,p:2,whiteSpace:"pre-wrap",children:JSON.stringify(W,null,2)},L))]}),s.jsx(Xn,{children:s.jsx(Ee,{ref:H,onClick:()=>y(!1),children:"Close"})})]})})}),s.jsxs(zn,{size:"4xl",isOpen:_,onClose:()=>N(!1),children:[s.jsx(vn,{}),s.jsxs(Pn,{bg:h==="dark"?"gray.900":"white",maxH:"80vh",overflowY:"auto",children:[s.jsx(wn,{children:"Local Storage Data Preview"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(Fi,{isFitted:!0,children:[s.jsxs(Li,{children:[s.jsx(Jn,{children:"Core Data"}),s.jsx(Jn,{children:"Algorithm Data"})]}),s.jsxs(Ia,{children:[s.jsx(fr,{children:s.jsx(Y,{maxH:"60vh",overflowY:"auto",children:s.jsx(it,{width:"100%",whiteSpace:"pre",p:4,fontSize:"sm",display:"block",children:E})})}),s.jsx(fr,{children:s.jsx(Y,{maxH:"60vh",overflowY:"auto",children:s.jsx(it,{width:"100%",whiteSpace:"pre",p:4,fontSize:"sm",display:"block",children:JSON.stringify(u9(),null,2)})})})]})]})})]})]})]})}function h9(e,t){if(e==null)return{};var n,r,i=fx(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function od(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f9(e){if(Array.isArray(e))return od(e)}function p9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function m9(e,t){if(e){if(typeof e=="string")return od(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?od(e,t):void 0}}function g9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ld(e){return f9(e)||p9(e)||m9(e)||g9()}function Yf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function la(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yf(Object(n),!0).forEach(function(r){zp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yf(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function y9(e){var t=e.length;if(t===0||t===1)return e;if(t===2)return[e[0],e[1],"".concat(e[0],".").concat(e[1]),"".concat(e[1],".").concat(e[0])];if(t===3)return[e[0],e[1],e[2],"".concat(e[0],".").concat(e[1]),"".concat(e[0],".").concat(e[2]),"".concat(e[1],".").concat(e[0]),"".concat(e[1],".").concat(e[2]),"".concat(e[2],".").concat(e[0]),"".concat(e[2],".").concat(e[1]),"".concat(e[0],".").concat(e[1],".").concat(e[2]),"".concat(e[0],".").concat(e[2],".").concat(e[1]),"".concat(e[1],".").concat(e[0],".").concat(e[2]),"".concat(e[1],".").concat(e[2],".").concat(e[0]),"".concat(e[2],".").concat(e[0],".").concat(e[1]),"".concat(e[2],".").concat(e[1],".").concat(e[0])];if(t>=4)return[e[0],e[1],e[2],e[3],"".concat(e[0],".").concat(e[1]),"".concat(e[0],".").concat(e[2]),"".concat(e[0],".").concat(e[3]),"".concat(e[1],".").concat(e[0]),"".concat(e[1],".").concat(e[2]),"".concat(e[1],".").concat(e[3]),"".concat(e[2],".").concat(e[0]),"".concat(e[2],".").concat(e[1]),"".concat(e[2],".").concat(e[3]),"".concat(e[3],".").concat(e[0]),"".concat(e[3],".").concat(e[1]),"".concat(e[3],".").concat(e[2]),"".concat(e[0],".").concat(e[1],".").concat(e[2]),"".concat(e[0],".").concat(e[1],".").concat(e[3]),"".concat(e[0],".").concat(e[2],".").concat(e[1]),"".concat(e[0],".").concat(e[2],".").concat(e[3]),"".concat(e[0],".").concat(e[3],".").concat(e[1]),"".concat(e[0],".").concat(e[3],".").concat(e[2]),"".concat(e[1],".").concat(e[0],".").concat(e[2]),"".concat(e[1],".").concat(e[0],".").concat(e[3]),"".concat(e[1],".").concat(e[2],".").concat(e[0]),"".concat(e[1],".").concat(e[2],".").concat(e[3]),"".concat(e[1],".").concat(e[3],".").concat(e[0]),"".concat(e[1],".").concat(e[3],".").concat(e[2]),"".concat(e[2],".").concat(e[0],".").concat(e[1]),"".concat(e[2],".").concat(e[0],".").concat(e[3]),"".concat(e[2],".").concat(e[1],".").concat(e[0]),"".concat(e[2],".").concat(e[1],".").concat(e[3]),"".concat(e[2],".").concat(e[3],".").concat(e[0]),"".concat(e[2],".").concat(e[3],".").concat(e[1]),"".concat(e[3],".").concat(e[0],".").concat(e[1]),"".concat(e[3],".").concat(e[0],".").concat(e[2]),"".concat(e[3],".").concat(e[1],".").concat(e[0]),"".concat(e[3],".").concat(e[1],".").concat(e[2]),"".concat(e[3],".").concat(e[2],".").concat(e[0]),"".concat(e[3],".").concat(e[2],".").concat(e[1]),"".concat(e[0],".").concat(e[1],".").concat(e[2],".").concat(e[3]),"".concat(e[0],".").concat(e[1],".").concat(e[3],".").concat(e[2]),"".concat(e[0],".").concat(e[2],".").concat(e[1],".").concat(e[3]),"".concat(e[0],".").concat(e[2],".").concat(e[3],".").concat(e[1]),"".concat(e[0],".").concat(e[3],".").concat(e[1],".").concat(e[2]),"".concat(e[0],".").concat(e[3],".").concat(e[2],".").concat(e[1]),"".concat(e[1],".").concat(e[0],".").concat(e[2],".").concat(e[3]),"".concat(e[1],".").concat(e[0],".").concat(e[3],".").concat(e[2]),"".concat(e[1],".").concat(e[2],".").concat(e[0],".").concat(e[3]),"".concat(e[1],".").concat(e[2],".").concat(e[3],".").concat(e[0]),"".concat(e[1],".").concat(e[3],".").concat(e[0],".").concat(e[2]),"".concat(e[1],".").concat(e[3],".").concat(e[2],".").concat(e[0]),"".concat(e[2],".").concat(e[0],".").concat(e[1],".").concat(e[3]),"".concat(e[2],".").concat(e[0],".").concat(e[3],".").concat(e[1]),"".concat(e[2],".").concat(e[1],".").concat(e[0],".").concat(e[3]),"".concat(e[2],".").concat(e[1],".").concat(e[3],".").concat(e[0]),"".concat(e[2],".").concat(e[3],".").concat(e[0],".").concat(e[1]),"".concat(e[2],".").concat(e[3],".").concat(e[1],".").concat(e[0]),"".concat(e[3],".").concat(e[0],".").concat(e[1],".").concat(e[2]),"".concat(e[3],".").concat(e[0],".").concat(e[2],".").concat(e[1]),"".concat(e[3],".").concat(e[1],".").concat(e[0],".").concat(e[2]),"".concat(e[3],".").concat(e[1],".").concat(e[2],".").concat(e[0]),"".concat(e[3],".").concat(e[2],".").concat(e[0],".").concat(e[1]),"".concat(e[3],".").concat(e[2],".").concat(e[1],".").concat(e[0])]}var xu={};function x9(e){if(e.length===0||e.length===1)return e;var t=e.join(".");return xu[t]||(xu[t]=y9(e)),xu[t]}function b9(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e.filter(function(a){return a!=="token"}),i=x9(r);return i.reduce(function(a,l){return la(la({},a),n[l])},t)}function Jf(e){return e.join(" ")}function v9(e,t){var n=0;return function(r){return n+=1,r.map(function(i,a){return l1({node:i,stylesheet:e,useInlineStyles:t,key:"code-segment-".concat(n,"-").concat(a)})})}}function l1(e){var t=e.node,n=e.stylesheet,r=e.style,i=r===void 0?{}:r,a=e.useInlineStyles,l=e.key,u=t.properties,h=t.type,f=t.tagName,p=t.value;if(h==="text")return p;if(f){var g=v9(n,a),y;if(!a)y=la(la({},u),{},{className:Jf(u.className)});else{var b=Object.keys(n).reduce(function(w,C){return C.split(".").forEach(function(_){w.includes(_)||w.push(_)}),w},[]),A=u.className&&u.className.includes("token")?["token"]:[],D=u.className&&A.concat(u.className.filter(function(w){return!b.includes(w)}));y=la(la({},u),{},{className:Jf(D)||void 0,style:b9(u.className,Object.assign({},u.style,i),n)})}var j=g(t.children);return kt.createElement(f,vd({key:l},y),j)}}const w9=function(e,t){var n=e.listLanguages();return n.indexOf(t)!==-1};var S9=["language","children","style","customStyle","codeTagProps","useInlineStyles","showLineNumbers","showInlineLineNumbers","startingLineNumber","lineNumberContainerStyle","lineNumberStyle","wrapLines","wrapLongLines","lineProps","renderer","PreTag","CodeTag","code","astGenerator"];function Xf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function li(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Xf(Object(n),!0).forEach(function(r){zp(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xf(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var k9=/\n/g;function j9(e){return e.match(k9)}function C9(e){var t=e.lines,n=e.startingLineNumber,r=e.style;return t.map(function(i,a){var l=a+n;return kt.createElement("span",{key:"line-".concat(a),className:"react-syntax-highlighter-line-number",style:typeof r=="function"?r(l):r},"".concat(l,`
`))})}function T9(e){var t=e.codeString,n=e.codeStyle,r=e.containerStyle,i=r===void 0?{float:"left",paddingRight:"10px"}:r,a=e.numberStyle,l=a===void 0?{}:a,u=e.startingLineNumber;return kt.createElement("code",{style:Object.assign({},n,i)},C9({lines:t.replace(/\n$/,"").split(`
`),style:l,startingLineNumber:u}))}function I9(e){return"".concat(e.toString().length,".25em")}function c1(e,t){return{type:"element",tagName:"span",properties:{key:"line-number--".concat(e),className:["comment","linenumber","react-syntax-highlighter-line-number"],style:t},children:[{type:"text",value:e}]}}function u1(e,t,n){var r={display:"inline-block",minWidth:I9(n),paddingRight:"1em",textAlign:"right",userSelect:"none"},i=typeof e=="function"?e(t):e,a=li(li({},r),i);return a}function fl(e){var t=e.children,n=e.lineNumber,r=e.lineNumberStyle,i=e.largestLineNumber,a=e.showInlineLineNumbers,l=e.lineProps,u=l===void 0?{}:l,h=e.className,f=h===void 0?[]:h,p=e.showLineNumbers,g=e.wrapLongLines,y=e.wrapLines,b=y===void 0?!1:y,A=b?li({},typeof u=="function"?u(n):u):{};if(A.className=A.className?[].concat(ld(A.className.trim().split(/\s+/)),ld(f)):f,n&&a){var D=u1(r,n,i);t.unshift(c1(n,D))}return g&p&&(A.style=li({display:"flex"},A.style)),{type:"element",tagName:"span",properties:A,children:t}}function d1(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=0;r<e.length;r++){var i=e[r];if(i.type==="text")n.push(fl({children:[i],className:ld(new Set(t))}));else if(i.children){var a=t.concat(i.properties.className);d1(i.children,a).forEach(function(l){return n.push(l)})}}return n}function A9(e,t,n,r,i,a,l,u,h){var f,p=d1(e.value),g=[],y=-1,b=0;function A(E,I){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return fl({children:E,lineNumber:I,lineNumberStyle:u,largestLineNumber:l,showInlineLineNumbers:i,lineProps:n,className:H,showLineNumbers:r,wrapLongLines:h,wrapLines:t})}function D(E,I){if(r&&I&&i){var H=u1(u,I,l);E.unshift(c1(I,H))}return E}function j(E,I){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return t||H.length>0?A(E,I,H):D(E,I)}for(var w=function(){var I=p[b],H=I.children[0].value,Z=j9(H);if(Z){var ae=H.split(`
`);ae.forEach(function(ne,F){var J=r&&g.length+a,pe={type:"text",value:"".concat(ne,`
`)};if(F===0){var G=p.slice(y+1,b).concat(fl({children:[pe],className:I.properties.className})),ge=j(G,J);g.push(ge)}else if(F===ae.length-1){var W=p[b+1]&&p[b+1].children&&p[b+1].children[0],L={type:"text",value:"".concat(ne)};if(W){var Q=fl({children:[L],className:I.properties.className});p.splice(b+1,0,Q)}else{var fe=[L],xe=j(fe,J,I.properties.className);g.push(xe)}}else{var ue=[pe],ke=j(ue,J,I.properties.className);g.push(ke)}}),y=b}b++};b<p.length;)w();if(y!==p.length-1){var C=p.slice(y+1,p.length);if(C&&C.length){var _=r&&g.length+a,N=j(C,_);g.push(N)}}return t?g:(f=[]).concat.apply(f,g)}function _9(e){var t=e.rows,n=e.stylesheet,r=e.useInlineStyles;return t.map(function(i,a){return l1({node:i,stylesheet:n,useInlineStyles:r,key:"code-segement".concat(a)})})}function h1(e){return e&&typeof e.highlightAuto<"u"}function E9(e){var t=e.astGenerator,n=e.language,r=e.code,i=e.defaultCodeValue;if(h1(t)){var a=w9(t,n);return n==="text"?{value:i,language:"text"}:a?t.highlight(n,r):t.highlightAuto(r)}try{return n&&n!=="text"?{value:t.highlight(r,n)}:{value:i}}catch{return{value:i}}}function N9(e,t){return function(r){var i=r.language,a=r.children,l=r.style,u=l===void 0?t:l,h=r.customStyle,f=h===void 0?{}:h,p=r.codeTagProps,g=p===void 0?{className:i?"language-".concat(i):void 0,style:li(li({},u['code[class*="language-"]']),u['code[class*="language-'.concat(i,'"]')])}:p,y=r.useInlineStyles,b=y===void 0?!0:y,A=r.showLineNumbers,D=A===void 0?!1:A,j=r.showInlineLineNumbers,w=j===void 0?!0:j,C=r.startingLineNumber,_=C===void 0?1:C,N=r.lineNumberContainerStyle,E=r.lineNumberStyle,I=E===void 0?{}:E,H=r.wrapLines,Z=r.wrapLongLines,ae=Z===void 0?!1:Z,ne=r.lineProps,F=ne===void 0?{}:ne,J=r.renderer,pe=r.PreTag,G=pe===void 0?"pre":pe,ge=r.CodeTag,W=ge===void 0?"code":ge,L=r.code,Q=L===void 0?(Array.isArray(a)?a[0]:a)||"":L,fe=r.astGenerator,xe=h9(r,S9);fe=fe||e;var ue=D?kt.createElement(T9,{containerStyle:N,codeStyle:g.style||{},numberStyle:I,startingLineNumber:_,codeString:Q}):null,ke=u.hljs||u['pre[class*="language-"]']||{backgroundColor:"#fff"},q=h1(fe)?"hljs":"prismjs",re=b?Object.assign({},xe,{style:Object.assign({},ke,f)}):Object.assign({},xe,{className:xe.className?"".concat(q," ").concat(xe.className):q,style:Object.assign({},f)});if(ae?g.style=li({whiteSpace:"pre-wrap"},g.style):g.style=li({whiteSpace:"pre"},g.style),!fe)return kt.createElement(G,re,ue,kt.createElement(W,g,Q));(H===void 0&&J||ae)&&(H=!0),J=J||_9;var Se=[{type:"text",value:Q}],we=E9({astGenerator:fe,language:i,code:Q,defaultCodeValue:Se});we.language===null&&(we.value=Se);var Ce=we.value.length;Ce===1&&we.value[0].type==="text"&&(Ce=we.value[0].value.split(`
`).length);var Le=Ce+_,ft=A9(we,H,F,D,w,_,Le,I,ae);return kt.createElement(G,re,kt.createElement(W,g,!w&&ue,J({rows:ft,stylesheet:u,useInlineStyles:b})))}}var qi={};function t0(e){return e instanceof Map?e.clear=e.delete=e.set=function(){throw new Error("map is read-only")}:e instanceof Set&&(e.add=e.clear=e.delete=function(){throw new Error("set is read-only")}),Object.freeze(e),Object.getOwnPropertyNames(e).forEach(function(t){var n=e[t];typeof n=="object"&&!Object.isFrozen(n)&&t0(n)}),e}var f1=t0,M9=t0;f1.default=M9;class Kf{constructor(t){t.data===void 0&&(t.data={}),this.data=t.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function da(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function ci(e,...t){const n=Object.create(null);for(const r in e)n[r]=e[r];return t.forEach(function(r){for(const i in r)n[i]=r[i]}),n}const D9="</span>",Qf=e=>!!e.kind;class R9{constructor(t,n){this.buffer="",this.classPrefix=n.classPrefix,t.walk(this)}addText(t){this.buffer+=da(t)}openNode(t){if(!Qf(t))return;let n=t.kind;t.sublanguage||(n=`${this.classPrefix}${n}`),this.span(n)}closeNode(t){Qf(t)&&(this.buffer+=D9)}value(){return this.buffer}span(t){this.buffer+=`<span class="${t}">`}}class n0{constructor(){this.rootNode={children:[]},this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(t){this.top.children.push(t)}openNode(t){const n={kind:t,children:[]};this.add(n),this.stack.push(n)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(t){return this.constructor._walk(t,this.rootNode)}static _walk(t,n){return typeof n=="string"?t.addText(n):n.children&&(t.openNode(n),n.children.forEach(r=>this._walk(t,r)),t.closeNode(n)),t}static _collapse(t){typeof t!="string"&&t.children&&(t.children.every(n=>typeof n=="string")?t.children=[t.children.join("")]:t.children.forEach(n=>{n0._collapse(n)}))}}class O9 extends n0{constructor(t){super(),this.options=t}addKeyword(t,n){t!==""&&(this.openNode(n),this.addText(t),this.closeNode())}addText(t){t!==""&&this.add(t)}addSublanguage(t,n){const r=t.root;r.kind=n,r.sublanguage=!0,this.add(r)}toHTML(){return new R9(this,this.options).value()}finalize(){return!0}}function V9(e){return new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}function bo(e){return e?typeof e=="string"?e:e.source:null}function z9(...e){return e.map(n=>bo(n)).join("")}function P9(...e){return"("+e.map(n=>bo(n)).join("|")+")"}function B9(e){return new RegExp(e.toString()+"|").exec("").length-1}function F9(e,t){const n=e&&e.exec(t);return n&&n.index===0}const L9=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function $9(e,t="|"){let n=0;return e.map(r=>{n+=1;const i=n;let a=bo(r),l="";for(;a.length>0;){const u=L9.exec(a);if(!u){l+=a;break}l+=a.substring(0,u.index),a=a.substring(u.index+u[0].length),u[0][0]==="\\"&&u[1]?l+="\\"+String(Number(u[1])+i):(l+=u[0],u[0]==="("&&n++)}return l}).map(r=>`(${r})`).join(t)}const G9=/\b\B/,p1="[a-zA-Z]\\w*",r0="[a-zA-Z_]\\w*",s0="\\b\\d+(\\.\\d+)?",m1="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",g1="\\b(0b[01]+)",H9="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",q9=(e={})=>{const t=/^#![ ]*\//;return e.binary&&(e.begin=z9(t,/.*\b/,e.binary,/\b.*/)),ci({className:"meta",begin:t,end:/$/,relevance:0,"on:begin":(n,r)=>{n.index!==0&&r.ignoreMatch()}},e)},vo={begin:"\\\\[\\s\\S]",relevance:0},U9={className:"string",begin:"'",end:"'",illegal:"\\n",contains:[vo]},W9={className:"string",begin:'"',end:'"',illegal:"\\n",contains:[vo]},y1={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},pc=function(e,t,n={}){const r=ci({className:"comment",begin:e,end:t,contains:[]},n);return r.contains.push(y1),r.contains.push({className:"doctag",begin:"(?:TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):",relevance:0}),r},Z9=pc("//","$"),Y9=pc("/\\*","\\*/"),J9=pc("#","$"),X9={className:"number",begin:s0,relevance:0},K9={className:"number",begin:m1,relevance:0},Q9={className:"number",begin:g1,relevance:0},ew={className:"number",begin:s0+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},tw={begin:/(?=\/[^/\n]*\/)/,contains:[{className:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[vo,{begin:/\[/,end:/\]/,relevance:0,contains:[vo]}]}]},nw={className:"title",begin:p1,relevance:0},rw={className:"title",begin:r0,relevance:0},sw={begin:"\\.\\s*"+r0,relevance:0},iw=function(e){return Object.assign(e,{"on:begin":(t,n)=>{n.data._beginMatch=t[1]},"on:end":(t,n)=>{n.data._beginMatch!==t[1]&&n.ignoreMatch()}})};var nl=Object.freeze({__proto__:null,MATCH_NOTHING_RE:G9,IDENT_RE:p1,UNDERSCORE_IDENT_RE:r0,NUMBER_RE:s0,C_NUMBER_RE:m1,BINARY_NUMBER_RE:g1,RE_STARTERS_RE:H9,SHEBANG:q9,BACKSLASH_ESCAPE:vo,APOS_STRING_MODE:U9,QUOTE_STRING_MODE:W9,PHRASAL_WORDS_MODE:y1,COMMENT:pc,C_LINE_COMMENT_MODE:Z9,C_BLOCK_COMMENT_MODE:Y9,HASH_COMMENT_MODE:J9,NUMBER_MODE:X9,C_NUMBER_MODE:K9,BINARY_NUMBER_MODE:Q9,CSS_NUMBER_MODE:ew,REGEXP_MODE:tw,TITLE_MODE:nw,UNDERSCORE_TITLE_MODE:rw,METHOD_GUARD:sw,END_SAME_AS_BEGIN:iw});function aw(e,t){e.input[e.index-1]==="."&&t.ignoreMatch()}function ow(e,t){t&&e.beginKeywords&&(e.begin="\\b("+e.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",e.__beforeBegin=aw,e.keywords=e.keywords||e.beginKeywords,delete e.beginKeywords,e.relevance===void 0&&(e.relevance=0))}function lw(e,t){Array.isArray(e.illegal)&&(e.illegal=P9(...e.illegal))}function cw(e,t){if(e.match){if(e.begin||e.end)throw new Error("begin & end are not supported with match");e.begin=e.match,delete e.match}}function uw(e,t){e.relevance===void 0&&(e.relevance=1)}const dw=["of","and","for","in","not","or","if","then","parent","list","value"],hw="keyword";function x1(e,t,n=hw){const r={};return typeof e=="string"?i(n,e.split(" ")):Array.isArray(e)?i(n,e):Object.keys(e).forEach(function(a){Object.assign(r,x1(e[a],t,a))}),r;function i(a,l){t&&(l=l.map(u=>u.toLowerCase())),l.forEach(function(u){const h=u.split("|");r[h[0]]=[a,fw(h[0],h[1])]})}}function fw(e,t){return t?Number(t):pw(e)?0:1}function pw(e){return dw.includes(e.toLowerCase())}function mw(e,{plugins:t}){function n(u,h){return new RegExp(bo(u),"m"+(e.case_insensitive?"i":"")+(h?"g":""))}class r{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(h,f){f.position=this.position++,this.matchIndexes[this.matchAt]=f,this.regexes.push([f,h]),this.matchAt+=B9(h)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const h=this.regexes.map(f=>f[1]);this.matcherRe=n($9(h),!0),this.lastIndex=0}exec(h){this.matcherRe.lastIndex=this.lastIndex;const f=this.matcherRe.exec(h);if(!f)return null;const p=f.findIndex((y,b)=>b>0&&y!==void 0),g=this.matchIndexes[p];return f.splice(0,p),Object.assign(f,g)}}class i{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(h){if(this.multiRegexes[h])return this.multiRegexes[h];const f=new r;return this.rules.slice(h).forEach(([p,g])=>f.addRule(p,g)),f.compile(),this.multiRegexes[h]=f,f}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(h,f){this.rules.push([h,f]),f.type==="begin"&&this.count++}exec(h){const f=this.getMatcher(this.regexIndex);f.lastIndex=this.lastIndex;let p=f.exec(h);if(this.resumingScanAtSamePosition()&&!(p&&p.index===this.lastIndex)){const g=this.getMatcher(0);g.lastIndex=this.lastIndex+1,p=g.exec(h)}return p&&(this.regexIndex+=p.position+1,this.regexIndex===this.count&&this.considerAll()),p}}function a(u){const h=new i;return u.contains.forEach(f=>h.addRule(f.begin,{rule:f,type:"begin"})),u.terminatorEnd&&h.addRule(u.terminatorEnd,{type:"end"}),u.illegal&&h.addRule(u.illegal,{type:"illegal"}),h}function l(u,h){const f=u;if(u.isCompiled)return f;[cw].forEach(g=>g(u,h)),e.compilerExtensions.forEach(g=>g(u,h)),u.__beforeBegin=null,[ow,lw,uw].forEach(g=>g(u,h)),u.isCompiled=!0;let p=null;if(typeof u.keywords=="object"&&(p=u.keywords.$pattern,delete u.keywords.$pattern),u.keywords&&(u.keywords=x1(u.keywords,e.case_insensitive)),u.lexemes&&p)throw new Error("ERR: Prefer `keywords.$pattern` to `mode.lexemes`, BOTH are not allowed. (see mode reference) ");return p=p||u.lexemes||/\w+/,f.keywordPatternRe=n(p,!0),h&&(u.begin||(u.begin=/\B|\b/),f.beginRe=n(u.begin),u.endSameAsBegin&&(u.end=u.begin),!u.end&&!u.endsWithParent&&(u.end=/\B|\b/),u.end&&(f.endRe=n(u.end)),f.terminatorEnd=bo(u.end)||"",u.endsWithParent&&h.terminatorEnd&&(f.terminatorEnd+=(u.end?"|":"")+h.terminatorEnd)),u.illegal&&(f.illegalRe=n(u.illegal)),u.contains||(u.contains=[]),u.contains=[].concat(...u.contains.map(function(g){return gw(g==="self"?u:g)})),u.contains.forEach(function(g){l(g,f)}),u.starts&&l(u.starts,h),f.matcher=a(f),f}if(e.compilerExtensions||(e.compilerExtensions=[]),e.contains&&e.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return e.classNameAliases=ci(e.classNameAliases||{}),l(e)}function b1(e){return e?e.endsWithParent||b1(e.starts):!1}function gw(e){return e.variants&&!e.cachedVariants&&(e.cachedVariants=e.variants.map(function(t){return ci(e,{variants:null},t)})),e.cachedVariants?e.cachedVariants:b1(e)?ci(e,{starts:e.starts?ci(e.starts):null}):Object.isFrozen(e)?ci(e):e}var yw="10.7.3";function xw(e){return!!(e||e==="")}function bw(e){const t={props:["language","code","autodetect"],data:function(){return{detectedLanguage:"",unknownLanguage:!1}},computed:{className(){return this.unknownLanguage?"":"hljs "+this.detectedLanguage},highlighted(){if(!this.autoDetect&&!e.getLanguage(this.language))return console.warn(`The language "${this.language}" you specified could not be found.`),this.unknownLanguage=!0,da(this.code);let r={};return this.autoDetect?(r=e.highlightAuto(this.code),this.detectedLanguage=r.language):(r=e.highlight(this.language,this.code,this.ignoreIllegals),this.detectedLanguage=this.language),r.value},autoDetect(){return!this.language||xw(this.autodetect)},ignoreIllegals(){return!0}},render(r){return r("pre",{},[r("code",{class:this.className,domProps:{innerHTML:this.highlighted}})])}};return{Component:t,VuePlugin:{install(r){r.component("highlightjs",t)}}}}const vw={"after:highlightElement":({el:e,result:t,text:n})=>{const r=ep(e);if(!r.length)return;const i=document.createElement("div");i.innerHTML=t.value,t.value=ww(r,ep(i),n)}};function cd(e){return e.nodeName.toLowerCase()}function ep(e){const t=[];return function n(r,i){for(let a=r.firstChild;a;a=a.nextSibling)a.nodeType===3?i+=a.nodeValue.length:a.nodeType===1&&(t.push({event:"start",offset:i,node:a}),i=n(a,i),cd(a).match(/br|hr|img|input/)||t.push({event:"stop",offset:i,node:a}));return i}(e,0),t}function ww(e,t,n){let r=0,i="";const a=[];function l(){return!e.length||!t.length?e.length?e:t:e[0].offset!==t[0].offset?e[0].offset<t[0].offset?e:t:t[0].event==="start"?e:t}function u(p){function g(y){return" "+y.nodeName+'="'+da(y.value)+'"'}i+="<"+cd(p)+[].map.call(p.attributes,g).join("")+">"}function h(p){i+="</"+cd(p)+">"}function f(p){(p.event==="start"?u:h)(p.node)}for(;e.length||t.length;){let p=l();if(i+=da(n.substring(r,p[0].offset)),r=p[0].offset,p===e){a.reverse().forEach(h);do f(p.splice(0,1)[0]),p=l();while(p===e&&p.length&&p[0].offset===r);a.reverse().forEach(u)}else p[0].event==="start"?a.push(p[0].node):a.pop(),f(p.splice(0,1)[0])}return i+da(n.substr(r))}const tp={},bu=e=>{console.error(e)},np=(e,...t)=>{console.log(`WARN: ${e}`,...t)},Jr=(e,t)=>{tp[`${e}/${t}`]||(console.log(`Deprecated as of ${e}. ${t}`),tp[`${e}/${t}`]=!0)},vu=da,rp=ci,sp=Symbol("nomatch"),Sw=function(e){const t=Object.create(null),n=Object.create(null),r=[];let i=!0;const a=/(^(<[^>]+>|\t|)+|\n)/gm,l="Could not find the language '{}', did you forget to load/include a language module?",u={disableAutodetect:!0,name:"Plain text",contains:[]};let h={noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:null,__emitter:O9};function f(q){return h.noHighlightRe.test(q)}function p(q){let re=q.className+" ";re+=q.parentNode?q.parentNode.className:"";const Se=h.languageDetectRe.exec(re);if(Se){const we=ge(Se[1]);return we||(np(l.replace("{}",Se[1])),np("Falling back to no-highlight mode for this block.",q)),we?Se[1]:"no-highlight"}return re.split(/\s+/).find(we=>f(we)||ge(we))}function g(q,re,Se,we){let Ce="",Le="";typeof re=="object"?(Ce=q,Se=re.ignoreIllegals,Le=re.language,we=void 0):(Jr("10.7.0","highlight(lang, code, ...args) has been deprecated."),Jr("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),Le=q,Ce=re);const ft={code:Ce,language:Le};xe("before:highlight",ft);const vt=ft.result?ft.result:y(ft.language,ft.code,Se,we);return vt.code=ft.code,xe("after:highlight",vt),vt}function y(q,re,Se,we){function Ce(be,Oe){const Pe=Ct.case_insensitive?Oe[0].toLowerCase():Oe[0];return Object.prototype.hasOwnProperty.call(be.keywords,Pe)&&be.keywords[Pe]}function Le(){if(!ee.keywords){Ie.addText(Ne);return}let be=0;ee.keywordPatternRe.lastIndex=0;let Oe=ee.keywordPatternRe.exec(Ne),Pe="";for(;Oe;){Pe+=Ne.substring(be,Oe.index);const qe=Ce(ee,Oe);if(qe){const[Qe,je]=qe;if(Ie.addText(Pe),Pe="",ot+=je,Qe.startsWith("_"))Pe+=Oe[0];else{const un=Ct.classNameAliases[Qe]||Qe;Ie.addKeyword(Oe[0],un)}}else Pe+=Oe[0];be=ee.keywordPatternRe.lastIndex,Oe=ee.keywordPatternRe.exec(Ne)}Pe+=Ne.substr(be),Ie.addText(Pe)}function ft(){if(Ne==="")return;let be=null;if(typeof ee.subLanguage=="string"){if(!t[ee.subLanguage]){Ie.addText(Ne);return}be=y(ee.subLanguage,Ne,!0,Ve[ee.subLanguage]),Ve[ee.subLanguage]=be.top}else be=A(Ne,ee.subLanguage.length?ee.subLanguage:null);ee.relevance>0&&(ot+=be.relevance),Ie.addSublanguage(be.emitter,be.language)}function vt(){ee.subLanguage!=null?ft():Le(),Ne=""}function on(be){return be.className&&Ie.openNode(Ct.classNameAliases[be.className]||be.className),ee=Object.create(be,{parent:{value:ee}}),ee}function Rt(be,Oe,Pe){let qe=F9(be.endRe,Pe);if(qe){if(be["on:end"]){const Qe=new Kf(be);be["on:end"](Oe,Qe),Qe.isMatchIgnored&&(qe=!1)}if(qe){for(;be.endsParent&&be.parent;)be=be.parent;return be}}if(be.endsWithParent)return Rt(be.parent,Oe,Pe)}function nn(be){return ee.matcher.regexIndex===0?(Ne+=be[0],1):(Ae=!0,0)}function Ir(be){const Oe=be[0],Pe=be.rule,qe=new Kf(Pe),Qe=[Pe.__beforeBegin,Pe["on:begin"]];for(const je of Qe)if(je&&(je(be,qe),qe.isMatchIgnored))return nn(Oe);return Pe&&Pe.endSameAsBegin&&(Pe.endRe=V9(Oe)),Pe.skip?Ne+=Oe:(Pe.excludeBegin&&(Ne+=Oe),vt(),!Pe.returnBegin&&!Pe.excludeBegin&&(Ne=Oe)),on(Pe),Pe.returnBegin?0:Oe.length}function jt(be){const Oe=be[0],Pe=re.substr(be.index),qe=Rt(ee,be,Pe);if(!qe)return sp;const Qe=ee;Qe.skip?Ne+=Oe:(Qe.returnEnd||Qe.excludeEnd||(Ne+=Oe),vt(),Qe.excludeEnd&&(Ne=Oe));do ee.className&&Ie.closeNode(),!ee.skip&&!ee.subLanguage&&(ot+=ee.relevance),ee=ee.parent;while(ee!==qe.parent);return qe.starts&&(qe.endSameAsBegin&&(qe.starts.endRe=qe.endRe),on(qe.starts)),Qe.returnEnd?0:Oe.length}function Bt(){const be=[];for(let Oe=ee;Oe!==Ct;Oe=Oe.parent)Oe.className&&be.unshift(Oe.className);be.forEach(Oe=>Ie.openNode(Oe))}let qn={};function Fn(be,Oe){const Pe=Oe&&Oe[0];if(Ne+=be,Pe==null)return vt(),0;if(qn.type==="begin"&&Oe.type==="end"&&qn.index===Oe.index&&Pe===""){if(Ne+=re.slice(Oe.index,Oe.index+1),!i){const qe=new Error("0 width match regex");throw qe.languageName=q,qe.badRule=qn.rule,qe}return 1}if(qn=Oe,Oe.type==="begin")return Ir(Oe);if(Oe.type==="illegal"&&!Se){const qe=new Error('Illegal lexeme "'+Pe+'" for mode "'+(ee.className||"<unnamed>")+'"');throw qe.mode=ee,qe}else if(Oe.type==="end"){const qe=jt(Oe);if(qe!==sp)return qe}if(Oe.type==="illegal"&&Pe==="")return 1;if(Et>1e5&&Et>Oe.index*3)throw new Error("potential infinite loop, way more iterations than matches");return Ne+=Pe,Pe.length}const Ct=ge(q);if(!Ct)throw bu(l.replace("{}",q)),new Error('Unknown language: "'+q+'"');const kn=mw(Ct,{plugins:r});let Ln="",ee=we||kn;const Ve={},Ie=new h.__emitter(h);Bt();let Ne="",ot=0,Ke=0,Et=0,Ae=!1;try{for(ee.matcher.considerAll();;){Et++,Ae?Ae=!1:ee.matcher.considerAll(),ee.matcher.lastIndex=Ke;const be=ee.matcher.exec(re);if(!be)break;const Oe=re.substring(Ke,be.index),Pe=Fn(Oe,be);Ke=be.index+Pe}return Fn(re.substr(Ke)),Ie.closeAllNodes(),Ie.finalize(),Ln=Ie.toHTML(),{relevance:Math.floor(ot),value:Ln,language:q,illegal:!1,emitter:Ie,top:ee}}catch(be){if(be.message&&be.message.includes("Illegal"))return{illegal:!0,illegalBy:{msg:be.message,context:re.slice(Ke-100,Ke+100),mode:be.mode},sofar:Ln,relevance:0,value:vu(re),emitter:Ie};if(i)return{illegal:!1,relevance:0,value:vu(re),emitter:Ie,language:q,top:ee,errorRaised:be};throw be}}function b(q){const re={relevance:0,emitter:new h.__emitter(h),value:vu(q),illegal:!1,top:u};return re.emitter.addText(q),re}function A(q,re){re=re||h.languages||Object.keys(t);const Se=b(q),we=re.filter(ge).filter(L).map(on=>y(on,q,!1));we.unshift(Se);const Ce=we.sort((on,Rt)=>{if(on.relevance!==Rt.relevance)return Rt.relevance-on.relevance;if(on.language&&Rt.language){if(ge(on.language).supersetOf===Rt.language)return 1;if(ge(Rt.language).supersetOf===on.language)return-1}return 0}),[Le,ft]=Ce,vt=Le;return vt.second_best=ft,vt}function D(q){return h.tabReplace||h.useBR?q.replace(a,re=>re===`
`?h.useBR?"<br>":re:h.tabReplace?re.replace(/\t/g,h.tabReplace):re):q}function j(q,re,Se){const we=re?n[re]:Se;q.classList.add("hljs"),we&&q.classList.add(we)}const w={"before:highlightElement":({el:q})=>{h.useBR&&(q.innerHTML=q.innerHTML.replace(/\n/g,"").replace(/<br[ /]*>/g,`
`))},"after:highlightElement":({result:q})=>{h.useBR&&(q.value=q.value.replace(/\n/g,"<br>"))}},C=/^(<[^>]+>|\t)+/gm,_={"after:highlightElement":({result:q})=>{h.tabReplace&&(q.value=q.value.replace(C,re=>re.replace(/\t/g,h.tabReplace)))}};function N(q){let re=null;const Se=p(q);if(f(Se))return;xe("before:highlightElement",{el:q,language:Se}),re=q;const we=re.textContent,Ce=Se?g(we,{language:Se,ignoreIllegals:!0}):A(we);xe("after:highlightElement",{el:q,result:Ce,text:we}),q.innerHTML=Ce.value,j(q,Se,Ce.language),q.result={language:Ce.language,re:Ce.relevance,relavance:Ce.relevance},Ce.second_best&&(q.second_best={language:Ce.second_best.language,re:Ce.second_best.relevance,relavance:Ce.second_best.relevance})}function E(q){q.useBR&&(Jr("10.3.0","'useBR' will be removed entirely in v11.0"),Jr("10.3.0","Please see https://github.com/highlightjs/highlight.js/issues/2559")),h=rp(h,q)}const I=()=>{if(I.called)return;I.called=!0,Jr("10.6.0","initHighlighting() is deprecated.  Use highlightAll() instead."),document.querySelectorAll("pre code").forEach(N)};function H(){Jr("10.6.0","initHighlightingOnLoad() is deprecated.  Use highlightAll() instead."),Z=!0}let Z=!1;function ae(){if(document.readyState==="loading"){Z=!0;return}document.querySelectorAll("pre code").forEach(N)}function ne(){Z&&ae()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",ne,!1);function F(q,re){let Se=null;try{Se=re(e)}catch(we){if(bu("Language definition for '{}' could not be registered.".replace("{}",q)),i)bu(we);else throw we;Se=u}Se.name||(Se.name=q),t[q]=Se,Se.rawDefinition=re.bind(null,e),Se.aliases&&W(Se.aliases,{languageName:q})}function J(q){delete t[q];for(const re of Object.keys(n))n[re]===q&&delete n[re]}function pe(){return Object.keys(t)}function G(q){Jr("10.4.0","requireLanguage will be removed entirely in v11."),Jr("10.4.0","Please see https://github.com/highlightjs/highlight.js/pull/2844");const re=ge(q);if(re)return re;throw new Error("The '{}' language is required, but not loaded.".replace("{}",q))}function ge(q){return q=(q||"").toLowerCase(),t[q]||t[n[q]]}function W(q,{languageName:re}){typeof q=="string"&&(q=[q]),q.forEach(Se=>{n[Se.toLowerCase()]=re})}function L(q){const re=ge(q);return re&&!re.disableAutodetect}function Q(q){q["before:highlightBlock"]&&!q["before:highlightElement"]&&(q["before:highlightElement"]=re=>{q["before:highlightBlock"](Object.assign({block:re.el},re))}),q["after:highlightBlock"]&&!q["after:highlightElement"]&&(q["after:highlightElement"]=re=>{q["after:highlightBlock"](Object.assign({block:re.el},re))})}function fe(q){Q(q),r.push(q)}function xe(q,re){const Se=q;r.forEach(function(we){we[Se]&&we[Se](re)})}function ue(q){return Jr("10.2.0","fixMarkup will be removed entirely in v11.0"),Jr("10.2.0","Please see https://github.com/highlightjs/highlight.js/issues/2534"),D(q)}function ke(q){return Jr("10.7.0","highlightBlock will be removed entirely in v12.0"),Jr("10.7.0","Please use highlightElement now."),N(q)}Object.assign(e,{highlight:g,highlightAuto:A,highlightAll:ae,fixMarkup:ue,highlightElement:N,highlightBlock:ke,configure:E,initHighlighting:I,initHighlightingOnLoad:H,registerLanguage:F,unregisterLanguage:J,listLanguages:pe,getLanguage:ge,registerAliases:W,requireLanguage:G,autoDetection:L,inherit:rp,addPlugin:fe,vuePlugin:bw(e).VuePlugin}),e.debugMode=function(){i=!1},e.safeMode=function(){i=!0},e.versionString=yw;for(const q in nl)typeof nl[q]=="object"&&f1(nl[q]);return Object.assign(e,nl),e.addPlugin(w),e.addPlugin(vw),e.addPlugin(_),e};var kw=Sw({}),jw=kw,v1={exports:{}};(function(e){(function(){var t;t=e.exports=i,t.format=i,t.vsprintf=r,typeof console<"u"&&typeof console.log=="function"&&(t.printf=n);function n(){console.log(i.apply(null,arguments))}function r(a,l){return i.apply(null,[a].concat(l))}function i(a){for(var l=1,u=[].slice.call(arguments),h=0,f=a.length,p="",g,y=!1,b,A,D=!1,j,w=function(){return u[l++]},C=function(){for(var _="";/\d/.test(a[h]);)_+=a[h++],g=a[h];return _.length>0?parseInt(_):null};h<f;++h)if(g=a[h],y)switch(y=!1,g=="."?(D=!1,g=a[++h]):g=="0"&&a[h+1]=="."?(D=!0,h+=2,g=a[h]):D=!0,j=C(),g){case"b":p+=parseInt(w(),10).toString(2);break;case"c":b=w(),typeof b=="string"||b instanceof String?p+=b:p+=String.fromCharCode(parseInt(b,10));break;case"d":p+=parseInt(w(),10);break;case"f":A=String(parseFloat(w()).toFixed(j||6)),p+=D?A:A.replace(/^0/,"");break;case"j":p+=JSON.stringify(w());break;case"o":p+="0"+parseInt(w(),10).toString(8);break;case"s":p+=w();break;case"x":p+="0x"+parseInt(w(),10).toString(16);break;case"X":p+="0x"+parseInt(w(),10).toString(16).toUpperCase();break;default:p+=g;break}else g==="%"?y=!0:p+=g;return p}})()})(v1);var Cw=v1.exports,Tw=Cw,Si=ki(Error),Iw=Si;Si.eval=ki(EvalError);Si.range=ki(RangeError);Si.reference=ki(ReferenceError);Si.syntax=ki(SyntaxError);Si.type=ki(TypeError);Si.uri=ki(URIError);Si.create=ki;function ki(e){return t.displayName=e.displayName||e.name,t;function t(n){return n&&(n=Tw.apply(null,arguments)),new e(n)}}var vs=jw,pl=Iw;qi.highlight=w1;qi.highlightAuto=_w;qi.registerLanguage=Ew;qi.listLanguages=Nw;qi.registerAlias=Mw;Ys.prototype.addText=Ow;Ys.prototype.addKeyword=Dw;Ys.prototype.addSublanguage=Rw;Ys.prototype.openNode=Vw;Ys.prototype.closeNode=zw;Ys.prototype.closeAllNodes=S1;Ys.prototype.finalize=S1;Ys.prototype.toHTML=Pw;var Aw="hljs-";function w1(e,t,n){var r=vs.configure({}),i=n||{},a=i.prefix,l;if(typeof e!="string")throw pl("Expected `string` for name, got `%s`",e);if(!vs.getLanguage(e))throw pl("Unknown language: `%s` is not registered",e);if(typeof t!="string")throw pl("Expected `string` for value, got `%s`",t);if(a==null&&(a=Aw),vs.configure({__emitter:Ys,classPrefix:a}),l=vs.highlight(t,{language:e,ignoreIllegals:!0}),vs.configure(r||{}),l.errorRaised)throw l.errorRaised;return{relevance:l.relevance,language:l.language,value:l.emitter.rootNode.children}}function _w(e,t){var n=t||{},r=n.subset||vs.listLanguages();n.prefix;var i=r.length,a=-1,l,u,h,f;if(typeof e!="string")throw pl("Expected `string` for value, got `%s`",e);for(u={relevance:0,language:null,value:[]},l={relevance:0,language:null,value:[]};++a<i;)f=r[a],vs.getLanguage(f)&&(h=w1(f,e,t),h.language=f,h.relevance>u.relevance&&(u=h),h.relevance>l.relevance&&(u=l,l=h));return u.language&&(l.secondBest=u),l}function Ew(e,t){vs.registerLanguage(e,t)}function Nw(){return vs.listLanguages()}function Mw(e,t){var n=e,r;t&&(n={},n[e]=t);for(r in n)vs.registerAliases(n[r],{languageName:r})}function Ys(e){this.options=e,this.rootNode={children:[]},this.stack=[this.rootNode]}function Dw(e,t){this.openNode(t),this.addText(e),this.closeNode()}function Rw(e,t){var n=this.stack,r=n[n.length-1],i=e.rootNode.children,a=t?{type:"element",tagName:"span",properties:{className:[t]},children:i}:i;r.children=r.children.concat(a)}function Ow(e){var t=this.stack,n,r;e!==""&&(n=t[t.length-1],r=n.children[n.children.length-1],r&&r.type==="text"?r.value+=e:n.children.push({type:"text",value:e}))}function Vw(e){var t=this.stack,n=this.options.classPrefix+e,r=t[t.length-1],i={type:"element",tagName:"span",properties:{className:[n]},children:[]};r.children.push(i),t.push(i)}function zw(){this.stack.pop()}function Pw(){return""}function S1(){}function Bw(e){const t={literal:"true false null"},n=[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE],r=[e.QUOTE_STRING_MODE,e.C_NUMBER_MODE],i={end:",",endsWithParent:!0,excludeEnd:!0,contains:r,keywords:t},a={begin:/\{/,end:/\}/,contains:[{className:"attr",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE],illegal:"\\n"},e.inherit(i,{begin:/:/})].concat(n),illegal:"\\S"},l={begin:"\\[",end:"\\]",contains:[e.inherit(i)],illegal:"\\S"};return r.push(a,l),n.forEach(function(u){r.push(u)}),{name:"JSON",contains:r,keywords:t,illegal:"\\S"}}var Fw=Bw;const Lw=vx(Fw);var i0=N9(qi,{});i0.registerLanguage=qi.registerLanguage;const $w={hljs:{display:"block",overflowX:"auto",padding:"0.5em",color:"#abb2bf",background:"#282c34"},"hljs-comment":{color:"#5c6370",fontStyle:"italic"},"hljs-quote":{color:"#5c6370",fontStyle:"italic"},"hljs-doctag":{color:"#c678dd"},"hljs-keyword":{color:"#c678dd"},"hljs-formula":{color:"#c678dd"},"hljs-section":{color:"#e06c75"},"hljs-name":{color:"#e06c75"},"hljs-selector-tag":{color:"#e06c75"},"hljs-deletion":{color:"#e06c75"},"hljs-subst":{color:"#e06c75"},"hljs-literal":{color:"#56b6c2"},"hljs-string":{color:"#98c379"},"hljs-regexp":{color:"#98c379"},"hljs-addition":{color:"#98c379"},"hljs-attribute":{color:"#98c379"},"hljs-meta-string":{color:"#98c379"},"hljs-built_in":{color:"#e6c07b"},"hljs-class .hljs-title":{color:"#e6c07b"},"hljs-attr":{color:"#d19a66"},"hljs-variable":{color:"#d19a66"},"hljs-template-variable":{color:"#d19a66"},"hljs-type":{color:"#d19a66"},"hljs-selector-class":{color:"#d19a66"},"hljs-selector-attr":{color:"#d19a66"},"hljs-selector-pseudo":{color:"#d19a66"},"hljs-number":{color:"#d19a66"},"hljs-symbol":{color:"#61aeee"},"hljs-bullet":{color:"#61aeee"},"hljs-link":{color:"#61aeee",textDecoration:"underline"},"hljs-meta":{color:"#61aeee"},"hljs-selector-id":{color:"#61aeee"},"hljs-title":{color:"#61aeee"},"hljs-emphasis":{fontStyle:"italic"},"hljs-strong":{fontWeight:"bold"}},Gw={hljs:{display:"block",overflowX:"auto",padding:"0.5em",color:"#383a42",background:"#fafafa"},"hljs-comment":{color:"#a0a1a7",fontStyle:"italic"},"hljs-quote":{color:"#a0a1a7",fontStyle:"italic"},"hljs-doctag":{color:"#a626a4"},"hljs-keyword":{color:"#a626a4"},"hljs-formula":{color:"#a626a4"},"hljs-section":{color:"#e45649"},"hljs-name":{color:"#e45649"},"hljs-selector-tag":{color:"#e45649"},"hljs-deletion":{color:"#e45649"},"hljs-subst":{color:"#e45649"},"hljs-literal":{color:"#0184bb"},"hljs-string":{color:"#50a14f"},"hljs-regexp":{color:"#50a14f"},"hljs-addition":{color:"#50a14f"},"hljs-attribute":{color:"#50a14f"},"hljs-meta-string":{color:"#50a14f"},"hljs-built_in":{color:"#c18401"},"hljs-class .hljs-title":{color:"#c18401"},"hljs-attr":{color:"#986801"},"hljs-variable":{color:"#986801"},"hljs-template-variable":{color:"#986801"},"hljs-type":{color:"#986801"},"hljs-selector-class":{color:"#986801"},"hljs-selector-attr":{color:"#986801"},"hljs-selector-pseudo":{color:"#986801"},"hljs-number":{color:"#986801"},"hljs-symbol":{color:"#4078f2"},"hljs-bullet":{color:"#4078f2"},"hljs-link":{color:"#4078f2",textDecoration:"underline"},"hljs-meta":{color:"#4078f2"},"hljs-selector-id":{color:"#4078f2"},"hljs-title":{color:"#4078f2"},"hljs-emphasis":{fontStyle:"italic"},"hljs-strong":{fontWeight:"bold"}};i0.registerLanguage("json",Lw);const an=({code:e,showLineNumbers:t=!1})=>{const{colorMode:n}=tn(),[r,i,a,l]=px("colors",["gray.900","white","gray.700","gray.200"]);return s.jsx(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:n==="dark"?r:i,borderColor:n==="dark"?a:l,children:s.jsx(i0,{language:"json",showLineNumbers:t,style:n==="dark"?$w:Gw,customStyle:{background:"transparent",padding:0,margin:0,fontSize:"0.875rem",lineHeight:"1.5",fontFamily:"monospace"},children:e})})},Hw=()=>s.jsxs(ye,{spacing:6,align:"stretch",children:[s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"System Name & ID"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"systemName"})," (required): Human-readable name for the design token system.",s.jsx("br",{}),s.jsx("b",{children:"systemId"})," (required): Unique identifier for the design token system, using the same pattern as other IDs.",s.jsx("br",{}),s.jsx("b",{children:"description"})," (optional): Human-readable description of the design token system.",s.jsx("br",{}),s.jsx("br",{}),"These fields are required at the top level of every token data file. They ensure that every data set is uniquely and clearly identified, and provide a summary for documentation and discovery."]}),s.jsx(an,{code:JSON.stringify({systemName:"Acme Design System",systemId:"acme-design-system",description:"The canonical design token set for Acme Corp."},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Version & Version History"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"version"})," (required): Semantic version of the token set, following ",s.jsx("a",{href:"https://semver.org/",target:"_blank",rel:"noopener noreferrer",children:"semantic versioning"})," (e.g., 1.0.0).",s.jsx("br",{}),s.jsx("b",{children:"versionHistory"})," (required): Array of previous versions, each with dimension configuration and date. This supports migrations and compatibility tracking."]}),s.jsx(an,{code:JSON.stringify({version:"1.0.0",versionHistory:[{version:"1.0.0",dimensions:["dimension-color-scheme"],date:"2024-06-01",migrationStrategy:{emptyModeIds:"mapToDefaults",preserveOriginalValues:!0}}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Metadata & Configuration"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"metadata"})," (optional): Additional information about the token set including maintainers and last updated date.",s.jsx("br",{}),s.jsx("b",{children:"dimensionOrder"})," (optional): Order of dimensions to use when resolving token values.",s.jsx("br",{}),s.jsx("b",{children:"exportConfigurations"})," (optional): Platform-specific export configuration rules."]}),s.jsx(an,{code:JSON.stringify({metadata:{description:"Core design tokens for Acme Corp applications",lastUpdated:"2024-06-01",maintainers:["design-team@acme.com"]},dimensionOrder:["dimension-color-scheme","dimension-size"],exportConfigurations:{"platform-web":{prefix:"--",delimiter:"-",capitalization:"lowercase"}}},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Resolved Value Types"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"resolvedValueTypes"})," (required): The canonical list of value types supported by the system.",s.jsx("br",{}),"Each value type has a unique ",s.jsx(it,{colorScheme:"purple",children:"id"})," (referenced by tokens, collections, dimensions, and taxonomies), a human-readable ",s.jsx(it,{colorScheme:"purple",children:"displayName"}),", and an optional standard ",s.jsx(it,{colorScheme:"purple",children:"type"})," (UPPER_CASE, for standards compliance).",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Custom value types:"})," You may define your own custom value types by omitting the ",s.jsx(it,{colorScheme:"purple",children:"type"})," field. Custom types must still have a unique ",s.jsx(it,{colorScheme:"purple",children:"id"})," and ",s.jsx(it,{colorScheme:"purple",children:"displayName"}),". These can be referenced by tokens, collections, dimensions, and taxonomies using their ",s.jsx(it,{colorScheme:"purple",children:"id"}),".",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Technical notes:"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsxs($t,{children:["All references to value types elsewhere in the data model must use the ",s.jsx("b",{children:"id"})," field from this array (never UPPER_CASE enums)."]}),s.jsxs($t,{children:["Additional fields like ",s.jsx(it,{colorScheme:"purple",children:"description"})," and ",s.jsx(it,{colorScheme:"purple",children:"validation"})," may be present for documentation and validation purposes."]}),s.jsx($t,{children:"Custom value types allow for extensibility beyond the standard set (see example below)."}),s.jsxs($t,{children:["See ",s.jsx(it,{colorScheme:"purple",children:"schema.json"})," and ",s.jsx(it,{colorScheme:"purple",children:"technical-decisions.md"})," for full structure and rationale."]})]})]}),s.jsx(an,{code:JSON.stringify({resolvedValueTypes:[{id:"color",displayName:"Color",type:"COLOR",description:"A color value, e.g. #RRGGBB or rgba()."},{id:"fontFamily",displayName:"Font Family",type:"FONT_FAMILY",description:"A font family name or stack."},{id:"dimension",displayName:"Dimension",type:"DIMENSION",description:"A numeric value with a unit, e.g. 16px or 1.5rem."},{id:"spacing",displayName:"Spacing",type:"SPACING",description:"A spacing value, e.g. 16px or 1rem."},{id:"icon",displayName:"Icon",description:"A custom value type for referencing icon names in the design system.",validation:{pattern:"^[a-z0-9-]+$"}}]},null,2)}),s.jsxs(B,{fontSize:"sm",color:"gray.500",mt:2,children:[s.jsx("b",{children:"Custom value type example:"})," The ",s.jsx(it,{colorScheme:"purple",children:"icon"})," value type above is a custom type (no ",s.jsx(it,{colorScheme:"purple",children:"type"})," field). It can be referenced by tokens, collections, dimensions, and taxonomies using ",s.jsx(it,{colorScheme:"purple",children:'resolvedValueTypeId: "icon"'})," or ",s.jsx(it,{colorScheme:"purple",children:'resolvedValueTypeIds: ["icon"]'}),". Custom types are validated and referenced exactly like standard types."]})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Token Collections"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"tokenCollections"})," (required): Collections of tokens grouped by type.",s.jsx("br",{}),"Each collection specifies which value types it supports using ",s.jsx(it,{colorScheme:"purple",children:"resolvedValueTypeIds"})," (string IDs, not enums).",s.jsx("br",{}),s.jsx("b",{children:"Technical note:"})," All reference fields use the ",s.jsx("b",{children:"ID/Ids suffix"})," convention for clarity and validation."]}),s.jsx(an,{code:JSON.stringify({tokenCollections:[{id:"collection-color",name:"Color",description:"Color tokens for the design system",resolvedValueTypeIds:["color"],private:!1},{id:"collection-typography",name:"Typography",description:"Typography tokens for the design system",resolvedValueTypeIds:["fontFamily","fontSize","fontWeight","lineHeight"],private:!1}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Dimensions"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"dimensions"})," (required): Dimensions that can modify token values.",s.jsx("br",{}),"Each dimension contains one or more ",s.jsx("b",{children:"modes"})," (with ",s.jsx(it,{colorScheme:"purple",children:"id"}),", ",s.jsx(it,{colorScheme:"purple",children:"name"}),", and ",s.jsx(it,{colorScheme:"purple",children:"dimensionId"}),"), and specifies supported value types via ",s.jsx(it,{colorScheme:"purple",children:"resolvedValueTypeIds"}),".",s.jsx("br",{}),s.jsx("b",{children:"Technical note:"})," All reference fields use the ",s.jsx("b",{children:"ID/Ids suffix"})," convention. Value types are referenced by string ID only."]}),s.jsx(an,{code:JSON.stringify({dimensions:[{id:"dimension-color-scheme",displayName:"Color Scheme",description:"Color scheme dimension for light and dark themes",modes:[{id:"mode-light",name:"Light",description:"Light theme mode",dimensionId:"dimension-color-scheme"},{id:"mode-dark",name:"Dark",description:"Dark theme mode",dimensionId:"dimension-color-scheme"}],resolvedValueTypeIds:["color","dimension","spacing"],defaultMode:"mode-light",required:!0}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Tokens"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"tokens"})," (required): Design tokens with values that can vary by mode.",s.jsx("br",{}),"Each token references its collection and value type by ID (",s.jsx(it,{colorScheme:"purple",children:"tokenCollectionId"}),", ",s.jsx(it,{colorScheme:"purple",children:"resolvedValueTypeId"}),").",s.jsx("br",{}),s.jsx("b",{children:"valuesByMode"}),": Each entry must use ",s.jsx(it,{colorScheme:"purple",children:"modeIds"})," (array of string IDs). Value type is determined by the token's ",s.jsx(it,{colorScheme:"purple",children:"resolvedValueTypeId"}),".",s.jsx("br",{}),s.jsx("b",{children:"Technical note:"})," Never use UPPER_CASE enums for value types; always reference by string ID. Do not add ",s.jsx(it,{colorScheme:"purple",children:"resolvedValueTypeId"})," to individual values."]}),s.jsx(an,{code:JSON.stringify({tokens:[{id:"token-blue-500",displayName:"Blue 500",description:"Primary blue color token",tokenCollectionId:"collection-color",resolvedValueTypeId:"color",tokenTier:"PRIMITIVE",private:!1,status:"stable",themeable:!0,generatedByAlgorithm:!1,propertyTypes:["color","background-color"],codeSyntax:[{platformId:"platform-web",formattedName:"--color-blue-500"},{platformId:"platform-figma",formattedName:"ColorBlue500"}],valuesByMode:[{modeIds:["mode-light"],value:{value:"#3B82F6"}},{modeIds:["mode-dark"],value:{value:"#60A5FA"}},{modeIds:[],value:{tokenId:"token-blue-400"}}]}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Platforms"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"platforms"})," (required): Platforms that can be used to resolve token values.",s.jsx("br",{}),"Each platform can specify naming conventions and value formatting rules for code export using ",s.jsx(it,{colorScheme:"purple",children:"syntaxPatterns"})," and ",s.jsx(it,{colorScheme:"purple",children:"valueFormatters"}),".",s.jsx("br",{}),s.jsx("b",{children:"Technical note:"})," All platform references use ",s.jsx(it,{colorScheme:"purple",children:"id"})," fields. Syntax patterns and value formatters follow the schema structure."]}),s.jsx(an,{code:JSON.stringify({platforms:[{id:"platform-web",displayName:"Web",description:"Web platform for CSS and JavaScript",syntaxPatterns:{prefix:"--",delimiter:"-",capitalization:"lowercase",formatString:"var({name})"},valueFormatters:{color:"hex",dimension:"rem",numberPrecision:2}},{id:"platform-figma",displayName:"Figma",description:"Figma design tool",syntaxPatterns:{prefix:"",delimiter:"",capitalization:"capitalize"}}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Themes"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"themes"})," (required): Themes that can override token values across the entire dataset.",s.jsx("br",{}),"Each theme has an ",s.jsx(it,{colorScheme:"purple",children:"overrideFileUri"})," that points to a theme override file.",s.jsx("br",{}),s.jsx("b",{children:"Technical note:"})," Exactly one theme must be marked as ",s.jsx(it,{colorScheme:"purple",children:"isDefault: true"}),"."]}),s.jsx(an,{code:JSON.stringify({themes:[{id:"theme-default",displayName:"Default Theme",description:"The default theme for the design system",isDefault:!0,overrideFileUri:"themed/default-overrides.json"},{id:"theme-brand-a",displayName:"Brand A Theme",description:"Brand A specific theme overrides",isDefault:!1,overrideFileUri:"themed/brand-a-overrides.json"}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Taxonomies"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"taxonomies"})," (optional): Categorical classification system for organizing tokens.",s.jsx("br",{}),"Each taxonomy contains terms and specifies which value types it supports via ",s.jsx(it,{colorScheme:"purple",children:"resolvedValueTypeIds"}),".",s.jsx("br",{}),s.jsx("b",{children:"Technical note:"})," Taxonomies provide flexible categorization beyond traditional grouping by value type."]}),s.jsx(an,{code:JSON.stringify({taxonomies:[{id:"taxonomy-semantic",name:"Semantic Classification",description:"Semantic classification of tokens",terms:[{id:"term-primary",name:"Primary",description:"Primary brand colors and elements"},{id:"term-secondary",name:"Secondary",description:"Secondary brand colors and elements"}],resolvedValueTypeIds:["color","dimension","spacing"]}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Naming Rules"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"namingRules"})," (optional): Rules for generating code syntax and naming conventions for tokens.",s.jsx("br",{}),s.jsx(it,{colorScheme:"purple",children:"taxonomyOrder"})," determines the order of taxonomy terms when generating code syntax strings."]}),s.jsx(an,{code:JSON.stringify({namingRules:{taxonomyOrder:["taxonomy-semantic","taxonomy-component"]}},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Dimension Evolution"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"dimensionEvolution"})," (optional): Rules for handling dimension changes and migrations.",s.jsx("br",{}),"Defines how to handle empty modeIds and whether to preserve default values when mapping."]}),s.jsx(an,{code:JSON.stringify({dimensionEvolution:{rules:[{whenAdding:"dimension-size",mapEmptyModeIdsTo:["mode-default"],preserveDefaultValues:!0}]}},null,2)})]})]}),qw=()=>{const[e,t]=z.useState(""),[n,r]=z.useState(!0),[i,a]=z.useState(null),{colorMode:l}=tn();return z.useEffect(()=>{(async()=>{r(!0),a(null);try{const h=await Xl.core();t(JSON.stringify(h.default,null,2))}catch{a("Failed to load example data")}finally{r(!1)}})()},[]),n?s.jsx(Y,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:s.jsx(cs,{})}):i?s.jsx(Y,{p:4,children:s.jsx(B,{color:"red.500",children:i})}):s.jsx(Y,{overflow:"auto",height:"100%",children:s.jsx(an,{code:e})})},Uw=()=>s.jsxs(Yl,{maxW:"1000px",p:0,children:[s.jsxs(ye,{spacing:4,align:"stretch",mb:6,children:[s.jsx(yt,{size:"lg",children:"Core Data Schema"}),s.jsx(B,{children:"The core data schema defines the canonical structure for the Token Model system, including tokens, collections, dimensions, platforms, themes, and taxonomies. It serves as the single source of truth for validation and interoperability, defining which tokens are themeable, how they can be customized, and how they relate to each other. The schema requires system identification, versioning, and comprehensive token definitions with support for multi-dimensional modes, platform-specific code syntax, and algorithmic generation."})]}),s.jsxs(Fi,{children:[s.jsxs(Li,{children:[s.jsx(Jn,{children:"Properties"}),s.jsx(Jn,{children:"Example"})]}),s.jsxs(Ia,{children:[s.jsx(fr,{children:s.jsx(Hw,{})}),s.jsx(fr,{children:s.jsx(qw,{})})]})]})]}),Ww=()=>s.jsxs(ye,{spacing:6,align:"stretch",children:[s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"System ID"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"systemId"})," (required): ID of the core token system this theme override is for. This field ensures that the theme override file is linked to the correct core data set. It must match the ",s.jsx(it,{colorScheme:"purple",children:"systemId"})," in the main core data file. This guarantees referential integrity and prevents accidental overrides of the wrong system.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Why is this required?"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsx($t,{children:"Ensures that overrides are only applied to the intended design system."}),s.jsx($t,{children:"Prevents data corruption and accidental cross-system overrides."}),s.jsx($t,{children:"Supports validation and safe merging of theme data."})]})]}),s.jsx(an,{code:JSON.stringify({systemId:"acme-design-system"},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Theme ID"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"themeId"})," (required): ID of the theme these overrides belong to. This field references the specific theme being customized. It must match a theme defined in the core data file's ",s.jsx(it,{colorScheme:"purple",children:"themes"})," array. This linkage ensures that each override file is associated with a valid, existing theme.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Why is this required?"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsx($t,{children:"Guarantees that overrides are only applied to valid, pre-defined themes."}),s.jsx($t,{children:"Prevents orphaned or misapplied overrides."}),s.jsx($t,{children:"Supports validation and safe theme management."})]})]}),s.jsx(an,{code:JSON.stringify({themeId:"theme-brand-a"},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Token Overrides"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"tokenOverrides"})," (required): Overrides for tokens in this theme. This array lists all the tokens whose values are being customized for the theme. Each entry must reference a valid, themeable token from the core data set. Only tokens marked as ",s.jsx(it,{colorScheme:"purple",children:"themeable: true"})," in the core data can be overridden.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"valuesByMode Structure:"})," Each token override uses the same ",s.jsx(it,{colorScheme:"purple",children:"valuesByMode"})," structure as the core schema, with ",s.jsx(it,{colorScheme:"purple",children:"modeIds"})," arrays and support for both direct values and aliases.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Why this structure?"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsx($t,{children:"Ensures that only explicitly themeable tokens can be overridden, preserving the integrity of core tokens."}),s.jsx($t,{children:"Allows theme designers to safely extend or customize the design system without modifying the core data."}),s.jsx($t,{children:"Supports mode-specific overrides, enabling different values for different theme modes (e.g., light/dark)."}),s.jsx($t,{children:"Supports validation: each override is checked for type and value constraints, and must reference a valid token ID."})]}),s.jsx("b",{children:"Technical note:"})," The ",s.jsx(it,{colorScheme:"purple",children:"value"})," object must match the type and constraints of the original token. This ensures that overrides are always valid and compatible with the core schema."]}),s.jsx(an,{code:JSON.stringify({tokenOverrides:[{tokenId:"token-primary-color",valuesByMode:[{modeIds:["mode-light"],value:{value:"#FF6F61"}},{modeIds:["mode-dark"],value:{value:"#FF8A80"}},{modeIds:[],value:{tokenId:"token-accent-color"}}]}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Platform Overrides"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"platformOverrides"})," (optional): Platform-specific overrides within each ",s.jsx(it,{colorScheme:"purple",children:"valuesByMode"})," entry. This allows you to specify different override values for different platforms (e.g., Web, iOS, Android) within a specific mode combination.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Why platform overrides?"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsx($t,{children:"Enables fine-grained control over how tokens are rendered or exported for each platform."}),s.jsx($t,{children:"Supports platform-specific design requirements and constraints."}),s.jsx($t,{children:"Ensures that overrides remain valid and consistent across all platforms."}),s.jsx($t,{children:"Allows mode-specific platform overrides (e.g., different web colors for light vs dark modes)."})]}),s.jsx("b",{children:"Technical note:"})," Each ",s.jsx(it,{colorScheme:"purple",children:"platformId"})," must reference a valid platform defined in the core data. The ",s.jsx(it,{colorScheme:"purple",children:"value"})," must be a string that matches the platform's expected format."]}),s.jsx(an,{code:JSON.stringify({tokenOverrides:[{tokenId:"token-primary-color",valuesByMode:[{modeIds:["mode-light"],value:{value:"#FF6F61"},platformOverrides:[{platformId:"platform-web",value:"#FF6F61",metadata:{description:"Web-specific primary color override"}},{platformId:"platform-ios",value:"#FF6F61",metadata:{description:"iOS-specific primary color override"}}]}]}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Metadata"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"metadata"})," (optional): Additional information about specific value overrides. This can include descriptions, change reasons, or other contextual information about why a particular override was made.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Why metadata?"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsx($t,{children:"Provides context for why specific overrides were made."}),s.jsx($t,{children:"Supports documentation and change tracking."}),s.jsx($t,{children:"Helps maintainers understand the reasoning behind theme customizations."})]})]}),s.jsx(an,{code:JSON.stringify({tokenOverrides:[{tokenId:"token-primary-color",valuesByMode:[{modeIds:["mode-light"],value:{value:"#FF6F61"},metadata:{description:"Brand A primary color for light mode",changeReason:"Brand guidelines update",approvedBy:"design-team"}}]}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Complete Example"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"Complete theme override structure:"})," This example shows a comprehensive theme override file with all available features including mode-specific values, platform overrides, and metadata."]}),s.jsx(an,{code:JSON.stringify({systemId:"acme-design-system",themeId:"theme-brand-a",tokenOverrides:[{tokenId:"token-primary-color",valuesByMode:[{modeIds:["mode-light"],value:{value:"#FF6F61"},platformOverrides:[{platformId:"platform-web",value:"#FF6F61"}],metadata:{description:"Brand A primary color for light mode"}},{modeIds:["mode-dark"],value:{value:"#FF8A80"},metadata:{description:"Brand A primary color for dark mode"}}]},{tokenId:"token-accent-color",valuesByMode:[{modeIds:[],value:{tokenId:"token-primary-color"}}]}]},null,2)})]})]}),Zw=()=>{const[e,t]=z.useState(""),[n,r]=z.useState(!0),[i,a]=z.useState(null),{colorMode:l}=tn();return z.useEffect(()=>{(async()=>{r(!0),a(null);try{const h=await Xl.brandAOverrides();t(JSON.stringify(h.default,null,2))}catch{a("Failed to load example data")}finally{r(!1)}})()},[]),n?s.jsx(Y,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:s.jsx(cs,{})}):i?s.jsx(Y,{p:4,children:s.jsx(B,{color:"red.500",children:i})}):s.jsx(Y,{overflow:"auto",height:"100%",children:s.jsx(an,{code:e})})},Yw=()=>s.jsxs(Yl,{maxW:"1000px",p:0,children:[s.jsxs(ye,{spacing:4,align:"stretch",mb:6,children:[s.jsx(yt,{size:"lg",children:"Theme Overrides Schema"}),s.jsx(B,{children:"Theme overrides provide a safe, schema-driven way to extend or customize tokens that are explicitly marked as themeable in the core data. This schema enables teams to create and maintain different themes independently, without modifying the core token set. Each theme override file must reference the core system ID and can only override tokens that are explicitly marked as themeable. The schema supports mode-specific overrides, platform-specific values, and comprehensive metadata for change tracking and documentation."})]}),s.jsxs(Fi,{children:[s.jsxs(Li,{children:[s.jsx(Jn,{children:"Properties"}),s.jsx(Jn,{children:"Example"})]}),s.jsxs(Ia,{children:[s.jsx(fr,{children:s.jsx(Ww,{})}),s.jsx(fr,{children:s.jsx(Zw,{})})]})]})]}),Jw=()=>s.jsxs(ye,{spacing:6,align:"stretch",children:[s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Schema Version & Profile"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"schemaVersion"})," (required): Semantic version of the algorithm schema, following semantic versioning (e.g., 5.0.0).",s.jsx("br",{}),s.jsx("b",{children:"profile"})," (optional): Complexity profile determining available features and validation strictness. Options are ",s.jsx(it,{colorScheme:"purple",children:"basic"}),", ",s.jsx(it,{colorScheme:"purple",children:"standard"}),", or ",s.jsx(it,{colorScheme:"purple",children:"advanced"}),".",s.jsx("br",{}),s.jsx("br",{}),"The profile determines which features are available and how strict validation should be. Basic profiles have simpler validation rules, while advanced profiles support complex mathematical operations and conditional logic."]}),s.jsx(an,{code:JSON.stringify({schemaVersion:"5.0.0",profile:"basic"},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Metadata"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"metadata"})," (optional): Information about the algorithm collection including name, description, version, and author.",s.jsx("br",{}),"This provides context and documentation for the algorithm collection, making it easier to understand its purpose and maintain it over time."]}),s.jsx(an,{code:JSON.stringify({metadata:{name:"Design System Algorithm Collection",description:"Algorithms for generating design tokens programmatically",version:"1.0.0",author:"Design System Team"}},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"System Variables"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"config.systemVariables"})," (optional): Global variables that can be referenced by algorithms across the collection.",s.jsx("br",{}),"System variables can be mode-based, allowing different values for different contexts (e.g., viewport sizes, text size indices).",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Mode-Based Variables:"})," Variables with ",s.jsx(it,{colorScheme:"purple",children:"modeBased: true"})," use the same ",s.jsx(it,{colorScheme:"purple",children:"valuesByMode"})," structure as tokens, with ",s.jsx(it,{colorScheme:"purple",children:"modeIds"})," arrays and mode-specific values."]}),s.jsx(an,{code:JSON.stringify({config:{systemVariables:[{id:"viewport-width",name:"viewportWidth",type:"number",defaultValue:320,description:"Current viewport width for responsive calculations",modeBased:!0,dimensionId:"dimension-viewport",valuesByMode:[{modeIds:["mode-mobile"],value:320},{modeIds:["mode-tablet"],value:768},{modeIds:["mode-desktop"],value:1200}]},{id:"text-size-index",name:"textSizeIndex",type:"number",defaultValue:0,description:"Text size index for typography scaling",constraints:{min:-2,max:2,step:1}}]}},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Algorithms"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"algorithms"})," (required): Array of algorithm definitions for generating design tokens programmatically.",s.jsx("br",{}),"Each algorithm specifies variables, formulas, conditions, and execution steps to produce token values.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Key Components:"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"resolvedValueTypeId"}),": References the value type this algorithm generates (must match core schema)"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"variables"}),": Input variables with types, defaults, and constraints"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"formulas"}),": Mathematical expressions in multiple formats (LaTeX, JavaScript, AST)"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"conditions"}),": Validation and conditional logic"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"steps"}),": Execution order of formulas and conditions"]})]})]}),s.jsx(an,{code:JSON.stringify({algorithms:[{id:"typography-scale-algorithm",name:"Typography Scale Algorithm",description:"Generates font sizes using modular scale",resolvedValueTypeId:"fontSize",variables:[{id:"base",name:"Base",type:"number",defaultValue:"16",description:"Base font size"},{id:"ratio",name:"Ratio",type:"number",defaultValue:"1.25",description:"Modular scale ratio"}],formulas:[{id:"font-size-calculation",name:"Font Size Calculation",description:"Calculate font size using modular scale",expressions:{latex:{value:"fontSize = base \\times ratio^n"},javascript:{value:"fontSize = base * Math.pow(ratio, n)",metadata:{allowedOperations:["math"]}},ast:{type:"assignment",variableName:"fontSize",expression:{type:"binary",operator:"*",left:{type:"variable",variableName:"base"},right:{type:"function",functionName:"Math.pow",arguments:[{type:"variable",variableName:"ratio"},{type:"variable",variableName:"n"}]}}}},variableIds:["base","ratio"]}],conditions:[{id:"validate-ratio",name:"Validate Ratio",expression:"ratio > 0 && ratio <= 2",variableIds:["ratio"]}],steps:[{type:"condition",id:"validate-ratio",name:"Validate Ratio"},{type:"formula",id:"font-size-calculation",name:"Calculate Font Size"}]}]},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Expression Formats"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"expressions"}),": Each formula supports multiple expression formats for different use cases and validation.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"LaTeX:"})," Mathematical notation for documentation and display purposes.",s.jsx("br",{}),s.jsx("b",{children:"JavaScript:"})," Executable code with metadata about allowed operations.",s.jsx("br",{}),s.jsx("b",{children:"AST:"})," Abstract Syntax Tree for validation, analysis, and transformation.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Technical note:"})," All expressions must produce the same result regardless of format. The AST format enables advanced validation and optimization."]}),s.jsx(an,{code:JSON.stringify({expressions:{latex:{value:"result = base \\times multiplier^n"},javascript:{value:"result = base * Math.pow(multiplier, n)",metadata:{allowedOperations:["math"]}},ast:{type:"assignment",variableName:"result",expression:{type:"binary",operator:"*",left:{type:"variable",variableName:"base"},right:{type:"function",functionName:"Math.pow",arguments:[{type:"variable",variableName:"multiplier"},{type:"variable",variableName:"n"}]}},metadata:{astVersion:"1.0.0",validationErrors:[],complexity:"medium"}}}},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Execution Configuration"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"execution"})," (optional): Configuration for algorithm execution including order, parallel processing, and error handling.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Key Features:"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"order"}),": Explicit execution order for algorithms (optional if auto-detected)"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"parallel"}),": Enable parallel execution if supported"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"onError"}),": Error handling strategy (stop, skip, warn)"]})]})]}),s.jsx(an,{code:JSON.stringify({execution:{order:["typography-scale-algorithm","spacing-scale-algorithm"],parallel:!1,onError:"stop"}},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Integration Settings"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"integration"})," (optional): Settings for integrating with the main token schema and output generation.",s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{children:"Key Features:"}),s.jsxs(Ls,{mt:1,mb:1,children:[s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"targetSchema"}),": URI or path to the target token schema"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"outputFormat"}),": Format for generated tokens (design-tokens, custom)"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"mergeStrategy"}),": How to handle existing tokens (replace, merge, append)"]}),s.jsxs($t,{children:[s.jsx(it,{colorScheme:"purple",children:"validation"}),": Whether to validate generated tokens against the target schema"]})]})]}),s.jsx(an,{code:JSON.stringify({integration:{targetSchema:"https://designsystem.org/schemas/tokens/v1.0.0",outputFormat:"design-tokens",mergeStrategy:"merge",validation:!0}},null,2)})]}),s.jsxs(Y,{children:[s.jsx(yt,{size:"md",mb:4,children:"Examples"}),s.jsxs(B,{mb:2,children:[s.jsx("b",{children:"examples"})," (optional): Use case examples for testing and validation of algorithms.",s.jsx("br",{}),"Each example includes configuration, algorithms, and expected output to help users understand how to use the algorithms effectively."]}),s.jsx(an,{code:JSON.stringify({examples:[{name:"Basic Typography Scale",description:"Generate font sizes for a typography scale",useCase:"Typography system generation",config:{baseFontSize:16,ratio:1.25},algorithms:[{id:"typography-scale-algorithm",variables:{base:16,ratio:1.25}}],expectedOutput:{tokens:[{name:"font-size-0",value:16,description:"Base font size"},{name:"font-size-1",value:20,description:"Font size with ratio applied once"}]}}]},null,2)})]})]}),Xw=()=>{const[e,t]=z.useState(""),[n,r]=z.useState(!0),[i,a]=z.useState(null);return z.useEffect(()=>{(async()=>{r(!0),a(null);try{const u=await Hp.minimal();if(u)t(JSON.stringify(u.default,null,2));else throw new Error("No algorithm example data available")}catch(u){a("Failed to load example data"),console.error("Error loading algorithm example data:",u)}finally{r(!1)}})()},[]),n?s.jsx(Y,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:s.jsx(cs,{})}):i?s.jsx(Y,{p:4,children:s.jsx(B,{color:"red.500",children:i})}):s.jsx(Y,{overflow:"auto",height:"100%",children:s.jsx(an,{code:e})})},Kw=()=>s.jsxs(Yl,{maxW:"1000px",p:0,children:[s.jsxs(ye,{spacing:4,align:"stretch",mb:6,children:[s.jsx(yt,{size:"lg",children:"Algorithm Data Schema"}),s.jsx(B,{children:"The algorithm data schema defines the structure for algorithmic design token generation with support for multiple expression formats, system variables, and execution workflows. It serves as the foundation for programmatic token generation, enabling teams to create dynamic design systems that can adapt to different contexts and requirements. The schema supports mathematical formulas, conditional logic, platform-specific execution, and seamless integration with the core token system."})]}),s.jsxs(Fi,{children:[s.jsxs(Li,{children:[s.jsx(Jn,{children:"Properties"}),s.jsx(Jn,{children:"Example"})]}),s.jsxs(Ia,{children:[s.jsx(fr,{children:s.jsx(Jw,{})}),s.jsx(fr,{children:s.jsx(Xw,{})})]})]})]});function ei(e,t){const n=t.find(r=>r.id===e);return n?n.name:(console.warn(`Unknown modeId: ${e}`),`Unknown Mode (${e})`)}function na(e){return e.length===0?[[]]:e.map(n=>n.modes.map(r=>r.id)).reduce((n,r)=>n.flatMap(i=>r.map(a=>[...i,a])),[[]])}function Qw(e){const t=he.getDimensionOrder(),n=[...e].sort((a,l)=>{const u=t.indexOf(a.id),h=t.indexOf(l.id);return u===-1?1:h===-1?-1:u-h}),r=n.find(a=>a.modes.length<=3),i=n.filter(a=>a!==r);return{columnDimensions:r?[r]:[],rowDimensions:i}}function wu(e,t){const n=t.find(r=>r.id===e);if(!n)throw new Error(`Unknown value type: ${e}`);switch(n.type){case"COLOR":return{value:"#000000"};case"DIMENSION":case"SPACING":case"FONT_SIZE":case"LINE_HEIGHT":case"LETTER_SPACING":case"BLUR":case"SPREAD":case"RADIUS":return{value:0};case"FONT_WEIGHT":return{value:400};case"FONT_FAMILY":return{value:"system-ui"};case"DURATION":return{value:0};case"CUBIC_BEZIER":return{value:"cubic-bezier(0.4, 0, 0.2, 1)"};default:return{value:""}}}function eS({columnDimensions:e,rowDimensions:t,modes:n,valueMap:r,getValueEditor:i,onDeleteValue:a,resolvedValueTypeId:l,resolvedValueTypes:u,onAddValue:h,isDisabled:f}){var y;const p=na(e),g=na(t);if(t.length>1){const b=t[0],A=t.slice(1);return s.jsxs(Bs,{size:"sm",variant:"simple",width:"100%",children:[s.jsx(ai,{children:s.jsxs(ir,{children:[s.jsx(pn,{children:b.displayName}),p.map((D,j)=>s.jsx(pn,{colSpan:1,children:D.map(w=>ei(w,n)).join(" + ")},j))]})}),s.jsx(Fs,{children:b.modes.map(D=>s.jsx(kt.Fragment,{children:na(A).map((j,w)=>s.jsxs(ir,{children:[w===0&&s.jsx(sn,{rowSpan:na(A).length,children:ei(D.id,n)}),p.map((C,_)=>([D.id,...j,...C].sort(),s.jsx(sn,{children:s.jsx(Bs,{size:"sm",variant:"simple",children:s.jsx(Fs,{children:j.map((N,E)=>{const I=[D.id,...j,...C].sort(),H=I.join(","),Z=r.get(H);return s.jsxs(ir,{children:[s.jsx(sn,{align:"left",children:ei(N,n)}),s.jsx(sn,{align:"left",children:s.jsxs(Y,{display:"flex",alignItems:"flex-start",gap:2,children:[Z?i(Z.value,I):s.jsx(Ee,{size:"sm",variant:"outline",onClick:()=>h(I,wu(l,u)),isDisabled:f,children:"Add value"}),Z&&s.jsx(mt,{"aria-label":"Remove value",icon:s.jsx(ws,{size:16}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>a(I),isDisabled:f})]})})]},E)})})})},_)))]},`${D.id}-${w}`))},D.id))})]})}if(e.length>1){const b=e[0],A=e.slice(1);return s.jsxs(Bs,{size:"sm",variant:"simple",children:[s.jsx(ai,{children:s.jsxs(ir,{children:[s.jsx(pn,{children:(y=t[0])==null?void 0:y.displayName}),b.modes.map(D=>s.jsx(pn,{colSpan:1,children:ei(D.id,n)},D.id))]})}),s.jsx(Fs,{children:g.map((D,j)=>s.jsxs(ir,{children:[s.jsx(sn,{children:ei(D[0],n)}),b.modes.map(w=>s.jsx(sn,{children:s.jsxs(Bs,{size:"sm",variant:"simple",children:[s.jsx(ai,{children:s.jsx(ir,{children:na(A).map((C,_)=>s.jsx(pn,{children:C.map(N=>ei(N,n)).join(" + ")},_))})}),s.jsx(Fs,{children:s.jsx(ir,{children:na(A).map((C,_)=>{const N=[...D,w.id,...C].sort(),E=N.join(","),I=r.get(E);return s.jsx(sn,{children:s.jsxs(Y,{display:"flex",alignItems:"center",gap:2,children:[I?i(I.value,N):s.jsx(Ee,{size:"sm",variant:"outline",onClick:()=>h(N,wu(l,u)),isDisabled:f,children:"Add value"}),I&&s.jsx(mt,{"aria-label":"Remove value",icon:s.jsx(ws,{size:16}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>a(N),isDisabled:f})]})},_)})})})]})},w.id))]},j))})]})}return s.jsxs(Bs,{size:"sm",variant:"simple",children:[s.jsx(ai,{children:s.jsxs(ir,{children:[t.map(b=>s.jsx(pn,{children:b.displayName},b.id)),p.map((b,A)=>s.jsx(pn,{children:b.map(D=>ei(D,n)).join(" + ")},A))]})}),s.jsx(Fs,{children:g.map((b,A)=>s.jsxs(ir,{children:[b.map(D=>s.jsx(sn,{children:s.jsx(B,{fontSize:"sm",children:ei(D,n)})},D)),p.map((D,j)=>{const w=[...b,...D].sort(),C=w.join(","),_=r.get(C);return s.jsx(sn,{children:s.jsxs(Y,{display:"flex",alignItems:"center",gap:2,children:[_?i(_.value,w):s.jsx(Ee,{size:"sm",variant:"outline",onClick:()=>h(w,wu(l,u)),isDisabled:f,children:"Add value"}),_&&s.jsx(mt,{"aria-label":"Remove value",icon:s.jsx(ws,{size:16}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>a(w),isDisabled:f})]})},j)})]},A))})]})}function ip({valuesByMode:e,modes:t,dimensions:n,getValueEditor:r,onDeleteValue:i,resolvedValueTypeId:a,resolvedValueTypes:l,onAddValue:u,isDisabled:h}){const f=b=>{if(typeof b=="string")return b;if(typeof b=="object"&&b){if("value"in b)return b.value;if("tokenId"in b)return`alias:${b.tokenId}`}return String(b)};console.log("[ValueByModeTable] Rendering with values:",{valuesByMode:e.map(b=>({modeIds:b.modeIds,value:b.value,valueType:typeof b.value,actualValue:f(b.value),valueString:JSON.stringify(b.value)})),dimensions:n.map(b=>({id:b.id,displayName:b.displayName})),modes:t.map(b=>({id:b.id,name:b.name}))});const p=new Map;e.forEach(b=>{const A=b.modeIds.slice().sort().join(",");p.set(A,b)}),console.log("[ValueByModeTable] Value map created:",{valueMapEntries:Array.from(p.entries()).map(([b,A])=>({key:b,value:{modeIds:A.modeIds,value:A.value,valueType:typeof A.value,actualValue:f(A.value),valueString:JSON.stringify(A.value)}}))});const{columnDimensions:g,rowDimensions:y}=Qw(n);return s.jsx(Y,{overflowX:"auto",children:s.jsx(eS,{columnDimensions:g,rowDimensions:y,modes:t,valueMap:p,getValueEditor:r,onDeleteValue:i,resolvedValueTypeId:a,resolvedValueTypes:l,onAddValue:u,isDisabled:h})})}function ap(e){var n;const t=(n=e.valuesByMode)==null?void 0:n[0];return t?"value"in t.value?String(t.value.value):"tokenId"in t.value?` ${t.value.tokenId}`:"":""}function Su({value:e,tokens:t,excludeTokenId:n,modes:r,resolvedValueTypeId:i,resolvedValueTypes:a,onChange:l,isDisabled:u}){const{isOpen:h,onOpen:f,onClose:p}=ca(),[g,y]=z.useState(""),b=a.find(I=>I.id===i);if(!b)throw new Error(`Unknown value type: ${i}`);const A=t.filter(I=>!(I.id===n||I.resolvedValueTypeId!==i||!I.displayName.toLowerCase().includes(g.toLowerCase()))),D=I=>{if(b.type)switch(b.type){case"COLOR":case"FONT_FAMILY":case"CUBIC_BEZIER":l({value:String(I)});break;case"DIMENSION":case"SPACING":case"FONT_WEIGHT":case"FONT_SIZE":case"LINE_HEIGHT":case"LETTER_SPACING":case"DURATION":case"BLUR":case"SPREAD":case"RADIUS":l({value:Number(I)});break;default:l({value:String(I)})}else l({value:String(I)})},j=I=>{l({tokenId:I.id}),p()},w=()=>{if(b.type)switch(b.type){case"COLOR":return s.jsx(ut,{size:"sm",value:typeof e=="object"&&"value"in e?String(e.value):"",onChange:I=>D(I.target.value),placeholder:"Enter color (hex)",isDisabled:u});case"DIMENSION":case"SPACING":case"FONT_WEIGHT":case"FONT_SIZE":case"LINE_HEIGHT":case"LETTER_SPACING":case"DURATION":case"BLUR":case"SPREAD":case"RADIUS":return s.jsxs(Au,{size:"sm",value:typeof e=="object"&&"value"in e?Number(e.value):0,onChange:(I,H)=>D(H),isDisabled:u,children:[s.jsx(_u,{}),s.jsxs(Eu,{children:[s.jsx(Nu,{}),s.jsx(Mu,{})]})]});case"FONT_FAMILY":case"CUBIC_BEZIER":return s.jsx(ut,{size:"sm",value:typeof e=="object"&&"value"in e?String(e.value):"",onChange:I=>D(I.target.value),placeholder:`Enter ${b.type.toLowerCase()}`,isDisabled:u});default:return s.jsx(ut,{size:"sm",value:typeof e=="object"&&"value"in e?String(e.value):"",onChange:I=>D(I.target.value),placeholder:"Enter value",isDisabled:u})}return s.jsx(ut,{size:"sm",value:typeof e=="object"&&"value"in e?String(e.value):"",onChange:I=>D(I.target.value),placeholder:"Enter value",isDisabled:u})},C=typeof e=="object"&&"tokenId"in e?t.find(I=>I.id===e.tokenId):void 0;function _(I){if(Array.isArray(I.valuesByMode)){if(Array.isArray(r)&&r.length>0){const Z=I.valuesByMode.find(ae=>Array.isArray(ae.modeIds)&&ae.modeIds.length===r.length&&ae.modeIds.every((ne,F)=>ne===r[F]));if(Z)return Z.value}const H=I.valuesByMode.find(Z=>Array.isArray(Z.modeIds)&&Z.modeIds.length===0);if(H)return H.value;if(I.valuesByMode.length>0)return I.valuesByMode[0].value}}const N=()=>{if(C){const I=_(C);I&&"value"in I&&l({value:I.value})}},E=s.jsxs(so,{children:[s.jsx(Mp,{}),s.jsx(mx,{}),s.jsx(io,{children:s.jsxs(ye,{spacing:2,align:"stretch",children:[s.jsx(ut,{placeholder:"Search tokens...",value:g,size:"sm",onChange:I=>y(I.target.value)}),s.jsx(gx,{spacing:0,children:A.map(I=>s.jsx($t,{children:s.jsx(Ee,{variant:"ghost",width:"100%",justifyContent:"flex-start",size:"sm",onClick:()=>j(I),children:s.jsx(Uu,{displayName:I.displayName,resolvedValueTypeId:I.resolvedValueTypeId,resolvedValueTypes:a,value:ap(I)})})},I.id))})]})})]});return s.jsx(ye,{spacing:2,align:"stretch",children:s.jsx(ve,{children:typeof e=="object"&&"tokenId"in e&&C?s.jsxs(s.Fragment,{children:[s.jsxs(pa,{isOpen:h,onClose:p,placement:"bottom-start",children:[s.jsx(ma,{children:s.jsx(Y,{width:"100%",children:s.jsx(Uu,{displayName:C.displayName,resolvedValueTypeId:C.resolvedValueTypeId,resolvedValueTypes:a,value:ap(C),onClick:u?void 0:f})})}),E]}),s.jsx(mt,{size:"sm","aria-label":"Unlink token alias",icon:s.jsx(Sb,{size:16}),onClick:N,isDisabled:u})]}):s.jsxs(s.Fragment,{children:[w(),s.jsxs(pa,{isOpen:h,onClose:p,placement:"bottom-start",children:[s.jsx(ma,{children:s.jsx(mt,{size:"sm","aria-label":"Search tokens",icon:s.jsx(om,{size:16}),onClick:f,isDisabled:u})}),E]})]})})})}function ti(e,t){return t?Lb(e,t.resolvedValueTypes):{value:""}}function op(e,t){return e.filter(n=>Array.isArray(n.resolvedValueTypeIds)&&n.resolvedValueTypeIds.includes(t))}function tS(e,t,n,r,i,a){console.log("getPlatformOverridesForTable input:",{valuesByMode:e.map(h=>{var f,p;return{modeIds:h.modeIds,hasOverrides:!!h.platformOverrides,overrideCount:((f=h.platformOverrides)==null?void 0:f.length)||0,overridePlatforms:((p=h.platformOverrides)==null?void 0:p.map(g=>g.platformId))||[]}}),platformId:t,resolvedValueTypeId:i});const l=e.filter(h=>{var p;const f=(p=h.platformOverrides)==null?void 0:p.some(g=>g.platformId===t);return console.log("Checking modeIds:",h.modeIds,"hasOverride:",f),f});if(console.log("Mode combinations with overrides:",l.map(h=>({modeIds:h.modeIds,overrides:h.platformOverrides}))),l.length===0)return console.log("No overrides found for platform:",t),[];const u=l.map(h=>{var y;const f=(y=h.platformOverrides)==null?void 0:y.find(b=>b.platformId===t);if(console.log("Processing override:",{modeIds:h.modeIds,override:f,allOverrides:h.platformOverrides}),!f)return console.log("No override found for modeIds:",h.modeIds),{modeIds:h.modeIds,value:ti(i,{resolvedValueTypes:a})};let p;try{i==="color"?p={value:f.value}:p=JSON.parse(f.value)}catch(b){console.warn("Failed to parse override value:",f.value,b),p={value:f.value}}const g={modeIds:h.modeIds,value:p};return console.log("Transformed override:",g),g});return console.log("Final transformed overrides:",u),u}function lp(e,t,n){var a;const r=[];if(!e.tokenCollectionId)return r;const i=(t??[]).find(l=>l.id===e.tokenCollectionId);return i?(i.resolvedValueTypeIds.includes(e.resolvedValueTypeId)||r.push(`Token '${e.displayName}' has type '${((a=n.find(l=>l.id===e.resolvedValueTypeId))==null?void 0:a.displayName)||e.resolvedValueTypeId}' which is not supported by collection '${i.name}'`),r):(r.push(`Token '${e.displayName}' references non-existent collection id '${e.tokenCollectionId}'`),r)}const xr=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e){if("value"in e)return e.value;if("tokenId"in e)return`alias:${e.tokenId}`}return String(e)};function nS({token:e,tokens:t,dimensions:n,modes:r,platforms:i,open:a,onClose:l,onSave:u,taxonomies:h,resolvedValueTypes:f,isNew:p=!1,onViewClassifications:g,schema:y,onDeleteToken:b,collections:A}){var Ln;console.debug("[TokenEditorDialog] Received resolvedValueTypes:",f);const{colorMode:D}=tn(),[j,w]=z.useState(()=>{if(p)return{...e,id:Vr("token"),themeable:e.themeable??!1,valuesByMode:[{modeIds:[],value:ti(e.resolvedValueTypeId,{resolvedValueTypes:f})}]};const{valuesByMode:ee,...Ve}=e;return{...Ve,themeable:e.themeable??!1,valuesByMode:ee.map(Ie=>({...Ie,platformOverrides:Ie.platformOverrides?[...Ie.platformOverrides]:[]}))}}),[C,_]=z.useState(()=>Array.isArray(e.taxonomies)?e.taxonomies:[]),[N,E]=z.useState([]),I=z.useRef({}),H=z.useRef(null),[Z,ae]=z.useState(()=>op(h,e.resolvedValueTypeId));z.useEffect(()=>{const ee=op(h,j.resolvedValueTypeId);ae(ee);const Ve=new Set(ee.map(Ne=>Ne.id)),Ie=C.filter(Ne=>Ve.has(Ne.taxonomyId));Ie.length!==C.length&&_(Ie)},[j.resolvedValueTypeId,h]),z.useEffect(()=>{if(a&&y){const{valuesByMode:ee,...Ve}=e,Ie={...Ve,themeable:e.themeable??!1,valuesByMode:ee.map(Ke=>({...Ke,platformOverrides:Ke.platformOverrides?[...Ke.platformOverrides]:[]}))};w(p?Ke=>({...Ie,id:Ke.id}):Ie),H.current=Ie,_(Array.isArray(e.taxonomies)?e.taxonomies:[]),E(n.filter(Ke=>Ke.required).map(Ke=>Ke.id));const Ne={platforms:i,taxonomies:h,namingRules:(y==null?void 0:y.namingRules)||{taxonomyOrder:[]}},ot={...Ie,taxonomies:Array.isArray(e.taxonomies)?e.taxonomies:[],codeSyntax:ua.generateAllCodeSyntaxes({...Ie,taxonomies:Array.isArray(e.taxonomies)?e.taxonomies:[],valuesByMode:Ie.valuesByMode},Ne)};w(p?Ke=>({...ot,id:Ke.id}):ot)}},[e,a,n,i,h,y==null?void 0:y.namingRules,p]),z.useEffect(()=>{if(e.valuesByMode&&e.valuesByMode.length>0){const ee=e.valuesByMode.flatMap(Ie=>Ie.modeIds),Ve=n.filter(Ie=>Ie.modes.some(Ne=>ee.includes(Ne.id))).map(Ie=>Ie.id);E(Ve)}else E([])},[e,a,n]);const ne=ee=>{console.log("[handleToggleDimension] Starting dimension toggle:",{dimensionId:ee,isActive:N.includes(ee),currentActiveDimensions:N,currentValuesByMode:j.valuesByMode.map(Ne=>({modeIds:Ne.modeIds,value:Ne.value,valueType:typeof Ne.value,actualValue:xr(Ne.value),valueString:JSON.stringify(Ne.value)}))});const Ve=N.includes(ee);let Ie;if(Ve)console.log("[handleToggleDimension] Removing dimension:",ee),Ie=N.filter(Ne=>Ne!==ee),console.log("[handleToggleDimension] After removing dimension:",{newActiveDimensions:Ie,valuesByMode:j.valuesByMode.map(Ne=>({modeIds:Ne.modeIds,value:Ne.value,valueType:typeof Ne.value,actualValue:xr(Ne.value),valueString:JSON.stringify(Ne.value)}))});else{console.log("[handleToggleDimension] Adding dimension:",ee);const Ne=n.find(Ke=>Ke.id===ee);if(!Ne){console.error("[handleToggleDimension] Dimension not found:",ee);return}Ie=[...N,ee];const ot=Ne.defaultMode;console.log("[handleToggleDimension] Adding dimension details:",{dimension:Ne,defaultModeId:ot,newActiveDimensions:Ie}),w(Ke=>{if(console.log("[handleToggleDimension] setEditedToken callback - initial state:",{prevValuesByMode:Ke.valuesByMode.map(be=>({modeIds:be.modeIds,value:be.value,valueType:typeof be.value,actualValue:xr(be.value),valueString:JSON.stringify(be.value)}))}),N.length===0){console.log("[handleToggleDimension] No previous dimensions active, creating mode values");const be=Ke.valuesByMode.find(Pe=>Pe.modeIds.length===0),Oe=Ne.modes.map(Pe=>({modeIds:[Pe.id],value:be?be.value:ti(Ke.resolvedValueTypeId,{resolvedValueTypes:f}),platformOverrides:be?be.platformOverrides:void 0}));return console.log("[handleToggleDimension] Created new values for no previous dimensions:",{newValuesByMode:Oe.map(Pe=>({modeIds:Pe.modeIds,value:Pe.value,valueType:typeof Pe.value,actualValue:xr(Pe.value),valueString:JSON.stringify(Pe.value)}))}),{...Ke,valuesByMode:[...Ke.valuesByMode,...Oe]}}const Et=[...Ke.valuesByMode],Ae=Ke.valuesByMode.filter(be=>F(be.modeIds));return console.log("[handleToggleDimension] Current active values:",{currentValues:Ae.map(be=>({modeIds:be.modeIds,value:be.value,valueType:typeof be.value,actualValue:xr(be.value),valueString:JSON.stringify(be.value)}))}),Ae.forEach(be=>{const Oe=[...be.modeIds,ot].sort(),Pe=Oe.join(",");Et.some(Qe=>Qe.modeIds.slice().sort().join(",")===Pe)||(console.log("[handleToggleDimension] Creating combinatory value:",{newModeIds:Oe,sourceValue:be.value,sourceValueType:typeof be.value,sourceActualValue:xr(be.value),sourceValueString:JSON.stringify(be.value)}),Et.push({modeIds:Oe,value:be.value,platformOverrides:be.platformOverrides}))}),Ne.modes.forEach(be=>{const Oe=[be.id].join(",");if(!Et.some(qe=>qe.modeIds.slice().sort().join(",")===Oe))if(be.id===ot){const qe=Et.find(Qe=>Qe.modeIds.includes(ot)&&Qe.modeIds.length>1);if(qe)console.log("[handleToggleDimension] Creating default mode value from combinatory:",{modeId:be.id,sourceValue:qe.value,sourceValueType:typeof qe.value,sourceActualValue:xr(qe.value),sourceValueString:JSON.stringify(qe.value)}),Et.push({modeIds:[be.id],value:qe.value,platformOverrides:qe.platformOverrides});else{const Qe=Ae.length>0?Ae[0].value:ti(Ke.resolvedValueTypeId,{resolvedValueTypes:f});console.log("[handleToggleDimension] Creating default mode value with fallback:",{modeId:be.id,fallbackValue:Qe,fallbackValueType:typeof Qe,fallbackActualValue:xr(Qe),fallbackValueString:JSON.stringify(Qe)}),Et.push({modeIds:[be.id],value:Qe,platformOverrides:Ae.length>0?Ae[0].platformOverrides:void 0})}}else{const qe=ti(Ke.resolvedValueTypeId,{resolvedValueTypes:f});console.log("[handleToggleDimension] Creating non-default mode value:",{modeId:be.id,defaultValue:qe,defaultValueType:typeof qe,defaultActualValue:xr(qe),defaultValueString:JSON.stringify(qe)}),Et.push({modeIds:[be.id],value:qe,platformOverrides:void 0})}}),console.log("[handleToggleDimension] Final valuesByMode after adding dimension:",{finalValuesByMode:Et.map(be=>({modeIds:be.modeIds,value:be.value,valueType:typeof be.value,actualValue:xr(be.value),valueString:JSON.stringify(be.value)}))}),{...Ke,valuesByMode:Et}})}E(Ie)},F=ee=>{if(console.log("[isValueActive] Checking value:",{modeIds:ee,activeDimensionIds:N,dimensions:n.map(Ne=>({id:Ne.id,modes:Ne.modes.map(ot=>ot.id)}))}),N.length===0){const Ne=ee.length===0;return console.log("[isValueActive] No active dimensions, result:",Ne),Ne}const Ve=n.filter(Ne=>N.includes(Ne.id)).flatMap(Ne=>Ne.modes.map(ot=>ot.id)),Ie=ee.every(Ne=>Ve.includes(Ne))&&ee.length===N.length;return console.log("[isValueActive] Result:",{activeModeIds:Ve,modeIds:ee,everyIdActive:ee.every(Ne=>Ve.includes(Ne)),lengthMatch:ee.length===N.length,finalResult:Ie}),Ie},J=(ee,Ve)=>{w(Ie=>{const Ne=Ie.valuesByMode.some(Ke=>Ke.modeIds.slice().sort().join(",")===ee.slice().sort().join(","));let ot;return Ne?ot=Ie.valuesByMode.map(Ke=>Ke.modeIds.slice().sort().join(",")===ee.slice().sort().join(",")?{...Ke,value:Ve}:Ke):ot=[...Ie.valuesByMode,{modeIds:ee,value:Ve}],{...Ie,valuesByMode:ot}})},pe=ee=>{w(Ve=>({...Ve,valuesByMode:Ve.valuesByMode.filter(Ie=>Ie.modeIds.slice().sort().join(",")!==ee.slice().sort().join(","))}))},G=j.valuesByMode.filter(ee=>F(ee.modeIds));console.log("[TokenEditorDialog] Displayed values calculation:",{allValuesByMode:j.valuesByMode.map(ee=>({modeIds:ee.modeIds,value:ee.value,valueType:typeof ee.value,actualValue:xr(ee.value),valueString:JSON.stringify(ee.value),isActive:F(ee.modeIds)})),displayedValuesByMode:G.map(ee=>({modeIds:ee.modeIds,value:ee.value,valueType:typeof ee.value,actualValue:xr(ee.value),valueString:JSON.stringify(ee.value)}))});const ge=(ee,Ve,Ie,Ne)=>(console.log("[getValueEditor] Processing value:",{value:ee,valueType:typeof ee,actualValue:typeof ee=="string"?ee:xr(ee),valueString:JSON.stringify(ee),modeIds:Ve,isOverride:Ie}),typeof ee=="string"?(console.log("[getValueEditor] Value is string, displaying as text:",ee),s.jsx(B,{fontSize:"sm",color:"gray.500",children:ee})):(console.log("[getValueEditor] Value is object, using TokenValuePicker:",{value:ee,valueType:typeof ee,actualValue:xr(ee),valueKeys:ee?Object.keys(ee):"null/undefined"}),s.jsx(Su,{value:ee,tokens:t,excludeTokenId:j.id,modes:Ve,resolvedValueTypeId:j.resolvedValueTypeId,resolvedValueTypes:f,onChange:ot=>{console.log("[getValueEditor] TokenValuePicker onChange:",{newValue:ot,newValueType:typeof ot,newActualValue:xr(ot),newValueString:JSON.stringify(ot)}),Ne?Ne(ot):w(Ke=>({...Ke,valuesByMode:Ke.valuesByMode.map(Et=>Et.modeIds.slice().sort().join(",")===Ve.slice().sort().join(",")?{...Et,value:ot}:Et)}))}}))),W=(ee,Ve,Ie,Ne,ot)=>{const Ke=typeof ee=="string"?JSON.parse(ee):ee;return s.jsx(Su,{value:Ke,tokens:t,excludeTokenId:j.id,modes:Ve,resolvedValueTypeId:j.resolvedValueTypeId,resolvedValueTypes:f,onChange:Et=>{ot?ot(Et):w(Ae=>{const be=Ae.valuesByMode.map(Oe=>Oe.modeIds.slice().sort().join(",")===Ve.slice().sort().join(",")?{...Oe,platformOverrides:[...(Oe.platformOverrides||[]).filter(Pe=>Pe.platformId!==Ie),{platformId:Ie,value:JSON.stringify(Et)}]}:Oe);return{...Ae,valuesByMode:be}})}})},[L,Q]=z.useState([]);z.useEffect(()=>{if(j.tokenCollectionId){const ee=lp(j,A,f);Q(ee)}else Q([])},[j.tokenCollectionId,j.resolvedValueTypeId,A,f]);const fe=()=>{if(console.debug("[TokenEditorDialog] Collections:",A),console.debug("[TokenEditorDialog] Current resolvedValueTypeId:",j.resolvedValueTypeId),!A||!j.resolvedValueTypeId)return[];const ee=A.filter(Ve=>{const Ie=Ve.resolvedValueTypeIds.includes(j.resolvedValueTypeId);return console.debug(`[TokenEditorDialog] Collection ${Ve.name} (${Ve.id}) compatible:`,Ie),Ie});return console.debug("[TokenEditorDialog] Compatible collections:",ee),ee},xe=ee=>{if(ee.preventDefault(),console.log("[TokenEditorDialog] handleSave called with editedToken:",j),j.tokenCollectionId){const Ae=lp(j,A,f);if(Ae.length>0){console.log("[TokenEditorDialog] Collection validation errors:",Ae),Q(Ae);return}}j.tokenTier&&!["PRIMITIVE","SEMANTIC","COMPONENT"].includes(j.tokenTier)&&(j.tokenTier="PRIMITIVE");const Ve={platforms:i,taxonomies:h,namingRules:(y==null?void 0:y.namingRules)||{taxonomyOrder:[]}},Ie=j.tokenCollectionId?j:(()=>{const{tokenCollectionId:Ae,...be}=j;return be})(),Ne=j.valuesByMode.filter(Ae=>F(Ae.modeIds)),ot={...Ie,valuesByMode:Ne,taxonomies:C,codeSyntax:ua.generateAllCodeSyntaxes(Ie,Ve)},Ke=Uf(ot.codeSyntax),Et=Ke.some(Ae=>Ae===void 0);if(console.log("[TokenEditorDialog] Validation debug after code syntax generation:",{codeSyntaxArray:Ke,hasTaxonomyError:Et,displayName:ot.displayName,resolvedValueTypeId:ot.resolvedValueTypeId}),Et){console.log("[TokenEditorDialog] Required field validation failed");return}console.log("[TokenEditorDialog] Calling onSave with token:",ot),u(ot),l()};function ue(ee){_(ee);const Ve={platforms:i,taxonomies:h,namingRules:(y==null?void 0:y.namingRules)||{taxonomyOrder:[]}};w(Ie=>({...Ie,taxonomies:ee,codeSyntax:ua.generateAllCodeSyntaxes({...Ie,taxonomies:ee},Ve)}))}const ke=Uf(j.codeSyntax),q=ke.some(ee=>ee===void 0);function re(ee){return new Set(ee.map(Ve=>`${Ve.taxonomyId}:${Ve.termId}`))}const Se=re(C),Ce=!!t.find(ee=>ee.id!==j.id&&Array.isArray(ee.taxonomies)&&ee.taxonomies.length===C.length&&re(ee.taxonomies).size===Se.size&&Array.from(Se).every(Ve=>re(ee.taxonomies).has(Ve))),Le=ee=>{w(Ve=>({...Ve,status:ee}))},{isOpen:ft,onToggle:vt}=ca(),on=Fb(j.resolvedValueTypeId,f),[Rt,nn]=z.useState(""),[Ir,jt]=z.useState(!1),Bt=z.useRef(null),qn=()=>{var Ve,Ie;const ee={aliases:[],groups:[],variants:[],themeOverrides:[]};return t.forEach(Ne=>{Ne.valuesByMode.forEach(ot=>{"tokenId"in ot.value&&ot.value.tokenId===e.id&&ee.aliases.push(Ne.id)})}),(Ve=y==null?void 0:y.extensions)!=null&&Ve.tokenGroups&&y.extensions.tokenGroups.forEach(Ne=>{Ne.tokens.some(ot=>ot.id===e.id)&&ee.groups.push(Ne.id)}),(Ie=y==null?void 0:y.extensions)!=null&&Ie.tokenVariants&&Object.entries(y.extensions.tokenVariants).forEach(([Ne,ot])=>{ot.tokens.some(Ke=>Ke.id===e.id)&&ee.variants.push(Ne)}),ee},Fn=()=>{b(e.id),jt(!1),l()},Ct=qn(),kn=Object.values(Ct).some(ee=>ee.length>0);return z.useEffect(()=>{a&&(I.current={},H.current=null)},[a,e.id]),s.jsxs(s.Fragment,{children:[s.jsxs(zn,{isOpen:a,onClose:l,isCentered:!0,size:"xl",children:[s.jsx(vn,{}),s.jsxs(Pn,{maxW:"900px",children:[s.jsx(wn,{children:p?"Create Token":`Edit Token: ${j.displayName}`}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{gap:4,align:"stretch",children:[s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:D==="dark"?"gray.800":"gray.50",borderColor:D==="dark"?"gray.600":"gray.200",children:s.jsxs(ye,{gap:3,align:"stretch",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Display Name"}),s.jsx(ut,{value:j.displayName,onChange:ee=>w(Ve=>({...Ve,displayName:ee.target.value}))})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{value:j.description||"",onChange:ee=>w(Ve=>({...Ve,description:ee.target.value}))})]}),s.jsxs(Di,{direction:"row",gap:6,align:"flex-start",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Value Type"}),s.jsx(Zt,{value:j.resolvedValueTypeId,onChange:ee=>{const Ve=ee.target.value;w(Ie=>({...Ie,resolvedValueTypeId:Ve,valuesByMode:[{modeIds:[],value:ti(Ve,{resolvedValueTypes:f})}]}))},children:f.map(ee=>s.jsx("option",{value:ee.id,children:ee.displayName},ee.id))}),j.resolvedValueTypeId&&s.jsx(B,{fontSize:"sm",color:"gray.500",mt:1,children:(Ln=f.find(ee=>ee.id===j.resolvedValueTypeId))==null?void 0:Ln.description})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Token Tier"}),s.jsxs(Zt,{value:j.tokenTier||"PRIMITIVE",onChange:ee=>{w(Ve=>({...Ve,tokenTier:ee.target.value}))},children:[s.jsx("option",{value:"PRIMITIVE",children:"Primitive"}),s.jsx("option",{value:"SEMANTIC",children:"Semantic"}),s.jsx("option",{value:"COMPONENT",children:"Component"})]})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Status"}),s.jsxs(Zt,{value:j.status||"",onChange:ee=>Le(ee.target.value),children:[s.jsx("option",{value:"",children:"None"}),s.jsx("option",{value:"experimental",children:"Experimental"}),s.jsx("option",{value:"stable",children:"Stable"}),s.jsx("option",{value:"deprecated",children:"Deprecated"})]})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Collection"}),s.jsxs(Zt,{value:j.tokenCollectionId||"",onChange:ee=>{const Ve=ee.target.value;w(Ie=>{if(!Ve){const{tokenCollectionId:Ne,...ot}=Ie;return ot}return{...Ie,tokenCollectionId:Ve}})},children:[s.jsx("option",{value:"",children:"Select a collection"}),fe().map(ee=>s.jsx("option",{value:ee.id,children:ee.name},ee.id))]}),L.length>0&&s.jsxs(xn,{status:"error",mt:2,children:[s.jsx(bn,{}),s.jsx(ye,{align:"start",spacing:1,children:L.map((ee,Ve)=>s.jsx(B,{fontSize:"sm",children:ee},Ve))})]}),s.jsx(B,{fontSize:"sm",color:"gray.500",mt:1,children:"If no collection is selected, a compatible collection will be automatically assigned."})]}),s.jsxs(ye,{mt:2,spacing:3,align:"stretch",flex:1,children:[s.jsx(Tn,{isChecked:j.private,onChange:ee=>w(Ve=>({...Ve,private:ee.target.checked})),children:"Private"}),s.jsx(Tn,{isChecked:!!j.themeable,onChange:ee=>w(Ve=>({...Ve,themeable:ee.target.checked})),children:"Themeable"})]})]})]})}),s.jsxs(ve,{gap:2,align:"center",mt:3,children:[s.jsx(fb,{size:24}),s.jsx(B,{fontSize:"lg",fontWeight:"bold",children:"Classification"})]}),s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:D==="dark"?"gray.800":"gray.50",borderColor:D==="dark"?"gray.600":"gray.200",children:s.jsxs(Di,{direction:"row",gap:6,align:"flex-start",children:[s.jsx(Y,{flex:1,minW:0,children:s.jsxs(Ge,{isRequired:!0,mb:3,children:[s.jsx(Ue,{children:"Taxonomies"}),s.jsx(o1,{taxonomies:Z,value:C,onChange:ue,disabled:Z.length===0,onViewClassifications:g}),Z.length===0&&s.jsxs(xn,{status:"warning",mt:2,children:[s.jsx(bn,{}),"No taxonomies available for this value type. Please select a different value type or add taxonomies for this type."]}),Ce&&s.jsxs(xn,{status:"error",mt:2,children:[s.jsx(bn,{}),"Another token already uses this exact set of taxonomy assignments. Please choose a unique combination."]})]})}),s.jsxs(Y,{flex:1,minW:0,children:[q&&s.jsxs(xn,{status:"error",mb:2,children:[s.jsx(bn,{}),"You must apply taxonomies to this token before a platform name can be generated."]}),s.jsx(B,{fontSize:"sm",fontWeight:"medium",mb:1,children:"Generated names per platform"}),s.jsxs(Bs,{size:"sm",variant:"simple",children:[s.jsx(ai,{children:s.jsxs(ir,{children:[s.jsx(pn,{children:"Platform"}),s.jsx(pn,{children:"Name"})]})}),s.jsx(Fs,{children:i.map(ee=>{const Ve=ke.find(Ie=>Ie.platformId===ee.id);return s.jsxs(ir,{children:[s.jsx(sn,{children:ee.displayName}),s.jsx(sn,{children:s.jsx(B,{fontFamily:"mono",fontSize:"sm",children:(Ve==null?void 0:Ve.formattedName)||""})})]},ee.id)})})]})]})]})}),s.jsxs(ve,{gap:2,align:"center",mt:3,children:[Id(on),s.jsx(B,{fontSize:"lg",fontWeight:"bold",children:"Values"})]}),e.generatedByAlgorithm&&e.algorithmId&&s.jsxs(xn,{status:"info",borderRadius:"md",children:[s.jsx(bn,{}),s.jsxs(Y,{flex:1,children:[s.jsx(B,{fontWeight:"bold",children:"Values generated by algorithm"}),s.jsxs(B,{fontSize:"sm",children:["This token's values are automatically generated by the algorithm ",e.algorithmId,". To modify the values, edit the algorithm instead."]})]}),s.jsx(Ee,{size:"sm",colorScheme:"blue",variant:"outline",onClick:()=>{window.location.href=`/tokens/algorithms?edit=${e.algorithmId}`},children:"Edit Algorithm"})]}),s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:D==="dark"?"gray.800":"gray.50",borderColor:D==="dark"?"gray.600":"gray.200",children:s.jsxs(ye,{gap:8,justify:"flex-start",align:"stretch",children:[s.jsxs(ve,{gap:4,align:"center",width:"100%",children:[s.jsx(B,{fontSize:"sm",fontWeight:"medium",children:"Dimensions"}),n.map(ee=>s.jsx(Tn,{isChecked:N.includes(ee.id),onChange:()=>ne(ee.id),isDisabled:e.generatedByAlgorithm,children:ee.displayName},ee.id))]}),N.length===0?(()=>{const ee=j.valuesByMode.find(Ve=>Array.isArray(Ve.modeIds)&&Ve.modeIds.length===0);return ee?s.jsxs(ve,{gap:2,width:"100%",children:[s.jsx(Su,{value:ee.value,tokens:t,excludeTokenId:j.id,modes:[],resolvedValueTypeId:j.resolvedValueTypeId,resolvedValueTypes:f,onChange:Ve=>w(Ie=>({...Ie,valuesByMode:Ie.valuesByMode.map(Ne=>Array.isArray(Ne.modeIds)&&Ne.modeIds.length===0?{...Ne,value:Ve}:Ne)})),isDisabled:e.generatedByAlgorithm}),s.jsx(mt,{"aria-label":"Remove value",icon:s.jsx(ws,{}),onClick:()=>w(Ve=>({...Ve,valuesByMode:Ve.valuesByMode.filter(Ie=>!(Array.isArray(Ie.modeIds)&&Ie.modeIds.length===0))})),isDisabled:e.generatedByAlgorithm})]}):s.jsx(Ee,{variant:"outline",onClick:()=>w(Ve=>({...Ve,valuesByMode:[...Ve.valuesByMode,{modeIds:[],value:ti(Ve.resolvedValueTypeId,y)}]})),children:"Add Value"})})():s.jsx(ip,{valuesByMode:G,modes:r,dimensions:n.filter(ee=>N.includes(ee.id)),getValueEditor:ge,onDeleteValue:pe,resolvedValueTypeId:j.resolvedValueTypeId,resolvedValueTypes:f,onAddValue:J,isDisabled:e.generatedByAlgorithm})]})}),s.jsx(Y,{children:s.jsxs(ye,{gap:2,justify:"flex-start",align:"stretch",children:[s.jsxs(Ee,{variant:"ghost",onClick:vt,width:"fit-content",gap:2,justifyContent:"space-between",mb:2,children:[s.jsx(rm,{size:24}),s.jsx(B,{fontSize:"md",fontWeight:"bold",children:"Platform overrides"}),s.jsx(cl,{size:16,style:{transform:ft?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"}})]}),s.jsx(yx,{in:ft,animateOpacity:!0,children:s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:D==="dark"?"gray.800":"gray.50",borderColor:D==="dark"?"gray.600":"gray.200",children:s.jsxs(Fi,{size:"sm",children:[s.jsx(Li,{children:i.map(ee=>s.jsx(Jn,{children:ee.displayName},ee.id))}),s.jsx(Ia,{children:i.map(ee=>{console.log("Rendering tab for platform:",ee.id);const Ve=tS(j.valuesByMode,ee.id,r,n.filter(Ie=>N.includes(Ie.id)),j.resolvedValueTypeId,f);return console.log("Platform overrides for table:",Ve),s.jsx(fr,{children:Ve.length>0?s.jsx(ip,{valuesByMode:Ve,modes:r,dimensions:n.filter(Ie=>N.includes(Ie.id)),getValueEditor:(Ie,Ne,ot,Ke)=>W(Ie,Ne,ee.id,ot,Ke),onDeleteValue:Ie=>{console.log("Deleting override for modeIds:",Ie),w(Ne=>{const ot=Ne.valuesByMode.map(Ke=>{var Et;return Ke.modeIds.slice().sort().join(",")===Ie.slice().sort().join(",")?{...Ke,platformOverrides:(Et=Ke.platformOverrides)==null?void 0:Et.filter(Ae=>Ae.platformId!==ee.id)}:Ke});return{...Ne,valuesByMode:ot}})},resolvedValueTypeId:j.resolvedValueTypeId,resolvedValueTypes:f,onAddValue:(Ie,Ne)=>{console.log("Adding override for modeIds:",Ie,Ne),w(ot=>{const Ke=ot.valuesByMode.map(Et=>Et.modeIds.slice().sort().join(",")===Ie.slice().sort().join(",")?{...Et,platformOverrides:[...(Et.platformOverrides||[]).filter(Ae=>Ae.platformId!==ee.id),{platformId:ee.id,value:JSON.stringify(Ne)}]}:Et);return{...ot,valuesByMode:Ke}})},isDisabled:e.generatedByAlgorithm}):s.jsxs(Y,{textAlign:"center",py:4,children:[s.jsx(B,{color:"gray.500",children:"No overrides for this platform"}),s.jsx(Ee,{variant:"outline",size:"sm",mt:2,onClick:()=>{w(Ie=>({...Ie,valuesByMode:Ie.valuesByMode.map((Ne,ot)=>ot===0?{...Ne,platformOverrides:[...Ne.platformOverrides||[],{platformId:ee.id,value:JSON.stringify(ti(Ie.resolvedValueTypeId,{resolvedValueTypes:f}))}]}:Ne)}))},children:"Add override"})]})},ee.id)})})]})})})]})})]})}),s.jsx(Xn,{children:s.jsxs(Di,{width:"100%",justify:"space-between",children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:l,children:"Cancel"}),s.jsxs(ve,{spacing:3,children:[!p&&s.jsx(Ee,{colorScheme:"red",variant:"outline",onClick:()=>jt(!0),children:"Delete"}),s.jsx(Ee,{colorScheme:"blue",onClick:xe,children:p?"Create":"Save"})]})]})})]})]}),s.jsx(bl,{isOpen:Ir,leastDestructiveRef:Bt,onClose:()=>jt(!1),isCentered:!0,children:s.jsx(vn,{bg:"blackAlpha.300",backdropFilter:"blur(2px)",children:s.jsxs(vl,{maxW:"500px",mx:"auto",my:"auto",borderRadius:"lg",boxShadow:"xl",children:[s.jsx(wn,{fontSize:"lg",fontWeight:"bold",children:"Delete Token"}),s.jsx(Sn,{children:s.jsxs(ye,{align:"stretch",spacing:4,children:[s.jsxs(B,{children:["Delete ",e.displayName,"?"]}),kn&&s.jsxs(xn,{status:"warning",borderRadius:"md",children:[s.jsx(bn,{}),s.jsxs(ye,{align:"start",spacing:1,children:[s.jsx(B,{fontWeight:"bold",children:"Warning: This token is referenced in:"}),Ct.aliases.length>0&&s.jsxs(B,{children:[" ",Ct.aliases.length," other token(s) as aliases"]}),Ct.groups.length>0&&s.jsxs(B,{children:[" ",Ct.groups.length," token group(s)"]}),Ct.variants.length>0&&s.jsxs(B,{children:[" ",Ct.variants.length," token variant(s)"]}),Ct.themeOverrides.length>0&&s.jsxs(B,{children:[" ",Ct.themeOverrides.length," theme override(s)"]})]})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Type Delete to confirm"}),s.jsx(ut,{value:Rt,onChange:ee=>nn(ee.target.value),placeholder:"Type Delete to confirm",autoFocus:!0})]})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{ref:Bt,onClick:()=>jt(!1),children:"Cancel"}),s.jsx(Ee,{colorScheme:"orange",onClick:()=>{const ee={...j,status:"deprecated"};u(ee),jt(!1),l()},ml:3,children:"Deprecate"}),s.jsx(Ee,{colorScheme:"red",onClick:Fn,ml:3,isDisabled:Rt!=="Delete",children:"Yes, delete"})]})]})})})]})}const rS=()=>({getItem:n=>{try{return localStorage.getItem(n)}catch(r){return console.error("Error reading from localStorage:",r),null}},setItem:(n,r)=>{try{localStorage.setItem(n,r)}catch(i){console.error("Error writing to localStorage:",i)}}}),sS=()=>{const{getItem:e,setItem:t}=rS(),n=Hn(),r=(u,h)=>{const f=new Set(h.map(g=>g.id)),p=u.taxonomyOrder.filter(g=>f.has(g));return p.length!==u.taxonomyOrder.length&&console.warn("[useSchema] Removed invalid taxonomy IDs from naming rules:",u.taxonomyOrder.filter(g=>!f.has(g))),{taxonomyOrder:p}},[i,a]=z.useState(()=>{const u=e("schema");if(u)try{const h=JSON.parse(u),f=he.getNamingRules(),p=he.getTaxonomies(),g=r(f,p),y={...h,namingRules:g},b=mr.validateData(y);return b.isValid?y:(console.error("Invalid schema in storage:",b.errors),n({title:"Schema Error",description:"Invalid schema found in storage",status:"error",duration:5e3,isClosable:!0}),null)}catch(h){return console.error("Failed to parse stored schema:",h),n({title:"Schema Error",description:"Failed to parse stored schema",status:"error",duration:5e3,isClosable:!0}),null}try{const h=he.getCollections(),f=he.getTokens(),p=he.getDimensions(),g=he.getPlatforms(),y=he.getThemes(),b=he.getTaxonomies(),A=he.getValueTypes(),D=he.getNamingRules(),j=he.getDimensionOrder();if(h.length>0||f.length>0){const w=r(D,b),C={version:"1.0.0",systemName:"Design System",systemId:"design-system",description:"A comprehensive design system with tokens, dimensions, and themes",tokenCollections:h,tokens:f,dimensions:p,platforms:g,themes:y,taxonomies:b,resolvedValueTypes:A,namingRules:w,dimensionOrder:j,versionHistory:[{version:"1.0.0",dimensions:p.map(N=>N.id),date:new Date().toISOString().slice(0,10)}]},_=mr.validateData(C);return _.isValid?C:(console.error("Invalid schema from storage:",_.errors),n({title:"Schema Error",description:"Invalid schema found in storage",status:"error",duration:5e3,isClosable:!0}),null)}}catch(h){console.error("Failed to load schema from storage:",h),n({title:"Schema Error",description:"Failed to load schema from storage",status:"error",duration:5e3,isClosable:!0})}return null});return z.useEffect(()=>{(async()=>{var h,f,p,g,y,b,A,D,j;if(!i)try{const C=(await Xl.minimal()).default;console.debug("[useSchema] Raw core data:",{version:C.version,systemName:C.systemName,systemId:C.systemId,hasTokenCollections:!!C.tokenCollections,tokenCollectionsCount:(h=C.tokenCollections)==null?void 0:h.length,hasTokens:!!C.tokens,tokensCount:(f=C.tokens)==null?void 0:f.length,hasDimensions:!!C.dimensions,dimensionsCount:(p=C.dimensions)==null?void 0:p.length,hasPlatforms:!!C.platforms,platformsCount:(g=C.platforms)==null?void 0:g.length,hasTaxonomies:!!C.taxonomies,taxonomiesCount:(y=C.taxonomies)==null?void 0:y.length,hasThemes:!!C.themes,themesCount:(b=C.themes)==null?void 0:b.length,hasResolvedValueTypes:!!C.resolvedValueTypes,resolvedValueTypesCount:(A=C.resolvedValueTypes)==null?void 0:A.length,hasNamingRules:!!C.namingRules,hasVersionHistory:!!C.versionHistory,versionHistoryCount:(D=C.versionHistory)==null?void 0:D.length});const _={...C,version:C.version||"1.0.0",systemName:C.systemName||"Design System",systemId:C.systemId||"design-system",taxonomies:C.taxonomies||[],tokenCollections:C.tokenCollections||[],platforms:(C.platforms||[]).map(E=>({...E,syntaxPatterns:E.syntaxPatterns?{...E.syntaxPatterns,delimiter:E.syntaxPatterns.delimiter,capitalization:E.syntaxPatterns.capitalization}:void 0})),resolvedValueTypes:(C.resolvedValueTypes||[]).map(E=>({...E,type:E.type})),tokens:(C.tokens||[]).map(E=>({...E,status:E.status,tokenTier:E.tokenTier,valuesByMode:E.valuesByMode.map(I=>({...I,value:I.value}))})),namingRules:r(C.namingRules||{taxonomyOrder:[]},C.taxonomies||[]),versionHistory:C.versionHistory||[{version:C.version||"1.0.0",dimensions:(C.dimensions||[]).map(E=>E.id),date:new Date().toISOString().slice(0,10)}]};console.debug("[useSchema] Processed data structure:",{version:_.version,systemName:_.systemName,systemId:_.systemId,tokenCollections:{count:_.tokenCollections.length,sample:_.tokenCollections[0]},tokens:{count:_.tokens.length,sample:_.tokens[0]},dimensions:{count:_.dimensions.length,sample:_.dimensions[0]},platforms:{count:_.platforms.length,sample:_.platforms[0]},taxonomies:{count:_.taxonomies.length,sample:_.taxonomies[0]},themes:{count:_.themes.length,sample:_.themes[0]},resolvedValueTypes:{count:_.resolvedValueTypes.length,sample:_.resolvedValueTypes[0]},namingRules:_.namingRules,versionHistory:{count:_.versionHistory.length,sample:_.versionHistory[0]}});const N=mr.validateData(_);if(N.isValid)he.setTaxonomies(_.taxonomies),a(_);else throw console.error("[useSchema] Schema validation failed:",{errors:N.errors,dataSummary:{version:_.version,systemName:_.systemName,systemId:_.systemId,tokenCollectionsCount:_.tokenCollections.length,tokensCount:_.tokens.length,dimensionsCount:_.dimensions.length,platformsCount:_.platforms.length,taxonomiesCount:_.taxonomies.length,themesCount:_.themes.length,resolvedValueTypesCount:_.resolvedValueTypes.length}}),new Error(`Invalid schema structure in default data: ${(j=N.errors)==null?void 0:j.join(", ")}`)}catch(w){console.error("Failed to load default schema:",w),n({title:"Schema Error",description:"Failed to load default schema",status:"error",duration:5e3,isClosable:!0})}})()},[i,n]),z.useEffect(()=>{var u;if(i)try{const h=mr.validateData(i);if(h.isValid)t("schema",JSON.stringify(i));else throw new Error(`Invalid schema structure: ${(u=h.errors)==null?void 0:u.join(", ")}`)}catch(h){console.error("Failed to save schema:",h),n({title:"Schema Error",description:"Failed to save schema",status:"error",duration:5e3,isClosable:!0})}},[i,t,n]),z.useEffect(()=>{console.debug("[useSchema] Current schema:",i)},[i]),{schema:i,updateSchema:u=>{var h;try{const f=mr.validateData(u);if(f.isValid)a(u);else throw new Error(`Invalid schema structure: ${(h=f.errors)==null?void 0:h.join(", ")}`)}catch(f){console.error("Failed to update schema:",f),n({title:"Schema Error",description:"Failed to update schema",status:"error",duration:5e3,isClosable:!0})}}}};function cp(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}var iS={value:()=>{}};function Eo(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ml(n)}function ml(e){this._=e}function aS(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ml.prototype=Eo.prototype={constructor:ml,on:function(e,t){var n=this._,r=aS(e+"",n),i,a=-1,l=r.length;if(arguments.length<2){for(;++a<l;)if((i=(e=r[a]).type)&&(i=oS(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<l;)if(i=(e=r[a]).type)n[i]=up(n[i],e.name,t);else if(t==null)for(i in n)n[i]=up(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ml(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function oS(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function up(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=iS,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var ud="http://www.w3.org/1999/xhtml";const dp={svg:"http://www.w3.org/2000/svg",xhtml:ud,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function mc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),dp.hasOwnProperty(t)?{space:dp[t],local:e}:e}function lS(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ud&&t.documentElement.namespaceURI===ud?t.createElement(e):t.createElementNS(n,e)}}function cS(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function k1(e){var t=mc(e);return(t.local?cS:lS)(t)}function uS(){}function a0(e){return e==null?uS:function(){return this.querySelector(e)}}function dS(e){typeof e!="function"&&(e=a0(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],l=a.length,u=r[i]=new Array(l),h,f,p=0;p<l;++p)(h=a[p])&&(f=e.call(h,h.__data__,p,a))&&("__data__"in h&&(f.__data__=h.__data__),u[p]=f);return new Fr(r,this._parents)}function hS(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function fS(){return[]}function j1(e){return e==null?fS:function(){return this.querySelectorAll(e)}}function pS(e){return function(){return hS(e.apply(this,arguments))}}function mS(e){typeof e=="function"?e=pS(e):e=j1(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var l=t[a],u=l.length,h,f=0;f<u;++f)(h=l[f])&&(r.push(e.call(h,h.__data__,f,l)),i.push(h));return new Fr(r,i)}function C1(e){return function(){return this.matches(e)}}function T1(e){return function(t){return t.matches(e)}}var gS=Array.prototype.find;function yS(e){return function(){return gS.call(this.children,e)}}function xS(){return this.firstElementChild}function bS(e){return this.select(e==null?xS:yS(typeof e=="function"?e:T1(e)))}var vS=Array.prototype.filter;function wS(){return Array.from(this.children)}function SS(e){return function(){return vS.call(this.children,e)}}function kS(e){return this.selectAll(e==null?wS:SS(typeof e=="function"?e:T1(e)))}function jS(e){typeof e!="function"&&(e=C1(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],l=a.length,u=r[i]=[],h,f=0;f<l;++f)(h=a[f])&&e.call(h,h.__data__,f,a)&&u.push(h);return new Fr(r,this._parents)}function I1(e){return new Array(e.length)}function CS(){return new Fr(this._enter||this._groups.map(I1),this._parents)}function $l(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}$l.prototype={constructor:$l,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function TS(e){return function(){return e}}function IS(e,t,n,r,i,a){for(var l=0,u,h=t.length,f=a.length;l<f;++l)(u=t[l])?(u.__data__=a[l],r[l]=u):n[l]=new $l(e,a[l]);for(;l<h;++l)(u=t[l])&&(i[l]=u)}function AS(e,t,n,r,i,a,l){var u,h,f=new Map,p=t.length,g=a.length,y=new Array(p),b;for(u=0;u<p;++u)(h=t[u])&&(y[u]=b=l.call(h,h.__data__,u,t)+"",f.has(b)?i[u]=h:f.set(b,h));for(u=0;u<g;++u)b=l.call(e,a[u],u,a)+"",(h=f.get(b))?(r[u]=h,h.__data__=a[u],f.delete(b)):n[u]=new $l(e,a[u]);for(u=0;u<p;++u)(h=t[u])&&f.get(y[u])===h&&(i[u]=h)}function _S(e){return e.__data__}function ES(e,t){if(!arguments.length)return Array.from(this,_S);var n=t?AS:IS,r=this._parents,i=this._groups;typeof e!="function"&&(e=TS(e));for(var a=i.length,l=new Array(a),u=new Array(a),h=new Array(a),f=0;f<a;++f){var p=r[f],g=i[f],y=g.length,b=NS(e.call(p,p&&p.__data__,f,r)),A=b.length,D=u[f]=new Array(A),j=l[f]=new Array(A),w=h[f]=new Array(y);n(p,g,D,j,w,b,t);for(var C=0,_=0,N,E;C<A;++C)if(N=D[C]){for(C>=_&&(_=C+1);!(E=j[_])&&++_<A;);N._next=E||null}}return l=new Fr(l,r),l._enter=u,l._exit=h,l}function NS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function MS(){return new Fr(this._exit||this._groups.map(I1),this._parents)}function DS(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function RS(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,l=Math.min(i,a),u=new Array(i),h=0;h<l;++h)for(var f=n[h],p=r[h],g=f.length,y=u[h]=new Array(g),b,A=0;A<g;++A)(b=f[A]||p[A])&&(y[A]=b);for(;h<i;++h)u[h]=n[h];return new Fr(u,this._parents)}function OS(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],l;--i>=0;)(l=r[i])&&(a&&l.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(l,a),a=l);return this}function VS(e){e||(e=zS);function t(g,y){return g&&y?e(g.__data__,y.__data__):!g-!y}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var l=n[a],u=l.length,h=i[a]=new Array(u),f,p=0;p<u;++p)(f=l[p])&&(h[p]=f);h.sort(t)}return new Fr(i,this._parents).order()}function zS(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function PS(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function BS(){return Array.from(this)}function FS(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var l=r[i];if(l)return l}return null}function LS(){let e=0;for(const t of this)++e;return e}function $S(){return!this.node()}function GS(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,l=i.length,u;a<l;++a)(u=i[a])&&e.call(u,u.__data__,a,i);return this}function HS(e){return function(){this.removeAttribute(e)}}function qS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function US(e,t){return function(){this.setAttribute(e,t)}}function WS(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ZS(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function YS(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function JS(e,t){var n=mc(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?qS:HS:typeof t=="function"?n.local?YS:ZS:n.local?WS:US)(n,t))}function A1(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function XS(e){return function(){this.style.removeProperty(e)}}function KS(e,t,n){return function(){this.style.setProperty(e,t,n)}}function QS(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ek(e,t,n){return arguments.length>1?this.each((t==null?XS:typeof t=="function"?QS:KS)(e,t,n??"")):ja(this.node(),e)}function ja(e,t){return e.style.getPropertyValue(t)||A1(e).getComputedStyle(e,null).getPropertyValue(t)}function tk(e){return function(){delete this[e]}}function nk(e,t){return function(){this[e]=t}}function rk(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function sk(e,t){return arguments.length>1?this.each((t==null?tk:typeof t=="function"?rk:nk)(e,t)):this.node()[e]}function _1(e){return e.trim().split(/^|\s+/)}function o0(e){return e.classList||new E1(e)}function E1(e){this._node=e,this._names=_1(e.getAttribute("class")||"")}E1.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function N1(e,t){for(var n=o0(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function M1(e,t){for(var n=o0(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function ik(e){return function(){N1(this,e)}}function ak(e){return function(){M1(this,e)}}function ok(e,t){return function(){(t.apply(this,arguments)?N1:M1)(this,e)}}function lk(e,t){var n=_1(e+"");if(arguments.length<2){for(var r=o0(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?ok:t?ik:ak)(n,t))}function ck(){this.textContent=""}function uk(e){return function(){this.textContent=e}}function dk(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function hk(e){return arguments.length?this.each(e==null?ck:(typeof e=="function"?dk:uk)(e)):this.node().textContent}function fk(){this.innerHTML=""}function pk(e){return function(){this.innerHTML=e}}function mk(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function gk(e){return arguments.length?this.each(e==null?fk:(typeof e=="function"?mk:pk)(e)):this.node().innerHTML}function yk(){this.nextSibling&&this.parentNode.appendChild(this)}function xk(){return this.each(yk)}function bk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function vk(){return this.each(bk)}function wk(e){var t=typeof e=="function"?e:k1(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Sk(){return null}function kk(e,t){var n=typeof e=="function"?e:k1(e),r=t==null?Sk:typeof t=="function"?t:a0(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function jk(){var e=this.parentNode;e&&e.removeChild(this)}function Ck(){return this.each(jk)}function Tk(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ik(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ak(e){return this.select(e?Ik:Tk)}function _k(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ek(e){return function(t){e.call(this,t,this.__data__)}}function Nk(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Mk(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function Dk(e,t,n){return function(){var r=this.__on,i,a=Ek(t);if(r){for(var l=0,u=r.length;l<u;++l)if((i=r[l]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Rk(e,t,n){var r=Nk(e+""),i,a=r.length,l;if(arguments.length<2){var u=this.node().__on;if(u){for(var h=0,f=u.length,p;h<f;++h)for(i=0,p=u[h];i<a;++i)if((l=r[i]).type===p.type&&l.name===p.name)return p.value}return}for(u=t?Dk:Mk,i=0;i<a;++i)this.each(u(r[i],t,n));return this}function D1(e,t,n){var r=A1(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Ok(e,t){return function(){return D1(this,e,t)}}function Vk(e,t){return function(){return D1(this,e,t.apply(this,arguments))}}function zk(e,t){return this.each((typeof t=="function"?Vk:Ok)(e,t))}function*Pk(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,l;i<a;++i)(l=r[i])&&(yield l)}var R1=[null];function Fr(e,t){this._groups=e,this._parents=t}function No(){return new Fr([[document.documentElement]],R1)}function Bk(){return this}Fr.prototype=No.prototype={constructor:Fr,select:dS,selectAll:mS,selectChild:bS,selectChildren:kS,filter:jS,data:ES,enter:CS,exit:MS,join:DS,merge:RS,selection:Bk,order:OS,sort:VS,call:PS,nodes:BS,node:FS,size:LS,empty:$S,each:GS,attr:JS,style:ek,property:sk,classed:lk,text:hk,html:gk,raise:xk,lower:vk,append:wk,insert:kk,remove:Ck,clone:Ak,datum:_k,on:Rk,dispatch:zk,[Symbol.iterator]:Pk};function wr(e){return typeof e=="string"?new Fr([[document.querySelector(e)]],[document.documentElement]):new Fr([[e]],R1)}function Fk(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ps(e,t){if(e=Fk(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const Lk={passive:!1},wo={capture:!0,passive:!1};function ku(e){e.stopImmediatePropagation()}function ha(e){e.preventDefault(),e.stopImmediatePropagation()}function O1(e){var t=e.document.documentElement,n=wr(e).on("dragstart.drag",ha,wo);"onselectstart"in t?n.on("selectstart.drag",ha,wo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function V1(e,t){var n=e.document.documentElement,r=wr(e).on("dragstart.drag",null);t&&(r.on("click.drag",ha,wo),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const rl=e=>()=>e;function dd(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:a,x:l,y:u,dx:h,dy:f,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:p}})}dd.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function $k(e){return!e.ctrlKey&&!e.button}function Gk(){return this.parentNode}function Hk(e,t){return t??{x:e.x,y:e.y}}function qk(){return navigator.maxTouchPoints||"ontouchstart"in this}function Uk(){var e=$k,t=Gk,n=Hk,r=qk,i={},a=Eo("start","drag","end"),l=0,u,h,f,p,g=0;function y(N){N.on("mousedown.drag",b).filter(r).on("touchstart.drag",j).on("touchmove.drag",w,Lk).on("touchend.drag touchcancel.drag",C).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function b(N,E){if(!(p||!e.call(this,N,E))){var I=_(this,t.call(this,N,E),N,E,"mouse");I&&(wr(N.view).on("mousemove.drag",A,wo).on("mouseup.drag",D,wo),O1(N.view),ku(N),f=!1,u=N.clientX,h=N.clientY,I("start",N))}}function A(N){if(ha(N),!f){var E=N.clientX-u,I=N.clientY-h;f=E*E+I*I>g}i.mouse("drag",N)}function D(N){wr(N.view).on("mousemove.drag mouseup.drag",null),V1(N.view,f),ha(N),i.mouse("end",N)}function j(N,E){if(e.call(this,N,E)){var I=N.changedTouches,H=t.call(this,N,E),Z=I.length,ae,ne;for(ae=0;ae<Z;++ae)(ne=_(this,H,N,E,I[ae].identifier,I[ae]))&&(ku(N),ne("start",N,I[ae]))}}function w(N){var E=N.changedTouches,I=E.length,H,Z;for(H=0;H<I;++H)(Z=i[E[H].identifier])&&(ha(N),Z("drag",N,E[H]))}function C(N){var E=N.changedTouches,I=E.length,H,Z;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),H=0;H<I;++H)(Z=i[E[H].identifier])&&(ku(N),Z("end",N,E[H]))}function _(N,E,I,H,Z,ae){var ne=a.copy(),F=Ps(ae||I,E),J,pe,G;if((G=n.call(N,new dd("beforestart",{sourceEvent:I,target:y,identifier:Z,active:l,x:F[0],y:F[1],dx:0,dy:0,dispatch:ne}),H))!=null)return J=G.x-F[0]||0,pe=G.y-F[1]||0,function ge(W,L,Q){var fe=F,xe;switch(W){case"start":i[Z]=ge,xe=l++;break;case"end":delete i[Z],--l;case"drag":F=Ps(Q||L,E),xe=l;break}ne.call(W,N,new dd(W,{sourceEvent:L,subject:G,target:y,identifier:Z,active:xe,x:F[0]+J,y:F[1]+pe,dx:F[0]-fe[0],dy:F[1]-fe[1],dispatch:ne}),H)}}return y.filter=function(N){return arguments.length?(e=typeof N=="function"?N:rl(!!N),y):e},y.container=function(N){return arguments.length?(t=typeof N=="function"?N:rl(N),y):t},y.subject=function(N){return arguments.length?(n=typeof N=="function"?N:rl(N),y):n},y.touchable=function(N){return arguments.length?(r=typeof N=="function"?N:rl(!!N),y):r},y.on=function(){var N=a.on.apply(a,arguments);return N===a?y:N},y.clickDistance=function(N){return arguments.length?(g=(N=+N)*N,y):Math.sqrt(g)},y}function l0(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function z1(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Mo(){}var So=.7,Gl=1/So,fa="\\s*([+-]?\\d+)\\s*",ko="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",js="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wk=/^#([0-9a-f]{3,8})$/,Zk=new RegExp(`^rgb\\(${fa},${fa},${fa}\\)$`),Yk=new RegExp(`^rgb\\(${js},${js},${js}\\)$`),Jk=new RegExp(`^rgba\\(${fa},${fa},${fa},${ko}\\)$`),Xk=new RegExp(`^rgba\\(${js},${js},${js},${ko}\\)$`),Kk=new RegExp(`^hsl\\(${ko},${js},${js}\\)$`),Qk=new RegExp(`^hsla\\(${ko},${js},${js},${ko}\\)$`),hp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};l0(Mo,Ca,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:fp,formatHex:fp,formatHex8:ej,formatHsl:tj,formatRgb:pp,toString:pp});function fp(){return this.rgb().formatHex()}function ej(){return this.rgb().formatHex8()}function tj(){return P1(this).formatHsl()}function pp(){return this.rgb().formatRgb()}function Ca(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Wk.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?mp(t):n===3?new Mr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?sl(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?sl(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Zk.exec(e))?new Mr(t[1],t[2],t[3],1):(t=Yk.exec(e))?new Mr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Jk.exec(e))?sl(t[1],t[2],t[3],t[4]):(t=Xk.exec(e))?sl(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Kk.exec(e))?xp(t[1],t[2]/100,t[3]/100,1):(t=Qk.exec(e))?xp(t[1],t[2]/100,t[3]/100,t[4]):hp.hasOwnProperty(e)?mp(hp[e]):e==="transparent"?new Mr(NaN,NaN,NaN,0):null}function mp(e){return new Mr(e>>16&255,e>>8&255,e&255,1)}function sl(e,t,n,r){return r<=0&&(e=t=n=NaN),new Mr(e,t,n,r)}function nj(e){return e instanceof Mo||(e=Ca(e)),e?(e=e.rgb(),new Mr(e.r,e.g,e.b,e.opacity)):new Mr}function hd(e,t,n,r){return arguments.length===1?nj(e):new Mr(e,t,n,r??1)}function Mr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}l0(Mr,hd,z1(Mo,{brighter(e){return e=e==null?Gl:Math.pow(Gl,e),new Mr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?So:Math.pow(So,e),new Mr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Mr(Ri(this.r),Ri(this.g),Ri(this.b),Hl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gp,formatHex:gp,formatHex8:rj,formatRgb:yp,toString:yp}));function gp(){return`#${Mi(this.r)}${Mi(this.g)}${Mi(this.b)}`}function rj(){return`#${Mi(this.r)}${Mi(this.g)}${Mi(this.b)}${Mi((isNaN(this.opacity)?1:this.opacity)*255)}`}function yp(){const e=Hl(this.opacity);return`${e===1?"rgb(":"rgba("}${Ri(this.r)}, ${Ri(this.g)}, ${Ri(this.b)}${e===1?")":`, ${e})`}`}function Hl(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ri(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Mi(e){return e=Ri(e),(e<16?"0":"")+e.toString(16)}function xp(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ls(e,t,n,r)}function P1(e){if(e instanceof ls)return new ls(e.h,e.s,e.l,e.opacity);if(e instanceof Mo||(e=Ca(e)),!e)return new ls;if(e instanceof ls)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),l=NaN,u=a-i,h=(a+i)/2;return u?(t===a?l=(n-r)/u+(n<r)*6:n===a?l=(r-t)/u+2:l=(t-n)/u+4,u/=h<.5?a+i:2-a-i,l*=60):u=h>0&&h<1?0:l,new ls(l,u,h,e.opacity)}function sj(e,t,n,r){return arguments.length===1?P1(e):new ls(e,t,n,r??1)}function ls(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}l0(ls,sj,z1(Mo,{brighter(e){return e=e==null?Gl:Math.pow(Gl,e),new ls(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?So:Math.pow(So,e),new ls(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Mr(ju(e>=240?e-240:e+120,i,r),ju(e,i,r),ju(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new ls(bp(this.h),il(this.s),il(this.l),Hl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Hl(this.opacity);return`${e===1?"hsl(":"hsla("}${bp(this.h)}, ${il(this.s)*100}%, ${il(this.l)*100}%${e===1?")":`, ${e})`}`}}));function bp(e){return e=(e||0)%360,e<0?e+360:e}function il(e){return Math.max(0,Math.min(1,e||0))}function ju(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const B1=e=>()=>e;function ij(e,t){return function(n){return e+n*t}}function aj(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function oj(e){return(e=+e)==1?F1:function(t,n){return n-t?aj(t,n,e):B1(isNaN(t)?n:t)}}function F1(e,t){var n=t-e;return n?ij(e,n):B1(isNaN(e)?t:e)}const vp=function e(t){var n=oj(t);function r(i,a){var l=n((i=hd(i)).r,(a=hd(a)).r),u=n(i.g,a.g),h=n(i.b,a.b),f=F1(i.opacity,a.opacity);return function(p){return i.r=l(p),i.g=u(p),i.b=h(p),i.opacity=f(p),i+""}}return r.gamma=e,r}(1);function si(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var fd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cu=new RegExp(fd.source,"g");function lj(e){return function(){return e}}function cj(e){return function(t){return e(t)+""}}function uj(e,t){var n=fd.lastIndex=Cu.lastIndex=0,r,i,a,l=-1,u=[],h=[];for(e=e+"",t=t+"";(r=fd.exec(e))&&(i=Cu.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),u[l]?u[l]+=a:u[++l]=a),(r=r[0])===(i=i[0])?u[l]?u[l]+=i:u[++l]=i:(u[++l]=null,h.push({i:l,x:si(r,i)})),n=Cu.lastIndex;return n<t.length&&(a=t.slice(n),u[l]?u[l]+=a:u[++l]=a),u.length<2?h[0]?cj(h[0].x):lj(t):(t=h.length,function(f){for(var p=0,g;p<t;++p)u[(g=h[p]).i]=g.x(f);return u.join("")})}var wp=180/Math.PI,pd={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function L1(e,t,n,r,i,a){var l,u,h;return(l=Math.sqrt(e*e+t*t))&&(e/=l,t/=l),(h=e*n+t*r)&&(n-=e*h,r-=t*h),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,h/=u),e*r<t*n&&(e=-e,t=-t,h=-h,l=-l),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*wp,skewX:Math.atan(h)*wp,scaleX:l,scaleY:u}}var al;function dj(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?pd:L1(t.a,t.b,t.c,t.d,t.e,t.f)}function hj(e){return e==null||(al||(al=document.createElementNS("http://www.w3.org/2000/svg","g")),al.setAttribute("transform",e),!(e=al.transform.baseVal.consolidate()))?pd:(e=e.matrix,L1(e.a,e.b,e.c,e.d,e.e,e.f))}function $1(e,t,n,r){function i(f){return f.length?f.pop()+" ":""}function a(f,p,g,y,b,A){if(f!==g||p!==y){var D=b.push("translate(",null,t,null,n);A.push({i:D-4,x:si(f,g)},{i:D-2,x:si(p,y)})}else(g||y)&&b.push("translate("+g+t+y+n)}function l(f,p,g,y){f!==p?(f-p>180?p+=360:p-f>180&&(f+=360),y.push({i:g.push(i(g)+"rotate(",null,r)-2,x:si(f,p)})):p&&g.push(i(g)+"rotate("+p+r)}function u(f,p,g,y){f!==p?y.push({i:g.push(i(g)+"skewX(",null,r)-2,x:si(f,p)}):p&&g.push(i(g)+"skewX("+p+r)}function h(f,p,g,y,b,A){if(f!==g||p!==y){var D=b.push(i(b)+"scale(",null,",",null,")");A.push({i:D-4,x:si(f,g)},{i:D-2,x:si(p,y)})}else(g!==1||y!==1)&&b.push(i(b)+"scale("+g+","+y+")")}return function(f,p){var g=[],y=[];return f=e(f),p=e(p),a(f.translateX,f.translateY,p.translateX,p.translateY,g,y),l(f.rotate,p.rotate,g,y),u(f.skewX,p.skewX,g,y),h(f.scaleX,f.scaleY,p.scaleX,p.scaleY,g,y),f=p=null,function(b){for(var A=-1,D=y.length,j;++A<D;)g[(j=y[A]).i]=j.x(b);return g.join("")}}}var fj=$1(dj,"px, ","px)","deg)"),pj=$1(hj,", ",")",")"),mj=1e-12;function Sp(e){return((e=Math.exp(e))+1/e)/2}function gj(e){return((e=Math.exp(e))-1/e)/2}function yj(e){return((e=Math.exp(2*e))-1)/(e+1)}const xj=function e(t,n,r){function i(a,l){var u=a[0],h=a[1],f=a[2],p=l[0],g=l[1],y=l[2],b=p-u,A=g-h,D=b*b+A*A,j,w;if(D<mj)w=Math.log(y/f)/t,j=function(H){return[u+H*b,h+H*A,f*Math.exp(t*H*w)]};else{var C=Math.sqrt(D),_=(y*y-f*f+r*D)/(2*f*n*C),N=(y*y-f*f-r*D)/(2*y*n*C),E=Math.log(Math.sqrt(_*_+1)-_),I=Math.log(Math.sqrt(N*N+1)-N);w=(I-E)/t,j=function(H){var Z=H*w,ae=Sp(E),ne=f/(n*C)*(ae*yj(t*Z+E)-gj(E));return[u+ne*b,h+ne*A,f*ae/Sp(t*Z+E)]}}return j.duration=w*1e3*t/Math.SQRT2,j}return i.rho=function(a){var l=Math.max(.001,+a),u=l*l,h=u*u;return e(l,u,h)},i}(Math.SQRT2,2,4);var Ta=0,Xa=0,Za=0,G1=1e3,ql,Ka,Ul=0,Pi=0,gc=0,jo=typeof performance=="object"&&performance.now?performance:Date,H1=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function c0(){return Pi||(H1(bj),Pi=jo.now()+gc)}function bj(){Pi=0}function Wl(){this._call=this._time=this._next=null}Wl.prototype=u0.prototype={constructor:Wl,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?c0():+n)+(t==null?0:+t),!this._next&&Ka!==this&&(Ka?Ka._next=this:ql=this,Ka=this),this._call=e,this._time=n,md()},stop:function(){this._call&&(this._call=null,this._time=1/0,md())}};function u0(e,t,n){var r=new Wl;return r.restart(e,t,n),r}function vj(){c0(),++Ta;for(var e=ql,t;e;)(t=Pi-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ta}function kp(){Pi=(Ul=jo.now())+gc,Ta=Xa=0;try{vj()}finally{Ta=0,Sj(),Pi=0}}function wj(){var e=jo.now(),t=e-Ul;t>G1&&(gc-=t,Ul=e)}function Sj(){for(var e,t=ql,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ql=n);Ka=e,md(r)}function md(e){if(!Ta){Xa&&(Xa=clearTimeout(Xa));var t=e-Pi;t>24?(e<1/0&&(Xa=setTimeout(kp,e-jo.now()-gc)),Za&&(Za=clearInterval(Za))):(Za||(Ul=jo.now(),Za=setInterval(wj,G1)),Ta=1,H1(kp))}}function jp(e,t,n){var r=new Wl;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var kj=Eo("start","end","cancel","interrupt"),jj=[],q1=0,Cp=1,gd=2,gl=3,Tp=4,yd=5,yl=6;function yc(e,t,n,r,i,a){var l=e.__transition;if(!l)e.__transition={};else if(n in l)return;Cj(e,n,{name:t,index:r,group:i,on:kj,tween:jj,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:q1})}function d0(e,t){var n=fs(e,t);if(n.state>q1)throw new Error("too late; already scheduled");return n}function Es(e,t){var n=fs(e,t);if(n.state>gl)throw new Error("too late; already running");return n}function fs(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Cj(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=u0(a,0,n.time);function a(f){n.state=Cp,n.timer.restart(l,n.delay,n.time),n.delay<=f&&l(f-n.delay)}function l(f){var p,g,y,b;if(n.state!==Cp)return h();for(p in r)if(b=r[p],b.name===n.name){if(b.state===gl)return jp(l);b.state===Tp?(b.state=yl,b.timer.stop(),b.on.call("interrupt",e,e.__data__,b.index,b.group),delete r[p]):+p<t&&(b.state=yl,b.timer.stop(),b.on.call("cancel",e,e.__data__,b.index,b.group),delete r[p])}if(jp(function(){n.state===gl&&(n.state=Tp,n.timer.restart(u,n.delay,n.time),u(f))}),n.state=gd,n.on.call("start",e,e.__data__,n.index,n.group),n.state===gd){for(n.state=gl,i=new Array(y=n.tween.length),p=0,g=-1;p<y;++p)(b=n.tween[p].value.call(e,e.__data__,n.index,n.group))&&(i[++g]=b);i.length=g+1}}function u(f){for(var p=f<n.duration?n.ease.call(null,f/n.duration):(n.timer.restart(h),n.state=yd,1),g=-1,y=i.length;++g<y;)i[g].call(e,p);n.state===yd&&(n.on.call("end",e,e.__data__,n.index,n.group),h())}function h(){n.state=yl,n.timer.stop(),delete r[t];for(var f in r)return;delete e.__transition}}function xl(e,t){var n=e.__transition,r,i,a=!0,l;if(n){t=t==null?null:t+"";for(l in n){if((r=n[l]).name!==t){a=!1;continue}i=r.state>gd&&r.state<yd,r.state=yl,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[l]}a&&delete e.__transition}}function Tj(e){return this.each(function(){xl(this,e)})}function Ij(e,t){var n,r;return function(){var i=Es(this,e),a=i.tween;if(a!==n){r=n=a;for(var l=0,u=r.length;l<u;++l)if(r[l].name===t){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function Aj(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=Es(this,e),l=a.tween;if(l!==r){i=(r=l).slice();for(var u={name:t,value:n},h=0,f=i.length;h<f;++h)if(i[h].name===t){i[h]=u;break}h===f&&i.push(u)}a.tween=i}}function _j(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=fs(this.node(),n).tween,i=0,a=r.length,l;i<a;++i)if((l=r[i]).name===e)return l.value;return null}return this.each((t==null?Ij:Aj)(n,e,t))}function h0(e,t,n){var r=e._id;return e.each(function(){var i=Es(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return fs(i,r).value[t]}}function U1(e,t){var n;return(typeof t=="number"?si:t instanceof Ca?vp:(n=Ca(t))?(t=n,vp):uj)(e,t)}function Ej(e){return function(){this.removeAttribute(e)}}function Nj(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Mj(e,t,n){var r,i=n+"",a;return function(){var l=this.getAttribute(e);return l===i?null:l===r?a:a=t(r=l,n)}}function Dj(e,t,n){var r,i=n+"",a;return function(){var l=this.getAttributeNS(e.space,e.local);return l===i?null:l===r?a:a=t(r=l,n)}}function Rj(e,t,n){var r,i,a;return function(){var l,u=n(this),h;return u==null?void this.removeAttribute(e):(l=this.getAttribute(e),h=u+"",l===h?null:l===r&&h===i?a:(i=h,a=t(r=l,u)))}}function Oj(e,t,n){var r,i,a;return function(){var l,u=n(this),h;return u==null?void this.removeAttributeNS(e.space,e.local):(l=this.getAttributeNS(e.space,e.local),h=u+"",l===h?null:l===r&&h===i?a:(i=h,a=t(r=l,u)))}}function Vj(e,t){var n=mc(e),r=n==="transform"?pj:U1;return this.attrTween(e,typeof t=="function"?(n.local?Oj:Rj)(n,r,h0(this,"attr."+e,t)):t==null?(n.local?Nj:Ej)(n):(n.local?Dj:Mj)(n,r,t))}function zj(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Pj(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Bj(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&Pj(e,a)),n}return i._value=t,i}function Fj(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&zj(e,a)),n}return i._value=t,i}function Lj(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=mc(e);return this.tween(n,(r.local?Bj:Fj)(r,t))}function $j(e,t){return function(){d0(this,e).delay=+t.apply(this,arguments)}}function Gj(e,t){return t=+t,function(){d0(this,e).delay=t}}function Hj(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?$j:Gj)(t,e)):fs(this.node(),t).delay}function qj(e,t){return function(){Es(this,e).duration=+t.apply(this,arguments)}}function Uj(e,t){return t=+t,function(){Es(this,e).duration=t}}function Wj(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?qj:Uj)(t,e)):fs(this.node(),t).duration}function Zj(e,t){if(typeof t!="function")throw new Error;return function(){Es(this,e).ease=t}}function Yj(e){var t=this._id;return arguments.length?this.each(Zj(t,e)):fs(this.node(),t).ease}function Jj(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Es(this,e).ease=n}}function Xj(e){if(typeof e!="function")throw new Error;return this.each(Jj(this._id,e))}function Kj(e){typeof e!="function"&&(e=C1(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],l=a.length,u=r[i]=[],h,f=0;f<l;++f)(h=a[f])&&e.call(h,h.__data__,f,a)&&u.push(h);return new Ws(r,this._parents,this._name,this._id)}function Qj(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),l=new Array(r),u=0;u<a;++u)for(var h=t[u],f=n[u],p=h.length,g=l[u]=new Array(p),y,b=0;b<p;++b)(y=h[b]||f[b])&&(g[b]=y);for(;u<r;++u)l[u]=t[u];return new Ws(l,this._parents,this._name,this._id)}function eC(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function tC(e,t,n){var r,i,a=eC(t)?d0:Es;return function(){var l=a(this,e),u=l.on;u!==r&&(i=(r=u).copy()).on(t,n),l.on=i}}function nC(e,t){var n=this._id;return arguments.length<2?fs(this.node(),n).on.on(e):this.each(tC(n,e,t))}function rC(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function sC(){return this.on("end.remove",rC(this._id))}function iC(e){var t=this._name,n=this._id;typeof e!="function"&&(e=a0(e));for(var r=this._groups,i=r.length,a=new Array(i),l=0;l<i;++l)for(var u=r[l],h=u.length,f=a[l]=new Array(h),p,g,y=0;y<h;++y)(p=u[y])&&(g=e.call(p,p.__data__,y,u))&&("__data__"in p&&(g.__data__=p.__data__),f[y]=g,yc(f[y],t,n,y,f,fs(p,n)));return new Ws(a,this._parents,t,n)}function aC(e){var t=this._name,n=this._id;typeof e!="function"&&(e=j1(e));for(var r=this._groups,i=r.length,a=[],l=[],u=0;u<i;++u)for(var h=r[u],f=h.length,p,g=0;g<f;++g)if(p=h[g]){for(var y=e.call(p,p.__data__,g,h),b,A=fs(p,n),D=0,j=y.length;D<j;++D)(b=y[D])&&yc(b,t,n,D,y,A);a.push(y),l.push(p)}return new Ws(a,l,t,n)}var oC=No.prototype.constructor;function lC(){return new oC(this._groups,this._parents)}function cC(e,t){var n,r,i;return function(){var a=ja(this,e),l=(this.style.removeProperty(e),ja(this,e));return a===l?null:a===n&&l===r?i:i=t(n=a,r=l)}}function W1(e){return function(){this.style.removeProperty(e)}}function uC(e,t,n){var r,i=n+"",a;return function(){var l=ja(this,e);return l===i?null:l===r?a:a=t(r=l,n)}}function dC(e,t,n){var r,i,a;return function(){var l=ja(this,e),u=n(this),h=u+"";return u==null&&(h=u=(this.style.removeProperty(e),ja(this,e))),l===h?null:l===r&&h===i?a:(i=h,a=t(r=l,u))}}function hC(e,t){var n,r,i,a="style."+t,l="end."+a,u;return function(){var h=Es(this,e),f=h.on,p=h.value[a]==null?u||(u=W1(t)):void 0;(f!==n||i!==p)&&(r=(n=f).copy()).on(l,i=p),h.on=r}}function fC(e,t,n){var r=(e+="")=="transform"?fj:U1;return t==null?this.styleTween(e,cC(e,r)).on("end.style."+e,W1(e)):typeof t=="function"?this.styleTween(e,dC(e,r,h0(this,"style."+e,t))).each(hC(this._id,e)):this.styleTween(e,uC(e,r,t),n).on("end.style."+e,null)}function pC(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function mC(e,t,n){var r,i;function a(){var l=t.apply(this,arguments);return l!==i&&(r=(i=l)&&pC(e,l,n)),r}return a._value=t,a}function gC(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,mC(e,t,n??""))}function yC(e){return function(){this.textContent=e}}function xC(e){return function(){var t=e(this);this.textContent=t??""}}function bC(e){return this.tween("text",typeof e=="function"?xC(h0(this,"text",e)):yC(e==null?"":e+""))}function vC(e){return function(t){this.textContent=e.call(this,t)}}function wC(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&vC(i)),t}return r._value=e,r}function SC(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,wC(e))}function kC(){for(var e=this._name,t=this._id,n=Z1(),r=this._groups,i=r.length,a=0;a<i;++a)for(var l=r[a],u=l.length,h,f=0;f<u;++f)if(h=l[f]){var p=fs(h,t);yc(h,e,n,f,l,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Ws(r,this._parents,e,n)}function jC(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,l){var u={value:l},h={value:function(){--i===0&&a()}};n.each(function(){var f=Es(this,r),p=f.on;p!==e&&(t=(e=p).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(h)),f.on=t}),i===0&&a()})}var CC=0;function Ws(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Z1(){return++CC}var zs=No.prototype;Ws.prototype={constructor:Ws,select:iC,selectAll:aC,selectChild:zs.selectChild,selectChildren:zs.selectChildren,filter:Kj,merge:Qj,selection:lC,transition:kC,call:zs.call,nodes:zs.nodes,node:zs.node,size:zs.size,empty:zs.empty,each:zs.each,on:nC,attr:Vj,attrTween:Lj,style:fC,styleTween:gC,text:bC,textTween:SC,remove:sC,tween:_j,delay:Hj,duration:Wj,ease:Yj,easeVarying:Xj,end:jC,[Symbol.iterator]:zs[Symbol.iterator]};function TC(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var IC={time:null,delay:0,duration:250,ease:TC};function AC(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function _C(e){var t,n;e instanceof Ws?(t=e._id,e=e._name):(t=Z1(),(n=IC).time=c0(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var l=r[a],u=l.length,h,f=0;f<u;++f)(h=l[f])&&yc(h,e,t,f,l,n||AC(h,t));return new Ws(r,this._parents,e,t)}No.prototype.interrupt=Tj;No.prototype.transition=_C;function EC(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,l=n.length,u,h=0,f=0;for(a=0;a<l;++a)u=n[a],h+=u.x,f+=u.y;for(h=(h/l-e)*r,f=(f/l-t)*r,a=0;a<l;++a)u=n[a],u.x-=h,u.y-=f}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function NC(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Y1(this.cover(t,n),t,n,e)}function Y1(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,l={data:r},u=e._x0,h=e._y0,f=e._x1,p=e._y1,g,y,b,A,D,j,w,C;if(!a)return e._root=l,e;for(;a.length;)if((D=t>=(g=(u+f)/2))?u=g:f=g,(j=n>=(y=(h+p)/2))?h=y:p=y,i=a,!(a=a[w=j<<1|D]))return i[w]=l,e;if(b=+e._x.call(null,a.data),A=+e._y.call(null,a.data),t===b&&n===A)return l.next=a,i?i[w]=l:e._root=l,e;do i=i?i[w]=new Array(4):e._root=new Array(4),(D=t>=(g=(u+f)/2))?u=g:f=g,(j=n>=(y=(h+p)/2))?h=y:p=y;while((w=j<<1|D)===(C=(A>=y)<<1|b>=g));return i[C]=a,i[w]=l,e}function MC(e){var t,n,r=e.length,i,a,l=new Array(r),u=new Array(r),h=1/0,f=1/0,p=-1/0,g=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(l[n]=i,u[n]=a,i<h&&(h=i),i>p&&(p=i),a<f&&(f=a),a>g&&(g=a));if(h>p||f>g)return this;for(this.cover(h,f).cover(p,g),n=0;n<r;++n)Y1(this,l[n],u[n],e[n]);return this}function DC(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var l=i-n||1,u=this._root,h,f;n>e||e>=i||r>t||t>=a;)switch(f=(t<r)<<1|e<n,h=new Array(4),h[f]=u,u=h,l*=2,f){case 0:i=n+l,a=r+l;break;case 1:n=i-l,a=r+l;break;case 2:i=n+l,r=a-l;break;case 3:n=i-l,r=a-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function RC(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function OC(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Sr(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function VC(e,t,n){var r,i=this._x0,a=this._y0,l,u,h,f,p=this._x1,g=this._y1,y=[],b=this._root,A,D;for(b&&y.push(new Sr(b,i,a,p,g)),n==null?n=1/0:(i=e-n,a=t-n,p=e+n,g=t+n,n*=n);A=y.pop();)if(!(!(b=A.node)||(l=A.x0)>p||(u=A.y0)>g||(h=A.x1)<i||(f=A.y1)<a))if(b.length){var j=(l+h)/2,w=(u+f)/2;y.push(new Sr(b[3],j,w,h,f),new Sr(b[2],l,w,j,f),new Sr(b[1],j,u,h,w),new Sr(b[0],l,u,j,w)),(D=(t>=w)<<1|e>=j)&&(A=y[y.length-1],y[y.length-1]=y[y.length-1-D],y[y.length-1-D]=A)}else{var C=e-+this._x.call(null,b.data),_=t-+this._y.call(null,b.data),N=C*C+_*_;if(N<n){var E=Math.sqrt(n=N);i=e-E,a=t-E,p=e+E,g=t+E,r=b.data}}return r}function zC(e){if(isNaN(p=+this._x.call(null,e))||isNaN(g=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,l=this._x0,u=this._y0,h=this._x1,f=this._y1,p,g,y,b,A,D,j,w;if(!n)return this;if(n.length)for(;;){if((A=p>=(y=(l+h)/2))?l=y:h=y,(D=g>=(b=(u+f)/2))?u=b:f=b,t=n,!(n=n[j=D<<1|A]))return this;if(!n.length)break;(t[j+1&3]||t[j+2&3]||t[j+3&3])&&(r=t,w=j)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[j]=a:delete t[j],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[w]=n:this._root=n),this):(this._root=a,this)}function PC(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function BC(){return this._root}function FC(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function LC(e){var t=[],n,r=this._root,i,a,l,u,h;for(r&&t.push(new Sr(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,l=n.y0,u=n.x1,h=n.y1)&&r.length){var f=(a+u)/2,p=(l+h)/2;(i=r[3])&&t.push(new Sr(i,f,p,u,h)),(i=r[2])&&t.push(new Sr(i,a,p,f,h)),(i=r[1])&&t.push(new Sr(i,f,l,u,p)),(i=r[0])&&t.push(new Sr(i,a,l,f,p))}return this}function $C(e){var t=[],n=[],r;for(this._root&&t.push(new Sr(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,l=r.x0,u=r.y0,h=r.x1,f=r.y1,p=(l+h)/2,g=(u+f)/2;(a=i[0])&&t.push(new Sr(a,l,u,p,g)),(a=i[1])&&t.push(new Sr(a,p,u,h,g)),(a=i[2])&&t.push(new Sr(a,l,g,p,f)),(a=i[3])&&t.push(new Sr(a,p,g,h,f))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function GC(e){return e[0]}function HC(e){return arguments.length?(this._x=e,this):this._x}function qC(e){return e[1]}function UC(e){return arguments.length?(this._y=e,this):this._y}function f0(e,t,n){var r=new p0(t??GC,n??qC,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function p0(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Ip(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Tr=f0.prototype=p0.prototype;Tr.copy=function(){var e=new p0(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Ip(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Ip(r));return e};Tr.add=NC;Tr.addAll=MC;Tr.cover=DC;Tr.data=RC;Tr.extent=OC;Tr.find=VC;Tr.remove=zC;Tr.removeAll=PC;Tr.root=BC;Tr.size=FC;Tr.visit=LC;Tr.visitAfter=$C;Tr.x=HC;Tr.y=UC;function kr(e){return function(){return e}}function ui(e){return(e()-.5)*1e-6}function WC(e){return e.x+e.vx}function ZC(e){return e.y+e.vy}function YC(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=kr(e==null?1:+e));function l(){for(var f,p=t.length,g,y,b,A,D,j,w=0;w<a;++w)for(g=f0(t,WC,ZC).visitAfter(u),f=0;f<p;++f)y=t[f],D=n[y.index],j=D*D,b=y.x+y.vx,A=y.y+y.vy,g.visit(C);function C(_,N,E,I,H){var Z=_.data,ae=_.r,ne=D+ae;if(Z){if(Z.index>y.index){var F=b-Z.x-Z.vx,J=A-Z.y-Z.vy,pe=F*F+J*J;pe<ne*ne&&(F===0&&(F=ui(r),pe+=F*F),J===0&&(J=ui(r),pe+=J*J),pe=(ne-(pe=Math.sqrt(pe)))/pe*i,y.vx+=(F*=pe)*(ne=(ae*=ae)/(j+ae)),y.vy+=(J*=pe)*ne,Z.vx-=F*(ne=1-ne),Z.vy-=J*ne)}return}return N>b+ne||I<b-ne||E>A+ne||H<A-ne}}function u(f){if(f.data)return f.r=n[f.data.index];for(var p=f.r=0;p<4;++p)f[p]&&f[p].r>f.r&&(f.r=f[p].r)}function h(){if(t){var f,p=t.length,g;for(n=new Array(p),f=0;f<p;++f)g=t[f],n[g.index]=+e(g,f,t)}}return l.initialize=function(f,p){t=f,r=p,h()},l.iterations=function(f){return arguments.length?(a=+f,l):a},l.strength=function(f){return arguments.length?(i=+f,l):i},l.radius=function(f){return arguments.length?(e=typeof f=="function"?f:kr(+f),h(),l):e},l}function JC(e){return e.index}function Ap(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function XC(e){var t=JC,n=g,r,i=kr(30),a,l,u,h,f,p=1;e==null&&(e=[]);function g(j){return 1/Math.min(u[j.source.index],u[j.target.index])}function y(j){for(var w=0,C=e.length;w<p;++w)for(var _=0,N,E,I,H,Z,ae,ne;_<C;++_)N=e[_],E=N.source,I=N.target,H=I.x+I.vx-E.x-E.vx||ui(f),Z=I.y+I.vy-E.y-E.vy||ui(f),ae=Math.sqrt(H*H+Z*Z),ae=(ae-a[_])/ae*j*r[_],H*=ae,Z*=ae,I.vx-=H*(ne=h[_]),I.vy-=Z*ne,E.vx+=H*(ne=1-ne),E.vy+=Z*ne}function b(){if(l){var j,w=l.length,C=e.length,_=new Map(l.map((E,I)=>[t(E,I,l),E])),N;for(j=0,u=new Array(w);j<C;++j)N=e[j],N.index=j,typeof N.source!="object"&&(N.source=Ap(_,N.source)),typeof N.target!="object"&&(N.target=Ap(_,N.target)),u[N.source.index]=(u[N.source.index]||0)+1,u[N.target.index]=(u[N.target.index]||0)+1;for(j=0,h=new Array(C);j<C;++j)N=e[j],h[j]=u[N.source.index]/(u[N.source.index]+u[N.target.index]);r=new Array(C),A(),a=new Array(C),D()}}function A(){if(l)for(var j=0,w=e.length;j<w;++j)r[j]=+n(e[j],j,e)}function D(){if(l)for(var j=0,w=e.length;j<w;++j)a[j]=+i(e[j],j,e)}return y.initialize=function(j,w){l=j,f=w,b()},y.links=function(j){return arguments.length?(e=j,b(),y):e},y.id=function(j){return arguments.length?(t=j,y):t},y.iterations=function(j){return arguments.length?(p=+j,y):p},y.strength=function(j){return arguments.length?(n=typeof j=="function"?j:kr(+j),A(),y):n},y.distance=function(j){return arguments.length?(i=typeof j=="function"?j:kr(+j),D(),y):i},y}const KC=1664525,QC=1013904223,_p=4294967296;function eT(){let e=1;return()=>(e=(KC*e+QC)%_p)/_p}function tT(e){return e.x}function nT(e){return e.y}var rT=10,sT=Math.PI*(3-Math.sqrt(5));function iT(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,l=.6,u=new Map,h=u0(g),f=Eo("tick","end"),p=eT();e==null&&(e=[]);function g(){y(),f.call("tick",t),n<r&&(h.stop(),f.call("end",t))}function y(D){var j,w=e.length,C;D===void 0&&(D=1);for(var _=0;_<D;++_)for(n+=(a-n)*i,u.forEach(function(N){N(n)}),j=0;j<w;++j)C=e[j],C.fx==null?C.x+=C.vx*=l:(C.x=C.fx,C.vx=0),C.fy==null?C.y+=C.vy*=l:(C.y=C.fy,C.vy=0);return t}function b(){for(var D=0,j=e.length,w;D<j;++D){if(w=e[D],w.index=D,w.fx!=null&&(w.x=w.fx),w.fy!=null&&(w.y=w.fy),isNaN(w.x)||isNaN(w.y)){var C=rT*Math.sqrt(.5+D),_=D*sT;w.x=C*Math.cos(_),w.y=C*Math.sin(_)}(isNaN(w.vx)||isNaN(w.vy))&&(w.vx=w.vy=0)}}function A(D){return D.initialize&&D.initialize(e,p),D}return b(),t={tick:y,restart:function(){return h.restart(g),t},stop:function(){return h.stop(),t},nodes:function(D){return arguments.length?(e=D,b(),u.forEach(A),t):e},alpha:function(D){return arguments.length?(n=+D,t):n},alphaMin:function(D){return arguments.length?(r=+D,t):r},alphaDecay:function(D){return arguments.length?(i=+D,t):+i},alphaTarget:function(D){return arguments.length?(a=+D,t):a},velocityDecay:function(D){return arguments.length?(l=1-D,t):1-l},randomSource:function(D){return arguments.length?(p=D,u.forEach(A),t):p},force:function(D,j){return arguments.length>1?(j==null?u.delete(D):u.set(D,A(j)),t):u.get(D)},find:function(D,j,w){var C=0,_=e.length,N,E,I,H,Z;for(w==null?w=1/0:w*=w,C=0;C<_;++C)H=e[C],N=D-H.x,E=j-H.y,I=N*N+E*E,I<w&&(Z=H,w=I);return Z},on:function(D,j){return arguments.length>1?(f.on(D,j),t):f.on(D)}}}function aT(){var e,t,n,r,i=kr(-30),a,l=1,u=1/0,h=.81;function f(b){var A,D=e.length,j=f0(e,tT,nT).visitAfter(g);for(r=b,A=0;A<D;++A)t=e[A],j.visit(y)}function p(){if(e){var b,A=e.length,D;for(a=new Array(A),b=0;b<A;++b)D=e[b],a[D.index]=+i(D,b,e)}}function g(b){var A=0,D,j,w=0,C,_,N;if(b.length){for(C=_=N=0;N<4;++N)(D=b[N])&&(j=Math.abs(D.value))&&(A+=D.value,w+=j,C+=j*D.x,_+=j*D.y);b.x=C/w,b.y=_/w}else{D=b,D.x=D.data.x,D.y=D.data.y;do A+=a[D.data.index];while(D=D.next)}b.value=A}function y(b,A,D,j){if(!b.value)return!0;var w=b.x-t.x,C=b.y-t.y,_=j-A,N=w*w+C*C;if(_*_/h<N)return N<u&&(w===0&&(w=ui(n),N+=w*w),C===0&&(C=ui(n),N+=C*C),N<l&&(N=Math.sqrt(l*N)),t.vx+=w*b.value*r/N,t.vy+=C*b.value*r/N),!0;if(b.length||N>=u)return;(b.data!==t||b.next)&&(w===0&&(w=ui(n),N+=w*w),C===0&&(C=ui(n),N+=C*C),N<l&&(N=Math.sqrt(l*N)));do b.data!==t&&(_=a[b.data.index]*r/N,t.vx+=w*_,t.vy+=C*_);while(b=b.next)}return f.initialize=function(b,A){e=b,n=A,p()},f.strength=function(b){return arguments.length?(i=typeof b=="function"?b:kr(+b),p(),f):i},f.distanceMin=function(b){return arguments.length?(l=b*b,f):Math.sqrt(l)},f.distanceMax=function(b){return arguments.length?(u=b*b,f):Math.sqrt(u)},f.theta=function(b){return arguments.length?(h=b*b,f):Math.sqrt(h)},f}function oT(e){var t=kr(.1),n,r,i;typeof e!="function"&&(e=kr(e==null?0:+e));function a(u){for(var h=0,f=n.length,p;h<f;++h)p=n[h],p.vx+=(i[h]-p.x)*r[h]*u}function l(){if(n){var u,h=n.length;for(r=new Array(h),i=new Array(h),u=0;u<h;++u)r[u]=isNaN(i[u]=+e(n[u],u,n))?0:+t(n[u],u,n)}}return a.initialize=function(u){n=u,l()},a.strength=function(u){return arguments.length?(t=typeof u=="function"?u:kr(+u),l(),a):t},a.x=function(u){return arguments.length?(e=typeof u=="function"?u:kr(+u),l(),a):e},a}function lT(e){var t=kr(.1),n,r,i;typeof e!="function"&&(e=kr(e==null?0:+e));function a(u){for(var h=0,f=n.length,p;h<f;++h)p=n[h],p.vy+=(i[h]-p.y)*r[h]*u}function l(){if(n){var u,h=n.length;for(r=new Array(h),i=new Array(h),u=0;u<h;++u)r[u]=isNaN(i[u]=+e(n[u],u,n))?0:+t(n[u],u,n)}}return a.initialize=function(u){n=u,l()},a.strength=function(u){return arguments.length?(t=typeof u=="function"?u:kr(+u),l(),a):t},a.y=function(u){return arguments.length?(e=typeof u=="function"?u:kr(+u),l(),a):e},a}const ol=e=>()=>e;function cT(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Gs(e,t,n){this.k=e,this.x=t,this.y=n}Gs.prototype={constructor:Gs,scale:function(e){return e===1?this:new Gs(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Gs(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Zl=new Gs(1,0,0);Gs.prototype;function Tu(e){e.stopImmediatePropagation()}function Ya(e){e.preventDefault(),e.stopImmediatePropagation()}function uT(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function dT(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ep(){return this.__zoom||Zl}function hT(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function fT(){return navigator.maxTouchPoints||"ontouchstart"in this}function pT(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],l=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),l>a?(a+l)/2:Math.min(0,a)||Math.max(0,l))}function mT(){var e=uT,t=dT,n=pT,r=hT,i=fT,a=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,h=xj,f=Eo("start","zoom","end"),p,g,y,b=500,A=150,D=0,j=10;function w(G){G.property("__zoom",Ep).on("wheel.zoom",Z,{passive:!1}).on("mousedown.zoom",ae).on("dblclick.zoom",ne).filter(i).on("touchstart.zoom",F).on("touchmove.zoom",J).on("touchend.zoom touchcancel.zoom",pe).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(G,ge,W,L){var Q=G.selection?G.selection():G;Q.property("__zoom",Ep),G!==Q?E(G,ge,W,L):Q.interrupt().each(function(){I(this,arguments).event(L).start().zoom(null,typeof ge=="function"?ge.apply(this,arguments):ge).end()})},w.scaleBy=function(G,ge,W,L){w.scaleTo(G,function(){var Q=this.__zoom.k,fe=typeof ge=="function"?ge.apply(this,arguments):ge;return Q*fe},W,L)},w.scaleTo=function(G,ge,W,L){w.transform(G,function(){var Q=t.apply(this,arguments),fe=this.__zoom,xe=W==null?N(Q):typeof W=="function"?W.apply(this,arguments):W,ue=fe.invert(xe),ke=typeof ge=="function"?ge.apply(this,arguments):ge;return n(_(C(fe,ke),xe,ue),Q,l)},W,L)},w.translateBy=function(G,ge,W,L){w.transform(G,function(){return n(this.__zoom.translate(typeof ge=="function"?ge.apply(this,arguments):ge,typeof W=="function"?W.apply(this,arguments):W),t.apply(this,arguments),l)},null,L)},w.translateTo=function(G,ge,W,L,Q){w.transform(G,function(){var fe=t.apply(this,arguments),xe=this.__zoom,ue=L==null?N(fe):typeof L=="function"?L.apply(this,arguments):L;return n(Zl.translate(ue[0],ue[1]).scale(xe.k).translate(typeof ge=="function"?-ge.apply(this,arguments):-ge,typeof W=="function"?-W.apply(this,arguments):-W),fe,l)},L,Q)};function C(G,ge){return ge=Math.max(a[0],Math.min(a[1],ge)),ge===G.k?G:new Gs(ge,G.x,G.y)}function _(G,ge,W){var L=ge[0]-W[0]*G.k,Q=ge[1]-W[1]*G.k;return L===G.x&&Q===G.y?G:new Gs(G.k,L,Q)}function N(G){return[(+G[0][0]+ +G[1][0])/2,(+G[0][1]+ +G[1][1])/2]}function E(G,ge,W,L){G.on("start.zoom",function(){I(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(L).end()}).tween("zoom",function(){var Q=this,fe=arguments,xe=I(Q,fe).event(L),ue=t.apply(Q,fe),ke=W==null?N(ue):typeof W=="function"?W.apply(Q,fe):W,q=Math.max(ue[1][0]-ue[0][0],ue[1][1]-ue[0][1]),re=Q.__zoom,Se=typeof ge=="function"?ge.apply(Q,fe):ge,we=h(re.invert(ke).concat(q/re.k),Se.invert(ke).concat(q/Se.k));return function(Ce){if(Ce===1)Ce=Se;else{var Le=we(Ce),ft=q/Le[2];Ce=new Gs(ft,ke[0]-Le[0]*ft,ke[1]-Le[1]*ft)}xe.zoom(null,Ce)}})}function I(G,ge,W){return!W&&G.__zooming||new H(G,ge)}function H(G,ge){this.that=G,this.args=ge,this.active=0,this.sourceEvent=null,this.extent=t.apply(G,ge),this.taps=0}H.prototype={event:function(G){return G&&(this.sourceEvent=G),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(G,ge){return this.mouse&&G!=="mouse"&&(this.mouse[1]=ge.invert(this.mouse[0])),this.touch0&&G!=="touch"&&(this.touch0[1]=ge.invert(this.touch0[0])),this.touch1&&G!=="touch"&&(this.touch1[1]=ge.invert(this.touch1[0])),this.that.__zoom=ge,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(G){var ge=wr(this.that).datum();f.call(G,this.that,new cT(G,{sourceEvent:this.sourceEvent,target:w,transform:this.that.__zoom,dispatch:f}),ge)}};function Z(G,...ge){if(!e.apply(this,arguments))return;var W=I(this,ge).event(G),L=this.__zoom,Q=Math.max(a[0],Math.min(a[1],L.k*Math.pow(2,r.apply(this,arguments)))),fe=Ps(G);if(W.wheel)(W.mouse[0][0]!==fe[0]||W.mouse[0][1]!==fe[1])&&(W.mouse[1]=L.invert(W.mouse[0]=fe)),clearTimeout(W.wheel);else{if(L.k===Q)return;W.mouse=[fe,L.invert(fe)],xl(this),W.start()}Ya(G),W.wheel=setTimeout(xe,A),W.zoom("mouse",n(_(C(L,Q),W.mouse[0],W.mouse[1]),W.extent,l));function xe(){W.wheel=null,W.end()}}function ae(G,...ge){if(y||!e.apply(this,arguments))return;var W=G.currentTarget,L=I(this,ge,!0).event(G),Q=wr(G.view).on("mousemove.zoom",ke,!0).on("mouseup.zoom",q,!0),fe=Ps(G,W),xe=G.clientX,ue=G.clientY;O1(G.view),Tu(G),L.mouse=[fe,this.__zoom.invert(fe)],xl(this),L.start();function ke(re){if(Ya(re),!L.moved){var Se=re.clientX-xe,we=re.clientY-ue;L.moved=Se*Se+we*we>D}L.event(re).zoom("mouse",n(_(L.that.__zoom,L.mouse[0]=Ps(re,W),L.mouse[1]),L.extent,l))}function q(re){Q.on("mousemove.zoom mouseup.zoom",null),V1(re.view,L.moved),Ya(re),L.event(re).end()}}function ne(G,...ge){if(e.apply(this,arguments)){var W=this.__zoom,L=Ps(G.changedTouches?G.changedTouches[0]:G,this),Q=W.invert(L),fe=W.k*(G.shiftKey?.5:2),xe=n(_(C(W,fe),L,Q),t.apply(this,ge),l);Ya(G),u>0?wr(this).transition().duration(u).call(E,xe,L,G):wr(this).call(w.transform,xe,L,G)}}function F(G,...ge){if(e.apply(this,arguments)){var W=G.touches,L=W.length,Q=I(this,ge,G.changedTouches.length===L).event(G),fe,xe,ue,ke;for(Tu(G),xe=0;xe<L;++xe)ue=W[xe],ke=Ps(ue,this),ke=[ke,this.__zoom.invert(ke),ue.identifier],Q.touch0?!Q.touch1&&Q.touch0[2]!==ke[2]&&(Q.touch1=ke,Q.taps=0):(Q.touch0=ke,fe=!0,Q.taps=1+!!p);p&&(p=clearTimeout(p)),fe&&(Q.taps<2&&(g=ke[0],p=setTimeout(function(){p=null},b)),xl(this),Q.start())}}function J(G,...ge){if(this.__zooming){var W=I(this,ge).event(G),L=G.changedTouches,Q=L.length,fe,xe,ue,ke;for(Ya(G),fe=0;fe<Q;++fe)xe=L[fe],ue=Ps(xe,this),W.touch0&&W.touch0[2]===xe.identifier?W.touch0[0]=ue:W.touch1&&W.touch1[2]===xe.identifier&&(W.touch1[0]=ue);if(xe=W.that.__zoom,W.touch1){var q=W.touch0[0],re=W.touch0[1],Se=W.touch1[0],we=W.touch1[1],Ce=(Ce=Se[0]-q[0])*Ce+(Ce=Se[1]-q[1])*Ce,Le=(Le=we[0]-re[0])*Le+(Le=we[1]-re[1])*Le;xe=C(xe,Math.sqrt(Ce/Le)),ue=[(q[0]+Se[0])/2,(q[1]+Se[1])/2],ke=[(re[0]+we[0])/2,(re[1]+we[1])/2]}else if(W.touch0)ue=W.touch0[0],ke=W.touch0[1];else return;W.zoom("touch",n(_(xe,ue,ke),W.extent,l))}}function pe(G,...ge){if(this.__zooming){var W=I(this,ge).event(G),L=G.changedTouches,Q=L.length,fe,xe;for(Tu(G),y&&clearTimeout(y),y=setTimeout(function(){y=null},b),fe=0;fe<Q;++fe)xe=L[fe],W.touch0&&W.touch0[2]===xe.identifier?delete W.touch0:W.touch1&&W.touch1[2]===xe.identifier&&delete W.touch1;if(W.touch1&&!W.touch0&&(W.touch0=W.touch1,delete W.touch1),W.touch0)W.touch0[1]=this.__zoom.invert(W.touch0[0]);else if(W.end(),W.taps===2&&(xe=Ps(xe,this),Math.hypot(g[0]-xe[0],g[1]-xe[1])<j)){var ue=wr(this).on("dblclick.zoom");ue&&ue.apply(this,arguments)}}}return w.wheelDelta=function(G){return arguments.length?(r=typeof G=="function"?G:ol(+G),w):r},w.filter=function(G){return arguments.length?(e=typeof G=="function"?G:ol(!!G),w):e},w.touchable=function(G){return arguments.length?(i=typeof G=="function"?G:ol(!!G),w):i},w.extent=function(G){return arguments.length?(t=typeof G=="function"?G:ol([[+G[0][0],+G[0][1]],[+G[1][0],+G[1][1]]]),w):t},w.scaleExtent=function(G){return arguments.length?(a[0]=+G[0],a[1]=+G[1],w):[a[0],a[1]]},w.translateExtent=function(G){return arguments.length?(l[0][0]=+G[0][0],l[1][0]=+G[1][0],l[0][1]=+G[0][1],l[1][1]=+G[1][1],w):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},w.constrain=function(G){return arguments.length?(n=G,w):n},w.duration=function(G){return arguments.length?(u=+G,w):u},w.interpolate=function(G){return arguments.length?(h=G,w):h},w.on=function(){var G=f.on.apply(f,arguments);return G===f?w:G},w.clickDistance=function(G){return arguments.length?(D=(G=+G)*G,w):Math.sqrt(D)},w.tapDistance=function(G){return arguments.length?(j=+G,w):j},w}const gT=({tokens:e,collections:t,dimensions:n,platforms:r,taxonomies:i,resolvedValueTypes:a})=>{const l=z.useRef(null),u=z.useRef(null),[h,f]=z.useState(!1),p=z.useRef(null),g={systemName:"Token Analysis",systemId:"token-analysis",tokens:e,resolvedValueTypes:a,tokenCollections:t,dimensions:n,platforms:r,taxonomies:i,version:"1.0.0",versionHistory:[]};z.useEffect(()=>{console.log("Loaded Data:",{tokenCount:e==null?void 0:e.length,collectionCount:t==null?void 0:t.length,dimensionCount:n==null?void 0:n.length,platformCount:r==null?void 0:r.length,taxonomyCount:i==null?void 0:i.length,valueTypeCount:a==null?void 0:a.length,sampleTokens:e==null?void 0:e.slice(0,2),sampleValueTypes:a==null?void 0:a.slice(0,2)})},[e,t,n,r,i,a]),z.useEffect(()=>{const _=()=>{if(l.current){console.log("SVG element found:",l.current);const N=mT().scaleExtent([.1,4]).on("zoom",E=>{wr(l.current).select("g").attr("transform",E.transform)});return u.current=N,f(!0),console.log("Zoom behavior initialized"),!0}return!1};if(!_()){const N=setInterval(()=>{_()&&clearInterval(N)},100),E=setTimeout(()=>{clearInterval(N)},5e3);return()=>{clearInterval(N),clearTimeout(E)}}},[]),z.useEffect(()=>{if(console.log("Checking visualization readiness...",{isInitialized:h,hasSvgRef:!!l.current,hasZoom:!!u.current,hasTokens:!!e,hasValueTypes:!!a}),!h||!l.current||!u.current){console.log("Not ready for visualization yet");return}try{if(!e||!a){console.error("Missing required data:",{hasTokens:!!e,hasValueTypes:!!a});return}const _=mr.validateData(g);if(!_.isValid){console.error("Invalid schema:",_.errors);return}console.log("Creating visualization..."),D()}catch(_){console.error("Error creating visualization:",_)}},[h,g]);const y=_=>{!_.active&&p.current&&p.current.alphaTarget(.3).restart(),_.subject.fx=_.subject.x,_.subject.fy=_.subject.y},b=_=>{_.subject.fx=_.x,_.subject.fy=_.y},A=_=>{!_.active&&p.current&&p.current.alphaTarget(0),_.subject.fx=null,_.subject.fy=null},D=()=>{var _;if(!l.current||!u.current){console.error("Missing required refs:",{hasSvgRef:!!l.current,hasZoom:!!u.current});return}try{wr(l.current).selectAll("*").remove();const N={COLOR:"#48BB78",DIMENSION:"#4299E1",SPACING:"#667EEA",FONT_FAMILY:"#9F7AEA",FONT_WEIGHT:"#ED64A6",FONT_SIZE:"#F56565",LINE_HEIGHT:"#ED8936",LETTER_SPACING:"#ECC94B",DURATION:"#38B2AC",CUBIC_BEZIER:"#4FD1C5",BLUR:"#4A5568",SPREAD:"#718096",RADIUS:"#A0AEC0"},E=e.map(Q=>{var xe,ue;const fe=a.find(ke=>ke.id===Q.resolvedValueTypeId);return{id:Q.id,name:Q.displayName,type:Q.resolvedValueTypeId,valueTypeName:(fe==null?void 0:fe.displayName)||"Unknown",valueTypeCategory:(fe==null?void 0:fe.type)||"Unknown",group:1,value:(ue=(xe=Q.valuesByMode)==null?void 0:xe[0])==null?void 0:ue.value}}),I=[];e.forEach(Q=>{var fe;console.log(`Processing token: ${Q.displayName} (${Q.id})`),(fe=Q.valuesByMode)==null||fe.forEach(xe=>{const ue=xe.value;if(console.log("Checking value for mode:",xe),ue&&typeof ue=="object"&&"tokenId"in ue){const ke=ue.tokenId;console.log(`Found tokenId reference: ${ke}`);const q=e.find(re=>re.id===ke);if(q)if(console.log(`Found target token: ${q.displayName} (${q.id})`),I.some(Se=>Se.source.id===Q.id&&Se.target.id===q.id))console.log(`Link already exists between ${Q.displayName} and ${q.displayName}`);else{const Se=E.find(Ce=>Ce.id===Q.id),we=E.find(Ce=>Ce.id===q.id);Se&&we?(I.push({source:Se,target:we,value:1}),console.log(`Created link: ${Q.displayName} -> ${q.displayName}`)):console.log(`Could not find node objects for link: ${Q.displayName} -> ${q.displayName}`)}else console.log(`Target token not found for ID: ${ke}`)}else console.log("Value does not contain tokenId:",ue)})}),console.log("All created links:",I.map(Q=>({source:Q.source.name,target:Q.target.name,sourceId:Q.source.id,targetId:Q.target.id}))),console.log("Visualization Data:",{nodeCount:E.length,linkCount:I.length,sampleNodes:E.slice(0,2),sampleLinks:I.slice(0,2)});const H=l.current.clientWidth,Z=l.current.clientHeight,ae=50,ne=wr(l.current),F=ne.append("g");ne.call(u.current);const J=iT().force("link",XC().id(Q=>Q.id).distance(150).strength(.2)).force("charge",aT().strength(-400).distanceMax(300)).force("center",EC(H/2,Z/2)).force("collision",YC(30)).force("x",oT(H/2).strength(.1)).force("y",lT(Z/2).strength(.1)).force("cluster",Q=>{const xe=J.nodes(),ue=new Map;xe.forEach(q=>{var Se;const re=q.valueTypeCategory;ue.has(re)||ue.set(re,[]),(Se=ue.get(re))==null||Se.push(q)});const ke=new Map;ue.forEach((q,re)=>{const Se={x:cp(q,we=>we.x??0)??0,y:cp(q,we=>we.y??0)??0};ke.set(re,Se)}),xe.forEach(q=>{const re=ke.get(q.valueTypeCategory);if(re){const Se=re.x-(q.x??0),we=re.y-(q.y??0);q.x=(q.x??0)+Se*.2*Q,q.y=(q.y??0)+we*.2*Q}})});p.current=J;const pe=F.append("g").attr("class","links").selectAll("line").data(I).enter().append("line").attr("stroke","#4A5568").attr("stroke-width",2).attr("stroke-opacity",.8),G=F.append("g").attr("class","nodes").selectAll("circle").data(E).enter().append("circle").attr("r",8).attr("fill",Q=>N[Q.valueTypeCategory]||"#A0AEC0").attr("stroke",Q=>{var xe;const fe=N[Q.valueTypeCategory]||"#A0AEC0";return((xe=Ca(fe))==null?void 0:xe.darker(.5).toString())||fe}).attr("stroke-width",2).call(Uk().on("start",y).on("drag",b).on("end",A)),ge=F.append("g").attr("class","labels").selectAll("text").data(E).enter().append("text").text(Q=>Q.name).attr("font-size",12).attr("dx",12).attr("dy",4).attr("fill","#2D3748").attr("pointer-events","none");(_=J.force("link"))==null||_.links(I),J.nodes(E).on("tick",()=>{E.forEach(Q=>{Q.x=Math.max(ae,Math.min(H-ae,Q.x??0)),Q.y=Math.max(ae,Math.min(Z-ae,Q.y??0))}),pe.attr("x1",Q=>Q.source.x??0).attr("y1",Q=>Q.source.y??0).attr("x2",Q=>Q.target.x??0).attr("y2",Q=>Q.target.y??0),G.attr("cx",Q=>Q.x??0).attr("cy",Q=>Q.y??0),ge.attr("x",Q=>Q.x??0).attr("y",Q=>Q.y??0)});const L=Zl.translate(H/2,Z/2).scale(.8).translate(-H/2,-Z/2);ne.transition().duration(750).call(u.current.transform,L),console.log("Visualization created successfully")}catch(N){console.error("Error in createVisualization:",N)}},j=()=>{l.current&&u.current&&u.current.scaleBy(wr(l.current),1.3)},w=()=>{l.current&&u.current&&u.current.scaleBy(wr(l.current),.7)},C=()=>{l.current&&u.current&&wr(l.current).transition().duration(750).call(u.current.transform,Zl)};return s.jsxs(Y,{children:[s.jsxs(ve,{gap:2,mb:4,children:[s.jsx(Ee,{size:"sm",onClick:j,children:"Zoom In"}),s.jsx(Ee,{size:"sm",onClick:w,children:"Zoom Out"}),s.jsx(Ee,{size:"sm",onClick:C,children:"Reset"})]}),s.jsx(Y,{borderWidth:1,borderRadius:"md",overflow:"hidden",bg:"white",children:s.jsx("svg",{ref:l,width:"100%",height:"600",style:{background:"#F7FAFC"}})})]})};function yT({dimensions:e,setDimensions:t,isOpen:n,onClose:r,editingIndex:i}){const[a,l]=z.useState({id:"",displayName:"",description:"",modes:[],defaultMode:"",required:!1,resolvedValueTypeIds:[]}),[u,h]=z.useState({id:"",name:"",description:""}),[f,p]=z.useState(!1),[g,y]=z.useState(null),b=Hn();kt.useEffect(()=>{var E;if(i!==null&&e[i]){const I=e[i];console.log("[DimensionsEditor] Editing existing dimension:",I),l({id:I.id,displayName:I.displayName,description:I.description||"",modes:I.modes,defaultMode:I.defaultMode||(((E=I.modes[0])==null?void 0:E.id)??""),required:I.required||!1,resolvedValueTypeIds:I.resolvedValueTypeIds||[]})}else console.log("[DimensionsEditor] Creating new dimension"),l({id:Vr("dimension"),displayName:"",description:"",modes:[],defaultMode:"",required:!1,resolvedValueTypeIds:[]})},[i,e,n]);const A=(E,I)=>{console.log(`[DimensionsEditor] Form field "${E}" changed to:`,I),l(H=>({...H,[E]:I}))},D=(E=null)=>{if(console.log("[DimensionsEditor] Opening mode dialog for index:",E),y(E),E!==null&&a.modes){const I=a.modes[E];console.log("[DimensionsEditor] Editing existing mode:",I),h({id:I.id,name:I.name,description:I.description||""})}else console.log("[DimensionsEditor] Creating new mode"),h({id:Vr("mode"),name:"",description:""});p(!0)},j=()=>{p(!1),y(null)},w=(E,I)=>{h(H=>({...H,[E]:I}))},C=()=>{if(console.log("[DimensionsEditor] Saving mode:",u),!u.id||!u.name){console.error("[DimensionsEditor] Mode validation failed: Missing id or name");return}const E=a.modes?[...a.modes]:[];let I=a.defaultMode;g!==null?(console.log("[DimensionsEditor] Updating existing mode at index:",g),E[g]={...u,dimensionId:a.id}):(console.log("[DimensionsEditor] Adding new mode"),E.push({...u,dimensionId:a.id}),E.length===1&&(I=E[0].id,console.log("[DimensionsEditor] Setting first mode as default:",I))),l(H=>({...H,modes:E,defaultMode:I})),p(!1),y(null)},_=E=>{l(I=>{var ae,ne;const H=(I.modes||[]).filter((F,J)=>J!==E);let Z=I.defaultMode;return((ae=I.modes[E])==null?void 0:ae.id)===I.defaultMode&&(Z=((ne=H[0])==null?void 0:ne.id)||""),{...I,modes:H,defaultMode:Z}})},N=()=>{if(console.log("[DimensionsEditor] Starting save process with form data:",a),!a.id||!a.displayName){console.error("[DimensionsEditor] Validation failed: Missing id or displayName",a),b({title:"Required Fields Missing",description:"ID and display name are required fields.",status:"error",duration:4e3,isClosable:!0});return}if(!a.modes||a.modes.length===0){console.error("[DimensionsEditor] Validation failed: No modes",a),b({title:"At least one mode required",description:"You must add at least one mode to the dimension.",status:"error",duration:4e3,isClosable:!0});return}if(!a.defaultMode||!a.modes.some(F=>F.id===a.defaultMode)){console.error("[DimensionsEditor] Validation failed: Invalid defaultMode",a),b({title:"Invalid Default Mode",description:"Please select a valid default mode from the available modes.",status:"error",duration:4e3,isClosable:!0});return}if(typeof a.required!="boolean"){console.error("[DimensionsEditor] Validation failed: required is not boolean",a),b({title:"Required Field Missing",description:'The "Required" field must be set.',status:"error",duration:4e3,isClosable:!0});return}for(const F of a.modes)if(!F.id||!F.name||!F.dimensionId){console.error("[DimensionsEditor] Validation failed: Mode missing required fields",F),b({title:"Invalid Mode",description:"Each mode must have an id, name, and dimensionId.",status:"error",duration:4e3,isClosable:!0});return}const E=[...e],I={...a,modes:a.modes||[],required:a.required,defaultMode:a.defaultMode,resolvedValueTypeIds:a.resolvedValueTypeIds||[]};console.log("[DimensionsEditor] Prepared dimension to save:",I),i!==null?(console.log("[DimensionsEditor] Updating existing dimension at index:",i),E[i]=I):(console.log("[DimensionsEditor] Adding new dimension"),E.push(I));const H=localStorage.getItem("tokenSystem");console.log("[DimensionsEditor] Existing data from storage:",H);const Z=H?JSON.parse(H):{systemName:"Design System",systemId:"design-system",description:"Design system for validation",tokenCollections:[],tokens:[],platforms:[],taxonomies:[],version:"1.0.0",versionHistory:[]},ae=he.getValueTypes()||[],ne={...Z,dimensions:E,resolvedValueTypes:ae};if(console.log("[DimensionsEditor] Validation data:",ne),typeof mr<"u"&&typeof mr.validateData=="function"){console.log("[DimensionsEditor] Calling ValidationService");const F=mr.validateData(ne);if(console.log("[DimensionsEditor] Validation result:",F),!F.isValid){console.error("[DimensionsEditor] Schema validation failed:",F.errors),b({title:"Schema Validation Failed",description:Array.isArray(F.errors)?F.errors.join(", "):"See console for details.",status:"error",duration:5e3,isClosable:!0});return}}t(E),r(),b({title:"Dimension Saved",description:`Successfully ${i!==null?"updated":"created"} dimension "${a.displayName}"`,status:"success",duration:3e3,isClosable:!0})};return s.jsxs(s.Fragment,{children:[s.jsxs(zn,{isOpen:n,onClose:r,size:"lg",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:i!==null?"Edit Dimension":"Add Dimension"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"ID"}),s.jsx(ut,{value:a.id,isReadOnly:!0})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Display Name"}),s.jsx(ut,{value:a.displayName,onChange:E=>A("displayName",E.target.value)})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{value:a.description,onChange:E=>A("description",E.target.value)})]}),s.jsxs(Ge,{isRequired:!0,display:"flex",alignItems:"center",children:[s.jsx(Ue,{mb:"0",children:"Required"}),s.jsx(Rp,{isChecked:a.required||!1,onChange:E=>l(I=>({...I,required:E.target.checked}))})]}),s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Default Mode"}),s.jsxs(Zt,{value:a.defaultMode,onChange:E=>A("defaultMode",E.target.value),children:[s.jsx("option",{value:"",children:"None"}),a.modes.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})]}),s.jsxs(Y,{children:[s.jsxs(B,{fontWeight:"bold",mb:2,children:["Modes ",s.jsx("span",{style:{color:"red"},children:"*"})]}),s.jsx(Ee,{leftIcon:s.jsx(ds,{}),size:"sm",onClick:()=>D(null),mb:2,children:"Add Mode"}),s.jsx(ye,{align:"stretch",spacing:1,children:a.modes.map((E,I)=>s.jsxs(ve,{children:[s.jsx(B,{children:E.name}),s.jsx(mt,{"aria-label":"Edit mode",icon:s.jsx(Is,{}),size:"xs",onClick:()=>D(I)}),s.jsx(mt,{"aria-label":"Delete mode",icon:s.jsx(hs,{}),size:"xs",colorScheme:"red",onClick:()=>_(I)})]},E.id))})]}),s.jsx(Ge,{children:s.jsx(ym,{value:a.resolvedValueTypeIds,onChange:E=>l(I=>({...I,resolvedValueTypeIds:E})),label:"Value Types",isRequired:!1,error:void 0})})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:r,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:N,children:i!==null?"Save":"Add"})]})]})]}),s.jsxs(zn,{isOpen:f,onClose:j,size:"sm",children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:g!==null?"Edit Mode":"Add Mode"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Name"}),s.jsx(ut,{value:u.name,onChange:E=>w("name",E.target.value)})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{value:u.description,onChange:E=>w("description",E.target.value)})]})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:j,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:C,children:g!==null?"Save":"Add"})]})]})]})]})}function xT({dimensions:e,setDimensions:t,dimensionOrder:n,setDimensionOrder:r,onDataChange:i}){const{colorMode:a}=tn(),[l,u]=z.useState(!1),[h,f]=z.useState(null),p=Hn(),g=he.getValueTypes();z.useEffect(()=>{if(!n||n.length===0){const w=e.map(C=>C.id);typeof r=="function"?(console.log("Initializing dimension order:",w),r(w),he.setDimensionOrder(w),i&&i({dimensions:e,dimensionOrder:w})):console.warn("setDimensionOrder is not a function, skipping initialization")}},[e,n,r,i]),z.useEffect(()=>{he.setDimensions(e)},[e]);const y=w=>{if(console.log("Drag end result:",w),console.log("Current dimensionOrder:",n),!w.destination||!n){console.log("No destination or dimensionOrder is undefined");return}const C=Array.from(n),[_]=C.splice(w.source.index,1);C.splice(w.destination.index,0,_),console.log("New order after drag:",C);const N=new Set(e.map(Z=>Z.id)),E=new Set(C);N.forEach(Z=>{E.has(Z)||C.push(Z)});const I={systemName:"Design System",systemId:"design-system",dimensions:e,dimensionOrder:C,tokenCollections:[],tokens:[],platforms:[],taxonomies:[],resolvedValueTypes:g,version:"1.0.0",versionHistory:[]};console.log("[ValidationService] Data being validated:",I);const H=mr.validateData(I);if(console.log("Validation result:",H),!H.isValid){console.log("Validation failed:",H.errors);const Z=H.errors.map(ae=>typeof ae=="object"&&ae!==null&&"message"in ae?ae.message:String(ae));p({title:"Validation Error",description:Z.join(`
`),status:"error",duration:5e3,isClosable:!0});return}r(C),i&&i({dimensions:e,dimensionOrder:C})};z.useEffect(()=>{const w=he.getDimensionOrder();console.log("Initial dimension order from localStorage:",w),w&&Array.isArray(w)&&w.length>0&&typeof r=="function"&&(console.log("Setting initial dimension order:",w),r(w))},[r]),z.useEffect(()=>{console.log("Dimension order changed:",n)},[n]),z.useEffect(()=>{console.log("Dimensions changed:",e)},[e]);const b=(w=null)=>{f(w),u(!0)},A=()=>{u(!1),f(null)},D=w=>{var H;const C=e[w],_=e.filter((Z,ae)=>ae!==w),N=n.filter(Z=>Z!==C.id),E={dimensions:_,dimensionOrder:N,tokenCollections:[],tokens:[],platforms:[],taxonomies:[],resolvedValueTypes:g,version:"1.0.0",versionHistory:[]},I=mr.validateData(E);if(!I.isValid){p({title:"Cannot Delete Dimension",description:(H=I.errors)==null?void 0:H.join(`
`),status:"error",duration:5e3,isClosable:!0});return}t(_),typeof r=="function"&&(r(N),he.setDimensionOrder(N)),i&&i({dimensions:_,dimensionOrder:N}),p({title:"Dimension Deleted",description:`Successfully deleted dimension "${C.displayName}"`,status:"info",duration:3e3,isClosable:!0})},j=[...e].sort((w,C)=>{if(!n||n.length===0)return console.log("No dimension order, using original order"),0;const _=n.indexOf(w.id),N=n.indexOf(C.id);return _===-1?1:N===-1?-1:_-N});return console.log("Sorted dimensions:",j),s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"Dimensions"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:a==="dark"?"gray.900":"white",children:[s.jsx(Ee,{size:"sm",leftIcon:s.jsx(ds,{}),onClick:()=>b(null),colorScheme:"blue",mb:4,children:"Add Dimension"}),s.jsx(ac,{onDragEnd:y,children:s.jsx(oc,{droppableId:"dimensions",children:w=>s.jsxs(ye,{...w.droppableProps,ref:w.innerRef,align:"stretch",spacing:2,children:[j.map((C,_)=>s.jsx(go,{draggableId:C.id,index:_,children:(N,E)=>s.jsx(Y,{ref:N.innerRef,...N.draggableProps,p:3,borderWidth:1,borderRadius:"md",bg:a==="dark"?"gray.800":"gray.50",borderColor:a==="dark"?"gray.600":"gray.200",boxShadow:E.isDragging?"md":"sm",transition:"all 0.2s",children:s.jsxs(ve,{justify:"space-between",align:"center",children:[s.jsxs(ve,{spacing:2,children:[s.jsx(Y,{w:"32px",textAlign:"center",fontWeight:"bold",color:"gray.500",children:_+1}),s.jsx(Y,{...N.dragHandleProps,cursor:"grab",children:s.jsx(Zp,{})}),s.jsxs(Y,{children:[s.jsx(Aa,{title:C.displayName,cardType:"dimension"}),s.jsxs(B,{fontSize:"sm",color:"gray.600",children:["Modes: ",C.modes.map(I=>I.name).join(", ")]}),s.jsxs(B,{fontSize:"xs",color:"gray.500",children:["ID: ",C.id]}),Array.isArray(C.resolvedValueTypeIds)&&C.resolvedValueTypeIds.length>0&&s.jsx(Jl,{mt:2,spacing:2,children:C.resolvedValueTypeIds.map(I=>{const H=g.find(Z=>Z.id===I);return H?s.jsx(us,{size:"md",borderRadius:"full",variant:"subtle",colorScheme:"blue",children:s.jsx(Bi,{children:H.displayName})},I):null})})]})]}),s.jsxs(ve,{children:[s.jsx(mt,{"aria-label":"Edit dimension",icon:s.jsx(Is,{}),size:"sm",onClick:()=>b(_)}),s.jsx(mt,{"aria-label":"Delete dimension",icon:s.jsx(hs,{}),size:"sm",colorScheme:"red",onClick:()=>D(_)})]})]})})},C.id)),w.placeholder]})})})]}),s.jsx(yT,{dimensions:e,setDimensions:t,isOpen:l,onClose:A,editingIndex:h})]})}const bT=e=>{const{open:t,onClose:n,onSave:r,form:i,handleFormChange:a,handleTermDialogOpen:l,handleTermDelete:u,resolvedValueTypes:h}=e,{colorMode:f}=tn();kt.useEffect(()=>{t&&console.log("[TaxonomyEditorDialog] Form data:",JSON.stringify(i,null,2))},[t,i]);const p=y=>{var b;if(!((b=i.resolvedValueTypeIds)!=null&&b.includes(y))){const A=[...i.resolvedValueTypeIds||[],y];a("resolvedValueTypeIds",A)}},g=y=>{const b=(i.resolvedValueTypeIds||[]).filter(A=>A!==y);a("resolvedValueTypeIds",b)};return s.jsxs(zn,{isOpen:t,onClose:n,size:"lg",children:[s.jsx(vn,{}),s.jsxs(Pn,{bg:f==="dark"?"gray.900":"white",children:[s.jsx(wn,{children:i.editingIndex!==null?"Edit Taxonomy":"Add Taxonomy"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Name"}),s.jsx(ut,{value:i.name,onChange:y=>a("name",y.target.value)})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{value:i.description,onChange:y=>a("description",y.target.value)})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Value Types"}),s.jsx(Zt,{placeholder:"Add a value type...",value:"",onChange:y=>{y.target.value&&p(y.target.value)},children:h.filter(y=>!(i.resolvedValueTypeIds||[]).includes(y.id)).map(y=>s.jsx("option",{value:y.id,children:y.name},y.id))}),s.jsx(Jl,{mt:2,spacing:2,children:(i.resolvedValueTypeIds||[]).map(y=>{const b=h.find(A=>A.id===y);return b?s.jsxs(us,{size:"md",borderRadius:"full",variant:"solid",colorScheme:"blue",children:[s.jsx(Bi,{children:b.name}),s.jsx(bd,{onClick:()=>g(y)})]},y):null})})]}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"bold",mb:2,children:"Terms"}),s.jsx(Ee,{leftIcon:s.jsx(ds,{}),size:"sm",onClick:()=>l(null),mb:2,children:"Add Term"}),s.jsx(ye,{align:"stretch",spacing:1,children:i.terms.map((y,b)=>s.jsxs(ve,{children:[s.jsx(B,{children:y.name}),s.jsx(mt,{"aria-label":"Edit term",icon:s.jsx(Is,{}),size:"xs",onClick:()=>l(b)}),s.jsx(mt,{"aria-label":"Delete term",icon:s.jsx(hs,{}),size:"xs",colorScheme:"red",onClick:()=>u(b)})]},y.id))})]})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:n,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:r,children:"Save"})]})]})]})},vT=({open:e,onClose:t,onSave:n,termForm:r,handleTermFormChange:i,termEditIndex:a})=>{const{colorMode:l}=tn();return s.jsxs(zn,{isOpen:e,onClose:t,size:"sm",children:[s.jsx(vn,{}),s.jsxs(Pn,{bg:l==="dark"?"gray.900":"white",children:[s.jsx(wn,{children:a!==null?"Edit Term":"Add Term"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{isRequired:!0,children:[s.jsx(Ue,{children:"Name"}),s.jsx(ut,{value:r.name,onChange:u=>i("name",u.target.value)})]}),s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Description"}),s.jsx(ut,{value:r.description,onChange:u=>i("description",u.target.value)})]})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:t,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:n,children:"Save"})]})]})]})};function ll(e){return e.map(t=>({...t,description:typeof t.description=="string"?t.description:""}))}function wT({taxonomies:e,setTaxonomies:t,tokens:n,collections:r,dimensions:i,platforms:a,resolvedValueTypes:l}){const{colorMode:u}=tn(),[h,f]=z.useState(!1),[p,g]=z.useState(null),[y,b]=z.useState({id:"",name:"",description:"",terms:ll([]),resolvedValueTypeIds:[]}),[A,D]=z.useState({id:"",name:"",description:""}),[j,w]=z.useState(!1),[C,_]=z.useState(null),N=Hn(),E=(W=null)=>{if(g(W),W!==null){const L=e[W];b({id:L.id,name:L.name,description:L.description||"",terms:ll(L.terms||[]),resolvedValueTypeIds:Array.isArray(L.resolvedValueTypeIds)?L.resolvedValueTypeIds:[]})}else b({id:Vr("taxonomy"),name:"",description:"",terms:ll([]),resolvedValueTypeIds:[]});f(!0)},I=()=>{f(!1),g(null)},H=(W,L)=>{b(Q=>W==="terms"?{...Q,terms:ll(L)}:W==="resolvedValueTypeIds"?{...Q,resolvedValueTypeIds:L}:{...Q,[W]:L})},Z=async W=>{try{const L=JSON.parse(localStorage.getItem("token-model:root")||"{}"),{systemName:Q="Design System",systemId:fe="design-system",version:xe="1.0.0",versionHistory:ue=[]}=L,ke={systemName:Q,systemId:fe,tokenCollections:r,dimensions:i,tokens:n,platforms:a,taxonomies:W,resolvedValueTypes:l,version:xe,versionHistory:ue};console.log("[ClassificationView] Validation data:",JSON.stringify(ke,null,2));const q=mr.validateData(ke);if(console.log("[ClassificationView] Validation result:",q),!q.isValid){console.error("[ClassificationView] Validation errors:",q.errors),N({title:"Validation Error",description:`Schema Validation Failed: ${Array.isArray(q.errors)?q.errors.join(", "):"See console for details."}`,status:"error",duration:5e3,isClosable:!0});return}localStorage.setItem("token-model:taxonomies",JSON.stringify(W)),t(W)}catch(L){console.error("[ClassificationView] Validation error:",L),N({title:"Validation Error",description:"An error occurred while validating the data",status:"error",duration:5e3,isClosable:!0})}},ae=()=>{const W=y.id&&y.id.trim()?y.id:Vr("taxonomy");if(!y.name.trim()){N({title:"Name is required",status:"error",duration:2e3});return}const L=(y.terms||[]).map(ke=>({...ke,id:ke.id&&ke.id.trim()?ke.id:Vr("term"),name:ke.name&&ke.name.trim()?ke.name:""}));if(L.some(ke=>!ke.name.trim())){N({title:"All terms must have a name",status:"error",duration:2e3});return}const Q=L.map(ke=>ke.id);if(new Set(Q).size!==Q.length){N({title:"Term IDs must be unique",status:"error",duration:2e3});return}const fe=L.map(ke=>ke.name.trim().toLowerCase());if(new Set(fe).size!==fe.length){N({title:"Term names must be unique",status:"error",duration:2e3});return}const xe=[...e],ue={...y,id:W,terms:L,resolvedValueTypeIds:Array.isArray(y.resolvedValueTypeIds)?y.resolvedValueTypeIds:[]};p!==null?xe[p]=ue:xe.push(ue),Z(xe)&&(f(!1),g(null),N({title:"Taxonomy saved",status:"success",duration:2e3}))},ne=W=>{const L=e.filter((Q,fe)=>fe!==W);Z(L)&&N({title:"Taxonomy deleted",status:"info",duration:2e3})},F=W=>{if(W!==null&&y.terms[W]){const L=y.terms[W];D({id:L.id,name:L.name,description:L.description||""})}else D({id:Vr("term"),name:"",description:""});w(!0),_(W)},J=()=>{w(!1),_(null)},pe=(W,L)=>{D(Q=>({...Q,[W]:L}))},G=()=>{const W=A.id&&A.id.trim()?A.id:Vr("term");if(!A.name.trim()){N({title:"Term name is required",status:"error",duration:2e3});return}const L=y.terms?[...y.terms]:[],Q=L.map(fe=>fe.name.trim().toLowerCase());if(C===null&&Q.includes(A.name.trim().toLowerCase())||C!==null&&Q.filter((fe,xe)=>xe!==C).includes(A.name.trim().toLowerCase())){N({title:"Term names must be unique",status:"error",duration:2e3});return}C!==null?L[C]={...A,id:W}:L.push({...A,id:W}),b(fe=>({...fe,terms:L})),w(!1),_(null)},ge=W=>{b(L=>({...L,terms:(L.terms||[]).filter((Q,fe)=>fe!==W)}))};return s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"Classification"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:u==="dark"?"gray.900":"white",children:[s.jsx(Ee,{size:"sm",leftIcon:s.jsx(ds,{}),onClick:()=>E(null),colorScheme:"blue",mb:4,children:"Add Taxonomy"}),s.jsx(ye,{align:"stretch",spacing:2,children:e.map((W,L)=>s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:u==="dark"?"gray.800":"gray.50",borderColor:u==="dark"?"gray.600":"gray.200",children:s.jsxs(ve,{justify:"space-between",align:"center",children:[s.jsxs(Y,{children:[s.jsx(Aa,{title:W.name,cardType:"taxonomy"}),s.jsx(B,{fontSize:"sm",color:"gray.600",children:W.description}),s.jsxs(B,{fontSize:"sm",color:"gray.600",children:["Terms: ",W.terms.map(Q=>Q.name).join(", ")]}),Array.isArray(W.resolvedValueTypeIds)&&W.resolvedValueTypeIds.length>0&&s.jsx(Jl,{mt:2,spacing:2,children:W.resolvedValueTypeIds.map(Q=>{const fe=l.find(xe=>xe.id===Q);return fe?s.jsx(us,{size:"md",borderRadius:"full",variant:"subtle",colorScheme:"blue",children:s.jsx(Bi,{children:fe.displayName})},Q):null})})]}),s.jsxs(ve,{children:[s.jsx(mt,{"aria-label":"Edit taxonomy",icon:s.jsx(Is,{}),size:"sm",onClick:()=>E(L)}),s.jsx(mt,{"aria-label":"Delete taxonomy",icon:s.jsx(hs,{}),size:"sm",colorScheme:"red",onClick:()=>ne(L)})]})]})},W.id))})]}),s.jsx(bT,{open:h,onClose:I,onSave:ae,form:{...y,editingIndex:p},handleFormChange:H,handleTermDialogOpen:F,handleTermDelete:ge,resolvedValueTypes:Array.isArray(l)?l.map(W=>({id:W.id,name:W.displayName})):[]}),s.jsx(vT,{open:j,onClose:J,onSave:G,termForm:A,handleTermFormChange:pe,termEditIndex:C})]})}function ST({taxonomies:e,taxonomyOrder:t,setTaxonomyOrder:n}){const{colorMode:r}=tn(),i=Hn(),a=y=>{if(!y.destination)return;const b=Array.from(t),[A]=b.splice(y.source.index,1);b.splice(y.destination.index,0,A),n(b),he.setNamingRules({taxonomyOrder:b})},l=y=>{if(t.includes(y)){i({title:"Taxonomy already in order",status:"warning",duration:3e3,isClosable:!0});return}const b=[...t,y];n(b),he.setNamingRules({taxonomyOrder:b})},u=y=>{const b=t.filter(A=>A!==y);n(b),he.setNamingRules({taxonomyOrder:b})},h=y=>{if(y===0)return;const b=[...t];[b[y-1],b[y]]=[b[y],b[y-1]],n(b),he.setNamingRules({taxonomyOrder:b})},f=y=>{if(y===t.length-1)return;const b=[...t];[b[y],b[y+1]]=[b[y+1],b[y]],n(b),he.setNamingRules({taxonomyOrder:b})},p=e.filter(y=>!t.includes(y.id)),g=t.filter(y=>e.some(b=>b.id===y));return s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"Naming Rules"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:r==="dark"?"gray.900":"white",children:[s.jsx(yt,{size:"md",mb:2,children:"Taxonomy Order"}),s.jsx(B,{fontSize:"sm",color:"gray.600",mb:4,children:"Define the order of taxonomies in token names. This order determines how taxonomy terms appear in generated code syntax."}),s.jsxs(ye,{spacing:4,align:"stretch",children:[s.jsxs(Ge,{children:[s.jsx(Ue,{children:"Add Taxonomy to Order"}),s.jsx(ve,{children:s.jsx(Zt,{placeholder:"Select taxonomy",onChange:y=>l(y.target.value),value:"",children:p.map(y=>s.jsx("option",{value:y.id,children:y.name},y.id))})})]}),s.jsx(Ss,{}),s.jsxs(Y,{children:[s.jsx(B,{fontWeight:"medium",mb:2,children:"Current Order"}),s.jsx(ac,{onDragEnd:a,children:s.jsx(oc,{droppableId:"taxonomy-order",children:y=>s.jsxs(ye,{...y.droppableProps,ref:y.innerRef,spacing:2,align:"stretch",children:[g.map((b,A)=>{const D=e.find(j=>j.id===b);return D?s.jsx(go,{draggableId:b,index:A,children:(j,w)=>s.jsxs(ve,{ref:j.innerRef,...j.draggableProps,p:3,bg:r==="dark"?"gray.800":"gray.50",borderRadius:"md",boxShadow:w.isDragging?"md":"sm",border:"1px",borderColor:r==="dark"?"gray.600":"gray.200",transition:"all 0.2s",children:[s.jsx(Y,{w:"32px",textAlign:"center",fontWeight:"bold",color:"gray.500",children:A+1}),s.jsx(Y,{...j.dragHandleProps,cursor:"grab",children:s.jsx(Zp,{})}),s.jsx(B,{flex:1,children:D.name}),s.jsxs(ve,{spacing:1,children:[s.jsx(mt,{"aria-label":"Move up",icon:s.jsx(M2,{}),size:"sm",variant:"ghost",isDisabled:A===0,onClick:()=>h(A)}),s.jsx(mt,{"aria-label":"Move down",icon:s.jsx(N2,{}),size:"sm",variant:"ghost",isDisabled:A===g.length-1,onClick:()=>f(A)}),s.jsx(mt,{"aria-label":"Remove taxonomy",icon:s.jsx(hs,{}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>u(b)})]})]})},b):null}),y.placeholder]})})})]})]})]})]})}const J1=en(["COLOR","DIMENSION","SPACING","FONT_FAMILY","FONT_WEIGHT","FONT_SIZE","LINE_HEIGHT","LETTER_SPACING","DURATION","CUBIC_BEZIER","BLUR","SPREAD","RADIUS"]),kT=He({pattern:ce().optional(),minimum:Jt().optional(),maximum:Jt().optional(),allowedValues:nt(ce()).optional()}),jT=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),displayName:ce(),type:J1.optional(),description:ce().optional(),validation:kT.optional()}),CT=en(["experimental","stable","deprecated"]),TT=en(["PRIMITIVE","SEMANTIC","COMPONENT"]),IT=en(["MOST_SPECIFIC_MATCH","DIMENSION_PRIORITY","NEAREST_PARENT","DEFAULT_VALUE"]),xd=He({hex:ce().regex(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/),rgb:He({r:Jt().int().min(0).max(255),g:Jt().int().min(0).max(255),b:Jt().int().min(0).max(255),a:Jt().min(0).max(1).optional()}).optional()}),Kr=nr([He({value:Jt(),unit:en(["px","rem","%","em","vh","vw","pt"])}),ce().regex(/^[0-9]+(\.[0-9]+)?(px|rem|%|em|vh|vw|pt)$/)]);nr([He({value:Jt().min(0),unit:en(["ms","s"])}),ce().regex(/^[0-9]+(\.[0-9]+)?(ms|s)$/)]);nr([He({x1:Jt().min(0).max(1),y1:Jt(),x2:Jt().min(0).max(1),y2:Jt()}),ce().regex(/^cubic-bezier\([0-9]*(\.[0-9]+)?, ?[0-9]*(\.[0-9]+)?, ?[0-9]*(\.[0-9]+)?, ?[0-9]*(\.[0-9]+)?\)$/)]);nr([He({offsetX:Kr,offsetY:Kr,blur:Kr,spread:Kr,color:xd,inset:Bn().optional()}),nt(He({offsetX:Kr,offsetY:Kr,blur:Kr,spread:Kr,color:xd,inset:Bn().optional()})),ce().regex(/^([0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) (#[A-Fa-f0-9]{6}|rgba?\([0-9]+, ?[0-9]+, ?[0-9]+(, ?[0-9]+(\.[0-9]+)?)?\))( inset)?)(, ?[0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) [0-9]+(\.[0-9]+)?(px|rem) (#[A-Fa-f0-9]{6}|rgba?\([0-9]+, ?[0-9]+, ?[0-9]+(, ?[0-9]+(\.[0-9]+)?)?\))( inset)?)*$/)]);He({fontFamily:ce(),fontSize:Kr,fontWeight:nr([Jt().int().min(100).max(900).multipleOf(100),en(["normal","bold","lighter","bolder"])]),lineHeight:nr([Jt(),Kr]).optional(),letterSpacing:Kr.optional(),textDecoration:en(["none","underline","line-through","overline"]).optional(),textTransform:en(["none","capitalize","uppercase","lowercase"]).optional()});nr([He({width:Kr,style:en(["solid","dashed","dotted","double","groove","ridge","inset","outset","none"]),color:xd}),ce().regex(/^[0-9]+(\.[0-9]+)?(px|rem) (solid|dashed|dotted|double|groove|ridge|inset|outset|none) (#[A-Fa-f0-9]{6}|rgba?\([0-9]+, ?[0-9]+, ?[0-9]+(, ?[0-9]+(\.[0-9]+)?)?\))$/)]);const AT=nr([He({value:bi()}),He({tokenId:ce().regex(/^[a-zA-Z0-9-_]+$/)})]),_T=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),name:ce(),description:ce().optional(),dimensionId:ce().regex(/^[a-zA-Z0-9-_]+$/)}),ET=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),displayName:ce(),description:ce().optional(),modes:nt(_T).min(1),required:Bn().default(!1),defaultMode:ce(),resolvedValueTypeIds:nt(ce()).optional()}),NT=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),name:ce(),description:ce().optional(),resolvedValueTypeIds:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)),private:Bn().default(!1),defaultModeIds:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)).optional(),modeResolutionStrategy:He({priorityByType:nt(ce()),fallbackStrategy:IT}).optional()}),MT=He({platformId:ce(),value:ce(),metadata:vi(bi()).optional()}),DT=He({taxonomyId:ce(),termId:ce()}),m0=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),displayName:ce(),description:ce().optional(),tokenCollectionId:ce().regex(/^[a-zA-Z0-9-_]+$/).optional(),resolvedValueTypeId:ce().regex(/^[a-zA-Z0-9-_]+$/),private:Bn().default(!1),themeable:Bn().default(!1),status:CT.optional(),tokenTier:TT,generatedByAlgorithm:Bn().default(!1),algorithmId:ce().regex(/^[a-zA-Z0-9-_]+$/).optional(),taxonomies:nt(DT),propertyTypes:nt(ce()),codeSyntax:nt(He({platformId:ce(),formattedName:ce()})),valuesByMode:nt(He({modeIds:nt(ce()),value:AT,metadata:vi(bi()).optional(),platformOverrides:nt(MT).optional()})).describe("If any entry in valuesByMode has modeIds: [], it must be the only entry in the array. Otherwise, all entries must have modeIds.length > 0. This enforces that a token can have either a single global value or multiple mode-specific values, but not both.").min(1)}),RT=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),name:ce(),description:ce().optional(),tokenCollectionId:ce().regex(/^[a-zA-Z0-9-_]+$/),tokens:nt(m0)});He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),name:ce(),description:ce().optional(),tokenCollectionId:ce().regex(/^[a-zA-Z0-9-_]+$/),tokens:nt(m0)});const OT=en(["","_","-",".","/"]),VT=He({id:ce(),displayName:ce(),description:ce().optional(),syntaxPatterns:He({prefix:ce().optional(),suffix:ce().optional(),delimiter:OT.optional(),capitalization:en(["none","uppercase","lowercase","capitalize"]).optional(),formatString:ce().optional()}).optional(),valueFormatters:He({color:en(["hex","rgb","rgba","hsl","hsla"]).optional(),dimension:en(["px","rem","em","pt","dp","sp"]).optional(),numberPrecision:Jt().int().min(0).max(10).optional()}).optional()}),zT=He({id:ce().regex(/^[a-zA-Z0-9-_]+$/),displayName:ce(),description:ce().optional(),isDefault:Bn()}),X1=He({value:nr([ce(),Jt(),Bn()]),tokenId:ce().regex(/^[a-zA-Z0-9-_]+$/).optional()}),PT=He({platformId:ce(),value:X1}),BT=He({tokenId:ce().regex(/^[a-zA-Z0-9-_]+$/),value:X1,platformOverrides:nt(PT).optional()}),FT=vi(nt(BT)),LT=He({id:ce(),name:ce(),description:ce().optional()}),$T=He({id:ce(),name:ce(),description:ce(),terms:nt(LT),resolvedValueTypeIds:nt(ce()).optional()}),GT=He({emptyModeIds:en(["mapToDefaults","preserveEmpty","requireExplicit"]),preserveOriginalValues:Bn()}),HT=He({version:ce(),dimensions:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)),date:ce(),migrationStrategy:GT.optional()}),qT=He({whenAdding:ce().regex(/^[a-zA-Z0-9-_]+$/),mapEmptyModeIdsTo:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)),preserveDefaultValues:Bn().optional()}),UT=He({rules:nt(qT)});He({systemName:ce(),systemId:ce().regex(/^[a-zA-Z0-9-_]+$/),description:ce().optional(),version:ce(),versionHistory:nt(HT),dimensionEvolution:UT.optional(),dimensions:nt(ET),dimensionOrder:nt(ce().regex(/^[a-zA-Z0-9-_]+$/)).optional(),tokenCollections:nt(NT),tokens:nt(m0),platforms:nt(VT),themes:nt(zT).optional(),themeOverrides:FT.optional(),taxonomies:nt($T),resolvedValueTypes:nt(jT),extensions:He({tokenGroups:nt(RT).optional(),tokenVariants:vi(bi()).optional()}).optional()}).refine(e=>{if(!e.dimensionOrder)return!0;const t=new Set(e.dimensions.map(n=>n.id));return e.dimensionOrder.every(n=>t.has(n))},{message:"All dimensionOrder IDs must match existing dimension IDs",path:["dimensionOrder"]});function WT({valueTypes:e,onUpdate:t,tokens:n,collections:r,dimensions:i,platforms:a,taxonomies:l,themes:u}){const{colorMode:h}=tn(),[f,p]=z.useState(!1),[g,y]=z.useState(null),[b,A]=z.useState(""),[D,j]=z.useState("CUSTOM"),[w,C]=z.useState({}),_=Hn(),N=e.filter(J=>!g||J.id!==g.id).map(J=>J.type).filter(J=>!!J),E=Object.values(J1.enum).filter(J=>!N.includes(J)),I=()=>{y(null),A(""),j("CUSTOM"),p(!0)},H=J=>{y(J),A(J.displayName),j(J.type||"CUSTOM"),p(!0)},Z=J=>{const pe=JSON.parse(localStorage.getItem("token-model:data")||"{}"),G=pe.systemName||"Design Token System",ge=pe.systemId||"default-system-id",W={tokenCollections:r,dimensions:i,tokens:n,platforms:a,taxonomies:l,themes:u,resolvedValueTypes:J,version:"1.0.0",versionHistory:[],systemName:G,systemId:ge},L=mr.validateData(W);return L.isValid?(t(J),!0):(console.error("[ValueTypesView] Schema validation failed:",{errors:L.errors,data:W}),_({title:"Schema Validation Failed",description:"Your change would make the data invalid. See the Validation tab for details.",status:"error",duration:4e3,isClosable:!0}),!1)},ae=()=>{if(C({}),!b.trim()){C({name:"Name is required"}),_({title:"Required Field Missing",description:"Value type name is required.",status:"error",duration:4e3,isClosable:!0});return}if(!D){C({type:"Type is required"}),_({title:"Required Field Missing",description:"Value type must be selected.",status:"error",duration:4e3,isClosable:!0});return}const J={id:b.trim().toLowerCase().replace(/\s+/g,"-"),displayName:b.trim(),...D!=="CUSTOM"?{type:D}:{}};if(g){const pe=e.map(G=>G.id===g.id?J:G);if(!Z(pe))return;_({title:"Value Type Updated",description:`Successfully updated value type "${J.displayName}"`,status:"success",duration:3e3,isClosable:!0})}else{const pe=[...e,J];if(!Z(pe))return;_({title:"Value Type Created",description:`Successfully created value type "${J.displayName}"`,status:"success",duration:3e3,isClosable:!0})}p(!1)},ne=()=>{p(!1)},F=J=>{const pe=e.filter(G=>G.id!==J.id);Z(pe)&&_({title:"Value Type Deleted",description:`Successfully deleted value type "${J.displayName}"`,status:"info",duration:3e3,isClosable:!0})};return s.jsxs(Y,{children:[s.jsx(B,{fontSize:"2xl",fontWeight:"bold",mb:4,children:"Value Types"}),s.jsxs(Y,{p:4,mb:4,borderWidth:1,borderRadius:"md",bg:h==="dark"?"gray.900":"white",children:[s.jsx(Ee,{size:"sm",onClick:I,colorScheme:"blue",mb:4,leftIcon:s.jsx(ds,{}),children:"Create New Value Type"}),s.jsx(ye,{align:"stretch",spacing:2,children:e.map(J=>s.jsx(Y,{p:3,borderWidth:1,borderRadius:"md",bg:h==="dark"?"gray.800":"gray.50",borderColor:h==="dark"?"gray.600":"gray.200",children:s.jsxs(ve,{justify:"space-between",align:"center",children:[s.jsxs(Y,{children:[s.jsx(Aa,{title:J.displayName,cardType:J.type||"Custom"}),s.jsxs(B,{fontSize:"sm",color:"gray.600",children:["Type: ",J.type||"Custom"]})]}),s.jsxs(ve,{children:[s.jsx(mt,{"aria-label":"Edit value type",icon:s.jsx(Is,{}),size:"sm",onClick:()=>H(J)}),s.jsx(mt,{"aria-label":"Delete value type",icon:s.jsx(hs,{}),size:"sm",colorScheme:"red",onClick:()=>F(J)})]})]})},J.id))})]}),s.jsxs(zn,{isOpen:f,onClose:ne,children:[s.jsx(vn,{}),s.jsxs(Pn,{children:[s.jsx(wn,{children:g?"Edit Value Type":"Create Value Type"}),s.jsx(cr,{}),s.jsx(Sn,{children:s.jsxs(ye,{spacing:4,children:[s.jsxs(Ge,{isInvalid:!!w.name,children:[s.jsx(Ue,{children:"Name"}),s.jsx(ut,{value:b,onChange:J=>A(J.target.value),placeholder:"Enter value type name"}),w.name&&s.jsx(_h,{children:w.name})]}),s.jsxs(Ge,{isInvalid:!!w.type,children:[s.jsx(Ue,{children:"Type"}),s.jsxs(Zt,{value:D,onChange:J=>j(J.target.value),children:[s.jsx("option",{value:"CUSTOM",children:"Custom"}),E.map(J=>s.jsx("option",{value:J,children:J},J))]}),w.type&&s.jsx(_h,{children:w.type})]})]})}),s.jsxs(Xn,{children:[s.jsx(Ee,{variant:"ghost",mr:3,onClick:ne,children:"Cancel"}),s.jsx(Ee,{colorScheme:"blue",onClick:ae,children:"Save"})]})]})]})]})}const ZT=()=>{const e=kx(),t=Hn(),[n,r]=z.useState("loading"),[i,a]=z.useState(""),[l,u]=z.useState(!1),h=z.useRef(!1);z.useEffect(()=>{(async()=>{if(!h.current){h.current=!0;try{const D=new URLSearchParams(window.location.search),j=D.get("code"),w=D.get("state"),C=D.get("error");if(C)throw new Error(`GitHub authorization error: ${C}`);if(!j||!w){if(cn.isAuthenticated()){r("success"),u(!0);return}throw new Error("Missing authorization code or state parameter")}const _=await cn.handleCallback(j,w);r("success"),t({title:"GitHub Connected",description:`Successfully connected to GitHub as ${_.login}`,status:"success",duration:5e3,isClosable:!0}),u(!0)}catch(D){console.error("GitHub callback error:",D),a(D instanceof Error?D.message:"Unknown error occurred"),r("error"),h.current=!1}}})()},[e,t]);const f=(A,D)=>{t({title:"Data Loaded",description:`Successfully loaded ${D==="schema"?"core data":"theme override"} from GitHub`,status:"success",duration:5e3,isClosable:!0}),window.dispatchEvent(new CustomEvent("github:file-loaded")),e("/")},p=()=>{e("/")},g=async()=>{cn.logout(),cn.clearOAuthState(),await cn.initiateAuth()},y=()=>{u(!0)},b=async()=>{cn.logout(),cn.clearOAuthState(),localStorage.removeItem("github_selected_repo"),await cn.initiateAuth()};return l?s.jsx(gm,{isOpen:l,onClose:p,onFileSelected:f}):n==="loading"?s.jsx(Y,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"column",children:s.jsxs(ye,{spacing:4,children:[s.jsx(cs,{size:"xl"}),s.jsx(B,{children:"Connecting to GitHub..."})]})}):n==="error"?s.jsx(Y,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"column",p:8,children:s.jsxs(ye,{spacing:6,maxW:"md",children:[s.jsxs(xn,{status:"error",children:[s.jsx(bn,{}),s.jsxs(Y,{children:[s.jsx(Oi,{children:"GitHub Connection Failed"}),s.jsx(or,{children:i})]})]}),s.jsxs(ye,{spacing:3,children:[s.jsx(Ee,{colorScheme:"blue",onClick:g,children:"Retry GitHub Connection"}),s.jsx(Ee,{variant:"outline",onClick:b,children:"Clear All & Retry"}),cn.isAuthenticated()&&s.jsx(Ee,{variant:"outline",onClick:y,children:"Select Repository"}),s.jsx(Ee,{variant:"ghost",onClick:()=>e("/"),children:"Return to App"})]})]})}):s.jsx(Y,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"column",p:8,children:s.jsxs(ye,{spacing:6,maxW:"md",children:[s.jsxs(xn,{status:"success",children:[s.jsx(bn,{}),s.jsxs(Y,{children:[s.jsx(Oi,{children:"GitHub Connected Successfully"}),s.jsx(or,{children:"Please select a repository and file to load."})]})]}),s.jsx(cs,{size:"md"})]})})},YT=()=>{const{schema:e}=sS(),[t,n]=z.useState("minimal"),[r,i]=z.useState([]),[a,l]=z.useState([]),[u,h]=z.useState([]),[f,p]=z.useState([]),[g,y]=z.useState([]),[b,A]=z.useState([]),[D,j]=z.useState([]),[w,C]=z.useState([]),[_,N]=z.useState([]),[E,I]=z.useState(!0),[H,Z]=z.useState([]),[ae,ne]=z.useState([]),[F,J]=z.useState(()=>{const Ae=he.getDimensionOrder();return Ae&&Array.isArray(Ae)&&Ae.length>0?Ae:u.map(be=>be.id)}),[pe,G]=z.useState(null),[ge,W]=z.useState(!1),[L,Q]=z.useState(!1),[fe,xe]=z.useState(null),[ue,ke]=z.useState(null),q=Hn(),[re,Se]=z.useState(null),[we,Ce]=z.useState({currentData:{},baselineData:null}),[Le,ft]=z.useState(!1);z.useEffect(()=>{const Ae=he.getCollections(),be=he.getModes(),Oe=he.getDimensions(),Pe=he.getValueTypes(),qe=he.getPlatforms(),Qe=he.getThemes(),je=he.getTokens(),un=he.getTaxonomies(),ur=he.getAlgorithms(),le=he.getNamingRules();i(Ae),l(be),h(Oe),p(Pe),A(qe),j(Qe),y(je),C(un),N(ur),ne(le.taxonomyOrder),Se({collections:Ae,modes:be,dimensions:Oe,resolvedValueTypes:Pe,platforms:qe,themes:Qe,tokens:je,taxonomies:un,algorithms:ur,namingRules:le});const Te=cn.getCurrentUser(),Je=An.getSelectedRepositoryInfo();xe(Te),ke(Je),I(!1)},[]),z.useEffect(()=>{const Ae=()=>{const Pe=cn.isAuthenticated(),qe=cn.getCurrentUser(),Qe=An.getSelectedRepositoryInfo();Q(Pe),xe(qe),ke(Qe)};Ae();const be=()=>{Ae()},Oe=()=>{Ae()};return window.addEventListener("storage",be),window.addEventListener("github:file-loaded",Oe),()=>{window.removeEventListener("storage",be),window.removeEventListener("github:file-loaded",Oe)}},[]),z.useEffect(()=>{Z([{label:"Example Minimal (with algorithms)",value:"minimal",hasAlgorithms:!0},{label:"Core Data (with algorithms)",value:"core",hasAlgorithms:!0},{label:"Brand A Overrides",value:"brandAOverrides",hasAlgorithms:!1},{label:"Brand B Overrides",value:"brandBOverrides",hasAlgorithms:!1}])},[]);const vt=z.useCallback(async Ae=>{var be;try{console.log("[App] Loading data from package source:",Ae);const Oe=await Xl[Ae](),Pe=Oe.default||Oe;let qe=null,Qe=null;try{const En=await Hp[Ae]();En&&En.default?(console.log("[App] Algorithm module loaded:",En.default),Qe=En.default,qe=En.default.algorithms||[],console.log("[App] Loaded algorithms:",qe)):(console.log("[App] No algorithm data available for this data source"),qe=null)}catch{console.log("[App] No algorithm data available for:",Ae)}const je=Pe,un=je.tokenCollections??[],ur=je.dimensions??[],le=(je.tokens??[]).map(En=>({...En,valuesByMode:En.valuesByMode})),Te=je.platforms??[],Je=(je.themes??[]).map(En=>({id:En.id,displayName:En.displayName,isDefault:En.isDefault??!1,description:En.description})),et=je.taxonomies??[],gt=je.resolvedValueTypes??[],Tt={taxonomyOrder:((be=je.namingRules)==null?void 0:be.taxonomyOrder)??[]},ln=je.versionHistory??[],Xt=je.systemName??"Design System",Ht=je.systemId??"design-system",Mt=je.description??"A comprehensive design system with tokens, dimensions, and themes",dr=je.version??"1.0.0",ps=ur.flatMap(En=>En.modes||[]);i(un),l(ps),h(ur),p(gt),y(le),A(Te),j(Je),C(et),ne(Tt.taxonomyOrder),qe?(console.log("[App] Loading",qe.length,"algorithms"),N(qe),he.setAlgorithms(qe),Qe&&he.setAlgorithmFile(Qe),console.log(`Loaded ${qe.length} algorithms from ${Ae}`)):(console.log("[App] No algorithm data found, clearing algorithms state"),N([]),he.setAlgorithms([]),localStorage.removeItem("token-model:algorithm-file")),I(!1),he.setCollections(un),he.setModes(ps),he.setDimensions(ur),he.setValueTypes(gt),he.setTokens(le),he.setPlatforms(Te),he.setThemes(Je),he.setTaxonomies(et),he.setNamingRules(Tt),he.setRootData({systemName:Xt,systemId:Ht,description:Mt,version:dr,versionHistory:ln}),window.dispatchEvent(new CustomEvent(sr))}catch(Oe){let Pe="Error loading data:";Oe instanceof SyntaxError?Pe+=" The selected file is not valid JSON.":Oe instanceof Error&&(Pe+=" "+Oe.message),console.error(Pe,Oe),alert(Pe),I(!1)}},[]);z.useEffect(()=>{t&&!L&&vt(t)},[t,L,vt]);const on=()=>{const Ae=he.getCollections(),be=he.getModes(),Oe=he.getDimensions(),Pe=he.getValueTypes(),qe=he.getPlatforms(),Qe=he.getThemes(),je=he.getTokens(),un=he.getTaxonomies(),ur=he.getAlgorithms(),le=he.getNamingRules();i(Ae),l(be),h(Oe),p(Pe),A(qe),j(Qe),y(je),C(un),N(ur),ne(le.taxonomyOrder)};z.useEffect(()=>(window.refreshAppData=on,()=>{delete window.refreshAppData}),[]);const Rt=()=>{localStorage.clear(),sessionStorage.clear(),he.clearAll(),y([]),i([]),l([]),h([]),p([]),A([]),j([]),C([]),ne([]),N([]),Se({collections:[],modes:[],dimensions:[],resolvedValueTypes:[],platforms:[],themes:[],tokens:[],taxonomies:[],algorithms:[],namingRules:{taxonomyOrder:[]}}),"caches"in window&&caches.keys().then(Ae=>{Ae.forEach(be=>{caches.delete(be)})}),window.location.reload()},nn=async()=>{try{cn.isAuthenticated()&&(console.log("User already authenticated, clearing OAuth state before new auth"),cn.clearOAuthState()),await cn.initiateAuth()}catch(Ae){console.error("GitHub connection error:",Ae),q({title:"GitHub Connection Failed",description:Ae instanceof Error?Ae.message:"Failed to connect to GitHub. Please try again.",status:"error",duration:5e3,isClosable:!0})}},Ir=()=>{cn.logout(),xe(null),ke(null),Q(!1),localStorage.removeItem("github_selected_repo"),q({title:"Disconnected",description:"Successfully disconnected from GitHub.",status:"info",duration:3e3,isClosable:!0})},jt=(Ae,be)=>{const Oe=localStorage.getItem("github_selected_repo");if(Oe){const qe=JSON.parse(Oe);ke(qe)}const Pe=cn.getCurrentUser();Pe&&(xe(Pe),Q(!0))},Bt=()=>{G({id:"",displayName:"",description:"",tokenCollectionId:"",resolvedValueTypeId:"color",propertyTypes:[],private:!1,themeable:!1,status:"experimental",tokenTier:"PRIMITIVE",generatedByAlgorithm:!1,taxonomies:[],codeSyntax:[],valuesByMode:[]}),W(!0)},qn=()=>{W(!1),G(null)},Fn=Ae=>{console.log("[App] handleSaveToken called with token:",Ae),y(be=>{console.log("[App] Previous tokens:",be);let Oe;const Pe=be.findIndex(qe=>qe.id===Ae.id);return Pe!==-1?(console.log("[App] Updating existing token at index:",Pe),Oe=be.map(qe=>qe.id===Ae.id?Ae:qe)):(console.log("[App] Adding new token with ID:",Ae.id),Oe=[...be,Ae]),console.log("[App] Updated tokens:",Oe),he.setTokens(Oe),window.dispatchEvent(new CustomEvent(sr)),Oe}),q({title:"Token saved",description:`Token "${Ae.displayName}" has been saved successfully`,status:"success",duration:3e3,isClosable:!0}),qn()},Ct=Ae=>{const be=g.find(Oe=>Oe.id===Ae);y(Oe=>{const Pe=Oe.filter(qe=>qe.id!==Ae);return he.setTokens(Pe),window.dispatchEvent(new CustomEvent(sr)),Pe}),be&&q({title:"Token deleted",description:`Token "${be.displayName}" has been deleted`,status:"info",duration:3e3,isClosable:!0})},kn=Ae=>{y(Ae),he.setTokens(Ae),window.dispatchEvent(new CustomEvent(sr))},Ln=Ae=>{i(Ae),he.setCollections(Ae),window.dispatchEvent(new CustomEvent(sr))},ee=Ae=>{h(Ae),he.setDimensions(Ae),window.dispatchEvent(new CustomEvent(sr))},Ve=Ae=>{p(Ae),he.setValueTypes(Ae),window.dispatchEvent(new CustomEvent(sr))},Ie=Ae=>{A(Ae),he.setPlatforms(Ae),window.dispatchEvent(new CustomEvent(sr))},Ne=Ae=>{j(Ae),he.setThemes(Ae),window.dispatchEvent(new CustomEvent(sr))},ot=Ae=>{C(Ae),he.setTaxonomies(Ae),window.dispatchEvent(new CustomEvent(sr))},Ke=Ae=>{N(Ae),he.setAlgorithms(Ae),window.dispatchEvent(new CustomEvent(sr))},Et=()=>{ft(!1)};return E?s.jsx(Y,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:s.jsx(cs,{})}):s.jsxs(Pp,{theme:qu,children:[s.jsx(jx,{children:s.jsx(Y,{h:"100vh",display:"flex",flexDirection:"column",children:s.jsx(Y,{flex:"1",position:"relative",children:s.jsx(zb,{dataSource:t,setDataSource:n,dataOptions:H,onResetData:Rt,onExportData:()=>{},isGitHubConnected:L,githubUser:fe,selectedRepoInfo:ue,onGitHubConnect:nn,onGitHubDisconnect:Ir,onFileSelected:jt,children:s.jsxs(Cx,{children:[s.jsx(yn,{path:"/",element:s.jsx(ta,{to:"/dashboard",replace:!0})}),s.jsx(yn,{path:"/dashboard",element:s.jsx(L2,{tokens:g,platforms:b,themes:D})}),s.jsx(yn,{path:"/tokens",element:s.jsx(ta,{to:"/tokens/tokens",replace:!0})}),s.jsx(yn,{path:"/tokens/tokens",element:s.jsxs(s.Fragment,{children:[s.jsx(Gb,{tokens:g,collections:r,resolvedValueTypes:f,modes:a,taxonomies:w,renderAddTokenButton:s.jsx(Ee,{colorScheme:"blue",size:"sm",onClick:Bt,leftIcon:s.jsx(ts,{}),children:"Add Token"}),onEditToken:Ae=>{G(Ae),W(!0)}}),ge&&pe&&s.jsx(nS,{token:pe,tokens:g,dimensions:u,modes:a,platforms:b,open:ge,onClose:qn,onSave:Fn,taxonomies:w,resolvedValueTypes:f,isNew:!pe.id,onViewClassifications:()=>{},onDeleteToken:Ct,collections:r,schema:e})]})}),s.jsx(yn,{path:"/tokens/collections",element:s.jsx(qb,{collections:r,onUpdate:Ln,tokens:g,resolvedValueTypes:f})}),s.jsx(yn,{path:"/tokens/system-variables",element:s.jsx(Wb,{dimensions:u})}),s.jsx(yn,{path:"/tokens/algorithms",element:s.jsx(o9,{algorithms:_,onUpdate:Ke,onUpdateTokens:kn})}),s.jsx(yn,{path:"/tokens/analysis",element:s.jsx(gT,{tokens:g,collections:r,dimensions:u,platforms:b,taxonomies:w,resolvedValueTypes:f})}),s.jsx(yn,{path:"/schemas",element:s.jsx(ta,{to:"/schemas/core-data",replace:!0})}),s.jsx(yn,{path:"/schemas/core-data",element:s.jsx(Uw,{})}),s.jsx(yn,{path:"/schemas/theme-overrides",element:s.jsx(Yw,{})}),s.jsx(yn,{path:"/schemas/algorithm-data",element:s.jsx(Kw,{})}),s.jsx(yn,{path:"/setup",element:s.jsx(ta,{to:"/dimensions",replace:!0})}),s.jsx(yn,{path:"/dimensions",element:s.jsx(xT,{dimensions:u,setDimensions:ee,dimensionOrder:F,setDimensionOrder:J,onDataChange:Ae=>{ee(Ae.dimensions),J(Ae.dimensionOrder),he.setDimensionOrder(Ae.dimensionOrder)}})}),s.jsx(yn,{path:"/classification",element:s.jsx(wT,{taxonomies:w,setTaxonomies:ot,tokens:g,collections:r,dimensions:u,platforms:b,resolvedValueTypes:f})}),s.jsx(yn,{path:"/naming-rules",element:s.jsx(ST,{taxonomies:w,taxonomyOrder:ae,setTaxonomyOrder:ne})}),s.jsx(yn,{path:"/value-types",element:s.jsx(WT,{valueTypes:f,onUpdate:Ve,tokens:g,collections:r,dimensions:u,platforms:b,taxonomies:w,themes:D})}),s.jsx(yn,{path:"/themes",element:s.jsx(O2,{themes:D,setThemes:Ne})}),s.jsx(yn,{path:"/publishing",element:s.jsx(ta,{to:"/platforms",replace:!0})}),s.jsx(yn,{path:"/platforms",element:s.jsx(c9,{platforms:b,setPlatforms:Ie,tokens:g,setTokens:kn,taxonomies:w})}),s.jsx(yn,{path:"/export-settings",element:s.jsx(Y,{p:4,children:"Export settings content coming soon..."})}),s.jsx(yn,{path:"/validation",element:s.jsx(d9,{tokens:g,collections:r,dimensions:u,platforms:b,taxonomies:w,version:"1.0.0",versionHistory:[],onValidate:()=>{}})}),s.jsx(yn,{path:"/version-history",element:s.jsx(Y,{p:4,children:"Version history content coming soon..."})}),s.jsx(yn,{path:"/access",element:s.jsx(Y,{p:4,children:"Access management coming soon..."})}),s.jsx(yn,{path:"/auth/github/callback",element:s.jsx(ZT,{})}),s.jsx(yn,{path:"*",element:s.jsx(ta,{to:"/dashboard",replace:!0})})]})})})})}),s.jsxs(zn,{isOpen:Le,onClose:Et,size:"xl",scrollBehavior:"inside",closeOnOverlayClick:!0,closeOnEsc:!0,isCentered:!0,children:[s.jsx(vn,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),s.jsxs(Pn,{children:[s.jsx(wn,{children:"Change History"}),s.jsx(cr,{}),s.jsx(Sn,{pb:6,children:s.jsx(mm,{currentData:we==null?void 0:we.currentData})})]})]})]})};typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log("System color scheme changed:",e.matches?"dark":"light")});const K1=document.getElementById("root");if(!K1)throw new Error("Failed to find the root element");Du.createRoot(K1).render(s.jsx(kt.StrictMode,{children:s.jsxs(Pp,{theme:qu,children:[s.jsx(xx,{initialColorMode:qu.config.initialColorMode}),s.jsx(YT,{})]})}));
